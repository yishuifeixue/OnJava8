<!DOCTYPE html><html><head>
      <title>19-Type-Information</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\18215\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.12\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <ul>
<li><a href="#%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF">&#x7B2C;&#x5341;&#x4E5D;&#x7AE0; &#x7C7B;&#x578B;&#x4FE1;&#x606F;</a>
<ul>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-rtti">&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981; RTTI</a></li>
<li><a href="#class-%E5%AF%B9%E8%B1%A1"><code>Class</code> &#x5BF9;&#x8C61;</a>
<ul>
<li><a href="#%E7%B1%BB%E5%AD%97%E9%9D%A2%E5%B8%B8%E9%87%8F">&#x7C7B;&#x5B57;&#x9762;&#x5E38;&#x91CF;</a></li>
<li><a href="#%E6%B3%9B%E5%8C%96%E7%9A%84-class-%E5%BC%95%E7%94%A8">&#x6CDB;&#x5316;&#x7684; <code>Class</code> &#x5F15;&#x7528;</a></li>
<li><a href="#cast-%E6%96%B9%E6%B3%95"><code>cast()</code> &#x65B9;&#x6CD5;</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%A3%80%E6%B5%8B">&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x68C0;&#x6D4B;</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%AD%97%E9%9D%A2%E9%87%8F">&#x4F7F;&#x7528;&#x7C7B;&#x5B57;&#x9762;&#x91CF;</a></li>
<li><a href="#%E4%B8%80%E4%B8%AA%E5%8A%A8%E6%80%81-instanceof-%E5%87%BD%E6%95%B0">&#x4E00;&#x4E2A;&#x52A8;&#x6001; <code>instanceof</code> &#x51FD;&#x6570;</a></li>
<li><a href="#%E9%80%92%E5%BD%92%E8%AE%A1%E6%95%B0">&#x9012;&#x5F52;&#x8BA1;&#x6570;</a></li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E5%86%8C%E5%B7%A5%E5%8E%82">&#x6CE8;&#x518C;&#x5DE5;&#x5382;</a></li>
<li><a href="#%E7%B1%BB%E7%9A%84%E7%AD%89%E4%BB%B7%E6%AF%94%E8%BE%83">&#x7C7B;&#x7684;&#x7B49;&#x4EF7;&#x6BD4;&#x8F83;</a></li>
<li><a href="#%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E4%BF%A1%E6%81%AF">&#x53CD;&#x5C04;&#xFF1A;&#x8FD0;&#x884C;&#x65F6;&#x7C7B;&#x4FE1;&#x606F;</a>
<ul>
<li><a href="#%E7%B1%BB%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96%E5%99%A8">&#x7C7B;&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x5668;</a></li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86">&#x52A8;&#x6001;&#x4EE3;&#x7406;</a></li>
<li><a href="#optional%E7%B1%BB">Optional&#x7C7B;</a>
<ul>
<li><a href="#%E6%A0%87%E8%AE%B0%E6%8E%A5%E5%8F%A3">&#x6807;&#x8BB0;&#x63A5;&#x53E3;</a></li>
<li><a href="#mock-%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%A1%A9">Mock &#x5BF9;&#x8C61;&#x548C;&#x6869;</a></li>
</ul>
</li>
<li><a href="#%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB%E5%9E%8B">&#x63A5;&#x53E3;&#x548C;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</a></li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF">&#x7B2C;&#x5341;&#x4E5D;&#x7AE0; &#x7C7B;&#x578B;&#x4FE1;&#x606F;</h1>

<blockquote>
<p>RTTI&#xFF08;RunTime Type Information&#xFF0C;&#x8FD0;&#x884C;&#x65F6;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF09;&#x80FD;&#x591F;&#x5728;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x53D1;&#x73B0;&#x548C;&#x4F7F;&#x7528;&#x7C7B;&#x578B;&#x4FE1;&#x606F;</p>
</blockquote>
<p>RTTI &#x628A;&#x6211;&#x4EEC;&#x4ECE;&#x53EA;&#x80FD;&#x5728;&#x7F16;&#x8BD1;&#x671F;&#x8FDB;&#x884C;&#x9762;&#x5411;&#x7C7B;&#x578B;&#x64CD;&#x4F5C;&#x7684;&#x7981;&#x9522;&#x4E2D;&#x89E3;&#x8131;&#x4E86;&#x51FA;&#x6765;&#xFF0C;&#x5E76;&#x4E14;&#x8BA9;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x67D0;&#x4E9B;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x5BF9; RTTI &#x7684;&#x9700;&#x8981;&#xFF0C;&#x63ED;&#x793A;&#x4E86;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x8BBE;&#x8BA1;&#x4E2D;&#x8BB8;&#x591A;&#x6709;&#x8DA3;&#xFF08;&#x5E76;&#x4E14;&#x590D;&#x6742;&#xFF09;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5E26;&#x6765;&#x4E86;&#x5173;&#x4E8E;&#x5982;&#x4F55;&#x7EC4;&#x7EC7;&#x7A0B;&#x5E8F;&#x7684;&#x57FA;&#x672C;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x672C;&#x7AE0;&#x5C06;&#x8BA8;&#x8BBA; Java &#x662F;&#x5982;&#x4F55;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x8BC6;&#x522B;&#x5BF9;&#x8C61;&#x548C;&#x7C7B;&#x4FE1;&#x606F;&#x7684;&#x3002;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<ol>
<li>&#x201C;&#x4F20;&#x7EDF;&#x7684;&#x201D; RTTI&#xFF1A;&#x5047;&#x5B9A;&#x6211;&#x4EEC;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x4E86;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x578B;&#xFF1B;</li>
<li>&#x201C;&#x53CD;&#x5C04;&#x201D;&#x673A;&#x5236;&#xFF1A;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x53D1;&#x73B0;&#x548C;&#x4F7F;&#x7528;&#x7C7B;&#x7684;&#x4FE1;&#x606F;&#x3002;</li>
</ol>
<h2 class="mume-header" id="%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-rtti">&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981; RTTI</h2>

<p>&#x4E0B;&#x9762;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5F88;&#x719F;&#x6089;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x4E86;&#x591A;&#x6001;&#x7684;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x3002;&#x57FA;&#x7C7B; <code>Shape</code> &#x662F;&#x6CDB;&#x5316;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x4ECE;&#x5B83;&#x6D3E;&#x751F;&#x51FA;&#x4E86;&#x4E09;&#x4E2A;&#x5177;&#x4F53;&#x7C7B;&#xFF1A; <code>Circle</code> &#x3001;<code>Square</code> &#x548C; <code>Triangle</code>&#xFF08;&#x89C1;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF09;&#x3002;</p>
<p><img src="../images/image-20190409114913825-4781754.png" alt="&#x591A;&#x6001;&#x4F8B;&#x5B50;Shape&#x7684;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x56FE;"></p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x56FE;&#xFF0C;&#x57FA;&#x7C7B;&#x4F4D;&#x4E8E;&#x9876;&#x90E8;&#xFF0C;&#x6D3E;&#x751F;&#x7C7B;&#x5411;&#x4E0B;&#x6269;&#x5C55;&#x3002;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x76EE;&#x7684;&#x662F;&#xFF1A;&#x8BA9;&#x4EE3;&#x7801;&#x53EA;&#x64CD;&#x7EB5;&#x5BF9;&#x57FA;&#x7C7B;(&#x8FD9;&#x91CC;&#x5373; <code>Shape</code> )&#x7684;&#x5F15;&#x7528;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x65B0;&#x7C7B;(&#x6BD4;&#x5982;&#x4ECE; <code>Shape</code> &#x6D3E;&#x751F;&#x51FA; <code>Rhomboid</code>)&#x6765;&#x6269;&#x5C55;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C31;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x539F;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;<code>Shape</code> &#x63A5;&#x53E3;&#x4E2D;&#x52A8;&#x6001;&#x7ED1;&#x5B9A;&#x4E86; <code>draw()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x8BA9;&#x5BA2;&#x6237;&#x7AEF;&#x7A0B;&#x5E8F;&#x5458;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6CDB;&#x5316;&#x7684; <code>Shape</code> &#x5F15;&#x7528;&#x6765;&#x8C03;&#x7528; <code>draw()</code>&#x3002;<code>draw()</code> &#x65B9;&#x6CD5;&#x5728;&#x6240;&#x6709;&#x6D3E;&#x751F;&#x7C7B;&#x91CC;&#x90FD;&#x4F1A;&#x88AB;&#x8986;&#x76D6;&#xFF0C;&#x800C;&#x4E14;&#x7531;&#x4E8E;&#x5B83;&#x662F;&#x52A8;&#x6001;&#x7ED1;&#x5B9A;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5373;&#x4F7F;&#x901A;&#x8FC7; <code>Shape</code> &#x5F15;&#x7528;&#x6765;&#x8C03;&#x7528;&#x5B83;&#xFF0C;&#x4E5F;&#x80FD;&#x4EA7;&#x751F;&#x6070;&#x5F53;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x591A;&#x6001;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x5BF9;&#x8C61;(<code>Circle</code>&#x3001;<code>Square</code> &#x6216;&#x8005; <code>Triangle</code>)&#xFF0C;&#x628A;&#x5B83;&#x5411;&#x4E0A;&#x8F6C;&#x578B;&#x6210; <code>Shape</code> (&#x5FFD;&#x7565;&#x5BF9;&#x8C61;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;)&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x540E;&#x9762;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528; <code>Shape</code> &#x5F15;&#x7528;&#x6765;&#x8C03;&#x7528;&#x5728;&#x5177;&#x4F53;&#x5BF9;&#x8C61;&#x4E2D;&#x88AB;&#x91CD;&#x8F7D;&#x7684;&#x65B9;&#x6CD5;&#xFF08;&#x5982; <code>draw()</code>&#xFF09;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Shapes.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot;.draw()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;Circle&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;Square&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Triangle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;Triangle&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Shapes</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Square</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Triangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">Shape</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">draw</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Circle.draw()
Square.draw()
Triangle.draw()
</code></pre><p>&#x57FA;&#x7C7B;&#x4E2D;&#x5305;&#x542B; <code>draw()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x901A;&#x8FC7;&#x4F20;&#x9012; <code>this</code> &#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9; <code>System.out.println()</code>&#xFF0C;&#x95F4;&#x63A5;&#x5730;&#x4F7F;&#x7528; <code>toString()</code> &#x6253;&#x5370;&#x7C7B;&#x6807;&#x8BC6;&#x7B26;(&#x6CE8;&#x610F;&#xFF1A;&#x8FD9;&#x91CC;&#x5C06; <code>toString()</code> &#x58F0;&#x660E;&#x4E3A; <code>abstract</code>&#xFF0C;&#x4EE5;&#x6B64;&#x5F3A;&#x5236;&#x7EE7;&#x627F;&#x8005;&#x8986;&#x76D6;&#x8BE5;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x9632;&#x6B62;&#x5BF9; <code>Shape</code> &#x7684;&#x5B9E;&#x4F8B;&#x5316;)&#x3002;&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x5BF9;&#x8C61;&#x51FA;&#x73B0;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;(&#x6D89;&#x53CA;&quot;+&quot;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;&#x7684;&#x8868;&#x8FBE;&#x5F0F;)&#xFF0C;<code>toString()</code> &#x65B9;&#x6CD5;&#x5C31;&#x4F1A;&#x88AB;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x751F;&#x6210;&#x8868;&#x793A;&#x8BE5;&#x5BF9;&#x8C61;&#x7684; <code>String</code>&#x3002;&#x6BCF;&#x4E2A;&#x6D3E;&#x751F;&#x7C7B;&#x90FD;&#x8981;&#x8986;&#x76D6;&#xFF08;&#x4ECE; <code>Object</code> &#x7EE7;&#x627F;&#x6765;&#x7684;&#xFF09;<code>toString()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837; <code>draw()</code> &#x5728;&#x4E0D;&#x540C;&#x60C5;&#x51B5;&#x4E0B;&#x5C31;&#x6253;&#x5370;&#x51FA;&#x4E0D;&#x540C;&#x7684;&#x6D88;&#x606F;(&#x591A;&#x6001;)&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5728;&#x628A; <code>Shape</code> &#x5BF9;&#x8C61;&#x653E;&#x5165; <code>Stream&lt;Shape&gt;</code> &#x4E2D;&#x65F6;&#x5C31;&#x4F1A;&#x8FDB;&#x884C;&#x5411;&#x4E0A;&#x8F6C;&#x578B;(&#x9690;&#x5F0F;)&#xFF0C;&#x4F46;&#x5728;&#x5411;&#x4E0A;&#x8F6C;&#x578B;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x4E22;&#x5931;&#x4E86;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x3002;&#x5BF9; <code>stream</code> &#x800C;&#x8A00;&#xFF0C;&#x5B83;&#x4EEC;&#x53EA;&#x662F; <code>Shape</code> &#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x4E25;&#x683C;&#x6765;&#x8BF4;&#xFF0C;<code>Stream&lt;Shape&gt;</code> &#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x628A;&#x653E;&#x5165;&#x5176;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x90FD;&#x5F53;&#x505A; <code>Object</code> &#x5BF9;&#x8C61;&#x6765;&#x6301;&#x6709;&#xFF0C;&#x53EA;&#x662F;&#x53D6;&#x5143;&#x7D20;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x5176;&#x7C7B;&#x578B;&#x8F6C;&#x4E3A; <code>Shape</code>&#x3002;&#x8FD9;&#x4E5F;&#x662F; RTTI &#x6700;&#x57FA;&#x672C;&#x7684;&#x4F7F;&#x7528;&#x5F62;&#x5F0F;&#xFF0C;&#x56E0;&#x4E3A;&#x5728; Java &#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x7684;&#x6B63;&#x786E;&#x6027;&#x68C0;&#x67E5;&#x90FD;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x8FDB;&#x884C;&#x7684;&#x3002;&#x8FD9;&#x4E5F;&#x6B63;&#x662F; RTTI &#x7684;&#x542B;&#x4E49;&#x6240;&#x5728;&#xFF1A;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x8BC6;&#x522B;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x5E76;&#x4E0D;&#x5F7B;&#x5E95;&#xFF1A;<code>Object</code> &#x88AB;&#x8F6C;&#x578B;&#x4E3A; <code>Shape</code> &#xFF0C;&#x800C;&#x4E0D;&#x662F; <code>Circle</code>&#x3001;<code>Square</code> &#x6216;&#x8005; <code>Triangle</code>&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x76EE;&#x524D;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A; <code>Stream&lt;Shape&gt;</code> &#x4FDD;&#x5B58;&#x7684;&#x90FD;&#x662F; <code>Shape</code>&#xFF1A;</p>
<ul>
<li>&#x7F16;&#x8BD1;&#x671F;&#xFF0C;<code>stream</code> &#x548C; Java &#x6CDB;&#x578B;&#x7CFB;&#x7EDF;&#x786E;&#x4FDD;&#x653E;&#x5165; <code>stream</code> &#x7684;&#x90FD;&#x662F; <code>Shape</code> &#x5BF9;&#x8C61;&#xFF08;<code>Shape</code> &#x5B50;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x4E5F;&#x53EF;&#x89C6;&#x4E3A; <code>Shape</code> &#x7684;&#x5BF9;&#x8C61;&#xFF09;&#xFF0C;&#x5426;&#x5219;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x62A5;&#x9519;&#xFF1B;</li>
<li>&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x786E;&#x4FDD;&#x4E86;&#x4ECE; <code>stream</code> &#x4E2D;&#x53D6;&#x51FA;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F; <code>Shape</code> &#x7C7B;&#x578B;&#x3002;</li>
</ul>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x591A;&#x6001;&#x673A;&#x5236;&#x7684;&#x4E8B;&#x4E86;&#xFF0C;<code>Shape</code> &#x5BF9;&#x8C61;&#x5B9E;&#x9645;&#x6267;&#x884C;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x662F;&#x7531;&#x5F15;&#x7528;&#x6240;&#x6307;&#x5411;&#x7684;&#x5177;&#x4F53;&#x5BF9;&#x8C61;&#xFF08;<code>Circle</code>&#x3001;<code>Square</code> &#x6216;&#x8005; <code>Triangle</code>&#xFF09;&#x51B3;&#x5B9A;&#x7684;&#x3002;&#x8FD9;&#x4E5F;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x7684;&#x4E00;&#x822C;&#x9700;&#x6C42;&#xFF0C;&#x901A;&#x5E38;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5927;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x5C3D;&#x53EF;&#x80FD;&#x5C11;&#x4E86;&#x89E3;&#x5BF9;&#x8C61;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x662F;&#x53EA;&#x4E0E;&#x5BF9;&#x8C61;&#x5BB6;&#x65CF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x8868;&#x793A;&#x6253;&#x4EA4;&#x9053;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x5373;&#x4E3A; <code>Shape</code>&#xFF09;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x4EE3;&#x7801;&#x4F1A;&#x66F4;&#x5BB9;&#x6613;&#x5199;&#xFF0C;&#x66F4;&#x6613;&#x8BFB;&#x548C;&#x7EF4;&#x62A4;&#xFF1B;&#x8BBE;&#x8BA1;&#x4E5F;&#x66F4;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;&#xFF0C;&#x66F4;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#x548C;&#x4FEE;&#x6539;&#x3002;&#x6240;&#x4EE5;&#x591A;&#x6001;&#x662F;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x57FA;&#x672C;&#x76EE;&#x6807;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x6709;&#x65F6;&#x4F60;&#x4F1A;&#x78B0;&#x5230;&#x4E00;&#x4E9B;&#x7F16;&#x7A0B;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x4E2D;&#x5982;&#x679C;&#x4F60;&#x80FD;&#x77E5;&#x9053;&#x67D0;&#x4E2A;&#x6CDB;&#x5316;&#x5F15;&#x7528;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x628A;&#x95EE;&#x9898;&#x8F7B;&#x677E;&#x89E3;&#x51B3;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x5C06;&#x67D0;&#x4E9B;&#x51E0;&#x4F55;&#x5F62;&#x72B6;&#x9AD8;&#x4EAE;&#x663E;&#x793A;&#xFF0C;&#x73B0;&#x5728;&#x5E0C;&#x671B;&#x627E;&#x5230;&#x5C4F;&#x5E55;&#x4E0A;&#x6240;&#x6709;&#x9AD8;&#x4EAE;&#x663E;&#x793A;&#x7684;&#x4E09;&#x89D2;&#x5F62;&#xFF1B;&#x6216;&#x8005;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x9700;&#x8981;&#x65CB;&#x8F6C;&#x6240;&#x6709;&#x56FE;&#x5F62;&#xFF0C;&#x4F46;&#x662F;&#x60F3;&#x8DF3;&#x8FC7;&#x5706;&#x5F62;(&#x56E0;&#x4E3A;&#x5706;&#x5F62;&#x65CB;&#x8F6C;&#x6CA1;&#x6709;&#x610F;&#x4E49;)&#x3002;&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x5C31;&#x5E0C;&#x671B;&#x77E5;&#x9053; <code>Stream&lt;Shape&gt;</code> &#x91CC;&#x8FB9;&#x7684;&#x5F62;&#x72B6;&#x5177;&#x4F53;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#xFF0C;&#x800C; Java &#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x6EE1;&#x8DB3;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x8FD9;&#x79CD;&#x9700;&#x6C42;&#x3002;&#x4F7F;&#x7528; RTTI&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x67E5;&#x8BE2;&#x67D0;&#x4E2A; <code>Shape</code> &#x5F15;&#x7528;&#x6240;&#x6307;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x9009;&#x62E9;&#x6216;&#x8005;&#x5254;&#x9664;&#x7279;&#x4F8B;&#x3002;</p>
<h2 class="mume-header" id="class-%E5%AF%B9%E8%B1%A1"><code>Class</code> &#x5BF9;&#x8C61;</h2>

<p>&#x8981;&#x7406;&#x89E3; RTTI &#x5728; Java &#x4E2D;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF0C;&#x9996;&#x5148;&#x5FC5;&#x987B;&#x77E5;&#x9053;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x662F;&#x5982;&#x4F55;&#x8868;&#x793A;&#x7684;&#x3002;&#x8FD9;&#x9879;&#x5DE5;&#x4F5C;&#x662F;&#x7531;&#x79F0;&#x4E3A; <strong><code>Class</code>&#x5BF9;&#x8C61;</strong> &#x7684;&#x7279;&#x6B8A;&#x5BF9;&#x8C61;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x5B83;&#x5305;&#x542B;&#x4E86;&#x4E0E;&#x7C7B;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;<code>Class</code> &#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x8BE5;&#x7C7B;&#x6240;&#x6709;&quot;&#x5E38;&#x89C4;&quot;&#x5BF9;&#x8C61;&#x7684;&#x3002;Java &#x4F7F;&#x7528; <code>Class</code> &#x5BF9;&#x8C61;&#x6765;&#x5B9E;&#x73B0; RTTI&#xFF0C;&#x5373;&#x4FBF;&#x662F;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x7528; <code>Class</code> &#x5BF9;&#x8C61;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x4E0D;&#x4EC5;&#x5982;&#x6B64;&#xFF0C;<code>Class</code> &#x7C7B;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x5F88;&#x591A;&#x4F7F;&#x7528; RTTI &#x7684;&#x5176;&#x5B83;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x7C7B;&#x662F;&#x7A0B;&#x5E8F;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x6BCF;&#x4E2A;&#x7C7B;&#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x6BCF;&#x5F53;&#x6211;&#x4EEC;&#x7F16;&#x5199;&#x5E76;&#x4E14;&#x7F16;&#x8BD1;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7C7B;&#xFF0C;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#xFF08;&#x66F4;&#x6070;&#x5F53;&#x7684;&#x8BF4;&#xFF0C;&#x662F;&#x88AB;&#x4FDD;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x540C;&#x540D;&#x7684; <code>.class</code> &#x6587;&#x4EF6;&#x4E2D;&#xFF09;&#x3002;&#x4E3A;&#x4E86;&#x751F;&#x6210;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;Java &#x865A;&#x62DF;&#x673A; (JVM) &#x5148;&#x4F1A;&#x8C03;&#x7528;&quot;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&quot;&#x5B50;&#x7CFB;&#x7EDF;&#x628A;&#x8FD9;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x3002;</p>
<p>&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x5B50;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x4E00;&#x6761;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x94FE;&#xFF0C;&#x4F46;&#x6709;&#x4E14;&#x53EA;&#x6709;&#x4E00;&#x4E2A;<strong>&#x539F;&#x751F;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;</strong>&#xFF0C;&#x5B83;&#x662F; JVM &#x5B9E;&#x73B0;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x539F;&#x751F;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x52A0;&#x8F7D;&#x7684;&#x662F;&#x201D;&#x53EF;&#x4FE1;&#x7C7B;&#x201D;&#xFF08;&#x5305;&#x62EC; Java API &#x7C7B;&#xFF09;&#x3002;&#x5B83;&#x4EEC;&#x901A;&#x5E38;&#x662F;&#x4ECE;&#x672C;&#x5730;&#x76D8;&#x52A0;&#x8F7D;&#x7684;&#x3002;&#x5728;&#x8FD9;&#x6761;&#x94FE;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x4E0D;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x989D;&#x5916;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x4F60;&#x6709;&#x7279;&#x6B8A;&#x9700;&#x6C42;&#xFF08;&#x4F8B;&#x5982;&#x4EE5;&#x67D0;&#x79CD;&#x7279;&#x6B8A;&#x7684;&#x65B9;&#x5F0F;&#x52A0;&#x8F7D;&#x7C7B;&#xFF0C;&#x4EE5;&#x652F;&#x6301; Web &#x670D;&#x52A1;&#x5668;&#x5E94;&#x7528;&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x4E0B;&#x8F7D;&#x7C7B;&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6302;&#x8F7D;&#x989D;&#x5916;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x3002;</p>
<p>&#x6240;&#x6709;&#x7684;&#x7C7B;&#x90FD;&#x662F;&#x7B2C;&#x4E00;&#x6B21;&#x4F7F;&#x7528;&#x65F6;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x5230; JVM &#x4E2D;&#x7684;&#xFF0C;&#x5F53;&#x7A0B;&#x5E8F;&#x521B;&#x5EFA;&#x7B2C;&#x4E00;&#x4E2A;&#x5BF9;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x6210;&#x5458;&#x7684;&#x5F15;&#x7528;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x7C7B;&#x3002;</p>
<blockquote>
<p>&#x5176;&#x5B9E;&#x6784;&#x9020;&#x5668;&#x4E5F;&#x662F;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x867D;&#x7136;&#x6784;&#x9020;&#x5668;&#x524D;&#x9762;&#x5E76;&#x6CA1;&#x6709; <code>static</code> &#x5173;&#x952E;&#x5B57;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x4F7F;&#x7528; <code>new</code> &#x64CD;&#x4F5C;&#x7B26;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x65B0;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x4E5F;&#x7B97;&#x4F5C;&#x5BF9;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x6210;&#x5458;&#x5F15;&#x7528;&#x3002;</p>
</blockquote>
<p>&#x56E0;&#x6B64;&#xFF0C;Java &#x7A0B;&#x5E8F;&#x5728;&#x5B83;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#x4E4B;&#x524D;&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x5B8C;&#x5168;&#x52A0;&#x8F7D;&#xFF0C;&#x5F88;&#x591A;&#x90E8;&#x5206;&#x662F;&#x5728;&#x9700;&#x8981;&#x65F6;&#x624D;&#x4F1A;&#x52A0;&#x8F7D;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x4E0E;&#x8BB8;&#x591A;&#x4F20;&#x7EDF;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E0D;&#x540C;&#xFF0C;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x4F7F;&#x5F97; Java &#x5177;&#x6709;&#x4E00;&#x4E9B;&#x9759;&#x6001;&#x52A0;&#x8F7D;&#x8BED;&#x8A00;&#xFF08;&#x5982; C++&#xFF09;&#x5F88;&#x96BE;&#x6216;&#x8005;&#x6839;&#x672C;&#x4E0D;&#x53EF;&#x80FD;&#x5B9E;&#x73B0;&#x7684;&#x7279;&#x6027;&#x3002;</p>
<p>&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x9996;&#x5148;&#x4F1A;&#x68C0;&#x67E5;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#xFF0C;&#x5982;&#x679C;&#x5C1A;&#x672A;&#x52A0;&#x8F7D;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x5C31;&#x4F1A;&#x6839;&#x636E;&#x7C7B;&#x540D;&#x67E5;&#x627E; <code>.class</code> &#x6587;&#x4EF6;&#xFF08;&#x5982;&#x679C;&#x6709;&#x9644;&#x52A0;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x5C31;&#x4F1A;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x6216;&#x8005;&#x901A;&#x8FC7;&#x5176;&#x5B83;&#x65B9;&#x5F0F;&#x83B7;&#x5F97;&#x5B57;&#x8282;&#x7801;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5B57;&#x8282;&#x7801;&#x88AB;&#x52A0;&#x8F7D;&#x540E;&#xFF0C;JVM &#x4F1A;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;&#xFF0C;&#x786E;&#x4FDD;&#x5B83;&#x6CA1;&#x6709;&#x635F;&#x574F;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x5305;&#x542B;&#x4E0D;&#x826F;&#x7684; Java &#x4EE3;&#x7801;(&#x8FD9;&#x662F; Java &#x5B89;&#x5168;&#x9632;&#x8303;&#x7684;&#x4E00;&#x79CD;&#x63AA;&#x65BD;)&#x3002;</p>
<p>&#x4E00;&#x65E6;&#x67D0;&#x4E2A;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x88AB;&#x8F7D;&#x5165;&#x5185;&#x5B58;&#xFF0C;&#x5B83;&#x5C31;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x793A;&#x8303;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;&#x8FD9;&#x70B9;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/SweetShop.java</span>
<span class="token comment">// &#x68C0;&#x67E5;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;</span>
<span class="token keyword">class</span> <span class="token class-name">Cookie</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Loading Cookie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Gum</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Loading Gum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Candy</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Loading Candy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SweetShop</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;inside main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Candy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;After creating Candy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;Gum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Couldn&apos;t find Gum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;After Class.forName(\&quot;Gum\&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;After creating Cookie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>inside main
Loading Candy
After creating Candy
Loading Gum
After Class.forName(&quot;Gum&quot;)
Loading Cookie
After creating Cookie
</code></pre><p>&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;<code>Candy</code>&#x3001;<code>Gum</code> &#x548C; <code>Cookie</code> &#x8FD9;&#x51E0;&#x4E2A;&#x7C7B;&#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>static{...}</code> &#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x5757;&#xFF0C;&#x8FD9;&#x4E9B;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x5757;&#x5728;&#x7C7B;&#x7B2C;&#x4E00;&#x6B21;&#x88AB;&#x52A0;&#x8F7D;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x6267;&#x884C;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x5757;&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x76F8;&#x5E94;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x8FD9;&#x4E9B;&#x7C7B;&#x5206;&#x522B;&#x662F;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x88AB;&#x52A0;&#x8F7D;&#x4E86;&#x3002;&#x800C;&#x5728;&#x4E3B;&#x65B9;&#x6CD5;&#x91CC;&#x8FB9;&#xFF0C;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7801;&#x90FD;&#x653E;&#x5728;&#x4E86; <code>print()</code> &#x8BED;&#x53E5;&#x4E4B;&#x95F4;&#xFF0C;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x5224;&#x65AD;&#x7C7B;&#x52A0;&#x8F7D;&#x7684;&#x65F6;&#x95F4;&#x70B9;&#x3002;</p>
<p>&#x4ECE;&#x8F93;&#x51FA;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;<code>Class</code> &#x5BF9;&#x8C61;&#x4EC5;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#xFF0C;<code>static</code> &#x521D;&#x59CB;&#x5316;&#x662F;&#x5728;&#x7C7B;&#x52A0;&#x8F7D;&#x65F6;&#x8FDB;&#x884C;&#x7684;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x91CC;&#x9762;&#x8FD8;&#x6709;&#x7279;&#x522B;&#x6709;&#x8DA3;&#x7684;&#x4E00;&#x884C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;Gum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>&#x6240;&#x6709; <code>Class</code> &#x5BF9;&#x8C61;&#x90FD;&#x5C5E;&#x4E8E; <code>Class</code> &#x7C7B;&#xFF0C;&#x800C;&#x4E14;&#x5B83;&#x8DDF;&#x5176;&#x4ED6;&#x666E;&#x901A;&#x5BF9;&#x8C61;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x548C;&#x64CD;&#x63A7;&#x5B83;&#x7684;&#x5F15;&#x7528;(&#x8FD9;&#x4E5F;&#x662F;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x7684;&#x5DE5;&#x4F5C;)&#x3002;<code>forName()</code> &#x662F; <code>Class</code> &#x7C7B;&#x7684;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>forName()</code> &#x6839;&#x636E;&#x76EE;&#x6807;&#x7C7B;&#x7684;&#x7C7B;&#x540D;&#xFF08;<code>String</code>&#xFF09;&#x5F97;&#x5230;&#x8BE5;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5FFD;&#x7565;&#x4E86; <code>forName()</code> &#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x90A3;&#x4E2A;&#x8C03;&#x7528;&#x662F;&#x4E3A;&#x4E86;&#x5F97;&#x5230;&#x5B83;&#x4EA7;&#x751F;&#x7684;&#x201C;&#x526F;&#x4F5C;&#x7528;&#x201D;&#x3002;&#x4ECE;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;<code>forName()</code> &#x6267;&#x884C;&#x7684;&#x526F;&#x4F5C;&#x7528;&#x662F;&#x5982;&#x679C; <code>Gum</code> &#x7C7B;&#x6CA1;&#x6709;&#x88AB;&#x52A0;&#x8F7D;&#x5C31;&#x52A0;&#x8F7D;&#x5B83;&#xFF0C;&#x800C;&#x5728;&#x52A0;&#x8F7D;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;<code>Gum</code> &#x7684; <code>static</code> &#x521D;&#x59CB;&#x5316;&#x5757;&#x88AB;&#x6267;&#x884C;&#x4E86;&#x3002;</p>
<p>&#x8FD8;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C; <code>Class.forName()</code> &#x627E;&#x4E0D;&#x5230;&#x8981;&#x52A0;&#x8F7D;&#x7684;&#x7C7B;&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38; <code>ClassNotFoundException</code>&#x3002;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x62A5;&#x544A;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x5728;&#x66F4;&#x4E25;&#x5BC6;&#x7684;&#x7A0B;&#x5E8F;&#x91CC;&#xFF0C;&#x5C31;&#x8981;&#x8003;&#x8651;&#x5728;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x628A;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x6389;&#xFF08;&#x5177;&#x4F53;&#x4F8B;&#x5B50;&#x8BE6;&#x89C1;<a href="./25-Patterns">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</a>&#x7AE0;&#x8282;&#xFF09;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#xFF0C;&#x53EA;&#x8981;&#x4F60;&#x60F3;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x4F7F;&#x7528;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x5148;&#x5F97;&#x5230;&#x90A3;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x3002;<code>Class.forName()</code> &#x5C31;&#x662F;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x7684;&#x4E00;&#x4E2A;&#x4FBF;&#x6377;&#x9014;&#x5F84;&#xFF0C;&#x56E0;&#x4E3A;&#x4F7F;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x5148;&#x6301;&#x6709;&#x8FD9;&#x4E2A;&#x7C7B;&#x578B; &#x7684;&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x5DF2;&#x7ECF;&#x62E5;&#x6709;&#x4E86;&#x76EE;&#x6807;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; <code>getClass()</code> &#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6; <code>Class</code> &#x5F15;&#x7528;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6765;&#x81EA;&#x6839;&#x7C7B; <code>Object</code>&#xFF0C;&#x5B83;&#x5C06;&#x8FD4;&#x56DE;&#x8868;&#x793A;&#x8BE5;&#x5BF9;&#x8C61;&#x5B9E;&#x9645;&#x7C7B;&#x578B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x3002;<code>Class</code> &#x5305;&#x542B;&#x5F88;&#x591A;&#x6709;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0B;&#x9762;&#x4EE3;&#x7801;&#x5C55;&#x793A;&#x4E86;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/toys/ToyTest.java</span>
<span class="token comment">// &#x6D4B;&#x8BD5; Class &#x7C7B;</span>
<span class="token comment">// {java typeinfo.toys.ToyTest}</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>toys</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">HasBatteries</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Waterproof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Shoots</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Toy</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x6CE8;&#x91CA;&#x4E0B;&#x9762;&#x7684;&#x65E0;&#x53C2;&#x6570;&#x6784;&#x9020;&#x5668;&#x4F1A;&#x5F15;&#x8D77; NoSuchMethodError &#x9519;&#x8BEF;</span>
    <span class="token class-name">Toy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">Toy</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">FancyToy</span> <span class="token keyword">extends</span> <span class="token class-name">Toy</span>
<span class="token keyword">implements</span> <span class="token class-name">HasBatteries</span><span class="token punctuation">,</span> <span class="token class-name">Waterproof</span><span class="token punctuation">,</span> <span class="token class-name">Shoots</span> <span class="token punctuation">{</span>
    <span class="token class-name">FancyToy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToyTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Class name: &quot;</span> <span class="token operator">+</span> cc<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token string">&quot; is interface? [&quot;</span> <span class="token operator">+</span> cc<span class="token punctuation">.</span><span class="token function">isInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Simple name: &quot;</span> <span class="token operator">+</span> cc<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Canonical name : &quot;</span> <span class="token operator">+</span> cc<span class="token punctuation">.</span><span class="token function">getCanonicalName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;typeinfo.toys.FancyToy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Can&apos;t find FancyToy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">printInfo</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Class</span> face <span class="token operator">:</span> c<span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">printInfo</span><span class="token punctuation">(</span>face<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Class</span> up <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Requires no-arg constructor:</span>
            obj <span class="token operator">=</span> up<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Cannot instantiate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Cannot access&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">printInfo</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Class name: typeinfo.toys.FancyToy is interface?
[false]
Simple name: FancyToy
Canonical name : typeinfo.toys.FancyToy
Class name: typeinfo.toys.HasBatteries is interface?
[true]
Simple name: HasBatteries
Canonical name : typeinfo.toys.HasBatteries
Class name: typeinfo.toys.Waterproof is interface?
[true]
Simple name: Waterproof
Canonical name : typeinfo.toys.Waterproof
Class name: typeinfo.toys.Shoots is interface? [true]
Simple name: Shoots
Canonical name : typeinfo.toys.Shoots
Class name: typeinfo.toys.Toy is interface? [false]
Simple name: Toy
Canonical name : typeinfo.toys.Toy
</code></pre><p><code>FancyToy</code> &#x7EE7;&#x627F;&#x81EA; <code>Toy</code> &#x5E76;&#x5B9E;&#x73B0;&#x4E86; <code>HasBatteries</code>&#x3001;<code>Waterproof</code> &#x548C; <code>Shoots</code> &#x63A5;&#x53E3;&#x3002;&#x5728; <code>main</code> &#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; <code>Class</code> &#x5F15;&#x7528;&#xFF0C;&#x7136;&#x540E;&#x5728; <code>try</code> &#x8BED;&#x53E5;&#x91CC;&#x8FB9;&#x7528; <code>forName()</code> &#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; <code>FancyToy</code> &#x7684;&#x7C7B;&#x5BF9;&#x8C61;&#x5E76;&#x8D4B;&#x503C;&#x7ED9;&#x8BE5;&#x5F15;&#x7528;&#x3002;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x4F20;&#x9012;&#x7ED9; <code>forName()</code> &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x7C7B;&#x7684;&#x5168;&#x9650;&#x5B9A;&#x540D;&#xFF08;&#x5305;&#x542B;&#x5305;&#x540D;&#xFF09;&#x3002;</p>
<p><code>printInfo()</code> &#x51FD;&#x6570;&#x4F7F;&#x7528; <code>getName()</code> &#x6765;&#x4EA7;&#x751F;&#x5B8C;&#x6574;&#x7C7B;&#x540D;&#xFF0C;&#x4F7F;&#x7528; <code>getSimpleName()</code> &#x4EA7;&#x751F;&#x4E0D;&#x5E26;&#x5305;&#x540D;&#x7684;&#x7C7B;&#x540D;&#xFF0C;<code>getCanonicalName()</code> &#x4E5F;&#x662F;&#x4EA7;&#x751F;&#x5B8C;&#x6574;&#x7C7B;&#x540D;&#xFF08;&#x9664;&#x5185;&#x90E8;&#x7C7B;&#x548C;&#x6570;&#x7EC4;&#x5916;&#xFF0C;&#x5BF9;&#x5927;&#x90E8;&#x5206;&#x7C7B;&#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x4E0E; <code>getName()</code> &#x76F8;&#x540C;&#xFF09;&#x3002;<code>isInterface()</code> &#x7528;&#x4E8E;&#x5224;&#x65AD;&#x67D0;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x4EE3;&#x8868;&#x7684;&#x662F;&#x5426;&#x4E3A;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x8FC7; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5173;&#x4E8E;&#x8BE5;&#x7C7B;&#x578B;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5728;&#x4E3B;&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;&#x7684; <code>Class.getInterfaces()</code> &#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x5B58;&#x653E; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x91CC;&#x9762;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x8868;&#x793A;&#x7684;&#x662F;&#x90A3;&#x4E2A;&#x7C7B;&#x5B9E;&#x73B0;&#x7684;&#x63A5;&#x53E3;&#x3002;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x8C03;&#x7528; <code>getSuperclass()</code> &#x65B9;&#x6CD5;&#x6765;&#x5F97;&#x5230;&#x7236;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x518D;&#x7528;&#x7236;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#xFF0C;&#x91CD;&#x590D;&#x591A;&#x6B21;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B8C;&#x6574;&#x7684;&#x7C7B;&#x7EE7;&#x627F;&#x7ED3;&#x6784;&#x3002;</p>
<p><code>Class</code> &#x5BF9;&#x8C61;&#x7684; <code>newInstance()</code> &#x65B9;&#x6CD5;&#x662F;&#x5B9E;&#x73B0;&#x201C;&#x865A;&#x62DF;&#x6784;&#x9020;&#x5668;&#x201D;&#x7684;&#x4E00;&#x79CD;&#x9014;&#x5F84;&#xFF0C;&#x865A;&#x62DF;&#x6784;&#x9020;&#x5668;&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x5728;&#x4E0D;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5728;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;<code>up</code> &#x53EA;&#x662F;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x671F;&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x4F1A;&#x6307;&#x5411;&#x54EA;&#x4E2A;&#x7C7B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;&#x5F53;&#x4F60;&#x521B;&#x5EFA;&#x65B0;&#x5B9E;&#x4F8B;&#x65F6;&#xFF0C;&#x4F1A;&#x5F97;&#x5230;&#x4E00;&#x4E2A; <code>Object</code> &#x5F15;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x6307;&#x5411;&#x7684;&#x662F; <code>Toy</code> &#x5BF9;&#x8C61;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x7531;&#x4E8E;&#x5F97;&#x5230;&#x7684;&#x662F; <code>Object</code> &#x5F15;&#x7528;&#xFF0C;&#x76EE;&#x524D;&#x4F60;&#x53EA;&#x80FD;&#x7ED9;&#x5B83;&#x53D1;&#x9001; <code>Object</code> &#x5BF9;&#x8C61;&#x80FD;&#x591F;&#x63A5;&#x53D7;&#x7684;&#x8C03;&#x7528;&#x3002;&#x800C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8BF7;&#x6C42;&#x5177;&#x4F53;&#x5BF9;&#x8C61;&#x624D;&#x6709;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4F60;&#x5C31;&#x5F97;&#x5148;&#x83B7;&#x53D6;&#x8BE5;&#x5BF9;&#x8C61;&#x66F4;&#x591A;&#x7684;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x67D0;&#x79CD;&#x8F6C;&#x578B;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4F7F;&#x7528; <code>newInstance()</code> &#x6765;&#x521B;&#x5EFA;&#x7684;&#x7C7B;&#xFF0C;&#x5FC5;&#x987B;&#x5E26;&#x6709;&#x65E0;&#x53C2;&#x6570;&#x7684;&#x6784;&#x9020;&#x5668;&#x3002;&#x5728;&#x672C;&#x7AE0;&#x7A0D;&#x540E;&#x90E8;&#x5206;&#xFF0C;&#x4F60;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4F55;&#x901A;&#x8FC7; Java &#x7684;&#x53CD;&#x5C04; API&#xFF0C;&#x7528;&#x4EFB;&#x610F;&#x7684;&#x6784;&#x9020;&#x5668;&#x6765;&#x52A8;&#x6001;&#x5730;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<h3 class="mume-header" id="%E7%B1%BB%E5%AD%97%E9%9D%A2%E5%B8%B8%E9%87%8F">&#x7C7B;&#x5B57;&#x9762;&#x5E38;&#x91CF;</h3>

<p>Java &#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x751F;&#x6210;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF1A;<strong>&#x7C7B;&#x5B57;&#x9762;&#x5E38;&#x91CF;</strong>&#x3002;&#x5BF9;&#x4E0A;&#x8FF0;&#x7A0B;&#x5E8F;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x50CF;&#x8FD9;&#x6837;&#xFF1A;<code>FancyToy.class;</code>&#x3002;&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x4EC5;&#x66F4;&#x7B80;&#x5355;&#xFF0C;&#x800C;&#x4E14;&#x66F4;&#x5B89;&#x5168;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x5C31;&#x4F1A;&#x53D7;&#x5230;&#x68C0;&#x67E5;&#xFF08;&#x56E0;&#x6B64;&#x4E0D;&#x5FC5;&#x653E;&#x5728; <code>try</code> &#x8BED;&#x53E5;&#x5757;&#x4E2D;&#xFF09;&#x3002;&#x5E76;&#x4E14;&#x5B83;&#x6839;&#x9664;&#x4E86;&#x5BF9; <code>forName()</code> &#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x6548;&#x7387;&#x66F4;&#x9AD8;&#x3002;</p>
<p>&#x7C7B;&#x5B57;&#x9762;&#x5E38;&#x91CF;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x666E;&#x901A;&#x7C7B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x63A5;&#x53E3;&#x3001;&#x6570;&#x7EC4;&#x4EE5;&#x53CA;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x5BF9;&#x4E8E;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x5305;&#x88C5;&#x7C7B;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x5B57;&#x6BB5; <code>TYPE</code>&#x3002;<code>TYPE</code> &#x5B57;&#x6BB5;&#x662F;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#xFF0C;&#x6307;&#x5411;&#x5BF9;&#x5E94;&#x7684;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<figure>
<table style="text-align:center;">
  <thead>
    <tr>
      <th colspan="2">...&#x7B49;&#x4EF7;&#x4E8E;...</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>boolean.class</td>
      <td>Boolean.TYPE</td>
    </tr>
    <tr>
      <td>char.class</td>
      <td>Character.TYPE</td>
    </tr>
    <tr>
      <td>byte.class</td>
      <td>Byte.TYPE</td>
    </tr>
    <tr>
      <td>short.class</td>
      <td>Short.TYPE</td>
    </tr>
    <tr>
      <td>int.class</td>
      <td>Integer.TYPE</td>
    </tr>
    <tr>
      <td>long.class</td>
      <td>Long.TYPE</td>
    </tr>
    <tr>
      <td>float.class</td>
      <td>Float.TYPE</td>
    </tr>
    <tr>
      <td>double.class</td>
      <td>Double.TYPE</td>
    </tr>
    <tr>
      <td>void.class</td>
      <td>Void.TYPE</td>
    </tr>
  </tbody>
</table>
</figure>
<p>&#x6211;&#x7684;&#x5EFA;&#x8BAE;&#x662F;&#x4F7F;&#x7528; <code>.class</code> &#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x4EE5;&#x4FDD;&#x6301;&#x4E0E;&#x666E;&#x901A;&#x7C7B;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x6709;&#x4E00;&#x70B9;&#x5F88;&#x6709;&#x8DA3;&#xFF1A;&#x5F53;&#x4F7F;&#x7528; <code>.class</code> &#x6765;&#x521B;&#x5EFA;&#x5BF9; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x65F6;&#xFF0C;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x5730;&#x521D;&#x59CB;&#x5316;&#x8BE5; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x7528;&#x7C7B;&#x800C;&#x505A;&#x7684;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#x5B9E;&#x9645;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>
<p><strong>&#x52A0;&#x8F7D;</strong>&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x6267;&#x884C;&#x7684;&#x3002;&#x8BE5;&#x6B65;&#x9AA4;&#x5C06;&#x67E5;&#x627E;&#x5B57;&#x8282;&#x7801;&#xFF08;&#x901A;&#x5E38;&#x5728; classpath &#x6240;&#x6307;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x4E2D;&#x67E5;&#x627E;&#xFF0C;&#x4F46;&#x8FD9;&#x5E76;&#x975E;&#x662F;&#x5FC5;&#x987B;&#x7684;&#xFF09;&#xFF0C;&#x5E76;&#x4ECE;&#x8FD9;&#x4E9B;&#x5B57;&#x8282;&#x7801;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;</p>
</li>
<li>
<p><strong>&#x94FE;&#x63A5;</strong>&#x3002;&#x5728;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x5C06;&#x9A8C;&#x8BC1;&#x7C7B;&#x4E2D;&#x7684;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x4E3A; <code>static</code> &#x5B57;&#x6BB5;&#x5206;&#x914D;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x5C06;&#x89E3;&#x6790;&#x8FD9;&#x4E2A;&#x7C7B;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x5176;&#x4ED6;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x5F15;&#x7528;&#x3002;</p>
</li>
<li>
<p><strong>&#x521D;&#x59CB;&#x5316;</strong>&#x3002;&#x5982;&#x679C;&#x8BE5;&#x7C7B;&#x5177;&#x6709;&#x8D85;&#x7C7B;&#xFF0C;&#x5219;&#x5148;&#x521D;&#x59CB;&#x5316;&#x8D85;&#x7C7B;&#xFF0C;&#x6267;&#x884C; <code>static</code> &#x521D;&#x59CB;&#x5316;&#x5668;&#x548C; <code>static</code> &#x521D;&#x59CB;&#x5316;&#x5757;&#x3002;</p>
</li>
</ol>
<p>&#x76F4;&#x5230;&#x7B2C;&#x4E00;&#x6B21;&#x5F15;&#x7528;&#x4E00;&#x4E2A; <code>static</code> &#x65B9;&#x6CD5;&#xFF08;&#x6784;&#x9020;&#x5668;&#x9690;&#x5F0F;&#x5730;&#x662F; <code>static</code>&#xFF09;&#x6216;&#x8005;&#x975E;&#x5E38;&#x91CF;&#x7684; <code>static</code> &#x5B57;&#x6BB5;&#xFF0C;&#x624D;&#x4F1A;&#x8FDB;&#x884C;&#x7C7B;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/ClassInitialization.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Initable</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STATIC_FINAL <span class="token operator">=</span> <span class="token number">47</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STATIC_FINAL2 <span class="token operator">=</span>
        <span class="token class-name">ClassInitialization</span><span class="token punctuation">.</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Initializing Initable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Initable2</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> staticNonFinal <span class="token operator">=</span> <span class="token number">147</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Initializing Initable2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Initable3</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> staticNonFinal <span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Initializing Initable3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassInitialization</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span> initable <span class="token operator">=</span> <span class="token class-name">Initable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;After creating Initable ref&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Does not trigger initialization:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Initable</span><span class="token punctuation">.</span>STATIC_FINAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Does trigger initialization:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Initable</span><span class="token punctuation">.</span>STATIC_FINAL2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Does trigger initialization:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Initable2</span><span class="token punctuation">.</span>staticNonFinal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span> initable3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;Initable3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;After creating Initable3 ref&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Initable3</span><span class="token punctuation">.</span>staticNonFinal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>After creating Initable ref
47
Initializing Initable
258
Initializing Initable2
147
Initializing Initable3
After creating Initable3 ref
74
</code></pre><p>&#x521D;&#x59CB;&#x5316;&#x6709;&#x6548;&#x5730;&#x5B9E;&#x73B0;&#x4E86;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x201C;&#x60F0;&#x6027;&#x201D;&#xFF0C;&#x4ECE;&#x5BF9; <code>initable</code> &#x5F15;&#x7528;&#x7684;&#x521B;&#x5EFA;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4EC5;&#x4F7F;&#x7528; <code>.class</code> &#x8BED;&#x6CD5;&#x6765;&#x83B7;&#x5F97;&#x5BF9;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x4E0D;&#x4F1A;&#x5F15;&#x53D1;&#x521D;&#x59CB;&#x5316;&#x3002;&#x4F46;&#x4E0E;&#x6B64;&#x76F8;&#x53CD;&#xFF0C;&#x4F7F;&#x7528; <code>Class.forName()</code> &#x6765;&#x4EA7;&#x751F; <code>Class</code> &#x5F15;&#x7528;&#x4F1A;&#x7ACB;&#x5373;&#x5C31;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5982; <code>initable3</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A; <code>static final</code> &#x503C;&#x662F;&#x201C;&#x7F16;&#x8BD1;&#x671F;&#x5E38;&#x91CF;&#x201D;&#xFF08;&#x5982; <code>Initable.staticFinal</code>&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x503C;&#x4E0D;&#x9700;&#x8981;&#x5BF9; <code>Initable</code> &#x7C7B;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x5C31;&#x53EF;&#x4EE5;&#x88AB;&#x8BFB;&#x53D6;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x662F;&#x5C06;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x8BBE;&#x7F6E;&#x6210;&#x4E3A; <code>static</code> &#x548C; <code>final</code>&#xFF0C;&#x8FD8;&#x4E0D;&#x8DB3;&#x4EE5;&#x786E;&#x4FDD;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9; <code>Initable.staticFinal2</code> &#x7684;&#x8BBF;&#x95EE;&#x5C06;&#x5F3A;&#x5236;&#x8FDB;&#x884C;&#x7C7B;&#x7684;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7F16;&#x8BD1;&#x671F;&#x5E38;&#x91CF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A; <code>static</code> &#x5B57;&#x6BB5;&#x4E0D;&#x662F; <code>final</code> &#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5BF9;&#x5B83;&#x8BBF;&#x95EE;&#x65F6;&#xFF0C;&#x603B;&#x662F;&#x8981;&#x6C42;&#x5728;&#x5B83;&#x88AB;&#x8BFB;&#x53D6;&#x4E4B;&#x524D;&#xFF0C;&#x8981;&#x5148;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#xFF08;&#x4E3A;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x5206;&#x914D;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF09;&#x548C;&#x521D;&#x59CB;&#x5316;&#xFF08;&#x521D;&#x59CB;&#x5316;&#x8BE5;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF09;&#xFF0C;&#x5C31;&#x50CF;&#x5728;&#x5BF9; <code>Initable2.staticNonFinal</code> &#x7684;&#x8BBF;&#x95EE;&#x4E2D;&#x6240;&#x770B;&#x5230;&#x7684;&#x90A3;&#x6837;&#x3002;</p>
<h3 class="mume-header" id="%E6%B3%9B%E5%8C%96%E7%9A%84-class-%E5%BC%95%E7%94%A8">&#x6CDB;&#x5316;&#x7684; <code>Class</code> &#x5F15;&#x7528;</h3>

<p><code>Class</code> &#x5F15;&#x7528;&#x603B;&#x662F;&#x6307;&#x5411;&#x67D0;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x800C; <code>Class</code> &#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EA7;&#x751F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x542B;&#x53EF;&#x4F5C;&#x7528;&#x4E8E;&#x8FD9;&#x4E9B;&#x5B9E;&#x4F8B;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x4EE3;&#x7801;&#x3002;&#x5B83;&#x8FD8;&#x5305;&#x542B;&#x8BE5;&#x7C7B;&#x7684; <code>static</code> &#x6210;&#x5458;&#xFF0C;&#x56E0;&#x6B64; <code>Class</code> &#x5F15;&#x7528;&#x8868;&#x660E;&#x4E86;&#x5B83;&#x6240;&#x6307;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x8BE5;&#x5BF9;&#x8C61;&#x4FBF;&#x662F; <code>Class</code> &#x7C7B;&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;Java &#x8BBE;&#x8BA1;&#x8005;&#x770B;&#x51C6;&#x673A;&#x4F1A;&#xFF0C;&#x5C06;&#x5B83;&#x7684;&#x7C7B;&#x578B;&#x53D8;&#x5F97;&#x66F4;&#x5177;&#x4F53;&#x4E86;&#x4E00;&#x4E9B;&#x3002;Java &#x5F15;&#x5165;&#x6CDB;&#x578B;&#x8BED;&#x6CD5;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6CDB;&#x578B;&#x5BF9; <code>Class</code> &#x5F15;&#x7528;&#x6240;&#x6307;&#x5411;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x9650;&#x5B9A;&#x3002;&#x5728;&#x4E0B;&#x9762;&#x7684;&#x5B9E;&#x4F8B;&#x4E2D;&#xFF0C;&#x4E24;&#x79CD;&#x8BED;&#x6CD5;&#x90FD;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/GenericClassReferences.java</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenericClassReferences</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span> intClass <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> genericIntClass <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        genericIntClass <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// &#x540C;&#x4E00;&#x4E2A;&#x4E1C;&#x897F;</span>
        intClass <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token comment">// genericIntClass = double.class; // &#x975E;&#x6CD5;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x666E;&#x901A;&#x7684;&#x7C7B;&#x5F15;&#x7528;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x666E;&#x901A;&#x7684;&#x7C7B;&#x5F15;&#x7528;&#x53EF;&#x4EE5;&#x91CD;&#x65B0;&#x8D4B;&#x503C;&#x6307;&#x5411;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x662F;&#x4F7F;&#x7528;&#x6CDB;&#x578B;&#x9650;&#x5B9A;&#x7684;&#x7C7B;&#x5F15;&#x7528;&#x53EA;&#x80FD;&#x6307;&#x5411;&#x5176;&#x58F0;&#x660E;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x6CDB;&#x578B;&#x8BED;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA9;&#x7F16;&#x8BD1;&#x5668;&#x5F3A;&#x5236;&#x6267;&#x884C;&#x989D;&#x5916;&#x7684;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#x3002;</p>
<p>&#x90A3;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x7A0D;&#x5FAE;&#x653E;&#x677E;&#x4E00;&#x4E9B;&#x9650;&#x5236;&#xFF0C;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;&#x4E4D;&#x4E00;&#x770B;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#x597D;&#x50CF;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> geenericNumberClass <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
</pre><p>&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x4F3C;&#x4E4E;&#x662F;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A; <code>Integer</code> &#x7EE7;&#x627F;&#x81EA; <code>Number</code>&#x3002;&#x4F46;&#x4E8B;&#x5B9E;&#x5374;&#x662F;&#x4E0D;&#x884C;&#xFF0C;&#x56E0;&#x4E3A; <code>Integer</code> &#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x5E76;&#x4E0D;&#x662F; <code>Number</code>&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x5B50;&#x7C7B;&#xFF08;&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x53EF;&#x80FD;&#x6709;&#x70B9;&#x8BE1;&#x5F02;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5728;<a href="./20-Generics">&#x6CDB;&#x578B;</a>&#x8FD9;&#x4E00;&#x7AE0;&#x8BE6;&#x7EC6;&#x8BA8;&#x8BBA;&#xFF09;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5728;&#x4F7F;&#x7528; <code>Class</code> &#x5F15;&#x7528;&#x65F6;&#x653E;&#x677E;&#x9650;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x901A;&#x914D;&#x7B26;&#xFF0C;&#x5B83;&#x662F; Java &#x6CDB;&#x578B;&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x901A;&#x914D;&#x7B26;&#x5C31;&#x662F; <code>?</code>&#xFF0C;&#x8868;&#x793A;&#x201C;&#x4EFB;&#x4F55;&#x4E8B;&#x7269;&#x201D;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x4E0A;&#x4F8B;&#x7684;&#x666E;&#x901A; <code>Class</code> &#x5F15;&#x7528;&#x4E2D;&#x6DFB;&#x52A0;&#x901A;&#x914D;&#x7B26;&#xFF0C;&#x5E76;&#x4EA7;&#x751F;&#x76F8;&#x540C;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/WildcardClassReferences.java</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WildcardClassReferences</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> intClass <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        intClass <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x4F7F;&#x7528; <code>Class&lt;?&gt;</code> &#x6BD4;&#x5355;&#x7EAF;&#x4F7F;&#x7528; <code>Class</code> &#x8981;&#x597D;&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x4EEC;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5355;&#x7EAF;&#x4F7F;&#x7528; <code>Class</code> &#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x7F16;&#x8BD1;&#x5668;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#x3002;&#x4F7F;&#x7528; <code>Class&lt;?&gt;</code> &#x7684;&#x597D;&#x5904;&#x662F;&#x5B83;&#x8868;&#x793A;&#x4F60;&#x5E76;&#x975E;&#x662F;&#x78B0;&#x5DE7;&#x6216;&#x8005;&#x7531;&#x4E8E;&#x758F;&#x5FFD;&#x624D;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x5177;&#x4F53;&#x7684;&#x7C7B;&#x5F15;&#x7528;&#xFF0C;&#x800C;&#x662F;&#x7279;&#x610F;&#x4E3A;&#x4E4B;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x9650;&#x5B9A;&#x6307;&#x5411;&#x67D0;&#x79CD;&#x7C7B;&#x578B;&#x6216;&#x5176;&#x5B50;&#x7C7B;&#x7684; <code>Class</code> &#x5F15;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C06;&#x901A;&#x914D;&#x7B26;&#x4E0E; <code>extends</code> &#x5173;&#x952E;&#x5B57;&#x914D;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#x9650;&#x5B9A;&#x3002;&#x8FD9;&#x4E0E;&#x4EC5;&#x4EC5;&#x58F0;&#x660E; <code>Class&lt;Number&gt;</code> &#x4E0D;&#x540C;&#xFF0C;&#x73B0;&#x5728;&#x505A;&#x5982;&#x4E0B;&#x58F0;&#x660E;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/BoundedClassReferences.java</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BoundedClassReferences</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> bounded <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        bounded <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        bounded <span class="token operator">=</span> <span class="token class-name">Number</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token comment">// Or anything else derived from Number.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5411; <code>Class</code> &#x5F15;&#x7528;&#x6DFB;&#x52A0;&#x6CDB;&#x578B;&#x8BED;&#x6CD5;&#x7684;&#x539F;&#x56E0;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x7F16;&#x8BD1;&#x671F;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x4F60;&#x64CD;&#x4F5C;&#x6709;&#x8BEF;&#xFF0C;&#x7A0D;&#x540E;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#x8FD9;&#x70B9;&#x3002;&#x4F7F;&#x7528;&#x666E;&#x901A;&#x7684; <code>Class</code> &#x5F15;&#x7528;&#x4F60;&#x8981;&#x786E;&#x4FDD;&#x81EA;&#x5DF1;&#x4E0D;&#x4F1A;&#x72AF;&#x9519;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x65E6;&#x4F60;&#x72AF;&#x4E86;&#x9519;&#x8BEF;&#xFF0C;&#x5C31;&#x8981;&#x7B49;&#x5230;&#x8FD0;&#x884C;&#x65F6;&#x624D;&#x80FD;&#x53D1;&#x73B0;&#x5B83;&#xFF0C;&#x5F88;&#x4E0D;&#x65B9;&#x4FBF;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528;&#x4E86;&#x6CDB;&#x578B;&#x8BED;&#x6CD5;&#xFF0C;&#x5B83;&#x4FDD;&#x5B58;&#x4E86;&#x4E00;&#x4E2A;&#x7C7B;&#x5F15;&#x7528;&#xFF0C;&#x7A0D;&#x540E;&#x53C8;&#x7528; <code>newInstance()</code> &#x65B9;&#x6CD5;&#x4EA7;&#x751F;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/DynamicSupplier.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CountedInteger</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> counter<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">long</span> id <span class="token operator">=</span> counter<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicSupplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">DynamicSupplier</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> type<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> <span class="token operator">|</span>
                        <span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">DynamicSupplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">CountedInteger</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;:</p>
<pre data-role="codeBlock" data-info class="language-"><code>10
11
12
13
14
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x5FC5;&#x987B;&#x5047;&#x8BBE;&#x4E0E;&#x5B83;&#x4E00;&#x8D77;&#x5DE5;&#x4F5C;&#x7684;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x65E0;&#x53C2;&#x6784;&#x9020;&#x5668;&#xFF0C;&#x5426;&#x5219;&#x8FD0;&#x884C;&#x65F6;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;&#x7F16;&#x8BD1;&#x671F;&#x5BF9;&#x8BE5;&#x7A0B;&#x5E8F;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x4EFB;&#x4F55;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x5C06;&#x6CDB;&#x578B;&#x8BED;&#x6CD5;&#x7528;&#x4E8E; <code>Class</code> &#x5BF9;&#x8C61;&#x65F6;&#xFF0C;<code>newInstance()</code> &#x5C06;&#x8FD4;&#x56DE;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x4E0D;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x5728; <code>ToyTest.java</code> &#x4E2D;&#x770B;&#x5230;&#x7684;&#x57FA;&#x7C7B; <code>Object</code>&#x3002;&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x5728;&#x67D0;&#x79CD;&#x7A0B;&#x5EA6;&#x4E0A;&#x6709;&#x4E9B;&#x53D7;&#x9650;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/toys/GenericToyTest.java</span>
<span class="token comment">// &#x6D4B;&#x8BD5; Class &#x7C7B;</span>
<span class="token comment">// {java typeinfo.toys.GenericToyTest}</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>toys</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenericToyTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FancyToy</span><span class="token punctuation">&gt;</span></span> ftClass <span class="token operator">=</span> <span class="token class-name">FancyToy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token comment">// Produces exact type:</span>
        <span class="token class-name">FancyToy</span> fancyToy <span class="token operator">=</span> ftClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">FancyToy</span><span class="token punctuation">&gt;</span></span> up <span class="token operator">=</span>
            ftClass<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// This won&apos;t compile:</span>
        <span class="token comment">// Class&lt;Toy&gt; up2 = ftClass.getSuperclass();</span>
        <span class="token comment">// Only produces Object:</span>
        <span class="token class-name">Object</span> obj <span class="token operator">=</span> up<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5982;&#x679C;&#x4F60;&#x624B;&#x5934;&#x7684;&#x662F;&#x8D85;&#x7C7B;&#xFF0C;&#x90A3;&#x7F16;&#x8BD1;&#x5668;&#x5C06;&#x53EA;&#x5141;&#x8BB8;&#x4F60;&#x58F0;&#x660E;&#x8D85;&#x7C7B;&#x5F15;&#x7528;&#x4E3A;&#x201C;&#x67D0;&#x4E2A;&#x7C7B;&#xFF0C;&#x5B83;&#x662F; <code>FancyToy</code> &#x7684;&#x8D85;&#x7C7B;&#x201D;&#xFF0C;&#x5C31;&#x50CF;&#x5728;&#x8868;&#x8FBE;&#x5F0F; <code>Class&lt;? super FancyToy&gt;</code> &#x4E2D;&#x6240;&#x770B;&#x5230;&#x7684;&#x90A3;&#x6837;&#x3002;&#x800C;&#x4E0D;&#x4F1A;&#x63A5;&#x6536; <code>Class&lt;Toy&gt;</code> &#x8FD9;&#x6837;&#x7684;&#x58F0;&#x660E;&#x3002;&#x8FD9;&#x770B;&#x4E0A;&#x53BB;&#x663E;&#x5F97;&#x6709;&#x4E9B;&#x602A;&#xFF0C;&#x56E0;&#x4E3A; <code>getSuperClass()</code> &#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x57FA;&#x7C7B;&#xFF08;&#x4E0D;&#x662F;&#x63A5;&#x53E3;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x7F16;&#x8BD1;&#x671F;&#x5C31;&#x77E5;&#x9053;&#x5B83;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#x4E86;&#xFF08;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x5C31;&#x662F; <code>Toy.class</code>&#xFF09;&#xFF0C;&#x800C;&#x4E0D;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&quot;&#x67D0;&#x4E2A;&#x7C7B;&quot;&#x3002;&#x4E0D;&#x7BA1;&#x600E;&#x6837;&#xFF0C;&#x6B63;&#x662F;&#x7531;&#x4E8E;&#x8FD9;&#x79CD;&#x542B;&#x7CCA;&#x6027;&#xFF0C;<code>up.newInstance</code> &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E0D;&#x662F;&#x7CBE;&#x786E;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x53EA;&#x662F; <code>Object</code>&#x3002;</p>
<h3 class="mume-header" id="cast-%E6%96%B9%E6%B3%95"><code>cast()</code> &#x65B9;&#x6CD5;</h3>

<p>Java &#x4E2D;&#x8FD8;&#x6709;&#x7528;&#x4E8E; <code>Class</code> &#x5F15;&#x7528;&#x7684;&#x8F6C;&#x578B;&#x8BED;&#x6CD5;&#xFF0C;&#x5373; <code>cast()</code> &#x65B9;&#x6CD5;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/ClassCasts.java</span>

<span class="token keyword">class</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">House</span> <span class="token keyword">extends</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassCasts</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Building</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">House</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">House</span><span class="token punctuation">&gt;</span></span> houseType <span class="token operator">=</span> <span class="token class-name">House</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token class-name">House</span> h <span class="token operator">=</span> houseType<span class="token punctuation">.</span><span class="token function">cast</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">House</span><span class="token punctuation">)</span>b<span class="token punctuation">;</span> <span class="token comment">// ... &#x6216;&#x8005;&#x8FD9;&#x6837;&#x505A;.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><code>cast()</code> &#x65B9;&#x6CD5;&#x63A5;&#x53D7;&#x53C2;&#x6570;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x4E3A; <code>Class</code> &#x5F15;&#x7528;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x89C2;&#x5BDF;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x4E0E;&#x5B9E;&#x73B0;&#x4E86;&#x76F8;&#x540C;&#x529F;&#x80FD;&#x7684; <code>main</code> &#x65B9;&#x6CD5;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x884C;&#x76F8;&#x6BD4;&#xFF0C;&#x8FD9;&#x79CD;&#x8F6C;&#x578B;&#x597D;&#x50CF;&#x505A;&#x4E86;&#x5F88;&#x591A;&#x989D;&#x5916;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</p>
<p><code>cast()</code> &#x5728;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x666E;&#x901A;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x663E;&#x5F97;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x5728;&#x4F60;&#x7F16;&#x5199;&#x6CDB;&#x578B;&#x4EE3;&#x7801;&#xFF08;&#x4F60;&#x5C06;&#x5728;<a href="./20-Generics">&#x6CDB;&#x578B;</a>&#x8FD9;&#x4E00;&#x7AE0;&#x5B66;&#x4E60;&#x5230;&#xFF09;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4FDD;&#x5B58;&#x4E86; <code>Class</code> &#x5F15;&#x7528;&#xFF0C;&#x5E76;&#x5E0C;&#x671B;&#x4EE5;&#x540E;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x6765;&#x6267;&#x884C;&#x8F6C;&#x578B;&#xFF0C;&#x4F60;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230; <code>cast()</code>&#x3002;&#x4F46;&#x4E8B;&#x5B9E;&#x5374;&#x662F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x975E;&#x5E38;&#x5C11;&#x89C1;&#xFF0C;&#x6211;&#x53D1;&#x73B0;&#x6574;&#x4E2A; Java &#x7C7B;&#x5E93;&#x4E2D;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x5904;&#x4F7F;&#x7528;&#x4E86; <code>cast()</code>&#xFF08;&#x5728; <code>com.sun.mirror.util.DeclarationFilter</code> &#x4E2D;&#xFF09;&#x3002;</p>
<p>Java &#x7C7B;&#x5E93;&#x4E2D;&#x53E6;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7528;&#x5904;&#x7684;&#x7279;&#x6027;&#x5C31;&#x662F; <code>Class.asSubclass()</code>&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5141;&#x8BB8;&#x4F60;&#x5C06;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x8F6C;&#x578B;&#x4E3A;&#x66F4;&#x52A0;&#x5177;&#x4F53;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<h2 class="mume-header" id="%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%A3%80%E6%B5%8B">&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x68C0;&#x6D4B;</h2>

<p>&#x76F4;&#x5230;&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x77E5;&#x7684; RTTI &#x7C7B;&#x578B;&#x5305;&#x62EC;&#xFF1A;</p>
<ol>
<li>
<p>&#x4F20;&#x7EDF;&#x7684;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x5982; &#x201C;<code>(Shape)</code>&#x201D;&#xFF0C;&#x7531; RTTI &#x786E;&#x4FDD;&#x8F6C;&#x6362;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A; <code>ClassCastException</code> &#x5F02;&#x5E38;&#x3002;</p>
</li>
<li>
<p>&#x4EE3;&#x8868;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;. &#x901A;&#x8FC7;&#x67E5;&#x8BE2; <code>Class</code> &#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x9700;&#x7684;&#x4FE1;&#x606F;.</p>
</li>
</ol>
<p>&#x5728; C++ &#x4E2D;&#xFF0C;&#x7ECF;&#x5178;&#x7684;&#x7C7B;&#x578B;&#x8F6C;&#x6362; &#x201C;<code>(Shape)</code>&#x201D; &#x5E76;&#x4E0D;&#x4F7F;&#x7528; RTTI&#x3002;&#x5B83;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x544A;&#x8BC9;&#x7F16;&#x8BD1;&#x5668;&#x5C06;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x65B0;&#x7684;&#x7C7B;&#x578B;&#x5BF9;&#x5F85;. &#x800C; Java &#x4F1A;&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#xFF0C;&#x8FD9;&#x79CD;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x4E00;&#x822C;&#x88AB;&#x79F0;&#x4F5C;&#x201C;&#x7C7B;&#x578B;&#x5B89;&#x5168;&#x7684;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x201D;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x79F0;&#x4F5C;&#x201C;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x201D;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x4F20;&#x7EDF;&#x4E0A;&#x7C7B;&#x7EE7;&#x627F;&#x56FE;&#x662F;&#x8FD9;&#x4E48;&#x753B;&#x7684;&#x3002;&#x5C06; <code>Circle</code> &#x8F6C;&#x6362;&#x4E3A; <code>Shape</code> &#x662F;&#x4E00;&#x6B21;&#x5411;&#x4E0A;&#x8F6C;&#x578B;, &#x5C06; <code>Shape</code> &#x8F6C;&#x6362;&#x4E3A; <code>Circle</code> &#x662F;&#x4E00;&#x6B21;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x3002;&#x4F46;&#x662F;, &#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x77E5;&#x9053; <code>Circle</code> &#x80AF;&#x5B9A;&#x662F;&#x4E00;&#x4E2A; <code>Shape</code>&#xFF0C;&#x6240;&#x4EE5;&#x7F16;&#x8BD1;&#x5668;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x81EA;&#x7531;&#x5730;&#x505A;&#x5411;&#x4E0A;&#x8F6C;&#x578B;&#x7684;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#xFF0C;&#x4E14;&#x4E0D;&#x9700;&#x8981;&#x4EFB;&#x4F55;&#x663E;&#x5F0F;&#x7684;&#x8F6C;&#x578B;&#x64CD;&#x4F5C;&#x3002;&#x5F53;&#x4F60;&#x7ED9;&#x7F16;&#x8BD1;&#x5668;&#x4E00;&#x4E2A; <code>Shape</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#x5B83;&#x5230;&#x5E95;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#x7684; <code>Shape</code>&#x2014;&#x2014;&#x5B83;&#x53EF;&#x80FD;&#x662F; <code>Shape</code>&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x662F; <code>Shape</code> &#x7684;&#x5B50;&#x7C7B;&#x578B;&#xFF0C;&#x4F8B;&#x5982; <code>Circle</code>&#x3001;<code>Square</code>&#x3001;<code>Triangle</code> &#x6216;&#x67D0;&#x79CD;&#x5176;&#x4ED6;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x5728;&#x7F16;&#x8BD1;&#x671F;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x53EA;&#x80FD;&#x77E5;&#x9053;&#x5B83;&#x662F; <code>Shape</code>&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x5730;&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x4EE5;&#x544A;&#x77E5;&#x7F16;&#x8BD1;&#x5668;&#x4F60;&#x60F3;&#x8F6C;&#x6362;&#x7684;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#xFF0C;&#x5426;&#x5219;&#x7F16;&#x8BD1;&#x5668;&#x5C31;&#x4E0D;&#x5141;&#x8BB8;&#x4F60;&#x6267;&#x884C;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x8D4B;&#x503C;&#x3002; &#xFF08;&#x7F16;&#x8BD1;&#x5668;&#x5C06;&#x4F1A;&#x68C0;&#x67E5;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x662F;&#x5426;&#x5408;&#x7406;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4E0D;&#x5141;&#x8BB8;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x5230;&#x5B9E;&#x9645;&#x4E0D;&#x662F;&#x5F85;&#x8F6C;&#x578B;&#x7C7B;&#x578B;&#x7684;&#x5B50;&#x7C7B;&#x7C7B;&#x578B;&#x4E0A;&#xFF09;&#x3002;</p>
<p>RTTI &#x5728; Java &#x4E2D;&#x8FD8;&#x6709;&#x7B2C;&#x4E09;&#x79CD;&#x5F62;&#x5F0F;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5173;&#x952E;&#x5B57; <code>instanceof</code>&#x3002;&#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x503C;&#xFF0C;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x5BF9;&#x8C61;&#x662F;&#x4E0D;&#x662F;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x63D0;&#x95EE;&#x7684;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x5C31;&#x50CF;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token keyword">instanceof</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">)</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>&#x5728;&#x5C06; <code>x</code> &#x7684;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x4E3A; <code>Dog</code> &#x4E4B;&#x524D;&#xFF0C;<code>if</code> &#x8BED;&#x53E5;&#x4F1A;&#x5148;&#x68C0;&#x67E5; <code>x</code> &#x662F;&#x5426;&#x662F; <code>Dog</code> &#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FDB;&#x884C;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x524D;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x544A;&#x8BC9;&#x4F60;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528; <code>instanceof</code> &#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x5F97;&#x5230;&#x4E00;&#x4E2A; <code>ClassCastException</code> &#x5F02;&#x5E38;&#x3002;</p>
<p>&#x4E00;&#x822C;&#xFF0C;&#x53EF;&#x80FD;&#x60F3;&#x8981;&#x67E5;&#x627E;&#x67D0;&#x79CD;&#x7C7B;&#x578B;&#xFF08;&#x6BD4;&#x5982;&#x8981;&#x627E;&#x4E09;&#x89D2;&#x5F62;&#xFF0C;&#x5E76;&#x586B;&#x5145;&#x4E3A;&#x7D2B;&#x8272;&#xFF09;&#xFF0C;&#x8FD9;&#x65F6;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5730;&#x4F7F;&#x7528; <code>instanceof</code> &#x6765;&#x5EA6;&#x91CF;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x3002;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5047;&#x5982;&#x4F60;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x7EE7;&#x627F;&#x4F53;&#x7CFB;&#xFF0C;&#x63CF;&#x8FF0;&#x4E86; <code>Pet</code>&#xFF08;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x7684;&#x4E3B;&#x4EBA;&#xFF0C;&#x5728;&#x540E;&#x9762;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x4F1A;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#xFF09;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x7EE7;&#x627F;&#x4F53;&#x7CFB;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A; <code>Individual</code> &#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>id</code> &#x548C;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684;&#x540D;&#x5B57;&#x3002;&#x5C3D;&#x7BA1;&#x4E0B;&#x9762;&#x7684;&#x7C7B;&#x90FD;&#x7EE7;&#x627F;&#x81EA; <code>Individual</code>&#xFF0C;&#x4F46;&#x662F; <code>Individual</code> &#x7C7B;&#x590D;&#x6742;&#x6027;&#x8F83;&#x9AD8;&#xFF0C;&#x56E0;&#x6B64;&#x5176;&#x4EE3;&#x7801;&#x5C06;&#x653E;&#x5728;<a href="./Appendix-Collection-Topics">&#x9644;&#x5F55;&#xFF1A;&#x5BB9;&#x5668;</a>&#x4E2D;&#x8FDB;&#x884C;&#x89E3;&#x91CA;&#x8BF4;&#x660E;&#x3002;&#x6B63;&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x53BB;&#x4E86;&#x89E3; <code>Individual</code> &#x7684;&#x4EE3;&#x7801;&#x2014;&#x2014;&#x4F60;&#x53EA;&#x9700;&#x4E86;&#x89E3;&#x4F60;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x5176;&#x5177;&#x540D;&#x6216;&#x4E0D;&#x5177;&#x540D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A; <code>Individual</code> &#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>id()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x4E3A; <code>Individual</code> &#x63D0;&#x4F9B;&#x540D;&#x5B57;&#xFF0C;<code>toString()</code> &#x65B9;&#x6CD5;&#x53EA;&#x4EA7;&#x751F;&#x7C7B;&#x578B;&#x540D;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x7EE7;&#x627F;&#x81EA; <code>Individual</code> &#x7684;&#x7C7B;&#x7684;&#x7EE7;&#x627F;&#x4F53;&#x7CFB;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Person.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Individual</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Pet.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pet</span> <span class="token keyword">extends</span> <span class="token class-name">Individual</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Dog.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Mutt.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mutt</span> <span class="token keyword">extends</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Mutt</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Mutt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Pug.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pug</span> <span class="token keyword">extends</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Pug</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Pug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Cat.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/EgyptianMau.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EgyptianMau</span> <span class="token keyword">extends</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">EgyptianMau</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">EgyptianMau</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Manx.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Manx</span> <span class="token keyword">extends</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Manx</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Manx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Cymric.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cymric</span> <span class="token keyword">extends</span> <span class="token class-name">Manx</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Cymric</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Cymric</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Rodent.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rodent</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Rodent</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Rodent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Rat.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rat</span> <span class="token keyword">extends</span> <span class="token class-name">Rodent</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Rat</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Rat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Mouse.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mouse</span> <span class="token keyword">extends</span> <span class="token class-name">Rodent</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Mouse</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Mouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Hamster.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hamster</span> <span class="token keyword">extends</span> <span class="token class-name">Rodent</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Hamster</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Hamster</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x663E;&#x5F0F;&#x5730;&#x4E3A;&#x6BCF;&#x4E00;&#x4E2A;&#x5B50;&#x7C7B;&#x7F16;&#x5199;&#x65E0;&#x53C2;&#x6784;&#x9020;&#x5668;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x6709;&#x4E00;&#x4E2A;&#x5E26;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x6784;&#x9020;&#x5668;&#xFF0C;&#x6240;&#x4EE5;&#x7F16;&#x8BD1;&#x5668;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x5730;&#x4E3A;&#x6211;&#x4EEC;&#x52A0;&#x4E0A;&#x65E0;&#x53C2;&#x6784;&#x9020;&#x5668;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x968F;&#x673A;&#x5730;&#x521B;&#x5EFA;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x5BA0;&#x7269;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x5B83;&#x8FD8;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x5BA0;&#x7269;&#x6570;&#x7EC4;&#x548C;&#x6301;&#x6709;&#x5BA0;&#x7269;&#x7684; <code>List</code>&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x8FD9;&#x4E2A;&#x7C7B;&#x66F4;&#x52A0;&#x666E;&#x904D;&#x9002;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x5B9A;&#x4E49;&#x4E3A;&#x62BD;&#x8C61;&#x7C7B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/PetCreator.java</span>
<span class="token comment">// Creates random sequences of Pets</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">PetCreator</span> <span class="token keyword">implements</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// The List of the different types of Pet to create:</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">types</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Pet</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Create one random Pet</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token function">types</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">types</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> <span class="token operator">|</span>
                <span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x62BD;&#x8C61;&#x7684; <code>types()</code> &#x65B9;&#x6CD5;&#x9700;&#x8981;&#x5B50;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x83B7;&#x53D6; <code>Class</code> &#x5BF9;&#x8C61;&#x6784;&#x6210;&#x7684; <code>List</code>&#xFF08;&#x8FD9;&#x662F;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7684;&#x4E00;&#x79CD;&#x53D8;&#x4F53;&#xFF09;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x5176;&#x4E2D;&#x7C7B;&#x7684;&#x7C7B;&#x578B;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;&#x201C;&#x4EFB;&#x4F55;&#x4ECE; <code>Pet</code> &#x5BFC;&#x51FA;&#x7684;&#x7C7B;&#x578B;&#x201D;&#xFF0C;&#x56E0;&#x6B64; <code>newInstance()</code> &#x4E0D;&#x9700;&#x8981;&#x8F6C;&#x578B;&#x5C31;&#x53EF;&#x4EE5;&#x4EA7;&#x751F; <code>Pet</code>&#x3002;<code>get()</code> &#x968F;&#x673A;&#x7684;&#x9009;&#x53D6;&#x51FA;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>Class.newInstance()</code> &#x6765;&#x751F;&#x6210;&#x8BE5;&#x7C7B;&#x7684;&#x65B0;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x5728;&#x8C03;&#x7528; <code>newInstance()</code> &#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x4E24;&#x79CD;&#x5F02;&#x5E38;&#x3002;&#x5728;&#x7D27;&#x8DDF; <code>try</code> &#x8BED;&#x53E5;&#x5757;&#x540E;&#x9762;&#x7684; <code>catch</code> &#x5B50;&#x53E5;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5BF9;&#x5B83;&#x4EEC;&#x7684;&#x5904;&#x7406;&#x3002;&#x5F02;&#x5E38;&#x7684;&#x540D;&#x5B57;&#x518D;&#x6B21;&#x6210;&#x4E3A;&#x4E86;&#x4E00;&#x79CD;&#x5BF9;&#x9519;&#x8BEF;&#x7C7B;&#x578B;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x89E3;&#x91CA;&#xFF08;<code>IllegalAccessException</code> &#x8FDD;&#x53CD;&#x4E86; Java &#x5B89;&#x5168;&#x673A;&#x5236;&#xFF0C;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;&#x8868;&#x793A;&#x9ED8;&#x8BA4;&#x6784;&#x9020;&#x5668;&#x4E3A; <code>private</code> &#x7684;&#x60C5;&#x51B5;&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x521B;&#x5EFA; <code>PetCreator</code> &#x7684;&#x5B50;&#x7C7B;&#x65F6;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x4E3A; <code>get()</code> &#x65B9;&#x6CD5;&#x63D0;&#x4F9B; <code>Pet</code> &#x7C7B;&#x578B;&#x7684; <code>List</code>&#x3002;<code>types()</code> &#x65B9;&#x6CD5;&#x4F1A;&#x7B80;&#x5355;&#x5730;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9759;&#x6001; <code>List</code> &#x7684;&#x5F15;&#x7528;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4F7F;&#x7528; <code>forName()</code> &#x7684;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/ForNameCreator.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ForNameCreator</span> <span class="token keyword">extends</span> <span class="token class-name">PetCreator</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> types <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x9700;&#x8981;&#x968F;&#x673A;&#x751F;&#x6210;&#x7684;&#x7C7B;&#x578B;&#x540D;:</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> typeNames <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;typeinfo.pets.Mutt&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Pug&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.EgyptianMau&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Manx&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Cymric&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Rat&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Mouse&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;typeinfo.pets.Hamster&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> name <span class="token operator">:</span> typeNames<span class="token punctuation">)</span>
                types<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token function">loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">types</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> types<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><code>loader()</code> &#x65B9;&#x6CD5;&#x4F7F;&#x7528; <code>Class.forName()</code> &#x521B;&#x5EFA;&#x4E86; <code>Class</code> &#x5BF9;&#x8C61;&#x7684; <code>List</code>&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4; <code>ClassNotFoundException</code> &#x5F02;&#x5E38;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4F20;&#x5165;&#x7684;&#x662F;&#x4E00;&#x4E2A; <code>String</code> &#x7C7B;&#x578B;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5B83;&#x4E0D;&#x80FD;&#x5728;&#x7F16;&#x8BD1;&#x671F;&#x95F4;&#x88AB;&#x786E;&#x8BA4;&#x662F;&#x5426;&#x5408;&#x7406;&#x3002;&#x7531;&#x4E8E; <code>Pet</code> &#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;&#x5728; <code>typeinfo</code> &#x5305;&#x91CC;&#x9762;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x586B;&#x5199;&#x5B8C;&#x6574;&#x7684;&#x5305;&#x540D;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x5F97; <code>List</code> &#x88C5;&#x5165;&#x7684;&#x662F;&#x5177;&#x4F53;&#x7684; <code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x662F;&#x5FC5;&#x987B;&#x7684;&#xFF0C;&#x5B83;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x7F16;&#x8BD1;&#x65F6;&#x8B66;&#x544A;&#x3002;<code>loader()</code> &#x65B9;&#x6CD5;&#x662F;&#x5206;&#x5F00;&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x5B83;&#x88AB;&#x653E;&#x5165;&#x5230;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x4EE3;&#x7801;&#x5757;&#x91CC;&#xFF0C;&#x56E0;&#x4E3A; <code>@SuppressWarning</code> &#x6CE8;&#x89E3;&#x4E0D;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x653E;&#x7F6E;&#x5728;&#x9759;&#x6001;&#x4EE3;&#x7801;&#x5757;&#x4E4B;&#x4E0A;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5BF9; <code>Pet</code> &#x8FDB;&#x884C;&#x8BA1;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x80FD;&#x8DDF;&#x8E2A;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684; <code>Pet</code> &#x7684;&#x5DE5;&#x5177;&#x3002;<code>Map</code> &#x662F;&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x7684;&#x9996;&#x9009;&#xFF0C;&#x6211;&#x4EEC;&#x5C06; <code>Pet</code> &#x7C7B;&#x578B;&#x540D;&#x4F5C;&#x4E3A;&#x952E;&#xFF0C;&#x5C06;&#x4FDD;&#x5B58; <code>Pet</code> &#x6570;&#x91CF;&#x7684; <code>Integer</code> &#x4F5C;&#x4E3A;&#x503C;&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x8BE2;&#x95EE;&#xFF1A;&#x201C;&#x6709;&#x591A;&#x5C11;&#x4E2A; <code>Hamster</code> &#x5BF9;&#x8C61;&#xFF1F;&#x201D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>instanceof</code> &#x6765;&#x5BF9; <code>Pet</code> &#x8FDB;&#x884C;&#x8BA1;&#x6570;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/PetCount.java</span>
<span class="token comment">// &#x4F7F;&#x7528; instanceof</span>
<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PetCount</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Integer</span> quantity <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>quantity <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token function">put</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                <span class="token function">put</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> quantity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">countPets</span><span class="token punctuation">(</span><span class="token class-name">PetCreator</span> creator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Counter</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Pet</span> pet <span class="token operator">:</span> <span class="token class-name">Pets</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// List each individual pet:</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>
                    pet<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Pet</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Pet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Dog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Mutt</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Mutt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Pug</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Pug&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Cat</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">EgyptianMau</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;EgyptianMau&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Manx</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Manx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Cymric</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Cymric&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Rodent</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Rodent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Rat</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Rat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Mouse</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Mouse&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Hamster</span><span class="token punctuation">)</span>
                counter<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;Hamster&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Show the counts:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">countPets</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ForNameCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Rat Manx Cymric Mutt Pug Cymric Pug Manx Cymric Rat
EgyptianMau Hamster EgyptianMau Mutt Mutt Cymric Mouse
Pug Mouse Cymric
{EgyptianMau=2, Pug=3, Rat=2, Cymric=5, Mouse=2, Cat=9,
Manx=7, Rodent=5, Mutt=3, Dog=6, Pet=20, Hamster=1}
</code></pre><p>&#x5728; <code>countPets()</code> &#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x7B80;&#x77ED;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5; <code>Pets.array()</code> &#x751F;&#x4EA7;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x52A8;&#x7269;&#x7684;&#x96C6;&#x5408;&#x3002;&#x6BCF;&#x4E2A; <code>Pet</code> &#x90FD;&#x88AB; <code>instanceof</code> &#x68C0;&#x6D4B;&#x5230;&#x5E76;&#x8BA1;&#x7B97;&#x4E86;&#x4E00;&#x904D;&#x3002;</p>
<p><code>instanceof</code> &#x6709;&#x4E00;&#x4E2A;&#x4E25;&#x683C;&#x7684;&#x9650;&#x5236;&#xFF1A;&#x53EA;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x4E0E;&#x547D;&#x540D;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x4E0E; <code>Class</code> &#x5BF9;&#x8C61;&#x4F5C;&#x6BD4;&#x8F83;&#x3002;&#x5728;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x89C9;&#x5F97;&#x5199;&#x51FA;&#x4E00;&#x5927;&#x5806; <code>instanceof</code> &#x8868;&#x8FBE;&#x5F0F;&#x5F88;&#x4E4F;&#x5473;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E5F;&#x662F;&#x5982;&#x6B64;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x8BA9; <code>instanceof</code> &#x806A;&#x660E;&#x8D77;&#x6765;&#xFF0C;&#x8BA9;&#x5B83;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x5730;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x76EE;&#x6807;&#x4E0E;&#x8FD9;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x9010;&#x4E00;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF08;&#x7A0D;&#x540E;&#x4F1A;&#x770B;&#x5230;&#x4E00;&#x79CD;&#x66FF;&#x4EE3;&#x65B9;&#x6848;&#xFF09;&#x3002;&#x5176;&#x5B9E;&#x8FD9;&#x5E76;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x5927;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x5199;&#x4E86;&#x5927;&#x91CF;&#x7684; <code>instanceof</code>&#xFF0C;&#x90A3;&#x5C31;&#x8BF4;&#x660E;&#x4F60;&#x7684;&#x8BBE;&#x8BA1;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x7455;&#x75B5;&#x3002;</p>
<h3 class="mume-header" id="%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%AD%97%E9%9D%A2%E9%87%8F">&#x4F7F;&#x7528;&#x7C7B;&#x5B57;&#x9762;&#x91CF;</h3>

<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7C7B;&#x5B57;&#x9762;&#x91CF;&#x91CD;&#x65B0;&#x5B9E;&#x73B0; <code>PetCreator</code> &#x7C7B;&#x7684;&#x8BDD;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x5728;&#x5F88;&#x591A;&#x65B9;&#x9762;&#x90FD;&#x4F1A;&#x66F4;&#x6E05;&#x6670;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/LiteralPetCreator.java</span>
<span class="token comment">// &#x4F7F;&#x7528;&#x7C7B;&#x5B57;&#x9762;&#x91CF;</span>
<span class="token comment">// {java typeinfo.pets.LiteralPetCreator}</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LiteralPetCreator</span> <span class="token keyword">extends</span> <span class="token class-name">PetCreator</span> <span class="token punctuation">{</span>
    <span class="token comment">// try &#x4EE3;&#x7801;&#x5757;&#x4E0D;&#x518D;&#x9700;&#x8981;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ALL_TYPES <span class="token operator">=</span>
            <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
                    <span class="token class-name">Pet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Dog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Cat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Rodent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                    <span class="token class-name">Mutt</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Pug</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">EgyptianMau</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                    <span class="token class-name">Manx</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Cymric</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Rat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                    <span class="token class-name">Mouse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Hamster</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x7528;&#x4E8E;&#x968F;&#x673A;&#x521B;&#x5EFA;&#x7684;&#x7C7B;&#x578B;:</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> TYPES <span class="token operator">=</span>
            ALL_TYPES<span class="token punctuation">.</span><span class="token function">subList</span><span class="token punctuation">(</span>ALL_TYPES<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">Mutt</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    ALL_TYPES<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">types</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> TYPES<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>TYPES<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>[class typeinfo.pets.Mutt, class typeinfo.pets.Pug,
class typeinfo.pets.EgyptianMau, class
typeinfo.pets.Manx, class typeinfo.pets.Cymric, class
typeinfo.pets.Rat, class typeinfo.pets.Mouse, class
typeinfo.pets.Hamster]
</code></pre><p>&#x5728;&#x5373;&#x5C06;&#x5230;&#x6765;&#x7684; <code>PetCount3.java</code> &#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7528;&#x6240;&#x6709; <code>Pet</code> &#x7C7B;&#x578B;&#x9884;&#x5148;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A; <code>Map</code>&#xFF08;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x968F;&#x673A;&#x751F;&#x6210;&#x7684;&#xFF09;&#xFF0C;&#x56E0;&#x6B64; <code>ALL_TYPES</code> &#x7C7B;&#x578B;&#x7684;&#x5217;&#x8868;&#x662F;&#x5FC5;&#x8981;&#x7684;&#x3002;<code>types</code> &#x5217;&#x8868;&#x662F; <code>ALL_TYPES</code> &#x7C7B;&#x578B;&#xFF08;&#x4F7F;&#x7528; <code>List.subList()</code> &#x521B;&#x5EFA;&#xFF09;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5B83;&#x5305;&#x542B;&#x7CBE;&#x786E;&#x7684;&#x5BA0;&#x7269;&#x7C7B;&#x578B;&#xFF0C;&#x56E0;&#x6B64;&#x7528;&#x4E8E;&#x968F;&#x673A;&#x751F;&#x6210; <code>Pet</code>&#x3002;</p>
<p>&#x8FD9;&#x6B21;&#xFF0C;<code>types</code> &#x7684;&#x521B;&#x5EFA;&#x6CA1;&#x6709;&#x88AB; <code>try</code> &#x5757;&#x5305;&#x56F4;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x662F;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x8BA1;&#x7B97;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x4F1A;&#x5F15;&#x53D1;&#x4EFB;&#x4F55;&#x5F02;&#x5E38;&#xFF0C;&#x4E0D;&#x50CF; <code>Class.forName()</code>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x5728; <code>typeinfo.pets</code> &#x5E93;&#x4E2D;&#x6709;&#x4E24;&#x4E2A; <code>PetCreator</code> &#x7684;&#x5B9E;&#x73B0;&#x3002;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x7B2C;&#x4E8C;&#x4E2A;&#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4F7F;&#x7528; <code>LiteralPetCreator</code> &#x7684; <em>&#x5916;&#x89C2;&#x6A21;&#x5F0F;</em>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/pets/Pets.java</span>
<span class="token comment">// Facade to produce a default PetCreator</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pets</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">PetCreator</span> CREATOR <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiteralPetCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Pet</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> CREATOR<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Pet</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">array</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Pet</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pet</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> CREATOR<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token function">array</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pet</span><span class="token punctuation">&gt;</span></span> <span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>CREATOR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8FD9;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9; <code>get()</code>&#x3001;<code>array()</code> &#x548C; <code>list()</code> &#x7684;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;&#x751F;&#x6210; <code>Stream&lt;Pet&gt;</code> &#x7684;&#x65B0;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x56E0;&#x4E3A; <code>PetCount.countPets()</code> &#x91C7;&#x7528;&#x4E86; <code>PetCreator</code> &#x53C2;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x6D4B;&#x8BD5; <code>LiteralPetCreator</code>&#xFF08;&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x5916;&#x89C2;&#x6A21;&#x5F0F;&#xFF09;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/PetCount2.java</span>
<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PetCount2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PetCount</span><span class="token punctuation">.</span><span class="token function">countPets</span><span class="token punctuation">(</span><span class="token class-name">Pets</span><span class="token punctuation">.</span>CREATOR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Rat Manx Cymric Mutt Pug Cymric Pug Manx Cymric Rat
EgyptianMau Hamster EgyptianMau Mutt Mutt Cymric Mouse
Pug Mouse Cymric
{EgyptianMau=2, Pug=3, Rat=2, Cymric=5, Mouse=2, Cat=9,
Manx=7, Rodent=5, Mutt=3, Dog=6, Pet=20, Hamster=1}
</code></pre><p>&#x8F93;&#x51FA;&#x4E0E; <code>PetCount.java</code> &#x7684;&#x8F93;&#x51FA;&#x76F8;&#x540C;&#x3002;</p>
<h3 class="mume-header" id="%E4%B8%80%E4%B8%AA%E5%8A%A8%E6%80%81-instanceof-%E5%87%BD%E6%95%B0">&#x4E00;&#x4E2A;&#x52A8;&#x6001; <code>instanceof</code> &#x51FD;&#x6570;</h3>

<p><code>Class.isInstance()</code> &#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x52A8;&#x6001;&#x6D4B;&#x8BD5;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x7E41;&#x7410;&#x7684; <code>instanceof</code> &#x8BED;&#x53E5;&#x90FD;&#x53EF;&#x4EE5;&#x4ECE; <code>PetCount.java</code> &#x4E2D;&#x5220;&#x9664;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/PetCount3.java</span>
<span class="token comment">// &#x4F7F;&#x7528; isInstance() &#x65B9;&#x6CD5;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PetCount3</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span>
            <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Pet</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">LiteralPetCreator</span><span class="token punctuation">.</span>ALL_TYPES<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>lpc <span class="token operator">-&gt;</span> <span class="token class-name">Pair</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span>lpc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
                            <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">key</span><span class="token punctuation">,</span> <span class="token class-name">Pair</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token class-name">Pet</span> pet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Class.isInstance() &#x66FF;&#x6362; instanceof:</span>
            <span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>pair <span class="token operator">-&gt;</span> pair<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInstance</span><span class="token punctuation">(</span>pet<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>pair <span class="token operator">-&gt;</span>
                            <span class="token function">put</span><span class="token punctuation">(</span>pair<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pair<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>pair <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;%s=%s&quot;</span><span class="token punctuation">,</span>
                            pair<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            pair<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">&quot;{&quot;</span> <span class="token operator">+</span> result <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Counter</span> petCount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Pets</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>petCount<span class="token operator">:</span><span class="token operator">:</span><span class="token function">count</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>
                        p<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;n&quot;</span> <span class="token operator">+</span> petCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Rat Manx Cymric Mutt Pug Cymric Pug Manx Cymric Rat
EgyptianMau Hamster EgyptianMau Mutt Mutt Cymric Mouse
Pug Mouse Cymric
{Rat=2, Pug=3, Mutt=3, Mouse=2, Cat=9, Dog=6, Cymric=5,
EgyptianMau=2, Rodent=5, Hamster=1, Manx=7, Pet=20}
</code></pre><p>&#x4E3A;&#x4E86;&#x8BA1;&#x7B97;&#x6240;&#x6709;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684; <code>Pet</code>&#xFF0C;<code>Counter Map</code> &#x9884;&#x5148;&#x52A0;&#x8F7D;&#x4E86;&#x6765;&#x81EA; <code>LiteralPetCreator.ALL_TYPES</code> &#x7684;&#x7C7B;&#x578B;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x9884;&#x5148;&#x52A0;&#x8F7D; <code>Map</code>&#xFF0C;&#x5C06;&#x53EA;&#x8BA1;&#x6570;&#x968F;&#x673A;&#x751F;&#x6210;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x50CF; <code>Pet</code> &#x548C; <code>Cat</code> &#x8FD9;&#x6837;&#x7684;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x3002;</p>
<p><code>isInstance()</code> &#x65B9;&#x6CD5;&#x6D88;&#x9664;&#x4E86;&#x5BF9; <code>instanceof</code> &#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x9700;&#x8981;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x66F4;&#x6539; <code>LiteralPetCreator.types</code> &#x6570;&#x7EC4;&#x6765;&#x6DFB;&#x52A0;&#x65B0;&#x7C7B;&#x578B;&#x7684; <code>Pet</code>&#xFF1B;&#x7A0B;&#x5E8F;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x4E0D;&#x9700;&#x8981;&#x4FEE;&#x6539;&#xFF08;&#x5C31;&#x50CF;&#x4F7F;&#x7528; <code>instanceof</code> &#x8868;&#x8FBE;&#x5F0F;&#x65F6;&#x90A3;&#x6837;&#xFF09;&#x3002;</p>
<p><code>toString()</code> &#x65B9;&#x6CD5;&#x88AB;&#x91CD;&#x8F7D;&#xFF0C;&#x4EE5;&#x4FBF;&#x66F4;&#x5BB9;&#x6613;&#x8BFB;&#x53D6;&#x8F93;&#x51FA;&#xFF0C;&#x8BE5;&#x8F93;&#x51FA;&#x4ECD;&#x4E0E;&#x6253;&#x5370; <code>Map</code> &#x65F6;&#x770B;&#x5230;&#x7684;&#x5178;&#x578B;&#x8F93;&#x51FA;&#x5339;&#x914D;&#x3002;</p>
<h3 class="mume-header" id="%E9%80%92%E5%BD%92%E8%AE%A1%E6%95%B0">&#x9012;&#x5F52;&#x8BA1;&#x6570;</h3>

<p><code>PetCount3.Counter</code> &#x4E2D;&#x7684; <code>Map</code> &#x9884;&#x5148;&#x52A0;&#x8F7D;&#x4E86;&#x6240;&#x6709;&#x4E0D;&#x540C;&#x7684; <code>Pet</code> &#x7C7B;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>Class.isAssignableFrom()</code> &#x800C;&#x4E0D;&#x662F;&#x9884;&#x52A0;&#x8F7D; <code>Map</code> &#xFF0C;&#x5E76;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E0D;&#x9650;&#x4E8E;&#x8BA1;&#x6570; <code>Pet</code> &#x7684;&#x901A;&#x7528;&#x5DE5;&#x5177;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// onjava/TypeCounter.java</span>
<span class="token comment">// &#x8BA1;&#x7B97;&#x7C7B;&#x578B;&#x5BB6;&#x65CF;&#x7684;&#x5B9E;&#x4F8B;&#x6570;</span>
<span class="token keyword">package</span> onjava<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TypeCounter</span> <span class="token keyword">extends</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> baseType<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">TypeCounter</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> baseType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>baseType <span class="token operator">=</span> baseType<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>baseType<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>
                obj <span class="token operator">+</span> <span class="token string">&quot; incorrect type: &quot;</span> <span class="token operator">+</span> type <span class="token operator">+</span>
                <span class="token string">&quot;, should be type or subtype of &quot;</span> <span class="token operator">+</span> baseType<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">countClass</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">countClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Integer</span> quantity <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> quantity <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> quantity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> superClass <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>superClass <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
               baseType<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>superClass<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token function">countClass</span><span class="token punctuation">(</span>superClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>pair <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;%s=%s&quot;</span><span class="token punctuation">,</span>
                pair<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                pair<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;{&quot;</span> <span class="token operator">+</span> result <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><code>count()</code> &#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x5176;&#x53C2;&#x6570;&#x7684; <code>Class</code>&#xFF0C;&#x5E76;&#x4F7F;&#x7528; <code>isAssignableFrom()</code> &#x8FDB;&#x884C;&#x8FD0;&#x884C;&#x65F6;&#x68C0;&#x67E5;&#xFF0C;&#x4EE5;&#x9A8C;&#x8BC1;&#x4F20;&#x9012;&#x7684;&#x5BF9;&#x8C61;&#x5B9E;&#x9645;&#x4E0A;&#x5C5E;&#x4E8E;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x3002;<code>countClass()</code> &#x9996;&#x5148;&#x8BA1;&#x7B97;&#x7C7B;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x5982;&#x679C; <code>baseType</code> &#x53EF;&#x4EE5;&#x4ECE;&#x8D85;&#x7C7B;&#x8D4B;&#x503C;&#xFF0C;&#x5219;&#x5728;&#x8D85;&#x7C7B;&#x4E0A;&#x9012;&#x5F52;&#x8C03;&#x7528; <code>countClass()</code>&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/PetCount4.java</span>
<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>pets</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PetCount4</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TypeCounter</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeCounter</span><span class="token punctuation">(</span><span class="token class-name">Pet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Pets</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>counter<span class="token operator">:</span><span class="token operator">:</span><span class="token function">count</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>
                p<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;n&quot;</span> <span class="token operator">+</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Rat Manx Cymric Mutt Pug Cymric Pug Manx Cymric Rat
EgyptianMau Hamster EgyptianMau Mutt Mutt Cymric Mouse
Pug Mouse Cymric
{Dog=6, Manx=7, Cat=9, Rodent=5, Hamster=1, Rat=2,
Pug=3, Mutt=3, Cymric=5, EgyptianMau=2, Pet=20,
Mouse=2}
</code></pre><p>&#x8F93;&#x51FA;&#x8868;&#x660E;&#x4E24;&#x4E2A;&#x57FA;&#x7C7B;&#x578B;&#x4EE5;&#x53CA;&#x7CBE;&#x786E;&#x7C7B;&#x578B;&#x90FD;&#x88AB;&#x8BA1;&#x6570;&#x4E86;&#x3002;</p>
<h2 class="mume-header" id="%E6%B3%A8%E5%86%8C%E5%B7%A5%E5%8E%82">&#x6CE8;&#x518C;&#x5DE5;&#x5382;</h2>

<p>&#x4ECE; <code>Pet</code> &#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x751F;&#x6210;&#x5BF9;&#x8C61;&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x6BCF;&#x5F53;&#x5411;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x79CD;&#x65B0;&#x7C7B;&#x578B;&#x7684; <code>Pet</code> &#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x8BB0;&#x4F4F;&#x5C06;&#x5176;&#x6DFB;&#x52A0;&#x5230; <code>LiteralPetCreator.java</code> &#x7684;&#x6761;&#x76EE;&#x4E2D;&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x5B9A;&#x671F;&#x6DFB;&#x52A0;&#x66F4;&#x591A;&#x7C7B;&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x6210;&#x4E3A;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x8003;&#x8651;&#x5411;&#x6BCF;&#x4E2A;&#x5B50;&#x7C7B;&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x521D;&#x59CB;&#x503C;&#x8BBE;&#x5B9A;&#x9879;&#xFF0C;&#x56E0;&#x6B64;&#x521D;&#x59CB;&#x503C;&#x8BBE;&#x5B9A;&#x9879;&#x4F1A;&#x5C06;&#x5176;&#x7C7B;&#x6DFB;&#x52A0;&#x5230;&#x67D0;&#x4E2A;&#x5217;&#x8868;&#x4E2D;&#x3002;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x9759;&#x6001;&#x521D;&#x59CB;&#x503C;&#x8BBE;&#x5B9A;&#x9879;&#x4EC5;&#x5728;&#x9996;&#x6B21;&#x52A0;&#x8F7D;&#x7C7B;&#x65F6;&#x8C03;&#x7528;&#xFF0C;&#x56E0;&#x6B64;&#x5B58;&#x5728;&#x9E21;&#x548C;&#x86CB;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x751F;&#x6210;&#x5668;&#x7684;&#x5217;&#x8868;&#x4E2D;&#x6CA1;&#x6709;&#x7C7B;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&#x8BE5;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x6B64;&#x7C7B;&#x4E0D;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#x5E76;&#x653E;&#x5165;&#x5217;&#x8868;&#x4E2D;&#x3002;</p>
<p>&#x57FA;&#x672C;&#x4E0A;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x81EA;&#x5DF1;&#x624B;&#x5DE5;&#x521B;&#x5EFA;&#x5217;&#x8868;&#xFF08;&#x9664;&#x975E;&#x4F60;&#x7F16;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x6765;&#x641C;&#x7D22;&#x548C;&#x5206;&#x6790;&#x6E90;&#x4EE3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x521B;&#x5EFA;&#x548C;&#x7F16;&#x8BD1;&#x5217;&#x8868;&#xFF09;&#x3002;&#x6240;&#x4EE5;&#x4F60;&#x80FD;&#x505A;&#x7684;&#x6700;&#x597D;&#x7684;&#x4E8B;&#x60C5;&#x5C31;&#x662F;&#x628A;&#x5217;&#x8868;&#x96C6;&#x4E2D;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x660E;&#x663E;&#x7684;&#x5730;&#x65B9;&#x3002;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x7684;&#x57FA;&#x7C7B;&#x53EF;&#x80FD;&#x662F;&#x6700;&#x597D;&#x7684;&#x5730;&#x65B9;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x6240;&#x505A;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x66F4;&#x6539;&#x662F;&#x4F7F;&#x7528;<em>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;</em>&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5C06;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#x63A8;&#x8FDF;&#x5230;&#x7C7B;&#x672C;&#x8EAB;&#x3002;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x4EE5;&#x591A;&#x6001;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E3A;&#x4F60;&#x521B;&#x5EFA;&#x9002;&#x5F53;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#xFF0C;<code>java.util.function.Supplier</code> &#x7528; <code>T get()</code> &#x63CF;&#x8FF0;&#x4E86;&#x539F;&#x578B;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x3002;&#x534F;&#x53D8;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x5141;&#x8BB8; <code>get()</code> &#x4E3A; <code>Supplier</code> &#x7684;&#x6BCF;&#x4E2A;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;&#x57FA;&#x7C7B; <code>Part</code> &#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5DE5;&#x5382;&#x5BF9;&#x8C61;&#x7684;&#x9759;&#x6001;&#x5217;&#x8868;&#xFF0C;&#x5217;&#x8868;&#x6210;&#x5458;&#x7C7B;&#x578B;&#x4E3A; <code>Supplier&lt;Part&gt;</code>&#x3002;&#x5BF9;&#x4E8E;&#x5E94;&#x8BE5;&#x7531; <code>get()</code> &#x65B9;&#x6CD5;&#x751F;&#x6210;&#x7684;&#x7C7B;&#x578B;&#x7684;&#x5DE5;&#x5382;&#xFF0C;&#x901A;&#x8FC7;&#x5C06;&#x5B83;&#x4EEC;&#x6DFB;&#x52A0;&#x5230; <code>prototypes</code> &#x5217;&#x8868;&#x5411;&#x57FA;&#x7C7B;&#x201C;&#x6CE8;&#x518C;&#x201D;&#x3002;&#x5947;&#x602A;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x4E9B;&#x5DE5;&#x5382;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x5BF9;&#x8C61;&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x6B64;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x7684;<em>&#x539F;&#x578B;</em>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/RegisteredFactories.java</span>
<span class="token comment">// &#x6CE8;&#x518C;&#x5DE5;&#x5382;&#x5230;&#x57FA;&#x7840;&#x7C7B;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Part</span> <span class="token keyword">implements</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Part</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Supplier</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Part</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> prototypes <span class="token operator">=</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
          <span class="token keyword">new</span> <span class="token class-name">FuelFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">AirFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">CabinAirFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">OilFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">FanBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">PowerSteeringBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">new</span> <span class="token class-name">GeneratorBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Part</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>prototypes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> prototypes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Filter</span> <span class="token keyword">extends</span> <span class="token class-name">Part</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">FuelFilter</span> <span class="token keyword">extends</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">FuelFilter</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FuelFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AirFilter</span> <span class="token keyword">extends</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">AirFilter</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AirFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CabinAirFilter</span> <span class="token keyword">extends</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CabinAirFilter</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CabinAirFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">OilFilter</span> <span class="token keyword">extends</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">OilFilter</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OilFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Belt</span> <span class="token keyword">extends</span> <span class="token class-name">Part</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">FanBelt</span> <span class="token keyword">extends</span> <span class="token class-name">Belt</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">FanBelt</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FanBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">GeneratorBelt</span> <span class="token keyword">extends</span> <span class="token class-name">Belt</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">GeneratorBelt</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">GeneratorBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">PowerSteeringBelt</span> <span class="token keyword">extends</span> <span class="token class-name">Belt</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PowerSteeringBelt</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PowerSteeringBelt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RegisteredFactories</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Part</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>GeneratorBelt
CabinAirFilter
GeneratorBelt
AirFilter
PowerSteeringBelt
CabinAirFilter
FuelFilter
PowerSteeringBelt
PowerSteeringBelt
FuelFilter
</code></pre><p>&#x5E76;&#x975E;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7C7B;&#x90FD;&#x5E94;&#x5B9E;&#x4F8B;&#x5316;&#xFF1B;&#x8FD9;&#x91CC;&#x7684; <code>Filter</code> &#x548C; <code>Belt</code> &#x53EA;&#x662F;&#x5206;&#x7C7B;&#x5668;&#xFF0C;&#x8FD9;&#x6837;&#x4F60;&#x5C31;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C;&#x662F;&#x53EA;&#x521B;&#x5EFA;&#x5B83;&#x4EEC;&#x7684;&#x5B50;&#x7C7B;&#xFF08;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x5C1D;&#x8BD5;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x4F60;&#x5C06;&#x83B7;&#x5F97; <code>Part</code> &#x57FA;&#x7C7B;&#x7684;&#x884C;&#x4E3A;&#xFF09;&#x3002;</p>
<p>&#x56E0;&#x4E3A; <code>Part implements Supplier&lt;Part&gt;</code>&#xFF0C;<code>Part</code> &#x901A;&#x8FC7;&#x5176; <code>get()</code> &#x65B9;&#x6CD5;&#x4F9B;&#x5E94;&#x5176;&#x4ED6; <code>Part</code>&#x3002;&#x5982;&#x679C;&#x4E3A;&#x57FA;&#x7C7B; <code>Part</code> &#x8C03;&#x7528; <code>get()</code>&#xFF08;&#x6216;&#x8005;&#x5982;&#x679C; <code>generate()</code> &#x8C03;&#x7528; <code>get()</code>&#xFF09;&#xFF0C;&#x5B83;&#x5C06;&#x521B;&#x5EFA;&#x968F;&#x673A;&#x7279;&#x5B9A;&#x7684; <code>Part</code> &#x5B50;&#x7C7B;&#x578B;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x7C7B;&#x578B;&#x6700;&#x7EC8;&#x90FD;&#x4ECE; <code>Part</code> &#x7EE7;&#x627F;&#xFF0C;&#x5E76;&#x91CD;&#x5199;&#x76F8;&#x5E94;&#x7684; <code>get()</code> &#x4EE5;&#x751F;&#x6210;&#x5B83;&#x4EEC;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;</p>
<h2 class="mume-header" id="%E7%B1%BB%E7%9A%84%E7%AD%89%E4%BB%B7%E6%AF%94%E8%BE%83">&#x7C7B;&#x7684;&#x7B49;&#x4EF7;&#x6BD4;&#x8F83;</h2>

<p>&#x5F53;&#x4F60;&#x67E5;&#x8BE2;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF1A;instanceof &#x7684;&#x5F62;&#x5F0F;(&#x5373; <code>instanceof</code> &#x6216; <code>isInstance()</code> &#xFF0C;&#x8FD9;&#x4E24;&#x8005;&#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x76F8;&#x540C;) &#x548C; &#x4E0E; Class &#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x6BD4;&#x8F83; &#x8FD9;&#x4E24;&#x8005;&#x95F4;&#x5B58;&#x5728;&#x91CD;&#x8981;&#x533A;&#x522B;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x5C55;&#x793A;&#x4E86;&#x8FD9;&#x79CD;&#x533A;&#x522B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/FamilyVsExactType.java</span>
<span class="token comment">// instanceof &#x4E0E; class &#x7684;&#x5DEE;&#x522B;</span>
<span class="token comment">// {java typeinfo.FamilyVsExactType}</span>
<span class="token keyword">package</span> typeinfo<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FamilyVsExactType</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Object</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;Testing x of type &quot;</span> <span class="token operator">+</span> x<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x instanceof Base &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>x <span class="token keyword">instanceof</span> <span class="token class-name">Base</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x instanceof Derived &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>x <span class="token keyword">instanceof</span> <span class="token class-name">Derived</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;Base.isInstance(x) &quot;</span> <span class="token operator">+</span> <span class="token class-name">Base</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isInstance</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;Derived.isInstance(x) &quot;</span> <span class="token operator">+</span>
              <span class="token class-name">Derived</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isInstance</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x.getClass() == Base.class &quot;</span> <span class="token operator">+</span>
              <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Base</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x.getClass() == Derived.class &quot;</span> <span class="token operator">+</span>
              <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Derived</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x.getClass().equals(Base.class)) &quot;</span><span class="token operator">+</span>
              <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Base</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
              <span class="token string">&quot;x.getClass().equals(Derived.class)) &quot;</span> <span class="token operator">+</span>
              <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Derived</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Testing x of type class typeinfo.Base
x instanceof Base true
x instanceof Derived false
Base.isInstance(x) true
Derived.isInstance(x) false
x.getClass() == Base.class true
x.getClass() == Derived.class false
x.getClass().equals(Base.class)) true
x.getClass().equals(Derived.class)) false
Testing x of type class typeinfo.Derived
x instanceof Base true
x instanceof Derived true
Base.isInstance(x) true
Derived.isInstance(x) true
x.getClass() == Base.class false
x.getClass() == Derived.class true
x.getClass().equals(Base.class)) false
x.getClass().equals(Derived.class)) true
</code></pre><p><code>test()</code> &#x65B9;&#x6CD5;&#x4F7F;&#x7528;&#x4E24;&#x79CD;&#x5F62;&#x5F0F;&#x7684; <code>instanceof</code> &#x5BF9;&#x5176;&#x53C2;&#x6570;&#x6267;&#x884C;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x5B83;&#x83B7;&#x53D6; <code>Class</code> &#x5F15;&#x7528;&#xFF0C;&#x5E76;&#x4F7F;&#x7528; <code>==</code> &#x548C; <code>equals()</code> &#x6D4B;&#x8BD5; <code>Class</code> &#x5BF9;&#x8C61;&#x7684;&#x76F8;&#x7B49;&#x6027;&#x3002;&#x4EE4;&#x4EBA;&#x653E;&#x5FC3;&#x7684;&#x662F;&#xFF0C;<code>instanceof</code> &#x548C; <code>isInstance()</code> &#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x76F8;&#x540C;&#xFF0C; <code>equals()</code> &#x548C; <code>==</code> &#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x4E5F;&#x76F8;&#x540C;&#x3002;&#x4F46;&#x6D4B;&#x8BD5;&#x672C;&#x8EAB;&#x5F97;&#x51FA;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x8BBA;&#x3002;&#x4E0E;&#x7C7B;&#x578B;&#x7684;&#x6982;&#x5FF5;&#x4E00;&#x81F4;&#xFF0C;<code>instanceof</code> &#x8BF4;&#x7684;&#x662F;&#x201C;&#x4F60;&#x662F;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x8FD8;&#x662F;&#x4ECE;&#x8FD9;&#x4E2A;&#x7C7B;&#x6D3E;&#x751F;&#x7684;&#x7C7B;&#xFF1F;&#x201D;&#x3002;&#x800C;&#x5982;&#x679C;&#x4F7F;&#x7528; <code>==</code> &#x6BD4;&#x8F83;&#x5B9E;&#x9645;&#x7684;<code>Class</code> &#x5BF9;&#x8C61;&#xFF0C;&#x5219;&#x4E0E;&#x7EE7;&#x627F;&#x65E0;&#x5173; &#x2014;&#x2014; &#x5B83;&#x8981;&#x4E48;&#x662F;&#x786E;&#x5207;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x8981;&#x4E48;&#x4E0D;&#x662F;&#x3002;</p>
<h2 class="mume-header" id="%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E4%BF%A1%E6%81%AF">&#x53CD;&#x5C04;&#xFF1A;&#x8FD0;&#x884C;&#x65F6;&#x7C7B;&#x4FE1;&#x606F;</h2>

<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x77E5;&#x9053;&#x5BF9;&#x8C61;&#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#xFF0C;RTTI &#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x9650;&#x5236;&#xFF1A;&#x5FC5;&#x987B;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x77E5;&#x9053;&#x7C7B;&#x578B;&#xFF0C;&#x624D;&#x80FD;&#x4F7F;&#x7528; RTTI &#x68C0;&#x6D4B;&#x5B83;&#xFF0C;&#x5E76;&#x5BF9;&#x4FE1;&#x606F;&#x505A;&#x4E00;&#x4E9B;&#x6709;&#x7528;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5FC5;&#x987B;&#x77E5;&#x9053;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x6240;&#x6709;&#x7C7B;&#x3002;</p>
<p>&#x8D77;&#x521D;&#xFF0C;&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x5E76;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x5927;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x4F46;&#x662F;&#x5047;&#x8BBE;&#x4F60;&#x5F15;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x4E0D;&#x5728;&#x7A0B;&#x5E8F;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x751A;&#x81F3;&#x5BF9;&#x7A0B;&#x5E8F;&#x90FD;&#x4E0D;&#x53EF;&#x7528;&#x3002;&#x4E5F;&#x8BB8;&#x4F60;&#x4ECE;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x6216;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x4E2D;&#x83B7;&#x5F97;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x5B57;&#x8282;&#xFF0C;&#x5E76;&#x88AB;&#x544A;&#x77E5;&#x8FD9;&#x4E9B;&#x5B57;&#x8282;&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x7C7B;&#x3002;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x7C7B;&#x5728;&#x7F16;&#x8BD1;&#x5668;&#x4E3A;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x751F;&#x6210;&#x4EE3;&#x7801;&#x540E;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x624D;&#x4F1A;&#x51FA;&#x73B0;&#xFF0C;&#x4F60;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#xFF1F;</p>
<p>&#x5728;&#x4F20;&#x7EDF;&#x7F16;&#x7A0B;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x7275;&#x5F3A;&#x7684;&#x573A;&#x666F;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x7F16;&#x7A0B;&#x4E16;&#x754C;&#x65F6;&#xFF0C;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;&#x57FA;&#x4E8E;&#x7EC4;&#x4EF6;&#x7684;&#x7F16;&#x7A0B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6784;&#x5EFA;&#x5668;<em>&#x96C6;&#x6210;&#x5F00;&#x53D1;&#x73AF;&#x5883;</em>&#x4E2D;&#x4F7F;&#x7528;<em>&#x5FEB;&#x901F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;</em>&#xFF08;RAD&#xFF09;&#x6784;&#x5EFA;&#x9879;&#x76EE;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x901A;&#x8FC7;&#x5C06;&#x8868;&#x793A;&#x7EC4;&#x4EF6;&#x7684;&#x56FE;&#x6807;&#x79FB;&#x52A8;&#x5230;&#x7A97;&#x4F53;&#x4E0A;&#x6765;&#x521B;&#x5EFA;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x89C6;&#x5316;&#x65B9;&#x6CD5;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x5728;&#x7F16;&#x7A0B;&#x65F6;&#x8BBE;&#x7F6E;&#x8FD9;&#x4E9B;&#x7EC4;&#x4EF6;&#x7684;&#x4E00;&#x4E9B;&#x503C;&#x6765;&#x914D;&#x7F6E;&#x8FD9;&#x4E9B;&#x7EC4;&#x4EF6;&#x3002;&#x8FD9;&#x79CD;&#x8BBE;&#x8BA1;&#x65F6;&#x914D;&#x7F6E;&#x8981;&#x6C42;&#x4EFB;&#x4F55;&#x7EC4;&#x4EF6;&#x90FD;&#x662F;&#x53EF;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#xFF0C;&#x5B83;&#x516C;&#x5F00;&#x81EA;&#x5DF1;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x8BFB;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x5176;&#x5C5E;&#x6027;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5904;&#x7406;<em>&#x56FE;&#x5F62;&#x7528;&#x6237;&#x754C;&#x9762;</em>&#xFF08;GUI&#xFF09;&#x4E8B;&#x4EF6;&#x7684;&#x7EC4;&#x4EF6;&#x5FC5;&#x987B;&#x516C;&#x5F00;&#x6709;&#x5173;&#x9002;&#x5F53;&#x65B9;&#x6CD5;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x4FBF; IDE &#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x7A0B;&#x5E8F;&#x5458;&#x8986;&#x5199;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x65B9;&#x6CD5;&#x3002;&#x53CD;&#x5C04;&#x63D0;&#x4F9B;&#x4E86;&#x68C0;&#x6D4B;&#x53EF;&#x7528;&#x65B9;&#x6CD5;&#x5E76;&#x751F;&#x6210;&#x65B9;&#x6CD5;&#x540D;&#x79F0;&#x7684;&#x673A;&#x5236;&#x3002;</p>
<p>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x53D1;&#x73B0;&#x7C7B;&#x4FE1;&#x606F;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x4EE4;&#x4EBA;&#x4FE1;&#x670D;&#x7684;&#x52A8;&#x673A;&#x662F;&#x63D0;&#x4F9B;&#x8DE8;&#x7F51;&#x7EDC;&#x5728;&#x8FDC;&#x7A0B;&#x5E73;&#x53F0;&#x4E0A;&#x521B;&#x5EFA;&#x548C;&#x6267;&#x884C;&#x5BF9;&#x8C61;&#x7684;&#x80FD;&#x529B;&#x3002;&#x8FD9;&#x79F0;&#x4E3A;<em>&#x8FDC;&#x7A0B;&#x65B9;&#x6CD5;&#x8C03;&#x7528;</em>&#xFF08;RMI&#xFF09;&#xFF0C;&#x5B83;&#x4F7F; Java &#x7A0B;&#x5E8F;&#x7684;&#x5BF9;&#x8C61;&#x5206;&#x5E03;&#x5728;&#x8BB8;&#x591A;&#x673A;&#x5668;&#x4E0A;&#x3002;&#x8FD9;&#x79CD;&#x5206;&#x5E03;&#x6709;&#x591A;&#x79CD;&#x539F;&#x56E0;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x52A0;&#x901F;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x5BC6;&#x96C6;&#x578B;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x628A;&#x5B83;&#x5206;&#x89E3;&#x6210;&#x5C0F;&#x5757;&#x653E;&#x5230;&#x7A7A;&#x95F2;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x3002;&#x6216;&#x8005;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5904;&#x7406;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x4EFB;&#x52A1;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x591A;&#x5C42;&#x6B21;&#x5BA2;&#x6237;&#x673A;/&#x670D;&#x52A1;&#x5668;&#x4F53;&#x7CFB;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x201C;&#x4E1A;&#x52A1;&#x89C4;&#x5219;&#x201D;&#xFF09;&#x653E;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x673A;&#x5668;&#x5C31;&#x6210;&#x4E3A;&#x63CF;&#x8FF0;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7684;&#x516C;&#x5171;&#x5B58;&#x50A8;&#x5E93;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x66F4;&#x6539;&#x5B83;&#x4EE5;&#x5F71;&#x54CD;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x4EBA;&#x3002;&#x5206;&#x5E03;&#x5F0F;&#x8BA1;&#x7B97;&#x8FD8;&#x652F;&#x6301;&#x4E13;&#x95E8;&#x7684;&#x786C;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E9B;&#x786C;&#x4EF6;&#x53EF;&#x80FD;&#x64C5;&#x957F;&#x4E8E;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x4EFB;&#x52A1;&#x2014;&#x2014;&#x4F8B;&#x5982;&#x77E9;&#x9635;&#x8F6C;&#x6362;&#x2014;&#x2014;&#x4F46;&#x5BF9;&#x4E8E;&#x901A;&#x7528;&#x7F16;&#x7A0B;&#x6765;&#x8BF4;&#x4E0D;&#x5408;&#x9002;&#x6216;&#x8FC7;&#x4E8E;&#x6602;&#x8D35;&#x3002;</p>
<p>&#x7C7B; <code>Class</code> &#x652F;&#x6301;<em>&#x53CD;&#x5C04;</em>&#x7684;&#x6982;&#x5FF5;&#xFF0C; <code>java.lang.reflect</code> &#x5E93;&#x4E2D;&#x5305;&#x542B;&#x7C7B; <code>Field</code>&#x3001;<code>Method</code> &#x548C; <code>Constructor</code>&#xFF08;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x5B9E;&#x73B0;&#x4E86; <code>Member</code> &#x63A5;&#x53E3;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x7531; JVM &#x5728;&#x8FD0;&#x884C;&#x65F6;&#x521B;&#x5EFA;&#xFF0C;&#x4EE5;&#x8868;&#x793A;&#x672A;&#x77E5;&#x7C7B;&#x4E2D;&#x7684;&#x5BF9;&#x5E94;&#x6210;&#x5458;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>Constructor</code> &#x521B;&#x5EFA;&#x65B0;&#x5BF9;&#x8C61;&#xFF0C;<code>get()</code> &#x548C; <code>set()</code> &#x65B9;&#x6CD5;&#x8BFB;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4E0E; <code>Field</code> &#x5BF9;&#x8C61;&#x5173;&#x8054;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;<code>invoke()</code> &#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x4E0E; <code>Method</code> &#x5BF9;&#x8C61;&#x5173;&#x8054;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x4FBF;&#x5229;&#x65B9;&#x6CD5; <code>getFields()</code>&#x3001;<code>getMethods()</code>&#x3001;<code>getConstructors()</code> &#x7B49;&#xFF0C;&#x4EE5;&#x8FD4;&#x56DE;&#x8868;&#x793A;&#x5B57;&#x6BB5;&#x3001;&#x65B9;&#x6CD5;&#x548C;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x5BF9;&#x8C61;&#x6570;&#x7EC4;&#x3002;&#xFF08;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728; JDK &#x6587;&#x6863;&#x4E2D;&#x67E5;&#x627E;&#x7C7B; <code>Class</code> &#x6765;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#xFF0C;&#x533F;&#x540D;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5B8C;&#x5168;&#x786E;&#x5B9A;&#xFF0C;&#x7F16;&#x8BD1;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x77E5;&#x9053;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x91CD;&#x8981;&#x7684;&#x662F;&#x8981;&#x610F;&#x8BC6;&#x5230;&#x53CD;&#x5C04;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x9B54;&#x529B;&#x3002;&#x5F53;&#x4F60;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x4E0E;&#x672A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x4EA4;&#x4E92;&#x65F6;&#xFF0C;JVM &#x5C06;&#x67E5;&#x770B;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x770B;&#x5230;&#x5B83;&#x5C5E;&#x4E8E;&#x7279;&#x5B9A;&#x7684;&#x7C7B;&#xFF08;&#x5C31;&#x50CF;&#x666E;&#x901A;&#x7684; RTTI&#xFF09;&#x3002;&#x5728;&#x5BF9;&#x5176;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF0C;&#x5FC5;&#x987B;&#x52A0;&#x8F7D; <code>Class</code> &#x5BF9;&#x8C61;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8BE5;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684; <code>.class</code> &#x6587;&#x4EF6;&#x5FC5;&#x987B;&#x5728;&#x672C;&#x5730;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x6216;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x5BF9; JVM &#x4ECD;&#x7136;&#x53EF;&#x7528;&#x3002;&#x56E0;&#x6B64;&#xFF0C;RTTI &#x548C;&#x53CD;&#x5C04;&#x7684;&#x771F;&#x6B63;&#x533A;&#x522B;&#x5728;&#x4E8E;&#xFF0C;&#x4F7F;&#x7528; RTTI &#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x4F1A;&#x6253;&#x5F00;&#x5E76;&#x68C0;&#x67E5; <code>.class</code> &#x6587;&#x4EF6;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x201C;&#x6B63;&#x5E38;&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x3002;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#xFF0C;<code>.class</code> &#x6587;&#x4EF6;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x4E0D;&#x53EF;&#x7528;&#xFF1B;&#x5B83;&#x7531;&#x8FD0;&#x884C;&#x65F6;&#x73AF;&#x5883;&#x6253;&#x5F00;&#x5E76;&#x68C0;&#x67E5;&#x3002;</p>
<h3 class="mume-header" id="%E7%B1%BB%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96%E5%99%A8">&#x7C7B;&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x5668;</h3>

<p>&#x901A;&#x5E38;&#xFF0C;&#x4F60;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x5DE5;&#x5177;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x4F60;&#x521B;&#x5EFA;&#x66F4;&#x591A;&#x7684;&#x52A8;&#x6001;&#x4EE3;&#x7801;&#x3002;&#x53CD;&#x5C04;&#x662F;&#x7528;&#x6765;&#x652F;&#x6301;&#x5176;&#x4ED6; Java &#x7279;&#x6027;&#x7684;&#xFF0C;&#x4F8B;&#x5982;&#x5BF9;&#x8C61;&#x5E8F;&#x5217;&#x5316;&#xFF08;&#x53C2;&#x89C1;<a href="https://lingcoder.github.io/OnJava8/#/book/Appendix-Object-Serialization">&#x9644;&#x5F55;&#xFF1A;&#x5BF9;&#x8C61;&#x5E8F;&#x5217;&#x5316;</a>&#xFF09;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6709;&#x65F6;&#x52A8;&#x6001;&#x63D0;&#x53D6;&#x6709;&#x5173;&#x7C7B;&#x7684;&#x4FE1;&#x606F;&#x5F88;&#x6709;&#x7528;&#x3002;</p>
<p>&#x8003;&#x8651;&#x4E00;&#x4E2A;&#x7C7B;&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x5668;&#x3002;&#x67E5;&#x770B;&#x7C7B;&#x5B9A;&#x4E49;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x6216; JDK &#x6587;&#x6863;&#xFF0C;&#x53EA;&#x663E;&#x793A;<em>&#x5728;&#x8BE5;&#x7C7B;&#x5B9A;&#x4E49;&#x4E2D;</em>&#x5B9A;&#x4E49;&#x6216;&#x91CD;&#x5199;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x51E0;&#x5341;&#x4E2A;&#x6765;&#x81EA;&#x57FA;&#x7C7B;&#x7684;&#x53EF;&#x7528;&#x65B9;&#x6CD5;&#x3002;&#x627E;&#x5230;&#x5B83;&#x4EEC;&#x65E2;&#x5355;&#x8C03;&#x53C8;&#x8D39;&#x65F6;<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>&#x3002;&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x53CD;&#x5C04;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x5730;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;&#x81EA;&#x52A8;&#x5730;&#x5411;&#x4F60;&#x5C55;&#x793A;&#x6240;&#x6709;&#x7684;&#x63A5;&#x53E3;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/ShowMethods.java</span>
<span class="token comment">// &#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x5C55;&#x793A;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#xFF0C;&#x751A;&#x81F3;&#x5305;&#x62EC;&#x5B9A;&#x4E49;&#x5728;&#x57FA;&#x7C7B;&#x4E2D;&#x65B9;&#x6CD5;</span>
<span class="token comment">// {java ShowMethods ShowMethods}</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShowMethods</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> usage <span class="token operator">=</span>
            <span class="token string">&quot;usage:\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;ShowMethods qualified.class.name\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;To show all methods in class or:\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;ShowMethods qualified.class.name word\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;To search for methods involving &apos;word&apos;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> p <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">&quot;\\w+\\.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>usage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> lines <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ctors <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> method <span class="token operator">:</span> methods<span class="token punctuation">)</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                            p<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>
                                    method<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> ctor <span class="token operator">:</span> ctors<span class="token punctuation">)</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                            p<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>ctor<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                lines <span class="token operator">=</span> methods<span class="token punctuation">.</span>length <span class="token operator">+</span> ctors<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> method <span class="token operator">:</span> methods<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>
                                method<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        lines<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> ctor <span class="token operator">:</span> ctors<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>ctor<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>
                                ctor<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        lines<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No such class: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>public static void main(String[])
public final void wait() throws InterruptedException
public final void wait(long,int) throws
InterruptedException
public final native void wait(long) throws
InterruptedException
public boolean equals(Object)
public String toString()
public native int hashCode()
public final native Class getClass()
public final native void notify()
public final native void notifyAll()
public ShowMethods()
</code></pre><p><code>Class</code> &#x65B9;&#x6CD5; <code>getmethods()</code> &#x548C; <code>getconstructors()</code>  &#x5206;&#x522B;&#x8FD4;&#x56DE; <code>Method</code> &#x6570;&#x7EC4;&#x548C; <code>Constructor</code> &#x6570;&#x7EC4;&#x3002;&#x8FD9;&#x4E9B;&#x7C7B;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x6709;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x6790;&#x5B83;&#x4EEC;&#x6240;&#x8868;&#x793A;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x540D;&#x79F0;&#x3001;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C;&#x3002;&#x4F46;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x50CF;&#x8FD9;&#x91CC;&#x6240;&#x505A;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x4F7F;&#x7528; <code>toString()</code>&#xFF0C;&#x751F;&#x6210;&#x5E26;&#x6709;&#x6574;&#x4E2A;&#x65B9;&#x6CD5;&#x7B7E;&#x540D;&#x7684; <code>String</code>&#x3002;&#x4EE3;&#x7801;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x63D0;&#x53D6;&#x547D;&#x4EE4;&#x884C;&#x4FE1;&#x606F;&#xFF0C;&#x786E;&#x5B9A;&#x7279;&#x5B9A;&#x7B7E;&#x540D;&#x662F;&#x5426;&#x4E0E;&#x76EE;&#x6807; <code>String</code>&#xFF08;&#x4F7F;&#x7528; <code>indexOf()</code>&#xFF09;&#x5339;&#x914D;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF08;&#x5728; <a href="#ch021.xhtml#strings">Strings</a> &#x4E00;&#x7AE0;&#x4E2D;&#x4ECB;&#x7ECD;&#xFF09;&#x5220;&#x9664;&#x540D;&#x79F0;&#x9650;&#x5B9A;&#x7B26;&#x3002;</p>
<p>&#x7F16;&#x8BD1;&#x65F6;&#x65E0;&#x6CD5;&#x77E5;&#x9053; <code>Class.forName()</code> &#x751F;&#x6210;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x56E0;&#x6B64;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x7B7E;&#x540D;&#x4FE1;&#x606F;&#x90FD;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x63D0;&#x53D6;&#x7684;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7814;&#x7A76; JDK &#x53CD;&#x5C04;&#x6587;&#x6863;&#xFF0C;&#x4F60;&#x5C06;&#x770B;&#x5230;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x652F;&#x6301;&#x6765;&#x5B9E;&#x9645;&#x8BBE;&#x7F6E;&#x548C;&#x5BF9;&#x7F16;&#x8BD1;&#x65F6;&#x5B8C;&#x5168;&#x672A;&#x77E5;&#x7684;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF08;&#x672C;&#x4E66;&#x540E;&#x9762;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x4F8B;&#x5B50;&#xFF09;&#x3002;&#x867D;&#x7136;&#x6700;&#x521D;&#x4F60;&#x53EF;&#x80FD;&#x8BA4;&#x4E3A;&#x4F60;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x4F46;&#x662F;&#x53CD;&#x5C04;&#x7684;&#x5168;&#x90E8;&#x4EF7;&#x503C;&#x53EF;&#x80FD;&#x4F1A;&#x4EE4;&#x4EBA;&#x60CA;&#x8BB6;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x6765;&#x81EA;&#x547D;&#x4EE4;&#x884C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java">java <span class="token class-name">ShowMethods</span> <span class="token class-name">ShowMethods</span>
</pre><p>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x4E00;&#x4E2A; <code>public</code> &#x65E0;&#x53C2;&#x6570;&#x6784;&#x9020;&#x51FD;&#x6570;&#xFF0C;&#x5373;&#x4F7F;&#x672A;&#x5B9A;&#x4E49;&#x6784;&#x9020;&#x51FD;&#x6570;&#x3002;&#x4F60;&#x770B;&#x5230;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x662F;&#x7531;&#x7F16;&#x8BD1;&#x5668;&#x81EA;&#x52A8;&#x5408;&#x6210;&#x7684;&#x3002;&#x5982;&#x679C;&#x5C06; <code>ShowMethods</code> &#x8BBE;&#x7F6E;&#x4E3A;&#x975E; <code>public</code> &#x7C7B;&#xFF08;&#x5373;&#x53EA;&#x6709;&#x5305;&#x7EA7;&#x8BBF;&#x95EE;&#x6743;&#xFF09;&#xFF0C;&#x5219;&#x5408;&#x6210;&#x7684;&#x65E0;&#x53C2;&#x6570;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5C06;&#x4E0D;&#x518D;&#x663E;&#x793A;&#x5728;&#x8F93;&#x51FA;&#x4E2D;&#x3002;&#x81EA;&#x52A8;&#x4E3A;&#x5408;&#x6210;&#x7684;&#x65E0;&#x53C2;&#x6570;&#x6784;&#x9020;&#x51FD;&#x6570;&#x6388;&#x4E88;&#x4E0E;&#x7C7B;&#x76F8;&#x540C;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x3002;</p>
<p>&#x5C1D;&#x8BD5;&#x8FD0;&#x884C; <code>java ShowMethods java.lang.String</code>&#xFF0C;&#x5E76;&#x9644;&#x52A0;&#x4E00;&#x4E2A; <code>char</code>&#x3001;<code>int</code>&#x3001;<code>String</code> &#x7B49;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x7F16;&#x7A0B;&#x65F6;&#xFF0C;&#x5F53;&#x4F60;&#x4E0D;&#x8BB0;&#x5F97;&#x67D0;&#x4E2A;&#x7C7B;&#x662F;&#x5426;&#x6709;&#x7279;&#x5B9A;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x60F3;&#x5728; JDK &#x6587;&#x6863;&#x4E2D;&#x641C;&#x7D22;&#x7D22;&#x5F15;&#x6216;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x65F6;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x77E5;&#x9053;&#x8BE5;&#x7C7B;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5BF9; <code>Color</code> &#x5BF9;&#x8C61;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x8BE5;&#x5DE5;&#x5177;&#x80FD;&#x8282;&#x7701;&#x4E0D;&#x5C11;&#x65F6;&#x95F4;&#x3002;</p>
<h2 class="mume-header" id="%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86">&#x52A8;&#x6001;&#x4EE3;&#x7406;</h2>

<p><em>&#x4EE3;&#x7406;</em>&#x662F;&#x57FA;&#x672C;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E4B;&#x4E00;&#x3002;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5C01;&#x88C5;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#xFF0C;&#x4EE3;&#x66FF;&#x5176;&#x63D0;&#x4F9B;&#x5176;&#x4ED6;&#x6216;&#x4E0D;&#x540C;&#x7684;&#x64CD;&#x4F5C;---&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x901A;&#x5E38;&#x6D89;&#x53CA;&#x5230;&#x4E0E;&#x201C;&#x771F;&#x5B9E;&#x201D;&#x5BF9;&#x8C61;&#x7684;&#x901A;&#x4FE1;&#xFF0C;&#x56E0;&#x6B64;&#x4EE3;&#x7406;&#x901A;&#x5E38;&#x5145;&#x5F53;&#x4E2D;&#x95F4;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x663E;&#x793A;&#x4EE3;&#x7406;&#x7684;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/SimpleProxyDemo.java</span>

<span class="token keyword">interface</span> <span class="token class-name">Interface</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">somethingElse</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RealObject</span> <span class="token keyword">implements</span> <span class="token class-name">Interface</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;doSomething&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">somethingElse</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;somethingElse &quot;</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SimpleProxy</span> <span class="token keyword">implements</span> <span class="token class-name">Interface</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Interface</span> proxied<span class="token punctuation">;</span>

    <span class="token class-name">SimpleProxy</span><span class="token punctuation">(</span><span class="token class-name">Interface</span> proxied<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>proxied <span class="token operator">=</span> proxied<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SimpleProxy doSomething&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxied<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">somethingElse</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;SimpleProxy somethingElse &quot;</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxied<span class="token punctuation">.</span><span class="token function">somethingElse</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SimpleProxyDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token class-name">Interface</span> iface<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iface<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        iface<span class="token punctuation">.</span><span class="token function">somethingElse</span><span class="token punctuation">(</span><span class="token string">&quot;bonobo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RealObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RealObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>doSomething
somethingElse bonobo
SimpleProxy doSomething
doSomething
SimpleProxy somethingElse bonobo
somethingElse bonobo
</code></pre><p>&#x56E0;&#x4E3A; <code>consumer()</code> &#x63A5;&#x53D7; <code>Interface</code>&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4E0D;&#x77E5;&#x9053;&#x83B7;&#x5F97;&#x7684;&#x662F; <code>RealObject</code> &#x8FD8;&#x662F; <code>SimpleProxy</code>&#xFF0C;&#x56E0;&#x4E3A;&#x4E24;&#x8005;&#x90FD;&#x5B9E;&#x73B0;&#x4E86; <code>Interface</code>&#x3002;<br>
&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x548C; <code>RealObject</code> &#x4E4B;&#x95F4;&#x63D2;&#x5165;&#x7684; <code>SimpleProxy</code> &#x6267;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x7136;&#x540E;&#x5728; <code>RealObject</code> &#x4E0A;&#x8C03;&#x7528;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x5E0C;&#x671B;&#x5C06;&#x989D;&#x5916;&#x7684;&#x64CD;&#x4F5C;&#x4E0E;&#x201C;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#x201D;&#x505A;&#x5206;&#x79BB;&#x65F6;&#xFF0C;&#x4EE3;&#x7406;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5F53;&#x4F60;&#x60F3;&#x8981;&#x8F7B;&#x677E;&#x5730;&#x542F;&#x7528;&#x989D;&#x5916;&#x7684;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#xFF08;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5C31;&#x662F;&#x5C01;&#x88C5;&#x53D8;&#x66F4;---&#x6240;&#x4EE5;&#x4F60;&#x5FC5;&#x987B;&#x6539;&#x53D8;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#x4EE5;&#x8BC1;&#x660E;&#x6A21;&#x5F0F;&#x7684;&#x5408;&#x7406;&#x6027;&#xFF09;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8DDF;&#x8E2A;&#x5BF9; <code>RealObject</code> &#x4E2D;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x6216;&#x8861;&#x91CF;&#x6B64;&#x7C7B;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#xFF0C;&#x8BE5;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x4F60;&#x4E0D;&#x60F3;&#x8FD9;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x8026;&#x5408;&#x5230;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x800C;&#x4EE3;&#x7406;&#x80FD;&#x4F7F;&#x4F60;&#x53EF;&#x4EE5;&#x5F88;&#x8F7B;&#x677E;&#x5730;&#x6DFB;&#x52A0;&#x6216;&#x5220;&#x9664;&#x5B83;&#x3002;</p>
<p>Java &#x7684;<em>&#x52A8;&#x6001;&#x4EE3;&#x7406;</em>&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#xFF0C;&#x4E0D;&#x4EC5;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x800C;&#x4E14;&#x52A8;&#x6001;&#x5904;&#x7406;&#x5BF9;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x3002;&#x5728;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x4E0A;&#x8FDB;&#x884C;&#x7684;&#x6240;&#x6709;&#x8C03;&#x7528;&#x90FD;&#x88AB;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x5355;&#x4E2A;<em>&#x8C03;&#x7528;&#x5904;&#x7406;&#x7A0B;&#x5E8F;</em>&#xFF0C;&#x8BE5;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x8D1F;&#x8D23;&#x53D1;&#x73B0;&#x8C03;&#x7528;&#x7684;&#x5185;&#x5BB9;&#x5E76;&#x51B3;&#x5B9A;&#x5982;&#x4F55;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x662F; <code>SimpleProxyDemo.java</code> &#x4F7F;&#x7528;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x91CD;&#x5199;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/SimpleDynamicProxy.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DynamicProxyHandler</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> proxied<span class="token punctuation">;</span>

    <span class="token class-name">DynamicProxyHandler</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxied<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>proxied <span class="token operator">=</span> proxied<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span>
    <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;**** proxy: &quot;</span> <span class="token operator">+</span> proxy<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                        <span class="token string">&quot;, method: &quot;</span> <span class="token operator">+</span> method <span class="token operator">+</span> <span class="token string">&quot;, args: &quot;</span> <span class="token operator">+</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> arg <span class="token operator">:</span> args<span class="token punctuation">)</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>proxied<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SimpleDynamicProxy</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token class-name">Interface</span> iface<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iface<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        iface<span class="token punctuation">.</span><span class="token function">somethingElse</span><span class="token punctuation">(</span><span class="token string">&quot;bonobo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RealObject</span> real <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RealObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">consumer</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Insert a proxy and call again:</span>
        <span class="token class-name">Interface</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Interface</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>
                <span class="token class-name">Interface</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Interface</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">DynamicProxyHandler</span><span class="token punctuation">(</span>real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">consumer</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>doSomething
somethingElse bonobo
**** proxy: class $Proxy0, method: public abstract void
Interface.doSomething(), args: null
doSomething
**** proxy: class $Proxy0, method: public abstract void
Interface.somethingElse(java.lang.String), args:
[Ljava.lang.Object;@6bc7c054
  bonobo
somethingElse bonobo
</code></pre><p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x9759;&#x6001;&#x65B9;&#x6CD5; <code>Proxy.newProxyInstance()</code> &#x6765;&#x521B;&#x5EFA;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF08;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x4ECE;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x5BF9;&#x8C61;&#x4E2D;&#x83B7;&#x53D6;&#xFF09;&#xFF0C;&#x5E0C;&#x671B;&#x4EE3;&#x7406;&#x5B9E;&#x73B0;&#x7684;&#x63A5;&#x53E3;&#x5217;&#x8868;&#xFF08;&#x4E0D;&#x662F;&#x7C7B;&#x6216;&#x62BD;&#x8C61;&#x7C7B;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x63A5;&#x53E3;  <code>InvocationHandler</code> &#x7684;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x3002;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x8C03;&#x7528;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8C03;&#x7528;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x5E38;&#x4E3A;&#x8C03;&#x7528;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x5BF9;&#x201C;&#x771F;&#x5B9E;&#x201D;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E00;&#x65E6;&#x6267;&#x884C;&#x4E2D;&#x4ECB;&#x4EFB;&#x52A1;&#x4FBF;&#x53EF;&#x4EE5;&#x8F6C;&#x53D1;&#x8BF7;&#x6C42;&#x3002;</p>
<p><code>invoke()</code> &#x65B9;&#x6CD5;&#x88AB;&#x4F20;&#x9012;&#x7ED9;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#xFF0C;&#x4EE5;&#x9632;&#x4E07;&#x4E00;&#x4F60;&#x5FC5;&#x987B;&#x533A;&#x5206;&#x8BF7;&#x6C42;&#x7684;&#x6765;&#x6E90;---&#x4F46;&#x662F;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x65E0;&#x9700;&#x5173;&#x5FC3;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5728; <code>invoke()</code> &#x5185;&#x7684;&#x4EE3;&#x7406;&#x4E0A;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x65F6;&#x8981;&#x5C0F;&#x5FC3;&#xFF0C;&#x56E0;&#x4E3A;&#x63A5;&#x53E3;&#x7684;&#x8C03;&#x7528;&#x662F;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x91CD;&#x5B9A;&#x5411;&#x7684;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x6267;&#x884C;&#x4EE3;&#x7406;&#x64CD;&#x4F5C;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528; <code>Method.invoke()</code> &#x5C06;&#x8BF7;&#x6C42;&#x8F6C;&#x53D1;&#x7ED9;&#x88AB;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x643A;&#x5E26;&#x5FC5;&#x8981;&#x7684;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x770B;&#x8D77;&#x6765;&#x662F;&#x6709;&#x9650;&#x5236;&#x7684;&#xFF0C;&#x597D;&#x50CF;&#x4F60;&#x53EA;&#x80FD;&#x6267;&#x884C;&#x4E00;&#x822C;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x53EF;&#x4EE5;&#x8FC7;&#x6EE4;&#x67D0;&#x4E9B;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x540C;&#x65F6;&#x4F20;&#x9012;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/SelectingMethods.java</span>
<span class="token comment">// Looking for particular methods in a dynamic proxy</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MethodSelector</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> proxied<span class="token punctuation">;</span>

    <span class="token class-name">MethodSelector</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxied<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>proxied <span class="token operator">=</span> proxied<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span>
    <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;interesting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Proxy detected the interesting method&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>proxied<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SomeMethods</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">boring1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">boring2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">interesting</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">boring3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Implementation</span> <span class="token keyword">implements</span> <span class="token class-name">SomeMethods</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">boring1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;boring1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">boring2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;boring2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">interesting</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;interesting &quot;</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">boring3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;boring3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SelectingMethods</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SomeMethods</span> proxy <span class="token operator">=</span>
                <span class="token punctuation">(</span><span class="token class-name">SomeMethods</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>
                        <span class="token class-name">SomeMethods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token class-name">SomeMethods</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">MethodSelector</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Implementation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">boring1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">boring2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">interesting</span><span class="token punctuation">(</span><span class="token string">&quot;bonobo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">boring3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>boring1
boring2
Proxy detected the interesting method
interesting bonobo
boring3
</code></pre><p>&#x5728;&#x8FD9;&#x4E2A;&#x793A;&#x4F8B;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5728;&#x5BFB;&#x627E;&#x65B9;&#x6CD5;&#x540D;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5BFB;&#x627E;&#x65B9;&#x6CD5;&#x7B7E;&#x540D;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x9762;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x641C;&#x7D22;&#x7279;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#x503C;&#x3002;</p>
<p>&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x4E0D;&#x662F;&#x4F60;&#x6BCF;&#x5929;&#x90FD;&#x4F1A;&#x4F7F;&#x7528;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x5730;&#x89E3;&#x51B3;&#x67D0;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5728; Erich Gamma &#x7B49;&#x4EBA;&#x7684;<em>&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</em>&#x4E2D;&#x4E86;&#x89E3;&#x6709;&#x5173;<em>&#x4EE3;&#x7406;</em>&#x548C;&#x5176;&#x4ED6;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#x3002; &#xFF08;Addison-Wesley&#xFF0C;1995&#x5E74;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;<a href="./25-Patterns.md">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</a>&#x4E00;&#x7AE0;&#x3002;</p>
<h2 class="mume-header" id="optional%E7%B1%BB">Optional&#x7C7B;</h2>

<p>&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528;&#x5185;&#x7F6E;&#x7684; <code>null</code> &#x6765;&#x8868;&#x793A;&#x6CA1;&#x6709;&#x5BF9;&#x8C61;&#xFF0C;&#x6BCF;&#x6B21;&#x4F7F;&#x7528;&#x5F15;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x5FC5;&#x987B;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x5F15;&#x7528;&#x662F;&#x5426;&#x4E3A; <code>null</code>&#xFF0C;&#x8FD9;&#x663E;&#x5F97;&#x6709;&#x70B9;&#x67AF;&#x71E5;&#xFF0C;&#x800C;&#x4E14;&#x52BF;&#x5FC5;&#x4F1A;&#x4EA7;&#x751F;&#x76F8;&#x5F53;&#x4E4F;&#x5473;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x95EE;&#x9898;&#x5728;&#x4E8E; <code>null</code> &#x6CA1;&#x4EC0;&#x4E48;&#x81EA;&#x5DF1;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x53EA;&#x4F1A;&#x5728;&#x4F60;&#x60F3;&#x7528;&#x5B83;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x4EA7;&#x751F; <code>NullPointException</code>&#x3002;<code>java.util.Optional</code>&#xFF08;&#x9996;&#x6B21;&#x51FA;&#x73B0;&#x662F;&#x5728;<a href="docs/book/13-Functional-Programming.md">&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;</a>&#x8FD9;&#x7AE0;&#xFF09;&#x4E3A; <code>null</code> &#x503C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x4EE3;&#x7406;&#xFF0C;<code>Optional</code> &#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x629B;&#x51FA; <code>NullPointException</code>&#x3002;</p>
<p>&#x867D;&#x7136; <code>Optional</code> &#x662F; Java 8 &#x4E3A;&#x4E86;&#x652F;&#x6301;&#x6D41;&#x5F0F;&#x7F16;&#x7A0B;&#x624D;&#x5F15;&#x5165;&#x7684;&#xFF0C;&#x4F46;&#x5176;&#x5B9E;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x3002;&#x4E3A;&#x4E86;&#x8BC1;&#x660E;&#x8FD9;&#x70B9;&#xFF0C;&#x5728;&#x672C;&#x8282;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x628A;&#x5B83;&#x7528;&#x5728;&#x666E;&#x901A;&#x7684;&#x7C7B;&#x4E2D;&#x3002;&#x56E0;&#x4E3A;&#x6D89;&#x53CA;&#x4E00;&#x4E9B;&#x8FD0;&#x884C;&#x65F6;&#x68C0;&#x6D4B;&#xFF0C;&#x6240;&#x4EE5;&#x628A;&#x8FD9;&#x4E00;&#x5C0F;&#x8282;&#x653E;&#x5728;&#x4E86;&#x672C;&#x7AE0;&#x3002;</p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5728;&#x6240;&#x6709;&#x5730;&#x65B9;&#x90FD;&#x4F7F;&#x7528; <code>Optional</code> &#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x68C0;&#x67E5;&#x4E00;&#x4E0B;&#x662F;&#x4E0D;&#x662F; <code>null</code> &#x4E5F;&#x633A;&#x597D;&#x7684;&#xFF0C;&#x6216;&#x8005;&#x6709;&#x65F6;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5408;&#x7406;&#x5730;&#x5047;&#x8BBE;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0; <code>null</code>&#xFF0C;&#x751A;&#x81F3;&#x6709;&#x65F6;&#x5019;&#x68C0;&#x67E5; <code>NullPointException</code> &#x5F02;&#x5E38;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x7684;&#x3002;<code>Optional</code> &#x6700;&#x6709;&#x7528;&#x6B66;&#x4E4B;&#x5730;&#x7684;&#x662F;&#x5728;&#x90A3;&#x4E9B;&#x201C;&#x66F4;&#x63A5;&#x8FD1;&#x6570;&#x636E;&#x201D;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5728;&#x95EE;&#x9898;&#x7A7A;&#x95F4;&#x4E2D;&#x4EE3;&#x8868;&#x5B9E;&#x4F53;&#x7684;&#x5BF9;&#x8C61;&#x4E0A;&#x3002;&#x4E3E;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x5F88;&#x591A;&#x7CFB;&#x7EDF;&#x4E2D;&#x90FD;&#x6709; <code>Person</code> &#x7C7B;&#x578B;&#xFF0C;&#x4EE3;&#x7801;&#x4E2D;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x4F60;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x9645;&#x7684; <code>Person</code> &#x5BF9;&#x8C61;&#xFF08;&#x6216;&#x8005;&#x53EF;&#x80FD;&#x6709;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x8FD8;&#x6CA1;&#x7528;&#x5173;&#x4E8E;&#x90A3;&#x4E2A;&#x4EBA;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#xFF09;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x5728;&#x4F20;&#x7EDF;&#x65B9;&#x6CD5;&#x4E0B;&#xFF0C;&#x4F60;&#x4F1A;&#x7528;&#x5230;&#x4E00;&#x4E2A; <code>null</code> &#x5F15;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x6D4B;&#x8BD5;&#x5B83;&#x662F;&#x4E0D;&#x662F; <code>null</code>&#x3002;&#x800C;&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>Optional</code>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Person.java</span>
<span class="token comment">// Using Optional with regular classes</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> first<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> last<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> address<span class="token punctuation">;</span>
    <span class="token comment">// etc.</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Boolean</span> empty<span class="token punctuation">;</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> first<span class="token punctuation">,</span> <span class="token class-name">String</span> last<span class="token punctuation">,</span> <span class="token class-name">String</span> address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        empty <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>address<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> first<span class="token punctuation">,</span> <span class="token class-name">String</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> last<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>empty<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token string">&quot;&lt;Empty&gt;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> last<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> address<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;11 Degree Lane, Frostbite Falls, MN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>&lt;Empty&gt;
Smith
Bob Smith
Bob Smith 11 Degree Lane, Frostbite Falls, MN
</code></pre><p><code>Person</code> &#x7684;&#x8BBE;&#x8BA1;&#x6709;&#x65F6;&#x5019;&#x53C8;&#x53EB;&#x201C;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5BF9;&#x8C61;&#xFF08;DTO&#xFF0C;data-transfer object&#xFF09;&#x201D;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x6240;&#x6709;&#x5B57;&#x6BB5;&#x90FD;&#x662F; <code>public</code> &#x548C; <code>final</code> &#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x6709; <code>getter</code> &#x548C; <code>setter</code> &#x65B9;&#x6CD5;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<code>Person</code> &#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x5668;&#x7ED9;&#x5B83;&#x8D4B;&#x503C;&#xFF0C;&#x4E4B;&#x540E;&#x5C31;&#x53EA;&#x80FD;&#x8BFB;&#x800C;&#x4E0D;&#x80FD;&#x4FEE;&#x6539;&#x5B83;&#x7684;&#x503C;&#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4F60;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x7ED9;&#x5B83;&#x7684;&#x5B57;&#x6BB5;&#x91CD;&#x65B0;&#x8D4B;&#x503C;&#xFF09;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x4FEE;&#x6539;&#x4E00;&#x4E2A; <code>Person</code>&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x7528;&#x4E00;&#x4E2A;&#x65B0;&#x7684; <code>Person</code> &#x5BF9;&#x8C61;&#x6765;&#x66FF;&#x6362;&#x5B83;&#x3002;<code>empty</code> &#x5B57;&#x6BB5;&#x5728;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x88AB;&#x8D4B;&#x503C;&#xFF0C;&#x7528;&#x4E8E;&#x5FEB;&#x901F;&#x5224;&#x65AD;&#x8FD9;&#x4E2A; <code>Person</code> &#x5BF9;&#x8C61;&#x662F;&#x4E0D;&#x662F;&#x7A7A;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60F3;&#x4F7F;&#x7528; <code>Person</code>&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x4F7F;&#x7528; <code>Optional</code> &#x63A5;&#x53E3;&#x624D;&#x80FD;&#x8BBF;&#x95EE;&#x5B83;&#x7684; <code>String</code> &#x5B57;&#x6BB5;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F1A;&#x610F;&#x5916;&#x89E6;&#x53D1; <code>NullPointException</code> &#x4E86;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x4F60;&#x5DF2;&#x7ECF;&#x56E0;&#x4F60;&#x60CA;&#x4EBA;&#x7684;&#x7406;&#x5FF5;&#x800C;&#x83B7;&#x5F97;&#x4E86;&#x4E00;&#x5927;&#x7B14;&#x98CE;&#x9669;&#x6295;&#x8D44;&#xFF0C;&#x73B0;&#x5728;&#x4F60;&#x8981;&#x62DB;&#x5175;&#x4E70;&#x9A6C;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x865A;&#x4F4D;&#x4EE5;&#x5F85;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5C06; <code>Person Optional</code> &#x5BF9;&#x8C61;&#x653E;&#x5728;&#x6BCF;&#x4E2A; <code>Position</code> &#x4E0A;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Position.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EmptyTitleException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Position</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Person</span> person<span class="token punctuation">;</span>

    <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token class-name">String</span> jobTitle<span class="token punctuation">,</span> <span class="token class-name">Person</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTitle</span><span class="token punctuation">(</span>jobTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setPerson</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token class-name">String</span> jobTitle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>jobTitle<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> newTitle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Throws EmptyTitleException if newTitle is null:</span>
        title <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>newTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token class-name">EmptyTitleException</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> person<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token class-name">Person</span> newPerson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Uses empty Person if newPerson is null:</span>
        person <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>newPerson<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Position: &quot;</span> <span class="token operator">+</span> title <span class="token operator">+</span>
                <span class="token string">&quot;, Employee: &quot;</span> <span class="token operator">+</span> person<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token string">&quot;CEO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token string">&quot;Programmer&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Arthur&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Fonzarelli&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;caught &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Position: CEO, Employee: &lt;Empty&gt;
Position: Programmer, Employee: Arthur Fonzarelli
caught EmptyTitleException
</code></pre><p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528; <code>Optional</code> &#x7684;&#x65B9;&#x5F0F;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code>title</code> &#x548C; <code>person</code> &#x90FD;&#x662F;&#x666E;&#x901A;&#x5B57;&#x6BB5;&#xFF0C;&#x4E0D;&#x53D7; <code>Optional</code> &#x7684;&#x4FDD;&#x62A4;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4FEE;&#x6539;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x7684;&#x552F;&#x4E00;&#x9014;&#x5F84;&#x662F;&#x8C03;&#x7528; <code>setTitle()</code> &#x548C; <code>setPerson()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x90FD;&#x501F;&#x52A9; <code>Optional</code> &#x5BF9;&#x5B57;&#x6BB5;&#x8FDB;&#x884C;&#x4E86;&#x4E25;&#x683C;&#x7684;&#x9650;&#x5236;&#x3002;</p>
<p>&#x540C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x60F3;&#x4FDD;&#x8BC1; <code>title</code> &#x5B57;&#x6BB5;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x53D8;&#x6210; <code>null</code> &#x503C;&#x3002;&#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x5728; <code>setTitle()</code> &#x65B9;&#x6CD5;&#x91CC;&#x8FB9;&#x68C0;&#x67E5;&#x53C2;&#x6570; <code>newTitle</code> &#x7684;&#x503C;&#x3002;&#x4F46;&#x5176;&#x5B9E;&#x8FD8;&#x6709;&#x66F4;&#x597D;&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x4E00;&#x5927;&#x4F18;&#x52BF;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x8BA9;&#x6211;&#x4EEC;&#x91CD;&#x7528;&#x7ECF;&#x8FC7;&#x9A8C;&#x8BC1;&#x7684;&#x529F;&#x80FD;&#xFF08;&#x5373;&#x4FBF;&#x662F;&#x4E2A;&#x5F88;&#x5C0F;&#x7684;&#x529F;&#x80FD;&#xFF09;&#xFF0C;&#x4EE5;&#x51CF;&#x5C11;&#x81EA;&#x5DF1;&#x624B;&#x52A8;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x9519;&#x8BEF;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x7528; <code>ofNullable()</code> &#x628A; <code>newTitle</code> &#x8F6C;&#x6362;&#x4E00;&#x4E2A; <code>Optional</code>&#xFF08;&#x5982;&#x679C;&#x4F20;&#x5165;&#x7684;&#x503C;&#x4E3A; <code>null</code>&#xFF0C;<code>ofNullable()</code> &#x8FD4;&#x56DE;&#x7684;&#x5C06;&#x662F; <code>Optional.empty()</code>&#xFF09;&#x3002;&#x7D27;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x8C03;&#x7528;&#x4E86; <code>orElseThrow()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C; <code>newTitle</code> &#x7684;&#x503C;&#x662F; <code>null</code>&#xFF0C;&#x4F60;&#x5C06;&#x4F1A;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5E76;&#x6CA1;&#x6709;&#x628A; <code>title</code> &#x4FDD;&#x5B58;&#x6210; <code>Optional</code>&#xFF0C;&#x4F46;&#x901A;&#x8FC7;&#x5E94;&#x7528; <code>Optional</code> &#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x4EEC;&#x4ECD;&#x7136;&#x5982;&#x613F;&#x4EE5;&#x507F;&#x5730;&#x5BF9;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x65BD;&#x52A0;&#x4E86;&#x7EA6;&#x675F;&#x3002;</p>
<p><code>EmptyTitleException</code> &#x662F;&#x4E00;&#x4E2A; <code>RuntimeException</code>&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x610F;&#x5473;&#x7740;&#x7A0B;&#x5E8F;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x65B9;&#x6848;&#x91CC;&#x8FB9;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x53EF;&#x80FD;&#x4F1A;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x3002;&#x4F46;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x5728;&#x9519;&#x8BEF;&#x4EA7;&#x751F;&#x7684;&#x90A3;&#x4E00;&#x523B;&#xFF08;&#x5411; <code>setTitle()</code> &#x4F20; <code>null</code> &#x503C;&#x65F6;&#xFF09;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x53D1;&#x751F;&#x5728;&#x5176;&#x5B83;&#x65F6;&#x523B;&#xFF0C;&#x9700;&#x8981;&#x4F60;&#x901A;&#x8FC7;&#x8C03;&#x8BD5;&#x624D;&#x80FD;&#x53D1;&#x73B0;&#x95EE;&#x9898;&#x6240;&#x5728;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4F7F;&#x7528; <code>EmptyTitleException</code> &#x8FD8;&#x6709;&#x52A9;&#x4E8E;&#x5B9A;&#x4F4D; BUG&#x3002;</p>
<p><code>Person</code> &#x5B57;&#x6BB5;&#x7684;&#x9650;&#x5236;&#x53C8;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#xFF1A;&#x5982;&#x679C;&#x4F60;&#x628A;&#x5B83;&#x7684;&#x503C;&#x8BBE;&#x4E3A; <code>null</code>&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x81EA;&#x52A8;&#x628A;&#x5C06;&#x5B83;&#x8D4B;&#x503C;&#x6210;&#x4E00;&#x4E2A;&#x7A7A;&#x7684; <code>Person</code> &#x5BF9;&#x8C61;&#x3002;&#x5148;&#x524D;&#x6211;&#x4EEC;&#x4E5F;&#x7528;&#x8FC7;&#x7C7B;&#x4F3C;&#x7684;&#x65B9;&#x6CD5;&#x628A;&#x5B57;&#x6BB5;&#x8F6C;&#x6362;&#x6210; <code>Optional</code>&#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x662F;&#x5728;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528; <code>orElse(new Person())</code> &#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x7A7A;&#x7684; <code>Person</code> &#x5BF9;&#x8C61;&#x66FF;&#x4EE3;&#x4E86; <code>null</code>&#x3002;</p>
<p>&#x5728; <code>Position</code> &#x91CC;&#x8FB9;&#xFF0C;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x201C;&#x7A7A;&#x201D;&#x7684;&#x6807;&#x5FD7;&#x4F4D;&#x6216;&#x8005;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A; <code>person</code> &#x5B57;&#x6BB5;&#x7684; <code>Person</code> &#x5BF9;&#x8C61;&#x4E3A;&#x7A7A;&#xFF0C;&#x5C31;&#x8868;&#x793A;&#x8FD9;&#x4E2A; <code>Position</code> &#x662F;&#x4E2A;&#x7A7A;&#x7F3A;&#x4F4D;&#x7F6E;&#x3002;&#x4E4B;&#x540E;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x4F60;&#x5FC5;&#x987B;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x663E;&#x5F0F;&#x7684;&#x8868;&#x793A;&#x201C;&#x7A7A;&#x4F4D;&#x201D;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x6B63;&#x5982; YAGNI<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> (You Aren&apos;t Going to Need It&#xFF0C;&#x4F60;&#x6C38;&#x8FDC;&#x4E0D;&#x9700;&#x8981;&#x5B83;)&#x6240;&#x8A00;&#xFF0C;&#x5728;&#x521D;&#x7A3F;&#x65F6;&#x201C;&#x5B9E;&#x73B0;&#x5C3D;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x7684;&#x7B80;&#x5355;&#x201D;&#xFF0C;&#x76F4;&#x5230;&#x7A0B;&#x5E8F;&#x5728;&#x67D0;&#x4E9B;&#x65B9;&#x9762;&#x8981;&#x6C42;&#x4F60;&#x4E3A;&#x5176;&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5047;&#x8BBE;&#x8FD9;&#x662F;&#x5FC5;&#x8981;&#x7684;&#x3002;</p>
<p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x867D;&#x7136;&#x4F60;&#x6E05;&#x695A;&#x4F60;&#x4F7F;&#x7528;&#x4E86; <code>Optional</code>&#xFF0C;&#x53EF;&#x4EE5;&#x514D;&#x53D7; <code>NullPointerExceptions</code> &#x7684;&#x56F0;&#x6270;&#xFF0C;&#x4F46;&#x662F; <code>Staff</code> &#x7C7B;&#x5374;&#x5BF9;&#x6B64;&#x6BEB;&#x4E0D;&#x77E5;&#x60C5;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Staff.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Staff</span> <span class="token keyword">extends</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Position</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> titles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> title <span class="token operator">:</span> titles<span class="token punctuation">)</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Staff</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> titles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">add</span><span class="token punctuation">(</span>titles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">positionAvailable</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Position</span> position <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>position<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                    position<span class="token punctuation">.</span><span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>empty<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fillPosition</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">Person</span> hire<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Position</span> position <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>position<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                    position<span class="token punctuation">.</span><span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>empty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                position<span class="token punctuation">.</span><span class="token function">setPerson</span><span class="token punctuation">(</span>hire<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Position &quot;</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">&quot; not available&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Staff</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Staff</span><span class="token punctuation">(</span><span class="token string">&quot;President&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CTO&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Marketing Manager&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Product Manager&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Project Lead&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Test Engineer&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Technical Writer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        staff<span class="token punctuation">.</span><span class="token function">fillPosition</span><span class="token punctuation">(</span><span class="token string">&quot;President&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Me&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Last&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The Top, Lonely At&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        staff<span class="token punctuation">.</span><span class="token function">fillPosition</span><span class="token punctuation">(</span><span class="token string">&quot;Project Lead&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Janet&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Planner&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The Burbs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">positionAvailable</span><span class="token punctuation">(</span><span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            staff<span class="token punctuation">.</span><span class="token function">fillPosition</span><span class="token punctuation">(</span><span class="token string">&quot;Software Engineer&quot;</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>
                            <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Coder&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Bright Light City&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>[Position: President, Employee: Me Last The Top, Lonely
At, Position: CTO, Employee: &lt;Empty&gt;, Position:
Marketing Manager, Employee: &lt;Empty&gt;, Position: Product
Manager, Employee: &lt;Empty&gt;, Position: Project Lead,
Employee: Janet Planner The Burbs, Position: Software
Engineer, Employee: Bob Coder Bright Light City,
Position: Software Engineer, Employee: &lt;Empty&gt;,
Position: Software Engineer, Employee: &lt;Empty&gt;,
Position: Software Engineer, Employee: &lt;Empty&gt;,
Position: Test Engineer, Employee: &lt;Empty&gt;, Position:
Technical Writer, Employee: &lt;Empty&gt;]
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x4F60;&#x53EF;&#x80FD;&#x8FD8;&#x662F;&#x8981;&#x6D4B;&#x8BD5;&#x5F15;&#x7528;&#x662F;&#x4E0D;&#x662F; <code>Optional</code>&#xFF0C;&#x8FD9;&#x8DDF;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x4E3A; <code>null</code> &#x6CA1;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#x3002;&#x4F46;&#x662F;&#x5728;&#x5176;&#x5B83;&#x5730;&#x65B9;&#xFF08;&#x4F8B;&#x5982;&#x672C;&#x4F8B;&#x4E2D;&#x7684; <code>toString()</code> &#x8F6C;&#x6362;&#xFF09;&#xFF0C;&#x4F60;&#x5C31;&#x4E0D;&#x5FC5;&#x6267;&#x884C;&#x989D;&#x5916;&#x7684;&#x6D4B;&#x8BD5;&#x4E86;&#xFF0C;&#x800C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5047;&#x8BBE;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x6709;&#x6548;&#x7684;&#x3002;</p>
<h3 class="mume-header" id="%E6%A0%87%E8%AE%B0%E6%8E%A5%E5%8F%A3">&#x6807;&#x8BB0;&#x63A5;&#x53E3;</h3>

<p>&#x6709;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;<strong>&#x6807;&#x8BB0;&#x63A5;&#x53E3;</strong>&#x6765;&#x8868;&#x793A;&#x7A7A;&#x503C;&#x4F1A;&#x66F4;&#x65B9;&#x4FBF;&#x3002;&#x6807;&#x8BB0;&#x63A5;&#x53E3;&#x91CC;&#x8FB9;&#x4EC0;&#x4E48;&#x90FD;&#x6CA1;&#x6709;&#xFF0C;&#x4F60;&#x53EA;&#x8981;&#x628A;&#x5B83;&#x7684;&#x540D;&#x5B57;&#x5F53;&#x505A;&#x6807;&#x7B7E;&#x6765;&#x7528;&#x5C31;&#x53EF;&#x4EE5;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// onjava/Null.java</span>
<span class="token keyword">package</span> onjava<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Null</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</pre><p>&#x5982;&#x679C;&#x4F60;&#x7528;&#x63A5;&#x53E3;&#x53D6;&#x4EE3;&#x5177;&#x4F53;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>DynamicProxy</code> &#x6765;&#x81EA;&#x52A8;&#x5730;&#x521B;&#x5EFA; <code>Null</code> &#x5BF9;&#x8C61;&#x3002;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x6709;&#x4E00;&#x4E2A; <code>Robot</code> &#x63A5;&#x53E3;&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x3001;&#x4E00;&#x4E2A;&#x6A21;&#x578B;&#x548C;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0; <code>Robot</code> &#x884C;&#x4E3A;&#x80FD;&#x529B;&#x7684; <code>List&lt;Operation&gt;</code>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Robot.java</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Robot</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> <span class="token function">operations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Robot</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token keyword">instanceof</span> <span class="token class-name">Null</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[Null Robot]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Robot name: &quot;</span> <span class="token operator">+</span> r<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Robot model: &quot;</span> <span class="token operator">+</span> r<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Operation</span> operation <span class="token operator">:</span> r<span class="token punctuation">.</span><span class="token function">operations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>operation<span class="token punctuation">.</span>description<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            operation<span class="token punctuation">.</span>command<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; <code>operations()</code> &#x6765;&#x8BBF;&#x95EE; <code>Robot</code> &#x7684;&#x670D;&#x52A1;&#x3002;<code>Robot</code> &#x91CC;&#x8FB9;&#x8FD8;&#x6709;&#x4E00;&#x4E2A; <code>static</code> &#x65B9;&#x6CD5;&#x6765;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#x3002;</p>
<p><code>Operation</code> &#x5305;&#x542B;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#x548C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF08;&#x8FD9;&#x7528;&#x5230;&#x4E86;<strong>&#x547D;&#x4EE4;&#x6A21;&#x5F0F;</strong>&#xFF09;&#x3002;&#x5B83;&#x4EEC;&#x88AB;&#x5B9A;&#x4E49;&#x6210;&#x51FD;&#x6570;&#x5F0F;&#x63A5;&#x53E3;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x628A; lambda &#x8868;&#x8FBE;&#x5F0F;&#x6216;&#x8005;&#x65B9;&#x6CD5;&#x7684;&#x5F15;&#x7528;&#x4F20;&#x7ED9; <code>Operation</code> &#x7684;&#x6784;&#x9020;&#x5668;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/Operation.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Operation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> description<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Runnable</span> command<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Operation</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> descr<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> cmd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        description <span class="token operator">=</span> descr<span class="token punctuation">;</span>
        command <span class="token operator">=</span> cmd<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x626B;&#x96EA; <code>Robot</code>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/SnowRemovalRobot.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SnowRemovalRobot</span> <span class="token keyword">implements</span> <span class="token class-name">Robot</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">SnowRemovalRobot</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;SnowBot Series 11&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Operation</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> name <span class="token operator">+</span> <span class="token string">&quot; can shovel snow&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                            name <span class="token operator">+</span> <span class="token string">&quot; shoveling snow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">Operation</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> name <span class="token operator">+</span> <span class="token string">&quot; can chip ice&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot; chipping ice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">Operation</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> name <span class="token operator">+</span> <span class="token string">&quot; can clear the roof&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                            name <span class="token operator">+</span> <span class="token string">&quot; clearing roof&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> <span class="token function">operations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ops<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Robot</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SnowRemovalRobot</span><span class="token punctuation">(</span><span class="token string">&quot;Slusher&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Robot name: Slusher
Robot model: SnowBot Series 11
Slusher can shovel snow
Slusher shoveling snow
Slusher can chip ice
Slusher chipping ice
Slusher can clear the roof
Slusher clearing roof
</code></pre><p>&#x5047;&#x8BBE;&#x5B58;&#x5728;&#x8BB8;&#x591A;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684; <code>Robot</code>&#xFF0C;&#x6211;&#x4EEC;&#x60F3;&#x8BA9;&#x6BCF;&#x79CD; <code>Robot</code> &#x90FD;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; <code>Null</code> &#x5BF9;&#x8C61;&#x6765;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x64CD;&#x4F5C;&#x2014;&#x2014;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;&#x5373;&#x63D0;&#x4F9B; <code>Null</code> &#x5BF9;&#x8C61;&#x6240;&#x4EE3;&#x8868; <code>Robot</code> &#x7684;&#x786E;&#x5207;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x662F;&#x901A;&#x8FC7;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x6355;&#x83B7;&#x7684;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/NullRobot.java</span>
<span class="token comment">// Using a dynamic proxy to create an Optional</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">NullRobotProxyHandler</span>
        <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nullName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Robot</span> proxied <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NRobot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">NullRobotProxyHandler</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Robot</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nullName <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; NullRobot&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">NRobot</span> <span class="token keyword">implements</span> <span class="token class-name">Null</span><span class="token punctuation">,</span> <span class="token class-name">Robot</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> nullName<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> nullName<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> <span class="token function">operations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span>
    <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>proxied<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NullRobot</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Robot</span>
    <span class="token function">newNullRobot</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Robot</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Robot</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>
                <span class="token class-name">NullRobot</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token class-name">Null</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Robot</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">NullRobotProxyHandler</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">SnowRemovalRobot</span><span class="token punctuation">(</span><span class="token string">&quot;SnowBee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">newNullRobot</span><span class="token punctuation">(</span><span class="token class-name">SnowRemovalRobot</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">Robot</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">test</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Robot name: SnowBee
Robot model: SnowBot Series 11
SnowBee can shovel snow
SnowBee shoveling snow
SnowBee can chip ice
SnowBee chipping ice
SnowBee can clear the roof
SnowBee clearing roof
[Null Robot]
Robot name: SnowRemovalRobot NullRobot
Robot model: SnowRemovalRobot NullRobot
</code></pre><p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7A7A; <code>Robot</code> &#x5BF9;&#x8C61;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x8C03;&#x7528; <code>newNullRobot()</code>&#xFF0C;&#x5E76;&#x4F20;&#x9012;&#x9700;&#x8981;&#x4EE3;&#x7406;&#x7684; <code>Robot</code> &#x7684;&#x7C7B;&#x578B;&#x3002;&#x8FD9;&#x4E2A;&#x4EE3;&#x7406;&#x6EE1;&#x8DB3;&#x4E86; <code>Robot</code> &#x548C; <code>Null</code> &#x63A5;&#x53E3;&#x7684;&#x9700;&#x8981;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x5B83;&#x6240;&#x4EE3;&#x7406;&#x7684;&#x7C7B;&#x578B;&#x7684;&#x786E;&#x5207;&#x540D;&#x5B57;&#x3002;</p>
<h3 class="mume-header" id="mock-%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%A1%A9">Mock &#x5BF9;&#x8C61;&#x548C;&#x6869;</h3>

<p><strong>Mock &#x5BF9;&#x8C61;</strong>&#x548C; **&#x6869;&#xFF08;Stub&#xFF09;**&#x5728;&#x903B;&#x8F91;&#x4E0A;&#x90FD;&#x662F; <code>Optional</code> &#x7684;&#x53D8;&#x4F53;&#x3002;&#x4ED6;&#x4EEC;&#x90FD;&#x662F;&#x6700;&#x7EC8;&#x7A0B;&#x5E8F;&#x4E2D;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x201C;&#x5B9E;&#x9645;&#x201D;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7406;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;Mock &#x5BF9;&#x8C61;&#x548C;&#x6869;&#x90FD;&#x662F;&#x5047;&#x626E;&#x6210;&#x90A3;&#x4E9B;&#x53EF;&#x4EE5;&#x4F20;&#x9012;&#x5B9E;&#x9645;&#x4FE1;&#x606F;&#x7684;&#x5B9E;&#x9645;&#x5BF9;&#x8C61;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x50CF; <code>Optional</code> &#x90A3;&#x6837;&#x628A;&#x5305;&#x542B;&#x6F5C;&#x5728; <code>null</code> &#x503C;&#x7684;&#x5BF9;&#x8C61;&#x9690;&#x85CF;&#x3002;</p>
<p>Mock &#x5BF9;&#x8C61;&#x548C;&#x6869;&#x4E4B;&#x95F4;&#x7684;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#x7A0B;&#x5EA6;&#x4E0D;&#x540C;&#x3002;Mock &#x5BF9;&#x8C61;&#x5F80;&#x5F80;&#x662F;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#xFF0C;&#x4E14;&#x7528;&#x4E8E;&#x81EA;&#x6D4B;&#x8BD5;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x4E3A;&#x4E86;&#x5904;&#x7406;&#x5404;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x6D4B;&#x8BD5;&#x573A;&#x666F;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x521B;&#x5EFA;&#x51FA;&#x5F88;&#x591A; Mock &#x5BF9;&#x8C61;&#x3002;&#x800C;&#x6869;&#x53EA;&#x662F;&#x8FD4;&#x56DE;&#x6869;&#x6570;&#x636E;&#xFF0C;&#x5B83;&#x901A;&#x5E38;&#x662F;&#x91CD;&#x91CF;&#x7EA7;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x7ECF;&#x5E38;&#x5728;&#x591A;&#x4E2A;&#x6D4B;&#x8BD5;&#x4E2D;&#x88AB;&#x590D;&#x7528;&#x3002;&#x6869;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5B83;&#x4EEC;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6869;&#x662F;&#x4E00;&#x79CD;&#x590D;&#x6742;&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x505A;&#x5F88;&#x591A;&#x4E8B;&#x60C5;&#x3002;&#x81F3;&#x4E8E; Mock &#x5BF9;&#x8C61;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8981;&#x505A;&#x5F88;&#x591A;&#x4E8B;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x521B;&#x5EFA;&#x5927;&#x91CF;&#x53C8;&#x5C0F;&#x53C8;&#x7B80;&#x5355;&#x7684; Mock &#x5BF9;&#x8C61;&#x3002;</p>
<h2 class="mume-header" id="%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB%E5%9E%8B">&#x63A5;&#x53E3;&#x548C;&#x7C7B;&#x578B;</h2>

<p><code>interface</code> &#x5173;&#x952E;&#x5B57;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x76EE;&#x6807;&#x5C31;&#x662F;&#x5141;&#x8BB8;&#x7A0B;&#x5E8F;&#x5458;&#x9694;&#x79BB;&#x7EC4;&#x4EF6;&#xFF0C;&#x8FDB;&#x800C;&#x964D;&#x4F4E;&#x8026;&#x5408;&#x5EA6;&#x3002;&#x4F7F;&#x7528;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x76EE;&#x6807;&#xFF0C;&#x4F46;&#x662F;&#x901A;&#x8FC7;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x79CD;&#x8026;&#x5408;&#x6027;&#x8FD8;&#x662F;&#x4F1A;&#x4F20;&#x64AD;&#x51FA;&#x53BB;&#x2014;&#x2014;&#x63A5;&#x53E3;&#x5E76;&#x4E0D;&#x662F;&#x5BF9;&#x89E3;&#x8026;&#x7684;&#x4E00;&#x79CD;&#x65E0;&#x61C8;&#x53EF;&#x51FB;&#x7684;&#x4FDD;&#x969C;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x5148;&#x5199;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/interfacea/A.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>&#x7136;&#x540E;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5176;&#x4EE3;&#x7801;&#x662F;&#x600E;&#x4E48;&#x4ECE;&#x5B9E;&#x9645;&#x7C7B;&#x578B;&#x5F00;&#x59CB;&#x987A;&#x85E4;&#x6478;&#x74DC;&#x7684;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/InterfaceViolation.java</span>
<span class="token comment">// Sneaking around an interface</span>

<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">implements</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InterfaceViolation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// a.g(); // Compile error</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">instanceof</span> <span class="token class-name">B</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">B</span> b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">)</span> a<span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>B
</code></pre><p>&#x901A;&#x8FC7;&#x4F7F;&#x7528; RTTI&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0; <code>a</code> &#x662F;&#x7528; <code>B</code> &#x5B9E;&#x73B0;&#x7684;&#x3002;&#x901A;&#x8FC7;&#x5C06;&#x5176;&#x8F6C;&#x578B;&#x4E3A; <code>B</code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x4E0D;&#x5728; <code>A</code> &#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x5B8C;&#x5168;&#x662F;&#x5408;&#x60C5;&#x5408;&#x7406;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x4E5F;&#x8BB8;&#x5E76;&#x4E0D;&#x60F3;&#x8BA9;&#x5BA2;&#x6237;&#x7AEF;&#x5F00;&#x53D1;&#x8005;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x7ED9;&#x4E86;&#x4ED6;&#x4EEC;&#x4E00;&#x4E2A;&#x673A;&#x4F1A;&#xFF0C;&#x4F7F;&#x5F97;&#x4ED6;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x4E0E;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x8026;&#x5408;&#x5EA6;&#x8D85;&#x8FC7;&#x4E86;&#x4F60;&#x7684;&#x9884;&#x671F;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x8BA4;&#x4E3A; <code>interface</code> &#x5173;&#x952E;&#x5B57;&#x6B63;&#x5728;&#x4FDD;&#x62A4;&#x4F60;&#xFF0C;&#x4F46;&#x5176;&#x5B9E;&#x5E76;&#x6CA1;&#x6709;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x4F7F;&#x7528; <code>B</code> &#x6765;&#x5B9E;&#x73B0; <code>A</code> &#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x6709;&#x516C;&#x5F00;&#x6848;&#x4F8B;&#x53EF;&#x67E5;&#x7684;<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>&#x3002;</p>
<p>&#x4E00;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x76F4;&#x63A5;&#x58F0;&#x660E;&#xFF0C;&#x5982;&#x679C;&#x5F00;&#x53D1;&#x8005;&#x51B3;&#x5B9A;&#x4F7F;&#x7528;&#x5B9E;&#x9645;&#x7684;&#x7C7B;&#x800C;&#x4E0D;&#x662F;&#x63A5;&#x53E3;&#xFF0C;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x5BF9;&#x81EA;&#x5DF1;&#x8D1F;&#x8D23;&#x3002;&#x8FD9;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x662F;&#x53EF;&#x884C;&#x7684;&#xFF0C;&#x4F46;&#x201C;&#x53EF;&#x80FD;&#x201D;&#x8FD8;&#x4E0D;&#x591F;&#xFF0C;&#x4F60;&#x6216;&#x8BB8;&#x5E0C;&#x671B;&#x80FD;&#x6709;&#x4E00;&#x4E9B;&#x66F4;&#x4E25;&#x683C;&#x7684;&#x63A7;&#x5236;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x8BA9;&#x5B9E;&#x73B0;&#x7C7B;&#x53EA;&#x5177;&#x6709;&#x5305;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x5305;&#x5916;&#x90E8;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5C31;&#x770B;&#x4E0D;&#x5230;&#x5B83;&#x4E86;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/packageaccess/HiddenC.java</span>
<span class="token keyword">package</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>packageaccess</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token keyword">implements</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;package C.u()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;protected C.v()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;private C.w()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HiddenC</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">A</span> <span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5728;&#x8FD9;&#x4E2A;&#x5305;&#x4E2D;&#x552F;&#x4E00; <code>public</code> &#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F; <code>HiddenC</code>&#xFF0C;&#x5728;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x5C06;&#x4EA7;&#x751F; <code>A</code>&#x63A5;&#x53E3;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x91CC;&#x6709;&#x8DA3;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF1A;&#x5373;&#x4F7F;&#x4F60;&#x4ECE; <code>makeA()</code> &#x8FD4;&#x56DE;&#x7684;&#x662F; <code>C</code> &#x7C7B;&#x578B;&#xFF0C;&#x4F60;&#x5728;&#x5305;&#x7684;&#x5916;&#x90E8;&#x4ECD;&#x65E7;&#x4E0D;&#x80FD;&#x4F7F;&#x7528; <code>A</code> &#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4E0D;&#x80FD;&#x5728;&#x5305;&#x7684;&#x5916;&#x90E8;&#x547D;&#x540D; <code>C</code>&#x3002;</p>
<p>&#x73B0;&#x5728;&#x5982;&#x679C;&#x4F60;&#x8BD5;&#x7740;&#x5C06;&#x5176;&#x5411;&#x4E0B;&#x8F6C;&#x578B;&#x4E3A; <code>C</code>&#xFF0C;&#x5219;&#x5C06;&#x88AB;&#x7981;&#x6B62;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5305;&#x7684;&#x5916;&#x90E8;&#x6CA1;&#x6709;&#x4EFB;&#x4F55; <code>C</code> &#x7C7B;&#x578B;&#x53EF;&#x7528;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/HiddenImplementation.java</span>
<span class="token comment">// Sneaking around package hiding</span>

<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>packageaccess</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HiddenImplementation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token class-name">HiddenC</span><span class="token punctuation">.</span><span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Compile error: cannot find symbol &apos;C&apos;:</span>
        <span class="token comment">/* if(a instanceof C) {
            C c = (C)a;
            c.g();
        } */</span>
        <span class="token comment">// Oops! Reflection still allows us to call g():</span>
        <span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// And even less accessible methods!</span>
        <span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">callHiddenMethod</span><span class="token punctuation">(</span><span class="token class-name">Object</span> a<span class="token punctuation">,</span> <span class="token class-name">String</span> methodName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Method</span> g <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        g<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        g<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>public C.f()
typeinfo.packageaccess.C
public C.g()
package C.u()
protected C.v()
private C.w()
</code></pre><p>&#x6B63;&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#xFF0C;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#xFF0C;&#x751A;&#x81F3;&#x662F; <code>private</code> &#x65B9;&#x6CD5;&#xFF01;&#x5982;&#x679C;&#x77E5;&#x9053;&#x65B9;&#x6CD5;&#x540D;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x5176; <code>Method</code> &#x5BF9;&#x8C61;&#x4E0A;&#x8C03;&#x7528; <code>setAccessible(true)</code>&#xFF0C;&#x5C31;&#x50CF;&#x5728; <code>callHiddenMethod()</code> &#x4E2D;&#x770B;&#x5230;&#x7684;&#x90A3;&#x6837;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x80FD;&#x89C9;&#x5F97;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53EA;&#x53D1;&#x5E03;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x6765;&#x963B;&#x6B62;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4F46;&#x5176;&#x5B9E;&#x8FD9;&#x5E76;&#x4E0D;&#x80FD;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;&#x56E0;&#x4E3A;&#x53EA;&#x9700;&#x8981;&#x8FD0;&#x884C; <code>javap</code>&#xFF08;&#x4E00;&#x4E2A;&#x968F; JDK &#x53D1;&#x5E03;&#x7684;&#x53CD;&#x7F16;&#x8BD1;&#x5668;&#xFF09;&#x5373;&#x53EF;&#x7A81;&#x7834;&#x8FD9;&#x4E00;&#x9650;&#x5236;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x4F7F;&#x7528; <code>javap</code> &#x7684;&#x547D;&#x4EE4;&#x884C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell">javap -private C
</pre><p><code>-private</code> &#x6807;&#x5FD7;&#x8868;&#x793A;&#x6240;&#x6709;&#x7684;&#x6210;&#x5458;&#x90FD;&#x5E94;&#x8BE5;&#x663E;&#x793A;&#xFF0C;&#x751A;&#x81F3;&#x5305;&#x62EC;&#x79C1;&#x6709;&#x6210;&#x5458;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>class typeinfo.packageaccess.C extends
java.lang.Object implements typeinfo.interfacea.A {
  typeinfo.packageaccess.C();
  public void f();
  public void g();
  void u();
  protected void v();
  private void w();
}
</code></pre><p>&#x56E0;&#x6B64;&#xFF0C;&#x4EFB;&#x4F55;&#x4EBA;&#x90FD;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x4F60;&#x6700;&#x79C1;&#x6709;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x540D;&#x5B57;&#x548C;&#x7B7E;&#x540D;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x3002;</p>
<p>&#x90A3;&#x5982;&#x679C;&#x628A;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5185;&#x90E8;&#x7C7B;&#xFF0C;&#x53C8;&#x4F1A;&#x600E;&#x4E48;&#x6837;&#x5462;&#xFF1F;&#x4E0B;&#x9762;&#x5C55;&#x793A;&#x4E86;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/InnerImplementation.java</span>
<span class="token comment">// Private inner classes can&apos;t hide from reflection</span>

<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">InnerA</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token keyword">implements</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">void</span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;package C.u()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;protected C.v()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;private C.w()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">A</span> <span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InnerImplementation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token class-name">InnerA</span><span class="token punctuation">.</span><span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Reflection still gets into the private class:</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>public C.f()
InnerA$C
public C.g()
package C.u()
protected C.v()
private C.w()
</code></pre><p>&#x8FD9;&#x91CC;&#x5BF9;&#x53CD;&#x5C04;&#x4ECD;&#x7136;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x53EF;&#x4EE5;&#x9690;&#x85CF;&#x3002;&#x90A3;&#x4E48;&#x5982;&#x679C;&#x662F;&#x533F;&#x540D;&#x7C7B;&#x5462;&#xFF1F;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/AnonymousImplementation.java</span>
<span class="token comment">// Anonymous inner classes can&apos;t hide from reflection</span>

<span class="token keyword">import</span> <span class="token namespace">typeinfo<span class="token punctuation">.</span>interfacea</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AnonymousA</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">A</span> <span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.f()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;public C.g()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">void</span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;package C.u()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;protected C.v()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;private C.w()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnonymousImplementation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token class-name">AnonymousA</span><span class="token punctuation">.</span><span class="token function">makeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Reflection still gets into the anonymous class:</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HiddenImplementation</span><span class="token punctuation">.</span><span class="token function">callHiddenMethod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>public C.f()
AnonymousA$1
public C.g()
package C.u()
protected C.v()
private C.w()
</code></pre><p>&#x770B;&#x8D77;&#x6765;&#x4EFB;&#x4F55;&#x65B9;&#x5F0F;&#x90FD;&#x6CA1;&#x6CD5;&#x963B;&#x6B62;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x90A3;&#x4E9B;&#x975E;&#x516C;&#x5171;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5BF9;&#x4E8E;&#x5B57;&#x6BB5;&#x6765;&#x8BF4;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x5373;&#x4FBF;&#x662F; <code>private</code> &#x5B57;&#x6BB5;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// typeinfo/ModifyingPrivateFields.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">WithPrivateFinalField</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;I&apos;m totally safe&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;Am I safe?&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;i = &quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> s2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ModifyingPrivateFields</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">WithPrivateFinalField</span> pf <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">WithPrivateFinalField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Field</span> f <span class="token operator">=</span> pf<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token string">&quot;f.getInt(pf): &quot;</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span>pf<span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        f <span class="token operator">=</span> pf<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;f.get(pf): &quot;</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>pf<span class="token punctuation">,</span> <span class="token string">&quot;No, you&apos;re not!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        f <span class="token operator">=</span> pf<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;s2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;f.get(pf): &quot;</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>pf<span class="token punctuation">,</span> <span class="token string">&quot;No, you&apos;re not!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>i = 1, I&apos;m totally safe, Am I safe?
f.getInt(pf): 1
i = 47, I&apos;m totally safe, Am I safe?
f.get(pf): I&apos;m totally safe
i = 47, I&apos;m totally safe, Am I safe?
f.get(pf): Am I safe?
i = 47, I&apos;m totally safe, No, you&apos;re not!
</code></pre><p>&#x4F46;&#x5B9E;&#x9645;&#x4E0A; <code>final</code> &#x5B57;&#x6BB5;&#x5728;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x8FD0;&#x884C;&#x65F6;&#x7CFB;&#x7EDF;&#x4F1A;&#x5728;&#x4E0D;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x7684;&#x5C1D;&#x8BD5;&#xFF0C;&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x8FDD;&#x53CD;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x7684;&#x64CD;&#x4F5C;&#x5E76;&#x4E0D;&#x662F;&#x4EC0;&#x4E48;&#x5341;&#x6076;&#x4E0D;&#x8D66;&#x7684;&#x3002;&#x5982;&#x679C;&#x6709;&#x4EBA;&#x4F7F;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x6280;&#x672F;&#x53BB;&#x8C03;&#x7528;&#x6807;&#x5FD7;&#x4E3A; <code>private</code> &#x6216;&#x5305;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x7684;&#x65B9;&#x6CD5;&#xFF08;&#x5F88;&#x660E;&#x663E;&#x8FD9;&#x4E9B;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x8868;&#x793A;&#x8FD9;&#x4E9B;&#x4EBA;&#x4E0D;&#x5E94;&#x8BE5;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4ED6;&#x4EEC;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4FEE;&#x6539;&#x4E86;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x67D0;&#x4E9B;&#x5730;&#x65B9;&#xFF0C;&#x4ED6;&#x4EEC;&#x4E0D;&#x5E94;&#x8BE5;&#x62B1;&#x6028;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x603B;&#x662F;&#x5728;&#x7C7B;&#x4E2D;&#x7559;&#x4E0B;&#x540E;&#x95E8;&#xFF0C;&#x4E5F;&#x8BB8;&#x4F1A;&#x5E2E;&#x52A9;&#x4F60;&#x89E3;&#x51B3;&#x67D0;&#x4E9B;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#xFF08;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x5F80;&#x5F80;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x522B;&#x65E0;&#x5B83;&#x6CD5;&#xFF09;&#x3002;&#x603B;&#x4E4B;&#xFF0C;&#x4E0D;&#x53EF;&#x5426;&#x8BA4;&#xFF0C;&#x53CD;&#x5C04;&#x7ED9;&#x6211;&#x4EEC;&#x5E26;&#x6765;&#x4E86;&#x5F88;&#x591A;&#x597D;&#x5904;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x5458;&#x5F80;&#x5F80;&#x5BF9;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x7684;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x8FC7;&#x4E8E;&#x81EA;&#x4FE1;&#xFF0C;&#x751A;&#x81F3;&#x8BA4;&#x4E3A; Java &#x5728;&#x5B89;&#x5168;&#x6027;&#x4E0A;&#x6BD4;&#x5176;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#xFF08;&#x660E;&#x663E;&#xFF09;&#x66F4;&#x5BBD;&#x677E;&#x7684;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x7684;&#x8BED;&#x8A00;&#x8981;&#x4F18;&#x8D8A;<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6B63;&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x4E8B;&#x5B9E;&#x5E76;&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#x3002;</p>
<h2 class="mume-header" id="%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</h2>

<p>RTTI &#x5141;&#x8BB8;&#x901A;&#x8FC7;&#x533F;&#x540D;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#x3002;&#x521D;&#x5B66;&#x8005;&#x6781;&#x6613;&#x8BEF;&#x7528;&#x5B83;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5B66;&#x4F1A;&#x4F7F;&#x7528;&#x591A;&#x6001;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#xFF0C;&#x8FD9;&#x4E48;&#x505A;&#x4E5F;&#x5F88;&#x6709;&#x6548;&#x3002;&#x6709;&#x8FC7;&#x7A0B;&#x5316;&#x7F16;&#x7A0B;&#x80CC;&#x666F;&#x7684;&#x4EBA;&#x5F88;&#x5BB9;&#x6613;&#x628A;&#x7A0B;&#x5E8F;&#x7EC4;&#x7EC7;&#x6210;&#x4E00;&#x7CFB;&#x5217; <code>switch</code> &#x8BED;&#x53E5;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528; RTTI &#x548C; <code>switch</code> &#x5B9E;&#x73B0;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x8FD9;&#x6837;&#x5C31;&#x635F;&#x5931;&#x4E86;&#x591A;&#x6001;&#x673A;&#x5236;&#x5728;&#x4EE3;&#x7801;&#x5F00;&#x53D1;&#x548C;&#x7EF4;&#x62A4;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x91CD;&#x8981;&#x4EF7;&#x503C;&#x3002;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x662F;&#x60F3;&#x8BA9;&#x6211;&#x4EEC;&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x4F7F;&#x7528;&#x591A;&#x6001;&#x673A;&#x5236;&#xFF0C;&#x53EA;&#x5728;&#x975E;&#x7528;&#x4E0D;&#x53EF;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F7F;&#x7528; RTTI&#x3002;</p>
<p>&#x7136;&#x800C;&#x4F7F;&#x7528;&#x591A;&#x6001;&#x673A;&#x5236;&#x7684;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x8981;&#x6C42;&#x6211;&#x4EEC;&#x62E5;&#x6709;&#x57FA;&#x7C7B;&#x5B9A;&#x4E49;&#x7684;&#x63A7;&#x5236;&#x6743;&#x3002;&#x56E0;&#x4E3A;&#x5728;&#x4F60;&#x6269;&#x5C55;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x57FA;&#x7C7B;&#x5E76;&#x672A;&#x5305;&#x542B;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5982;&#x679C;&#x57FA;&#x7C7B;&#x6765;&#x81EA;&#x522B;&#x4EBA;&#x7684;&#x5E93;&#xFF0C;&#x8FD9;&#x65F6; RTTI &#x4FBF;&#x662F;&#x4E00;&#x79CD;&#x89E3;&#x51B3;&#x4E4B;&#x9053;&#xFF1A;&#x53EF;&#x7EE7;&#x627F;&#x4E00;&#x4E2A;&#x65B0;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x6DFB;&#x52A0;&#x4F60;&#x9700;&#x8981;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5728;&#x4EE3;&#x7801;&#x7684;&#x5176;&#x5B83;&#x5730;&#x65B9;&#xFF0C;&#x53EF;&#x4EE5;&#x68C0;&#x67E5;&#x4F60;&#x81EA;&#x5DF1;&#x7279;&#x5B9A;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x4F1A;&#x7834;&#x574F;&#x591A;&#x6001;&#x6027;&#x4EE5;&#x53CA;&#x7A0B;&#x5E8F;&#x7684;&#x6269;&#x5C55;&#x80FD;&#x529B;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7C7B;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684; <code>switch</code> &#x8BED;&#x53E5;&#x3002;&#x4F46;&#x5982;&#x679C;&#x60F3;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x589E;&#x52A0;&#x5177;&#x6709;&#x65B0;&#x7279;&#x6027;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x5C31;&#x5FC5;&#x987B;&#x4F7F;&#x7528; RTTI &#x6765;&#x68C0;&#x67E5;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x5982;&#x679C;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7C7B;&#xFF0C;&#x5C31;&#x5C06;&#x67D0;&#x4E2A;&#x7279;&#x6027;&#x653E;&#x8FDB;&#x57FA;&#x7C7B;&#x91CC;&#x8FB9;&#xFF0C;&#x8FD9;&#x5C06;&#x4F7F;&#x5F97;&#x4ECE;&#x90A3;&#x4E2A;&#x57FA;&#x7C7B;&#x6D3E;&#x751F;&#x51FA;&#x7684;&#x6240;&#x6709;&#x5176;&#x5B83;&#x5B50;&#x7C7B;&#x90FD;&#x5E26;&#x6709;&#x8FD9;&#x4E9B;&#x53EF;&#x80FD;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x7684;&#x4E1C;&#x897F;&#x3002;&#x8FD9;&#x4F1A;&#x5BFC;&#x81F4;&#x63A5;&#x53E3;&#x66F4;&#x52A0;&#x4E0D;&#x6E05;&#x6670;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x8986;&#x76D6;&#x4ECE;&#x57FA;&#x7C7B;&#x7EE7;&#x627F;&#x800C;&#x6765;&#x7684;&#x6240;&#x6709;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x4E8B;&#x60C5;&#x5C31;&#x53D8;&#x5F97;&#x5F88;&#x9EBB;&#x70E6;&#x3002;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x4E50;&#x5668; <code>Instrument</code> &#x7684;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x3002;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x60F3;&#x6E05;&#x7406;&#x7BA1;&#x5F26;&#x4E50;&#x961F;&#x4E2D;&#x67D0;&#x4E9B;&#x4E50;&#x5668;&#x6B8B;&#x7559;&#x7684;&#x53E3;&#x6C34;&#xFF0C;&#x4E00;&#x79CD;&#x529E;&#x6CD5;&#x662F;&#x5728;&#x57FA;&#x7C7B; <code>Instrument</code> &#x4E2D;&#x653E;&#x5165; <code>clearSpitValve()</code> &#x65B9;&#x6CD5;&#x3002;&#x4F46;&#x8FD9;&#x6837;&#x505A;&#x4F1A;&#x5BFC;&#x81F4;&#x7C7B;&#x7ED3;&#x6784;&#x6DF7;&#x4E71;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6253;&#x51FB;&#x4E50;&#x5668; <code>Percussion</code>&#x3001;&#x5F26;&#x4E50;&#x5668; <code>Stringed</code> &#x548C;&#x7535;&#x5B50;&#x4E50;&#x5668; <code>Electronic</code> &#x4E5F;&#x9700;&#x8981;&#x6E05;&#x7406;&#x53E3;&#x6C34;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;RTTI &#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x66F4;&#x5408;&#x7406;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;&#x53EF;&#x4EE5;&#x5C06; <code>clearSpitValve()</code> &#x653E;&#x5728;&#x67D0;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x7C7B;&#x4E2D;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x662F;&#x7BA1;&#x4E50;&#x5668; <code>Wind</code>&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x8FD8;&#x6709;&#x66F4;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x662F;&#x5C06; <code>prepareInstrument()</code> &#x653E;&#x5728;&#x57FA;&#x7C7B;&#x4E2D;&#xFF0C;&#x4F46;&#x662F;&#x521D;&#x6B21;&#x9762;&#x5BF9;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x8BFB;&#x8005;&#x53EF;&#x80FD;&#x60F3;&#x4E0D;&#x5230;&#x8FD8;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x800C;&#x8BEF;&#x8BA4;&#x4E3A;&#x5FC5;&#x987B;&#x4F7F;&#x7528; RTTI&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x70B9;&#xFF0C;RTTI &#x6709;&#x65F6;&#x5019;&#x4E5F;&#x80FD;&#x89E3;&#x51B3;&#x6548;&#x7387;&#x95EE;&#x9898;&#x3002;&#x5047;&#x8BBE;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x8FD0;&#x7528;&#x4E86;&#x591A;&#x6001;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x591A;&#x6001;&#xFF0C;&#x5BFC;&#x81F4;&#x5176;&#x4E2D;&#x67D0;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6548;&#x7387;&#x975E;&#x5E38;&#x4F4E;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x6311;&#x51FA;&#x90A3;&#x4E2A;&#x7C7B;&#xFF0C;&#x4F7F;&#x7528; RTTI &#x4E3A;&#x5B83;&#x7F16;&#x5199;&#x4E00;&#x6BB5;&#x7279;&#x522B;&#x7684;&#x4EE3;&#x7801;&#x4EE5;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#x3002;&#x7136;&#x800C;&#x5FC5;&#x987B;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x4E0D;&#x8981;&#x592A;&#x65E9;&#x5730;&#x5173;&#x6CE8;&#x7A0B;&#x5E8F;&#x7684;&#x6548;&#x7387;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x662F;&#x4E2A;&#x8BF1;&#x4EBA;&#x7684;&#x9677;&#x9631;&#x3002;&#x6700;&#x597D;&#x5148;&#x8BA9;&#x7A0B;&#x5E8F;&#x80FD;&#x8DD1;&#x8D77;&#x6765;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x53BB;&#x770B;&#x770B;&#x7A0B;&#x5E8F;&#x80FD;&#x4E0D;&#x80FD;&#x8DD1;&#x5F97;&#x66F4;&#x5FEB;&#xFF0C;&#x4E0B;&#x4E00;&#x6B65;&#x624D;&#x662F;&#x53BB;&#x89E3;&#x51B3;&#x6548;&#x7387;&#x95EE;&#x9898;&#xFF08;&#x6BD4;&#x5982;&#x4F7F;&#x7528; Profiler&#xFF09;<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#xFF0C;&#x53CD;&#x5C04;&#xFF0C;&#x56E0;&#x5176;&#x66F4;&#x52A0;&#x52A8;&#x6001;&#x7684;&#x7F16;&#x7A0B;&#x98CE;&#x683C;&#xFF0C;&#x4E3A;&#x6211;&#x4EEC;&#x5F00;&#x521B;&#x4E86;&#x7F16;&#x7A0B;&#x7684;&#x65B0;&#x4E16;&#x754C;&#x3002;&#x4F46;&#x5BF9;&#x6709;&#x4E9B;&#x4EBA;&#x6765;&#x8BF4;&#xFF0C;&#x53CD;&#x5C04;&#x7684;&#x52A8;&#x6001;&#x7279;&#x6027;&#x5374;&#x662F;&#x4E00;&#x79CD;&#x56F0;&#x6270;&#x3002;&#x5BF9;&#x90A3;&#x4E9B;&#x5DF2;&#x7ECF;&#x4E60;&#x60EF;&#x4E8E;&#x9759;&#x6001;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#x7684;&#x5B89;&#x5168;&#x6027;&#x7684;&#x4EBA;&#x6765;&#x8BF4;&#xFF0C;Java &#x4E2D;&#x5141;&#x8BB8;&#x8FD9;&#x79CD;&#x52A8;&#x6001;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#xFF08;&#x53EA;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x624D;&#x80FD;&#x68C0;&#x67E5;&#x5230;&#xFF0C;&#x5E76;&#x4EE5;&#x5F02;&#x5E38;&#x7684;&#x5F62;&#x5F0F;&#x4E0A;&#x62A5;&#x68C0;&#x67E5;&#x7ED3;&#x679C;&#xFF09;&#x7684;&#x64CD;&#x4F5C;&#x4F3C;&#x4E4E;&#x662F;&#x4E00;&#x79CD;&#x9519;&#x8BEF;&#x7684;&#x65B9;&#x5411;&#x3002;&#x6709;&#x4E9B;&#x4EBA;&#x60F3;&#x5F97;&#x66F4;&#x8FDC;&#xFF0C;&#x4ED6;&#x4EEC;&#x8BA4;&#x4E3A;&#x5F15;&#x5165;&#x8FD0;&#x884C;&#x65F6;&#x5F02;&#x5E38;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E00;&#x79CD;&#x6307;&#x793A;&#xFF0C;&#x6307;&#x793A;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x4EE3;&#x7801;&#x3002;&#x6211;&#x53D1;&#x73B0;&#x8FD9;&#x79CD;&#x610F;&#x4E49;&#x7684;&#x5B89;&#x5168;&#x662F;&#x4E00;&#x79CD;&#x9519;&#x89C9;&#xFF0C;&#x56E0;&#x4E3A;&#x603B;&#x662F;&#x6709;&#x4E9B;&#x4E8B;&#x60C5;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x624D;&#x53D1;&#x751F;&#x5E76;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x7684;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x5728;&#x90A3;&#x4E9B;&#x4E0D;&#x5305;&#x542B;&#x4EFB;&#x4F55; <code>try</code> &#x8BED;&#x53E5;&#x5757;&#x6216;&#x5F02;&#x5E38;&#x58F0;&#x660E;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x4E5F;&#x662F;&#x5982;&#x6B64;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x8BA4;&#x4E3A;&#x4E00;&#x81F4;&#x6027;&#x9519;&#x8BEF;&#x62A5;&#x544A;&#x6A21;&#x578B;&#x7684;&#x5B58;&#x5728;&#x4F7F;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x7F16;&#x5199;&#x52A8;&#x6001;&#x4EE3;&#x7801;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x5C3D;&#x529B;&#x7F16;&#x5199;&#x80FD;&#x591F;&#x8FDB;&#x884C;&#x9759;&#x6001;&#x68C0;&#x67E5;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x6709;&#x4EF7;&#x503C;&#x7684;&#xFF0C;&#x53EA;&#x8981;&#x4F60;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x80FD;&#x529B;&#x3002;&#x4F46;&#x662F;&#x6211;&#x76F8;&#x4FE1;&#x52A8;&#x6001;&#x4EE3;&#x7801;&#x662F;&#x5C06; Java &#x4E0E;&#x5176;&#x5B83;&#x8BF8;&#x5982; C++ &#x8FD9;&#x6837;&#x7684;&#x8BED;&#x8A00;&#x533A;&#x5206;&#x5F00;&#x7684;&#x91CD;&#x8981;&#x5DE5;&#x5177;&#x4E4B;&#x4E00;&#x3002;</p>
<div style="page-break-after: always;"></div>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>&#x7279;&#x522B;&#x662F;&#x5728;&#x8FC7;&#x53BB;&#x3002;&#x4F46;&#x73B0;&#x5728; Java &#x7684; HTML &#x6587;&#x6863;&#x6709;&#x4E86;&#x5F88;&#x5927;&#x7684;&#x63D0;&#x5347;&#xFF0C;&#x8981;&#x67E5;&#x770B;&#x57FA;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x53D8;&#x5F97;&#x5F88;&#x5BB9;&#x6613;&#x4E86;&#x3002; <a href="#fnref1" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn2" class="footnote-item"><p>&#x8FD9;&#x662F;&#x6781;&#x9650;&#x7F16;&#x7A0B;&#xFF08;XP&#xFF0C;Extreme Programming&#xFF09;&#x7684;&#x539F;&#x5219;&#x4E4B;&#x4E00;&#xFF1A;&#x201C;Try the simplest thing that could possibly work&#xFF0C;&#x5B9E;&#x73B0;&#x5C3D;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x7684;&#x7B80;&#x5355;&#x3002;&#x201D; <a href="#fnref2" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn3" class="footnote-item"><p>&#x6700;&#x8457;&#x540D;&#x7684;&#x4F8B;&#x5B50;&#x662F; Windows &#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;Windows &#x4E3A;&#x5F00;&#x53D1;&#x8005;&#x63D0;&#x4F9B;&#x4E86;&#x516C;&#x5F00;&#x7684; API&#xFF0C;&#x4F46;&#x662F;&#x5F00;&#x53D1;&#x8005;&#x8FD8;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x4E00;&#x4E9B;&#x975E;&#x516C;&#x5F00;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x3002;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#xFF0C;&#x5F88;&#x591A;&#x7A0B;&#x5E8F;&#x5458;&#x4F7F;&#x7528;&#x4E86;&#x9690;&#x85CF;&#x7684; API &#x51FD;&#x6570;&#x3002;&#x8FD9;&#x5C31;&#x8FEB;&#x4F7F;&#x5FAE;&#x8F6F;&#x516C;&#x53F8;&#x8981;&#x50CF;&#x7EF4;&#x62A4;&#x516C;&#x5F00; API &#x4E00;&#x6837;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x9690;&#x85CF;&#x7684; API&#xFF0C;&#x6D88;&#x8017;&#x4E86;&#x5DE8;&#x5927;&#x7684;&#x6210;&#x672C;&#x548C;&#x7CBE;&#x529B;&#x3002; <a href="#fnref3" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn4" class="footnote-item"><p>&#x6BD4;&#x5982;&#xFF0C;Python &#x4E2D;&#x5728;&#x5143;&#x7D20;&#x524D;&#x9762;&#x6DFB;&#x52A0;&#x53CC;&#x4E0B;&#x5212;&#x7EBF; <code>__</code>&#xFF0C;&#x5C31;&#x8868;&#x793A;&#x4F60;&#x60F3;&#x9690;&#x85CF;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5728;&#x7C7B;&#x6216;&#x8005;&#x5305;&#x5916;&#x9762;&#x8C03;&#x7528;&#x4E86;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#x5C31;&#x4F1A;&#x62A5;&#x9519;&#x3002; <a href="#fnref4" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn5" class="footnote-item"><p>&#x8BD1;&#x8005;&#x6CE8;&#xFF1A;Java Profiler &#x662F;&#x4E00;&#x79CD; Java &#x6027;&#x80FD;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x4E8E;&#x5728; JVM &#x7EA7;&#x522B;&#x76D1;&#x89C6; Java &#x5B57;&#x8282;&#x7801;&#x7684;&#x6784;&#x9020;&#x548C;&#x6267;&#x884C;&#x3002;&#x4E3B;&#x6D41;&#x7684; Profiler &#x6709; JProfiler&#x3001;YourKit &#x548C; Java VisualVM &#x7B49;&#x3002; <a href="#fnref5" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
</ol>
</section>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF">&#x7B2C;&#x5341;&#x4E5D;&#x7AE0; &#x7C7B;&#x578B;&#x4FE1;&#x606F;</a>
<ul>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-rtti">&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981; RTTI</a></li>
<li><a href="#class-%E5%AF%B9%E8%B1%A1"><code>Class</code> &#x5BF9;&#x8C61;</a>
<ul>
<li><a href="#%E7%B1%BB%E5%AD%97%E9%9D%A2%E5%B8%B8%E9%87%8F">&#x7C7B;&#x5B57;&#x9762;&#x5E38;&#x91CF;</a></li>
<li><a href="#%E6%B3%9B%E5%8C%96%E7%9A%84-class-%E5%BC%95%E7%94%A8">&#x6CDB;&#x5316;&#x7684; <code>Class</code> &#x5F15;&#x7528;</a></li>
<li><a href="#cast-%E6%96%B9%E6%B3%95"><code>cast()</code> &#x65B9;&#x6CD5;</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%A3%80%E6%B5%8B">&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x68C0;&#x6D4B;</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%AD%97%E9%9D%A2%E9%87%8F">&#x4F7F;&#x7528;&#x7C7B;&#x5B57;&#x9762;&#x91CF;</a></li>
<li><a href="#%E4%B8%80%E4%B8%AA%E5%8A%A8%E6%80%81-instanceof-%E5%87%BD%E6%95%B0">&#x4E00;&#x4E2A;&#x52A8;&#x6001; <code>instanceof</code> &#x51FD;&#x6570;</a></li>
<li><a href="#%E9%80%92%E5%BD%92%E8%AE%A1%E6%95%B0">&#x9012;&#x5F52;&#x8BA1;&#x6570;</a></li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E5%86%8C%E5%B7%A5%E5%8E%82">&#x6CE8;&#x518C;&#x5DE5;&#x5382;</a></li>
<li><a href="#%E7%B1%BB%E7%9A%84%E7%AD%89%E4%BB%B7%E6%AF%94%E8%BE%83">&#x7C7B;&#x7684;&#x7B49;&#x4EF7;&#x6BD4;&#x8F83;</a></li>
<li><a href="#%E5%8F%8D%E5%B0%84%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E4%BF%A1%E6%81%AF">&#x53CD;&#x5C04;&#xFF1A;&#x8FD0;&#x884C;&#x65F6;&#x7C7B;&#x4FE1;&#x606F;</a>
<ul>
<li><a href="#%E7%B1%BB%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96%E5%99%A8">&#x7C7B;&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x5668;</a></li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86">&#x52A8;&#x6001;&#x4EE3;&#x7406;</a></li>
<li><a href="#optional%E7%B1%BB">Optional&#x7C7B;</a>
<ul>
<li><a href="#%E6%A0%87%E8%AE%B0%E6%8E%A5%E5%8F%A3">&#x6807;&#x8BB0;&#x63A5;&#x53E3;</a></li>
<li><a href="#mock-%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%A1%A9">Mock &#x5BF9;&#x8C61;&#x548C;&#x6869;</a></li>
</ul>
</li>
<li><a href="#%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%B1%BB%E5%9E%8B">&#x63A5;&#x53E3;&#x548C;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>