<!DOCTYPE html><html><head>
      <title>24-Concurrent-Programming</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\18215\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.12\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <ul>
<li><a href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B">&#x7B2C;&#x4E8C;&#x5341;&#x56DB;&#x7AE0; &#x5E76;&#x53D1;&#x7F16;&#x7A0B;</a>
<ul>
<li><a href="#%E6%9C%AF%E8%AF%AD%E9%97%AE%E9%A2%98">&#x672F;&#x8BED;&#x95EE;&#x9898;</a>
<ul>
<li><a href="#%E5%B9%B6%E5%8F%91%E7%9A%84%E6%96%B0%E5%AE%9A%E4%B9%89">&#x5E76;&#x53D1;&#x7684;&#x65B0;&#x5B9A;&#x4E49;</a></li>
</ul>
</li>
<li><a href="#%E5%B9%B6%E5%8F%91%E7%9A%84%E8%B6%85%E8%83%BD%E5%8A%9B">&#x5E76;&#x53D1;&#x7684;&#x8D85;&#x80FD;&#x529B;</a></li>
<li><a href="#%E5%B9%B6%E5%8F%91%E4%B8%BA%E9%80%9F%E5%BA%A6%E8%80%8C%E7%94%9F">&#x5E76;&#x53D1;&#x4E3A;&#x901F;&#x5EA6;&#x800C;&#x751F;</a></li>
<li><a href="#%E5%9B%9B%E5%8F%A5%E6%A0%BC%E8%A8%80">&#x56DB;&#x53E5;&#x683C;&#x8A00;</a>
<ul>
<li><a href="#1%E4%B8%8D%E8%A6%81%E8%BF%99%E6%A0%B7%E5%81%9A">1.&#x4E0D;&#x8981;&#x8FD9;&#x6837;&#x505A;</a></li>
<li><a href="#2%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%9C%9F%E7%9A%84%E4%B8%80%E5%88%87%E5%8F%AF%E8%83%BD%E9%83%BD%E6%9C%89%E9%97%AE%E9%A2%98">2.&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x662F;&#x771F;&#x7684;&#xFF0C;&#x4E00;&#x5207;&#x53EF;&#x80FD;&#x90FD;&#x6709;&#x95EE;&#x9898;</a></li>
<li><a href="#3%E5%AE%83%E8%B5%B7%E4%BD%9C%E7%94%A8%E5%B9%B6%E4%B8%8D%E6%84%8F%E5%91%B3%E7%9D%80%E5%AE%83%E6%B2%A1%E6%9C%89%E9%97%AE%E9%A2%98">3.&#x5B83;&#x8D77;&#x4F5C;&#x7528;,&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x6CA1;&#x6709;&#x95EE;&#x9898;</a></li>
<li><a href="#4%E4%BD%A0%E5%BF%85%E9%A1%BB%E4%BB%8D%E7%84%B6%E7%90%86%E8%A7%A3">4.&#x4F60;&#x5FC5;&#x987B;&#x4ECD;&#x7136;&#x7406;&#x89E3;</a></li>
</ul>
</li>
<li><a href="#span-id-the-brutal-truth%E6%AE%8B%E9%85%B7%E7%9A%84%E7%9C%9F%E7%9B%B8span">&#x6B8B;&#x9177;&#x7684;&#x771F;&#x76F8;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%85%B6%E4%BD%99%E9%83%A8%E5%88%86">&#x672C;&#x7AE0;&#x5176;&#x4F59;&#x90E8;&#x5206;</a></li>
<li><a href="#%E5%B9%B6%E8%A1%8C%E6%B5%81">&#x5E76;&#x884C;&#x6D41;</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E4%BB%BB%E5%8A%A1">&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;</a></li>
<li><a href="#%E7%BB%88%E6%AD%A2%E8%80%97%E6%97%B6%E4%BB%BB%E5%8A%A1">&#x7EC8;&#x6B62;&#x8017;&#x65F6;&#x4EFB;&#x52A1;</a></li>
<li><a href="#completablefuture%E7%B1%BB">CompletableFuture&#x7C7B;</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">&#x57FA;&#x672C;&#x7528;&#x6CD5;</a></li>
<li><a href="#%E7%BB%93%E5%90%88-completablefuture">&#x7ED3;&#x5408; CompletableFuture</a></li>
<li><a href="#%E6%A8%A1%E6%8B%9F">&#x6A21;&#x62DF;</a></li>
<li><a href="#%E5%BC%82%E5%B8%B8">&#x5F02;&#x5E38;</a></li>
<li><a href="#%E6%B5%81%E5%BC%82%E5%B8%B8stream-exception">&#x6D41;&#x5F02;&#x5E38;&#xFF08;Stream Exception&#xFF09;</a></li>
<li><a href="#%E6%A3%80%E6%9F%A5%E6%80%A7%E5%BC%82%E5%B8%B8">&#x68C0;&#x67E5;&#x6027;&#x5F02;&#x5E38;</a></li>
</ul>
</li>
<li><a href="#%E6%AD%BB%E9%94%81">&#x6B7B;&#x9501;</a></li>
<li><a href="#%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E9%9D%9E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8">&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</a></li>
<li><a href="#%E5%A4%8D%E6%9D%82%E6%80%A7%E5%92%8C%E4%BB%A3%E4%BB%B7">&#x590D;&#x6742;&#x6027;&#x548C;&#x4EE3;&#x4EF7;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</a>
<ul>
<li><a href="#%E7%BC%BA%E7%82%B9">&#x7F3A;&#x70B9;</a></li>
<li><a href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E9%99%B7%E9%98%B1">&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x9677;&#x9631;</a></li>
<li><a href="#this-albatross-is-big">This Albatross is Big</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%BA%93">&#x5176;&#x4ED6;&#x7C7B;&#x5E93;</a></li>
<li><a href="#%E8%80%83%E8%99%91%E4%B8%BA%E5%B9%B6%E5%8F%91%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%AF%AD%E8%A8%80">&#x8003;&#x8651;&#x4E3A;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;</a></li>
<li><a href="#%E6%8B%93%E5%B1%95%E9%98%85%E8%AF%BB">&#x62D3;&#x5C55;&#x9605;&#x8BFB;</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B">&#x7B2C;&#x4E8C;&#x5341;&#x56DB;&#x7AE0; &#x5E76;&#x53D1;&#x7F16;&#x7A0B;</h1>

<blockquote>
<p>&#x7231;&#x4E3D;&#x4E1D;&#xFF1A;&#x201C;&#x6211;&#x53EF;&#x4E0D;&#x60F3;&#x5230;&#x75AF;&#x5B50;&#x4E2D;&#x95F4;&#x53BB;&#x201D;</p>
<p>&#x732B;&#x54AA;&#xFF1A;&#x201C;&#x554A;&#xFF0C;&#x90A3;&#x6CA1;&#x8F99;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x90FD;&#x662F;&#x75AF;&#x5B50;&#x3002;&#x6211;&#x75AF;&#x4E86;&#xFF0C;&#x4F60;&#x4E5F;&#x75AF;&#x4E86;&#x201D;</p>
<p>&#x7231;&#x4E3D;&#x4E1D;&#xFF1A;&#x201C;&#x4F60;&#x600E;&#x4E48;&#x77E5;&#x9053;&#x6211;&#x75AF;&#x4E86;&#x201D;&#x3002;</p>
<p>&#x732B;&#x54AA;&#xFF1A;&#x201C;&#x4F60;&#x4E00;&#x5B9A;&#x662F;&#x75AF;&#x4E86;&#xFF0C;&#x5426;&#x5219;&#x4F60;&#x5C31;&#x4E0D;&#x4F1A;&#x6765;&#x8FD9;&#x513F;&#x201D; &#x2014;&#x2014;&#x7231;&#x4E3D;&#x4E1D;&#x68A6;&#x6E38;&#x4ED9;&#x5883; &#x7B2C;6&#x7AE0;&#x3002;</p>
</blockquote>
<p>&#x5728;&#x672C;&#x7AE0;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x60EF;&#x7528;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x987A;&#x5E8F;&#x7684;&#x53D9;&#x4E8B;&#x65B9;&#x5F0F;&#x6765;&#x7F16;&#x7A0B;&#xFF0C;&#x6709;&#x70B9;&#x7C7B;&#x4F3C;&#x6587;&#x5B66;&#x4E2D;&#x7684;&#x610F;&#x8BC6;&#x6D41;&#xFF1A;&#x7B2C;&#x4E00;&#x4EF6;&#x4E8B;&#x53D1;&#x751F;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x7B2C;&#x4E8C;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E09;&#x4EF6;&#x2026;&#x2026;&#x603B;&#x4E4B;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x5168;&#x638C;&#x63E1;&#x7740;&#x4E8B;&#x60C5;&#x53D1;&#x751F;&#x7684;&#x8FDB;&#x5C55;&#x548C;&#x987A;&#x5E8F;&#x3002;&#x5982;&#x679C;&#x5C06;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;5&#xFF0C;&#x518D;&#x770B;&#x65F6;&#x5B83;&#x5DF2;&#x53D8;&#x6210;47&#x7684;&#x8BDD;&#xFF0C;&#x7ED3;&#x679C;&#x5C31;&#x5F88;&#x532A;&#x5937;&#x6240;&#x601D;&#x4E86;&#x3002;</p>
<p>&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x5230;&#x4E86;&#x964C;&#x751F;&#x7684;&#x5E76;&#x53D1;&#x4E16;&#x754C;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x7ED3;&#x679C;&#x4E00;&#x70B9;&#x90FD;&#x4E0D;&#x5947;&#x602A;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x539F;&#x6765;&#x4FE1;&#x8D56;&#x7684;&#x4E00;&#x5207;&#x90FD;&#x4E0D;&#x518D;&#x53EF;&#x9760;&#x3002;&#x5B83;&#x53EF;&#x80FD;&#x6709;&#x6548;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x65E0;&#x6548;&#x3002;&#x66F4;&#x53EF;&#x80FD;&#x5F97;&#x662F;&#xFF0C;&#x5B83;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x800C;&#x5728;&#x53E6;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x5219;&#x4E0D;&#x4F1A;&#x3002;&#x53EA;&#x6709;&#x4E86;&#x89E3;&#x4E86;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#xFF0C;&#x6211;&#x4EEC;&#x624D;&#x80FD;&#x6B63;&#x786E;&#x5730;&#x884C;&#x4E8B;&#x3002;</p>
<p>&#x4F5C;&#x4E3A;&#x7C7B;&#x6BD4;&#xFF0C;&#x6211;&#x4EEC;&#x6B63;&#x5E38;&#x751F;&#x6D3B;&#x662F;&#x53D1;&#x751F;&#x5728;&#x7ECF;&#x5178;&#x725B;&#x987F;&#x529B;&#x5B66;&#x4E2D;&#x7684;&#x3002;&#x7269;&#x4F53;&#x5177;&#x6709;&#x8D28;&#x91CF;&#xFF1A;&#x4F1A;&#x5760;&#x843D;&#x5E76;&#x8F6C;&#x79FB;&#x52A8;&#x91CF;&#x3002;&#x7535;&#x7EBF;&#x6709;&#x7535;&#x963B;&#xFF0C;&#x5149;&#x76F4;&#x7EBF;&#x4F20;&#x64AD;&#x3002;&#x5047;&#x5982;&#x6211;&#x4EEC;&#x8FDB;&#x5165;&#x6781;&#x5C0F;&#x3001;&#x6781;&#x70ED;&#x3001;&#x6781;&#x51B7;&#x3001;&#x6216;&#x662F;&#x6781;&#x5927;&#x7684;&#x4E16;&#x754C;&#xFF08;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x751F;&#x5B58;&#xFF09;&#xFF0C;&#x8FD9;&#x4E9B;&#x73B0;&#x8C61;&#x5C31;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x3002;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x5224;&#x65AD;&#x67D0;&#x7269;&#x4F53;&#x662F;&#x7C92;&#x5B50;&#x8FD8;&#x662F;&#x6CE2;&#xFF0C;&#x5149;&#x662F;&#x5426;&#x53D7;&#x5230;&#x91CD;&#x529B;&#x5F71;&#x54CD;&#xFF0C;&#x4E00;&#x4E9B;&#x7269;&#x8D28;&#x8FD8;&#x4F1A;&#x53D8;&#x4E3A;&#x8D85;&#x5BFC;&#x4F53;&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x5904;&#x5728;&#x591A;&#x6761;&#x6545;&#x4E8B;&#x7EBF;&#x5E76;&#x884C;&#x7684;&#x95F4;&#x8C0D;&#x5C0F;&#x8BF4;&#x91CC;&#xFF0C;&#x975E;&#x5355;&#x4E00;&#x610F;&#x8BC6;&#x6D41;&#x5730;&#x53D9;&#x4E8B;&#xFF1A;&#x7B2C;&#x4E00;&#x4E2A;&#x95F4;&#x8C0D;&#x5728;&#x5CA9;&#x77F3;&#x5E95;&#x7559;&#x4E0B;&#x4E86;&#x5FAE;&#x7F29;&#x80F6;&#x7247;&#x3002;&#x5F53;&#x7B2C;&#x4E8C;&#x4E2A;&#x95F4;&#x8C0D;&#x6765;&#x53D6;&#x65F6;&#xFF0C;&#x80F6;&#x7247;&#x53EF;&#x80FD;&#x5DF2;&#x88AB;&#x7B2C;&#x4E09;&#x4E2A;&#x95F4;&#x8C0D;&#x62FF;&#x8D70;&#x3002;&#x5C0F;&#x8BF4;&#x5E76;&#x6CA1;&#x6709;&#x4EA4;&#x4EE3;&#x6B64;&#x5904;&#x7684;&#x7EC6;&#x8282;&#x3002;&#x6240;&#x4EE5;&#x76F4;&#x5230;&#x6545;&#x4E8B;&#x7ED3;&#x5C3E;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x6CA1;&#x641E;&#x6E05;&#x695A;&#x5230;&#x5E95;&#x53D1;&#x751F;&#x4E86;&#x4EC0;&#x4E48;&#x3002;</p>
<p>&#x6784;&#x5EFA;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x597D;&#x6BD4;&#x73A9;<a href="https://en.wikipedia.org/wiki/Jenga">&#x642D;&#x79EF;&#x6728;</a>&#x6E38;&#x620F;&#x3002;&#x6BCF;&#x62C9;&#x51FA;&#x4E00;&#x5757;&#x653E;&#x5728;&#x5854;&#x9876;&#x65F6;&#x90FD;&#x6709;&#x5D29;&#x584C;&#x7684;&#x53EF;&#x80FD;&#x3002;&#x6BCF;&#x4E2A;&#x79EF;&#x6728;&#x5854;&#x548C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x662F;&#x72EC;&#x4E00;&#x65E0;&#x4E8C;&#x7684;&#xFF0C;&#x6709;&#x7740;&#x81EA;&#x5DF1;&#x7684;&#x4F5C;&#x7528;&#x3002;&#x4F60;&#x5728;&#x67D0;&#x4E2A;&#x7CFB;&#x7EDF;&#x6784;&#x5EFA;&#x4E2D;&#x5B66;&#x5230;&#x7684;&#x77E5;&#x8BC6;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x9002;&#x7528;&#x4E8E;&#x4E0B;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x3002;</p>
<p>&#x672C;&#x7AE0;&#x662F;&#x5BF9;&#x5E76;&#x53D1;&#x6982;&#x5FF5;&#x6700;&#x57FA;&#x672C;&#x7684;&#x4ECB;&#x7ECD;&#x3002;&#x867D;&#x7136;&#x6211;&#x4EEC;&#x7528;&#x5230;&#x4E86;&#x73B0;&#x4EE3;&#x7684; Java 8 &#x5DE5;&#x5177;&#x6765;&#x6F14;&#x793A;&#x539F;&#x7406;&#xFF0C;&#x4F46;&#x8FD8;&#x8FDC;&#x672A;&#x53CA;&#x5168;&#x9762;&#x8BBA;&#x8FF0;&#x5E76;&#x53D1;&#x3002;&#x6211;&#x7684;&#x76EE;&#x6807;&#x662F;&#x4E3A;&#x4F60;&#x63D0;&#x4F9B;&#x8DB3;&#x591F;&#x7684;&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#xFF0C;&#x4F7F;&#x4F60;&#x80FD;&#x591F;&#x628A;&#x63E1;&#x95EE;&#x9898;&#x7684;&#x590D;&#x6742;&#x6027;&#x548C;&#x5371;&#x9669;&#x6027;&#xFF0C;&#x4ECE;&#x800C;&#x5B89;&#x5168;&#x5730;&#x6E21;&#x8FC7;&#x8FD9;&#x7247;&#x9CA8;&#x9C7C;&#x8086;&#x8650;&#x7684;&#x56F0;&#x96BE;&#x6C34;&#x57DF;&#x3002;</p>
<p>&#x66F4;&#x591A;&#x7E41;&#x7410;&#x548C;&#x5E95;&#x5C42;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x5E76;&#x53D1;&#x5E95;&#x5C42;&#x539F;&#x7406;</a>&#x3002;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x6DF1;&#x5165;&#x8FD9;&#x4E2A;&#x9886;&#x57DF;&#xFF0C;&#x4F60;&#x8FD8;&#x5FC5;&#x987B;&#x9605;&#x8BFB; <em>Brian Goetz</em> &#x7B49;&#x4EBA;&#x7684; &#x300A;Java Concurrency in Practice&#x300B;&#x3002;&#x5728;&#x64B0;&#x5199;&#x672C;&#x6587;&#x65F6;&#xFF0C;&#x8BE5;&#x4E66;&#x5DF2;&#x6709;&#x5341;&#x591A;&#x5E74;&#x7684;&#x5386;&#x53F2;&#x4E86;&#xFF0C;&#x4F46;&#x5B83;&#x4ECD;&#x5305;&#x542B;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x8981;&#x4E86;&#x89E3;&#x548C;&#x660E;&#x767D;&#x7684;&#x77E5;&#x8BC6;&#x8981;&#x70B9;&#x3002;&#x7406;&#x60F3;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x672C;&#x7AE0;&#x548C;&#x4E0A;&#x8FF0;&#x9644;&#x5F55;&#x662F;&#x9605;&#x8BFB;&#x8BE5;&#x4E66;&#x7684;&#x826F;&#x597D;&#x524D;&#x63D0;&#x3002;&#x53E6;&#x5916;&#xFF0C;<em>Bill Venner</em> &#x7684; &#x300A;Inside the Java Virtual Machine&#x300B;&#x4E5F;&#x5F88;&#x503C;&#x5F97;&#x4E00;&#x770B;&#x3002;&#x5B83;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x4E86; JVM &#x7684;&#x5185;&#x90E8;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;&#xFF0C;&#x5305;&#x62EC;&#x7EBF;&#x7A0B;&#x3002;</p>
<h2 class="mume-header" id="%E6%9C%AF%E8%AF%AD%E9%97%AE%E9%A2%98">&#x672F;&#x8BED;&#x95EE;&#x9898;</h2>

<p>&#x672F;&#x8BED;&#x201C;&#x5E76;&#x53D1;&#x201D;&#xFF0C;&#x201C;&#x5E76;&#x884C;&#x201D;&#xFF0C;&#x201C;&#x591A;&#x4EFB;&#x52A1;&#x201D;&#xFF0C;&#x201C;&#x591A;&#x5904;&#x7406;&#x201D;&#xFF0C;&#x201C;&#x591A;&#x7EBF;&#x7A0B;&#x201D;&#xFF0C;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#xFF08;&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#xFF09;&#x5728;&#x6574;&#x4E2A;&#x7F16;&#x7A0B;&#x6587;&#x732E;&#x4E2D;&#x90FD;&#x4EE5;&#x591A;&#x79CD;&#x76F8;&#x4E92;&#x51B2;&#x7A81;&#x7684;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x7ECF;&#x5E38;&#x88AB;&#x6DF7;&#x4E3A;&#x4E00;&#x8C08;&#x3002;<br>
<em>Brian Goetz</em> &#x5728;&#x4ED6; 2016 &#x5E74;&#x300A;&#x4ECE;&#x5E76;&#x53D1;&#x5230;&#x5E76;&#x884C;&#x300B;&#x7684;&#x6F14;&#x8BB2;&#x4E2D;&#x6307;&#x51FA;&#x4E86;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x4E4B;&#x540E;&#x63D0;&#x51FA;&#x4E86;&#x5408;&#x7406;&#x7684;&#x4E8C;&#x5206;&#x6CD5;&#xFF1A;</p>
<ul>
<li>
<p>&#x5E76;&#x53D1;&#x662F;&#x5173;&#x4E8E;&#x6B63;&#x786E;&#x6709;&#x6548;&#x5730;&#x63A7;&#x5236;&#x5BF9;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x3002;</p>
</li>
<li>
<p>&#x5E76;&#x884C;&#x662F;&#x4F7F;&#x7528;&#x989D;&#x5916;&#x7684;&#x8D44;&#x6E90;&#x6765;&#x66F4;&#x5FEB;&#x5730;&#x4EA7;&#x751F;&#x7ED3;&#x679C;&#x3002;</p>
</li>
</ul>
<p>&#x8FD9;&#x4E9B;&#x5B9A;&#x4E49;&#x5F88;&#x597D;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5DF2;&#x6709;&#x51E0;&#x5341;&#x5E74;&#x6DF7;&#x4E71;&#x4F7F;&#x7528;&#x548C;&#x6297;&#x62D2;&#x89E3;&#x51B3;&#x6B64;&#x95EE;&#x9898;&#x7684;&#x5386;&#x53F2;&#x4E86;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;&#x5F53;&#x4EBA;&#x4EEC;&#x4F7F;&#x7528;&#x201C;&#x5E76;&#x53D1;&#x201D;&#x8FD9;&#x4E2A;&#x8BCD;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;&#x610F;&#x601D;&#x662F;&#x201C;&#x6240;&#x6709;&#x7684;&#x4E00;&#x5207;&#x201D;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x6211;&#x81EA;&#x5DF1;&#x4E5F;&#x7ECF;&#x5E38;&#x9677;&#x5165;&#x8FD9;&#x6837;&#x7684;&#x60F3;&#x6CD5;&#x3002;&#x5728;&#x5927;&#x591A;&#x6570;&#x4E66;&#x7C4D;&#x4E2D;&#xFF0C;&#x5305;&#x62EC; <em>Brian Goetz</em> &#x7684; &#x300A;Java Concurrency in Practice&#x300B;&#xFF0C;&#x90FD;&#x5728;&#x6807;&#x9898;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x8BCD;&#x3002;</p>
<p>&#x201C;&#x5E76;&#x53D1;&#x201D;&#x901A;&#x5E38;&#x8868;&#x793A;&#xFF1A;&#x4E0D;&#x6B62;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6B63;&#x5728;&#x6267;&#x884C;&#x3002;&#x800C;&#x201C;&#x5E76;&#x884C;&#x201D;&#x51E0;&#x4E4E;&#x603B;&#x662F;&#x4EE3;&#x8868;&#xFF1A;&#x4E0D;&#x6B62;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x540C;&#x65F6;&#x6267;&#x884C;&#x3002;&#x73B0;&#x5728;&#x4F60;&#x80FD;&#x770B;&#x5230;&#x95EE;&#x9898;&#x6240;&#x5728;&#x4E86;&#x5417;&#xFF1F;&#x201C;&#x5E76;&#x884C;&#x201D;&#x4E5F;&#x6709;&#x4E0D;&#x6B62;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x8BED;&#x4E49;&#x5728;&#x91CC;&#x9762;&#x3002;&#x533A;&#x522B;&#x5C31;&#x5728;&#x4E8E;&#x7EC6;&#x8282;&#xFF1A;&#x7A76;&#x7ADF;&#x662F;&#x600E;&#x4E48;&#x201C;&#x6267;&#x884C;&#x201D;&#x7684;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x91CD;&#x53E0;&#xFF1A;&#x4E3A;&#x5E76;&#x884C;&#x7F16;&#x5199;&#x7684;&#x7A0B;&#x5E8F;&#x6709;&#x65F6;&#x5728;&#x5355;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x800C;&#x4E00;&#x4E9B;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x5904;&#x7406;&#x5668;&#x3002;</p>
<p>&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x51CF;&#x901F;&#x53D1;&#x751F;&#x7684;&#x5730;&#x65B9;&#x5199;&#x4E0B;&#x5B9A;&#x4E49;&#xFF08;&#x539F;&#x6587;Here&#x2019;s another approach, writing the definitions around where the<br>
slowdown occurs&#xFF09;&#xFF1A;</p>
<p><strong>&#x5E76;&#x53D1;</strong></p>
<p>&#x540C;&#x65F6;&#x5B8C;&#x6210;&#x591A;&#x4EFB;&#x52A1;&#x3002;&#x65E0;&#x9700;&#x7B49;&#x5F85;&#x5F53;&#x524D;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x5373;&#x53EF;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#x3002;&#x201C;&#x5E76;&#x53D1;&#x201D;&#x89E3;&#x51B3;&#x4E86;&#x7A0B;&#x5E8F;&#x56E0;&#x5916;&#x90E8;&#x63A7;&#x5236;&#x800C;&#x65E0;&#x6CD5;&#x8FDB;&#x4E00;&#x6B65;&#x6267;&#x884C;&#x7684;&#x963B;&#x585E;&#x95EE;&#x9898;&#x3002;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x4F8B;&#x5B50;&#x5C31;&#x662F; I/O &#x64CD;&#x4F5C;&#xFF0C;&#x4EFB;&#x52A1;&#x5FC5;&#x987B;&#x7B49;&#x5F85;&#x6570;&#x636E;&#x8F93;&#x5165;&#xFF08;&#x5728;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#x4E2D;&#x4E5F;&#x79F0;&#x963B;&#x585E;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5E38;&#x89C1;&#x4E8E; I/O &#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x3002;</p>
<p><strong>&#x5E76;&#x884C;</strong></p>
<p>&#x540C;&#x65F6;&#x5728;&#x591A;&#x4E2A;&#x4F4D;&#x7F6E;&#x5B8C;&#x6210;&#x591A;&#x4EFB;&#x52A1;&#x3002;&#x8FD9;&#x89E3;&#x51B3;&#x4E86;&#x6240;&#x8C13;&#x7684; CPU &#x5BC6;&#x96C6;&#x578B;&#x95EE;&#x9898;&#xFF1A;&#x5C06;&#x7A0B;&#x5E8F;&#x5206;&#x4E3A;&#x591A;&#x90E8;&#x5206;&#xFF0C;&#x5728;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x540C;&#x65F6;&#x5904;&#x7406;&#x4E0D;&#x540C;&#x90E8;&#x5206;&#x6765;&#x52A0;&#x5FEB;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x6548;&#x7387;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x5B9A;&#x4E49;&#x544A;&#x8BC9;&#x4E86;&#x6211;&#x4EEC;&#x672F;&#x8BED;&#x4EE4;&#x4EBA;&#x56F0;&#x60D1;&#x7684;&#x539F;&#x56E0;&#xFF1A;&#x4E24;&#x8005;&#x7684;&#x6838;&#x5FC3;&#x662F;&#x201C;&#x540C;&#x65F6;&#x5B8C;&#x6210;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x201D;&#x3002;&#x5E76;&#x884C;&#x589E;&#x52A0;&#x4E86;&#x8DE8;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x7684;&#x5206;&#x5E03;&#x3002;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x89E3;&#x51B3;I / O&#x7ED1;&#x5B9A;&#x95EE;&#x9898;&#x548C;&#x5E76;&#x884C;&#x5316;&#x53EF;&#x80FD;&#x5BF9;&#x60A8;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x597D;&#x5904;&#xFF0C;&#x56E0;&#x4E3A;&#x8BE5;&#x95EE;&#x9898;&#x4E0D;&#x662F;&#x6574;&#x4F53;&#x901F;&#x5EA6;&#xFF0C;&#x800C;&#x662F;&#x963B;&#x585E;&#x3002;&#x91C7;&#x53D6;&#x8BA1;&#x7B97;&#x7EA6;&#x675F;&#x95EE;&#x9898;&#x5E76;&#x5C1D;&#x8BD5;&#x5728;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x6027;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x53EF;&#x80FD;&#x4F1A;&#x6D6A;&#x8D39;&#x65F6;&#x95F4;&#x3002;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x8BD5;&#x56FE;&#x5728;&#x66F4;&#x77ED;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x5B8C;&#x6210;&#x66F4;&#x591A;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4EEC;&#x5B9E;&#x73B0;&#x52A0;&#x901F;&#x7684;&#x65B9;&#x5F0F;&#x5374;&#x6709;&#x6240;&#x4E0D;&#x540C;&#xFF0C;&#x5E76;&#x4E14;&#x53D6;&#x51B3;&#x4E8E;&#x95EE;&#x9898;&#x6240;&#x65BD;&#x52A0;&#x7684;&#x7EA6;&#x675F;&#x3002;</p>
<p>&#x672F;&#x8BED;&#x6DF7;&#x6DC6;&#x7684;&#x539F;&#x56E0;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x5B9A;&#x4E49;&#x4E2D;&#x663E;&#x793A;&#xFF1A;&#x5176;&#x4E2D;&#x6838;&#x5FC3;&#x662F;&#x201C;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x5B8C;&#x6210;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;&#x201D;&#x5E76;&#x884C;&#x6027;&#x901A;&#x8FC7;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x589E;&#x52A0;&#x5206;&#x5E03;&#x3002;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#xFF0C;&#x4E24;&#x8005;&#x89E3;&#x51B3;&#x4E86;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x89E3;&#x51B3;I/O&#x5BC6;&#x96C6;&#x578B;&#x95EE;&#x9898;&#xFF0C;&#x5E76;&#x884C;&#x5316;&#x53EF;&#x80FD;&#x5BF9;&#x4F60;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x597D;&#x5904;&#xFF0C;&#x56E0;&#x4E3A;&#x95EE;&#x9898;&#x4E0D;&#x662F;&#x6574;&#x4F53;&#x901F;&#x5EA6;&#xFF0C;&#x800C;&#x662F;&#x963B;&#x585E;&#x3002;&#x5E76;&#x4E14;&#x8003;&#x8651;&#x5230;&#x8BA1;&#x7B97;&#x529B;&#x9650;&#x5236;&#x95EE;&#x9898;&#x5E76;&#x8BD5;&#x56FE;&#x5728;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x6765;&#x89E3;&#x51B3;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x6D6A;&#x8D39;&#x65F6;&#x95F4;&#x3002;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x8BD5;&#x56FE;&#x5728;&#x66F4;&#x77ED;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x5B8C;&#x6210;&#x66F4;&#x591A;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x5B9E;&#x73B0;&#x52A0;&#x901F;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x53D6;&#x51B3;&#x4E8E;&#x95EE;&#x9898;&#x6240;&#x5E26;&#x6765;&#x7684;&#x7EA6;&#x675F;&#x3002;</p>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#x6DF7;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x7684;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x662F;&#x5305;&#x62EC;Java&#x5728;&#x5185;&#x7684;&#x8BB8;&#x591A;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x673A;&#x5236;<strong>&#x7EBF;&#x7A0B;</strong>&#x6765;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x548C;&#x5E76;&#x884C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x6DFB;&#x52A0;&#x7EC6;&#x81F4;&#x7684;&#x7C92;&#x5EA6;&#x53BB;&#x5B9A;&#x4E49;&#xFF08;&#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x6807;&#x51C6;&#x5316;&#x7684;&#x672F;&#x8BED;&#xFF09;&#xFF1A;</p>
<ul>
<li><strong>&#x7EAF;&#x5E76;&#x53D1;</strong>&#xFF1A;&#x4EFB;&#x52A1;&#x4ECD;&#x7136;&#x5728;&#x5355;&#x4E2A;CPU&#x4E0A;&#x8FD0;&#x884C;&#x3002;&#x7EAF;&#x5E76;&#x53D1;&#x7CFB;&#x7EDF;&#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x6BD4;&#x987A;&#x5E8F;&#x7CFB;&#x7EDF;&#x66F4;&#x5FEB;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x6709;&#x66F4;&#x591A;&#x7684;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x5219;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x4E0D;&#x4F1A;&#x66F4;&#x5FEB;</li>
<li><strong>&#x5E76;&#x53D1;-&#x5E76;&#x884C;</strong>&#xFF1A;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x6280;&#x672F;&#xFF0C;&#x7ED3;&#x679C;&#x7A0B;&#x5E8F;&#x5229;&#x7528;&#x66F4;&#x591A;&#x5904;&#x7406;&#x5668;&#x5E76;&#x66F4;&#x5FEB;&#x5730;&#x751F;&#x6210;&#x7ED3;&#x679C;</li>
<li><strong>&#x5E76;&#x884C;-&#x5E76;&#x53D1;</strong>&#xFF1A;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x7F16;&#x7A0B;&#x6280;&#x672F;&#x7F16;&#x5199;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x7ED3;&#x679C;&#x7A0B;&#x5E8F;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#xFF08;Java 8 <strong>Streams</strong>&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x4F8B;&#x5B50;&#xFF09;&#x3002;</li>
<li><strong>&#x7EAF;&#x5E76;&#x884C;</strong>&#xFF1A;&#x9664;&#x975E;&#x6709;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x5426;&#x5219;&#x4E0D;&#x4F1A;&#x8FD0;&#x884C;&#x3002;</li>
</ul>
<p>&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x7528;&#x7684;&#x5206;&#x7C7B;&#x6CD5;&#x3002;</p>
<p>&#x5BF9;&#x5E76;&#x53D1;&#x6027;&#x7684;&#x8BED;&#x8A00;&#x548C;&#x5E93;&#x652F;&#x6301;&#x4F3C;&#x4E4E;<a href="https://en.wikipedia.org/wiki/Leaky_abstraction">Leaky Abstraction</a>&#x662F;&#x5B8C;&#x7F8E;&#x5019;&#x9009;&#x8005;&#x3002;&#x62BD;&#x8C61;&#x7684;&#x76EE;&#x6807;&#x662F;&#x201C;&#x62BD;&#x8C61;&#x51FA;&#x201D;&#x90A3;&#x4E9B;&#x5BF9;&#x4E8E;&#x624B;&#x5934;&#x60F3;&#x6CD5;&#x4E0D;&#x91CD;&#x8981;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x4ECE;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x7EC6;&#x8282;&#x4E2D;&#x6C72;&#x53D6;&#x7075;&#x611F;&#x3002;&#x5982;&#x679C;&#x62BD;&#x8C61;&#x662F;&#x6F0F;&#x6D1E;&#xFF0C;&#x90A3;&#x4E9B;&#x788E;&#x7247;&#x548C;&#x7EC6;&#x8282;&#x4F1A;&#x4E0D;&#x65AD;&#x91CD;&#x65B0;&#x58F0;&#x660E;&#x81EA;&#x5DF1;&#x662F;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x65E0;&#x8BBA;&#x4F60;&#x8BD5;&#x56FE;&#x9690;&#x85CF;&#x5B83;&#x4EEC;&#x591A;&#x5C11;</p>
<p>&#x6211;&#x5F00;&#x59CB;&#x6000;&#x7591;&#x662F;&#x5426;&#x771F;&#x7684;&#x6709;&#x9AD8;&#x5EA6;&#x62BD;&#x8C61;&#x3002;&#x5F53;&#x7F16;&#x5199;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4F60;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x88AB;&#x5E95;&#x5C42;&#x7CFB;&#x7EDF;&#x548C;&#x5DE5;&#x5177;&#x5C4F;&#x853D;&#xFF0C;&#x751A;&#x81F3;&#x5173;&#x4E8E;CPU&#x7F13;&#x5B58;&#x5982;&#x4F55;&#x5DE5;&#x4F5C;&#x7684;&#x7EC6;&#x8282;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x975E;&#x5E38;&#x5C0F;&#x5FC3;&#xFF0C;&#x4F60;&#x521B;&#x4F5C;&#x7684;&#x4E1C;&#x897F;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x4F46;&#x5B83;&#x5728;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x4E24;&#x53F0;&#x673A;&#x5668;&#x7684;&#x914D;&#x7F6E;&#x65B9;&#x5F0F;&#xFF0C;&#x6216;&#x8005;&#x7A0B;&#x5E8F;&#x7684;&#x4F30;&#x8BA1;&#x8D1F;&#x8F7D;&#x3002;&#x8FD9;&#x4E0D;&#x662F;Java&#x7279;&#x6709;&#x7684;-&#x5B83;&#x662F;&#x5E76;&#x53D1;&#x548C;&#x5E76;&#x884C;&#x7F16;&#x7A0B;&#x7684;&#x672C;&#x8D28;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x8BA4;&#x4E3A;<a href="https://en.wikipedia.org/wiki/Purely_functional">&#x7EAF;&#x51FD;&#x6570;&#x5F0F;</a>&#x8BED;&#x8A00;&#x6CA1;&#x6709;&#x8FD9;&#x4E9B;&#x9650;&#x5236;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x7EAF;&#x51FD;&#x6570;&#x5F0F;&#x8BED;&#x8A00;&#x89E3;&#x51B3;&#x4E86;&#x5927;&#x91CF;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4F60;&#x6B63;&#x5728;&#x89E3;&#x51B3;&#x4E00;&#x4E2A;&#x56F0;&#x96BE;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x7528;&#x7EAF;&#x51FD;&#x6570;&#x8BED;&#x8A00;&#x7F16;&#x5199;&#x8FD9;&#x4E2A;&#x90E8;&#x5206;&#x3002;&#x4F46;&#x6700;&#x7EC8;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x961F;&#x5217;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x5B83;&#x6CA1;&#x6709;&#x6B63;&#x786E;&#x8C03;&#x6574;&#x5E76;&#x4E14;&#x8F93;&#x5165;&#x901F;&#x7387;&#x8981;&#x4E48;&#x6CA1;&#x6709;&#x88AB;&#x6B63;&#x786E;&#x4F30;&#x8BA1;&#x6216;&#x88AB;&#x9650;&#x5236;&#xFF08;&#x5E76;&#x4E14;&#x9650;&#x5236;&#x610F;&#x5473;&#x7740;,&#x5728;&#x4E0D;&#x540C;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x540C;&#x7684;&#x4E1C;&#x897F;&#x5177;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x5F71;&#x54CD;&#xFF09;&#xFF0C;&#x8BE5;&#x961F;&#x5217;&#x5C06;&#x586B;&#x6EE1;&#x5E76;&#x963B;&#x585E;&#x6216;&#x6EA2;&#x51FA;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x4E86;&#x89E3;&#x6240;&#x6709;&#x7EC6;&#x8282;&#xFF0C;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x7834;&#x574F;&#x4F60;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x4E0D;&#x540C;&#x7684;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;</p>
<h3 class="mume-header" id="%E5%B9%B6%E5%8F%91%E7%9A%84%E6%96%B0%E5%AE%9A%E4%B9%89">&#x5E76;&#x53D1;&#x7684;&#x65B0;&#x5B9A;&#x4E49;</h3>

<p>&#x51E0;&#x5341;&#x5E74;&#x6765;&#xFF0C;&#x6211;&#x4E00;&#x76F4;&#x5728;&#x52AA;&#x529B;&#x89E3;&#x51B3;&#x5404;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6700;&#x5927;&#x7684;&#x6311;&#x6218;&#x4E00;&#x76F4;&#x662F;&#x7B80;&#x5355;&#x5730;&#x5B9A;&#x4E49;&#x5B83;&#x3002;&#x5728;&#x64B0;&#x5199;&#x672C;&#x7AE0;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x7EC8;&#x4E8E;&#x6709;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x6D1E;&#x5BDF;&#x529B;&#xFF0C;&#x6211;&#x8BA4;&#x4E3A;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x5B83;&#xFF1A;</p>
<blockquote>
<p><strong>&#x5E76;&#x53D1;&#x6027;&#x662F;&#x4E00;&#x7CFB;&#x5217;&#x6027;&#x80FD;&#x6280;&#x672F;&#xFF0C;&#x4E13;&#x6CE8;&#x4E8E;&#x51CF;&#x5C11;&#x7B49;&#x5F85;</strong></p>
</blockquote>
<p>&#x8FD9;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x76F8;&#x5F53;&#x591A;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5C06;&#x5176;&#x5206;&#x89E3;&#xFF1A;</p>
<ul>
<li>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6280;&#x672F;&#x7C7B;&#x96C6;&#x5408;&#xFF1A;&#x5305;&#x542B;&#x8BB8;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x8FD9;&#x662F;&#x4F7F;&#x5B9A;&#x4E49;&#x5E76;&#x53D1;&#x6027;&#x5982;&#x6B64;&#x5177;&#x6709;&#x6311;&#x6218;&#x6027;&#x7684;&#x95EE;&#x9898;&#x4E4B;&#x4E00;&#xFF0C;&#x56E0;&#x4E3A;&#x6280;&#x672F;&#x5DEE;&#x522B;&#x5F88;&#x5927;</li>
<li>&#x8FD9;&#x4E9B;&#x662F;&#x6027;&#x80FD;&#x6280;&#x672F;&#xFF1A;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x3002;&#x5E76;&#x53D1;&#x7684;&#x5173;&#x952E;&#x70B9;&#x5728;&#x4E8E;&#x8BA9;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x5FEB;&#x3002;&#x5728;Java&#x4E2D;&#xFF0C;&#x5E76;&#x53D1;&#x662F;&#x975E;&#x5E38;&#x68D8;&#x624B;&#x548C;&#x56F0;&#x96BE;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x7EDD;&#x5BF9;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x6709;&#x4E00;&#x4E2A;&#x91CD;&#x5927;&#x7684;&#x6027;&#x80FD;&#x95EE;&#x9898; - &#x5373;&#x4F7F;&#x8FD9;&#x6837;&#xFF0C;&#x4F7F;&#x7528;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x4EA7;&#x751F;&#x4F60;&#x9700;&#x8981;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x5E76;&#x53D1;&#x5F88;&#x5FEB;&#x53D8;&#x5F97;&#x65E0;&#x6CD5;&#x7BA1;&#x7406;&#x3002;</li>
<li>&#x201C;&#x51CF;&#x5C11;&#x7B49;&#x5F85;&#x201D;&#x90E8;&#x5206;&#x5F88;&#x91CD;&#x8981;&#x800C;&#x4E14;&#x5FAE;&#x5999;&#x3002;&#x65E0;&#x8BBA;&#xFF08;&#x4F8B;&#x5982;&#xFF09;&#x4F60;&#x8FD0;&#x884C;&#x591A;&#x5C11;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x5728;&#x7B49;&#x5F85;&#x67D0;&#x4E2A;&#x5730;&#x65B9;&#x65F6;&#x4EA7;&#x751F;&#x7ED3;&#x679C;&#x3002;&#x5982;&#x679C;&#x4F60;&#x53D1;&#x8D77;I/O&#x8BF7;&#x6C42;&#x5E76;&#x7ACB;&#x5373;&#x83B7;&#x5F97;&#x7ED3;&#x679C;&#xFF0C;&#x6CA1;&#x6709;&#x5EF6;&#x8FDF;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x9700;&#x6539;&#x8FDB;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5728;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x90FD;&#x4EE5;&#x6EE1;&#x5BB9;&#x91CF;&#x8FD0;&#x884C;&#xFF0C;&#x5E76;&#x4E14;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#x90FD;&#x6CA1;&#x6709;&#x7B49;&#x5F85;&#xFF0C;&#x90A3;&#x4E48;&#x5C1D;&#x8BD5;&#x63D0;&#x9AD8;&#x541E;&#x5410;&#x91CF;&#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;&#x3002;&#x5E76;&#x53D1;&#x7684;&#x552F;&#x4E00;&#x5F62;&#x5F0F;&#x662F;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x7684;&#x67D0;&#x4E9B;&#x90E8;&#x5206;&#x88AB;&#x8FEB;&#x7B49;&#x5F85;&#x3002;&#x7B49;&#x5F85;&#x53EF;&#x4EE5;&#x4EE5;&#x591A;&#x79CD;&#x5F62;&#x5F0F;&#x51FA;&#x73B0; - &#x8FD9;&#x89E3;&#x91CA;&#x4E86;&#x4E3A;&#x4EC0;&#x4E48;&#x5B58;&#x5728;&#x5982;&#x6B64;&#x4E0D;&#x540C;&#x7684;&#x5E76;&#x53D1;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<p>&#x503C;&#x5F97;&#x5F3A;&#x8C03;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B9A;&#x4E49;&#x7684;&#x6709;&#x6548;&#x6027;&#x53D6;&#x51B3;&#x4E8E;&#x7B49;&#x5F85;&#x8FD9;&#x4E2A;&#x8BCD;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x53EF;&#x4EE5;&#x7B49;&#x5F85;&#xFF0C;&#x90A3;&#x5C31;&#x6CA1;&#x6709;&#x673A;&#x4F1A;&#x4E86;&#x3002;&#x5982;&#x679C;&#x6709;&#x4EC0;&#x4E48;&#x4E1C;&#x897F;&#x5728;&#x7B49;&#x5F85;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x52A0;&#x5FEB;&#x901F;&#x5EA6;&#xFF0C;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x591A;&#x79CD;&#x56E0;&#x7D20;&#xFF0C;&#x5305;&#x62EC;&#x7CFB;&#x7EDF;&#x8FD0;&#x884C;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x4F60;&#x8981;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x7C7B;&#x578B;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x8BB8;&#x591A;&#x95EE;&#x9898;&#x3002;</p>
<h2 class="mume-header" id="%E5%B9%B6%E5%8F%91%E7%9A%84%E8%B6%85%E8%83%BD%E5%8A%9B">&#x5E76;&#x53D1;&#x7684;&#x8D85;&#x80FD;&#x529B;</h2>

<p>&#x60F3;&#x8C61;&#x4E00;&#x4E0B;&#xFF0C;&#x4F60;&#x7F6E;&#x8EAB;&#x4E8E;&#x4E00;&#x90E8;&#x79D1;&#x5E7B;&#x7535;&#x5F71;&#x3002;&#x4F60;&#x5FC5;&#x987B;&#x5728;&#x9AD8;&#x5C42;&#x5EFA;&#x7B51;&#x4E2D;&#x641C;&#x7D22;&#x4E00;&#x4E2A;&#x7CBE;&#x5FC3;&#x5DE7;&#x5999;&#x5730;&#x9690;&#x85CF;&#x5728;&#x5EFA;&#x7B51;&#x7269;&#x7684;&#x4E00;&#x5343;&#x4E07;&#x4E2A;&#x623F;&#x95F4;&#x4E4B;&#x4E00;&#x4E2D;&#x7684;&#x5355;&#x4E2A;&#x7269;&#x54C1;&#x3002;&#x4F60;&#x8FDB;&#x5165;&#x5EFA;&#x7B51;&#x7269;&#x5E76;&#x6CBF;&#x7740;&#x8D70;&#x5ECA;&#x5411;&#x4E0B;&#x79FB;&#x52A8;&#x3002;&#x8D70;&#x5ECA;&#x5206;&#x5F00;&#x4E86;&#x3002;</p>
<p>&#x4F60;&#x81EA;&#x5DF1;&#x5B8C;&#x6210;&#x8FD9;&#x9879;&#x4EFB;&#x52A1;&#x9700;&#x8981;&#x4E00;&#x767E;&#x4E2A;&#x751F;&#x547D;&#x5468;&#x671F;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x4F60;&#x6709;&#x4E00;&#x4E2A;&#x5947;&#x602A;&#x7684;&#x8D85;&#x80FD;&#x529B;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x81EA;&#x5DF1;&#x4E00;&#x5206;&#x4E3A;&#x4E8C;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x7EE7;&#x7EED;&#x524D;&#x8FDB;&#x7684;&#x540C;&#x65F6;&#x5C06;&#x53E6;&#x4E00;&#x534A;&#x9001;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x8D70;&#x5ECA;&#x3002;&#x6BCF;&#x5F53;&#x4F60;&#x5728;&#x8D70;&#x5ECA;&#x6216;&#x697C;&#x68AF;&#x4E0A;&#x9047;&#x5230;&#x5206;&#x9694;&#x5230;&#x4E0B;&#x4E00;&#x5C42;&#x65F6;&#xFF0C;&#x4F60;&#x90FD;&#x4F1A;&#x91CD;&#x590D;&#x8FD9;&#x4E2A;&#x5206;&#x88C2;&#x7684;&#x6280;&#x5DE7;&#x3002;&#x6700;&#x7EC8;&#xFF0C;&#x6574;&#x4E2A;&#x5EFA;&#x7B51;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8D70;&#x5ECA;&#x7684;&#x7EC8;&#x70B9;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x4F60;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x8D70;&#x5ECA;&#x90FD;&#x6709;&#x4E00;&#x5343;&#x4E2A;&#x623F;&#x95F4;&#x3002;&#x4F60;&#x7684;&#x8D85;&#x80FD;&#x529B;&#x53D8;&#x5F97;&#x6709;&#x70B9;&#x5F31;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x53EA;&#x80FD;&#x5206;&#x88C2;&#x51FA;50&#x4E2A;&#x81EA;&#x5DF1;&#x6765;&#x641C;&#x7D22;&#x8FD9;&#x95F4;&#x623F;&#x95F4;&#x3002;</p>
<p>&#x4E00;&#x65E6;&#x514B;&#x9686;&#x4F53;&#x8FDB;&#x5165;&#x623F;&#x95F4;&#xFF0C;&#x5B83;&#x5FC5;&#x987B;&#x641C;&#x7D22;&#x623F;&#x95F4;&#x7684;&#x6BCF;&#x4E2A;&#x89D2;&#x843D;&#x3002;&#x8FD9;&#x65F6;&#x5B83;&#x5207;&#x6362;&#x5230;&#x4E86;&#x7B2C;&#x4E8C;&#x79CD;&#x8D85;&#x80FD;&#x529B;&#x3002;&#x5B83;&#x5206;&#x88C2;&#x6210;&#x4E86;&#x4E00;&#x767E;&#x4E07;&#x4E2A;&#x7EB3;&#x7C73;&#x673A;&#x5668;&#x4EBA;&#xFF0C;&#x6BCF;&#x4E2A;&#x673A;&#x5668;&#x4EBA;&#x90FD;&#x4F1A;&#x98DE;&#x5230;&#x6216;&#x722C;&#x5230;&#x623F;&#x95F4;&#x91CC;&#x4E00;&#x4E9B;&#x770B;&#x4E0D;&#x89C1;&#x7684;&#x5730;&#x65B9;&#x3002;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x8FD9;&#x79CD;&#x529F;&#x80FD; - &#x4E00;&#x65E6;&#x4F60;&#x5F00;&#x542F;&#x5B83;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x5DE5;&#x4F5C;&#x3002;&#x5728;&#x4ED6;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;&#x63A7;&#x5236;&#x4E0B;&#xFF0C;&#x7EB3;&#x7C73;&#x673A;&#x5668;&#x4EBA;&#x5F00;&#x59CB;&#x884C;&#x52A8;&#xFF0C;&#x641C;&#x7D22;&#x623F;&#x95F4;&#x7136;&#x540E;&#x56DE;&#x6765;&#x91CD;&#x65B0;&#x7EC4;&#x88C5;&#x6210;&#x4F60;&#xFF0C;&#x7A81;&#x7136;&#x95F4;&#xFF0C;&#x4F60;&#x83B7;&#x5F97;&#x4E86;&#x5BFB;&#x627E;&#x7684;&#x7269;&#x54C1;&#x662F;&#x5426;&#x5728;&#x623F;&#x95F4;&#x5185;&#x7684;&#x6D88;&#x606F;&#x3002;</p>
<p>&#x6211;&#x5F88;&#x60F3;&#x8BF4;&#xFF0C;&#x201C;&#x5E76;&#x53D1;&#x5C31;&#x662F;&#x521A;&#x624D;&#x63CF;&#x8FF0;&#x7684;&#x7F6E;&#x8EAB;&#x4E8E;&#x79D1;&#x5E7B;&#x7535;&#x5F71;&#x4E2D;&#x7684;&#x8D85;&#x80FD;&#x529B;&#x201C;&#x5C31;&#x50CF;&#x4F60;&#x81EA;&#x5DF1;&#x53EF;&#x4EE5;&#x4E00;&#x5206;&#x4E3A;&#x4E8C;&#x7136;&#x540E;&#x89E3;&#x51B3;&#x66F4;&#x591A;&#x7684;&#x95EE;&#x9898;&#x4E00;&#x6837;&#x7B80;&#x5355;&#x3002;&#x4F46;&#x662F;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x63CF;&#x8FF0;&#x8FD9;&#x79CD;&#x73B0;&#x8C61;&#x7684;&#x4EFB;&#x4F55;&#x6A21;&#x578B;&#x6700;&#x7EC8;&#x90FD;&#x662F;&#x6CC4;&#x6F0F;&#x62BD;&#x8C61;&#x7684;&#xFF08;leaky abstraction)&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x662F;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6F0F;&#x6D1E;&#xFF1A;&#x5728;&#x7406;&#x60F3;&#x7684;&#x4E16;&#x754C;&#x4E2D;&#xFF0C;&#x6BCF;&#x6B21;&#x514B;&#x9686;&#x81EA;&#x5DF1;&#x65F6;&#xFF0C;&#x4F60;&#x8FD8;&#x4F1A;&#x590D;&#x5236;&#x786C;&#x4EF6;&#x5904;&#x7406;&#x5668;&#x6765;&#x8FD0;&#x884C;&#x8BE5;&#x514B;&#x9686;&#x3002;&#x4F46;&#x5F53;&#x7136;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5; - &#x4F60;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x53EF;&#x80FD;&#x6709;&#x56DB;&#x4E2A;&#x6216;&#x516B;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF08;&#x901A;&#x5E38;&#x5728;&#x5199;&#x5165;&#x65F6;&#xFF09;&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x66F4;&#x591A;&#xFF0C;&#x5E76;&#x4E14;&#x4ECD;&#x6709;&#x8BB8;&#x591A;&#x60C5;&#x51B5;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x3002;&#x5728;&#x62BD;&#x8C61;&#x7684;&#x8BA8;&#x8BBA;&#x4E2D;&#xFF0C;&#x7269;&#x7406;&#x5904;&#x7406;&#x5668;&#x7684;&#x5206;&#x914D;&#x65B9;&#x5F0F;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x6CC4;&#x6F0F;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x652F;&#x914D;&#x4F60;&#x7684;&#x51B3;&#x7B56;</p>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x5728;&#x79D1;&#x5E7B;&#x7535;&#x5F71;&#x4E2D;&#x6539;&#x53D8;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#x3002;&#x73B0;&#x5728;&#x5F53;&#x6BCF;&#x4E2A;&#x514B;&#x9686;&#x641C;&#x7D22;&#x8005;&#x6700;&#x7EC8;&#x5230;&#x8FBE;&#x4E00;&#x6247;&#x95E8;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x5FC5;&#x987B;&#x6572;&#x95E8;&#x5E76;&#x7B49;&#x5230;&#x6709;&#x4EBA;&#x56DE;&#x7B54;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6BCF;&#x4E2A;&#x641C;&#x7D22;&#x8005;&#x6709;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x8FD9;&#x6CA1;&#x6709;&#x95EE;&#x9898; - &#x5904;&#x7406;&#x5668;&#x53EA;&#x662F;&#x7A7A;&#x95F2;&#xFF0C;&#x76F4;&#x5230;&#x95E8;&#x88AB;&#x56DE;&#x7B54;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x53EA;&#x6709;8&#x4E2A;&#x5904;&#x7406;&#x5668;&#x548C;&#x6570;&#x5343;&#x4E2A;&#x641C;&#x7D22;&#x8005;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5E0C;&#x671B;&#x5904;&#x7406;&#x5668;&#x4EC5;&#x4EC5;&#x56E0;&#x4E3A;&#x67D0;&#x4E2A;&#x641C;&#x7D22;&#x8005;&#x6070;&#x597D;&#x5728;&#x7B49;&#x5F85;&#x56DE;&#x7B54;&#x4E2D;&#x88AB;&#x9501;&#x4F4F;&#x800C;&#x95F2;&#x7F6E;&#x4E0B;&#x6765;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5C06;&#x5904;&#x7406;&#x5668;&#x5E94;&#x7528;&#x4E8E;&#x53EF;&#x4EE5;&#x771F;&#x6B63;&#x6267;&#x884C;&#x5DE5;&#x4F5C;&#x7684;&#x641C;&#x7D22;&#x8005;&#x8EAB;&#x4E0A;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x5C06;&#x5904;&#x7406;&#x5668;&#x4ECE;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x5207;&#x6362;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x673A;&#x5236;&#x3002;</p>
<p>&#x8BB8;&#x591A;&#x6A21;&#x578B;&#x80FD;&#x591F;&#x6709;&#x6548;&#x5730;&#x9690;&#x85CF;&#x5904;&#x7406;&#x5668;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x4F60;&#x5047;&#x88C5;&#x4F60;&#x7684;&#x6570;&#x91CF;&#x975E;&#x5E38;&#x5927;&#x3002;&#x4F46;&#x662F;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4F1A;&#x53D1;&#x751F;&#x6545;&#x969C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x77E5;&#x9053;&#x5904;&#x7406;&#x5668;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x4EE5;&#x4FBF;&#x4F60;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6700;&#x5927;&#x7684;&#x5F71;&#x54CD;&#x53D6;&#x51B3;&#x4E8E;&#x4F60;&#x662F;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x8FD8;&#x662F;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x3002;&#x5982;&#x679C;&#x4F60;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x90A3;&#x4E48;&#x4EFB;&#x52A1;&#x5207;&#x6362;&#x7684;&#x6210;&#x672C;&#x4E5F;&#x7531;&#x8BE5;&#x5904;&#x7406;&#x5668;&#x627F;&#x62C5;&#xFF0C;&#x5C06;&#x5E76;&#x53D1;&#x6280;&#x672F;&#x5E94;&#x7528;&#x4E8E;&#x4F60;&#x7684;&#x7CFB;&#x7EDF;&#x4F1A;&#x4F7F;&#x5B83;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x6162;&#x3002;</p>
<p>&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x8BA9;&#x4F60;&#x8BA4;&#x4E3A;&#xFF0C;&#x5728;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7F16;&#x5199;&#x5E76;&#x53D1;&#x4EE3;&#x7801;&#x65F6;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E76;&#x53D1;&#x6A21;&#x578B;&#x4F1A;&#x4EA7;&#x751F;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4E3A;&#x4E86;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#x503C;&#x5F97;&#x8BA9;&#x5B83;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x6162;&#x3002;</p>
<p>&#x5728;&#x514B;&#x9686;&#x4F53;&#x6572;&#x95E8;&#x7B49;&#x5F85;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5373;&#x4F7F;&#x5355;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E5F;&#x80FD;&#x4ECE;&#x5E76;&#x53D1;&#x4E2D;&#x53D7;&#x76CA;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x53EF;&#x4EE5;&#x4ECE;&#x7B49;&#x5F85;&#xFF08;&#x963B;&#x585E;&#xFF09;&#x7684;&#x4EFB;&#x52A1;&#x5207;&#x6362;&#x5230;&#x51C6;&#x5907;&#x597D;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x90FD;&#x53EF;&#x4EE5;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#x90A3;&#x4E48;&#x5207;&#x6362;&#x7684;&#x6210;&#x672C;&#x53CD;&#x800C;&#x4F1A;&#x4F7F;&#x4EFB;&#x52A1;&#x53D8;&#x6162;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6709;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x53D1;&#x901A;&#x5E38;&#x53EA;&#x4F1A;&#x6709;&#x610F;&#x4E49;&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x4F60;&#x6B63;&#x5728;&#x5C1D;&#x8BD5;&#x7834;&#x89E3;&#x67D0;&#x79CD;&#x5BC6;&#x7801;&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x5185;&#x53C2;&#x4E0E;&#x7834;&#x89E3;&#x7684;&#x7EBF;&#x7A0B;&#x8D8A;&#x591A;&#xFF0C;&#x4F60;&#x8D8A;&#x5FEB;&#x5F97;&#x5230;&#x7B54;&#x6848;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x5C31;&#x8D8A;&#x5927;&#x3002;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x80FD;&#x6301;&#x7EED;&#x4F7F;&#x7528;&#x4F60;&#x6240;&#x5206;&#x914D;&#x7684;&#x5904;&#x7406;&#x5668;&#x65F6;&#x95F4;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF08;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x7EA6;&#x675F;&#x95EE;&#x9898;&#xFF09;&#xFF0C;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x5206;&#x914D;&#x7684;&#x7EBF;&#x7A0B;&#x6570;&#x5E94;&#x8BE5;&#x548C;&#x4F60;&#x62E5;&#x6709;&#x7684;&#x5904;&#x7406;&#x5668;&#x7684;&#x6570;&#x91CF;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;</p>
<p>&#x5728;&#x63A5;&#x542C;&#x7535;&#x8BDD;&#x7684;&#x5BA2;&#x6237;&#x670D;&#x52A1;&#x90E8;&#x95E8;&#xFF0C;&#x4F60;&#x53EA;&#x6709;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x5458;&#x5DE5;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x7684;&#x90E8;&#x95E8;&#x53EF;&#x80FD;&#x4F1A;&#x6536;&#x5230;&#x5F88;&#x591A;&#x7535;&#x8BDD;&#x3002;&#x8FD9;&#x4E9B;&#x5458;&#x5DE5;&#xFF08;&#x5904;&#x7406;&#x5668;&#xFF09;&#x4E00;&#x6B21;&#x53EA;&#x80FD;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x7535;&#x8BDD;&#xFF0C;&#x76F4;&#x5230;&#x5B8C;&#x6210;&#xFF0C;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;&#x989D;&#x5916;&#x7684;&#x7535;&#x8BDD;&#x5FC5;&#x987B;&#x6392;&#x961F;&#x3002;</p>
<p>&#x5728;&#x201C;&#x978B;&#x5320;&#x548C;&#x7CBE;&#x7075;&#x201D;&#x7684;&#x7AE5;&#x8BDD;&#x6545;&#x4E8B;&#x4E2D;&#xFF0C;&#x978B;&#x5320;&#x6709;&#x5F88;&#x591A;&#x5DE5;&#x4F5C;&#x8981;&#x505A;&#xFF0C;&#x5F53;&#x4ED6;&#x7761;&#x7740;&#x65F6;&#xFF0C;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x7FA4;&#x7CBE;&#x7075;&#x6765;&#x4E3A;&#x4ED6;&#x5236;&#x4F5C;&#x978B;&#x5B50;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x5DE5;&#x4F5C;&#x662F;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#xFF0C;&#x4F46;&#x5373;&#x4F7F;&#x4F7F;&#x7528;&#x5927;&#x91CF;&#x7684;&#x7269;&#x7406;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x5728;&#x5236;&#x9020;&#x978B;&#x5B50;&#x7684;&#x67D0;&#x4E9B;&#x90E8;&#x4EF6;&#x65F6;&#x4E5F;&#x4F1A;&#x4EA7;&#x751F;&#x9650;&#x5236; - &#x4F8B;&#x5982;&#xFF0C;&#x978B;&#x5E95;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;&#x65F6;&#x95F4;&#x53BB;&#x5236;&#x4F5C;&#xFF0C;&#x8FD9;&#x4F1A;&#x9650;&#x5236;&#x5236;&#x978B;&#x7684;&#x901F;&#x5EA6;&#x5E76;&#x6539;&#x53D8;&#x4F60;&#x8BBE;&#x8BA1;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x5C1D;&#x8BD5;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x9A71;&#x52A8;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x8BBE;&#x8BA1;&#x3002;&#x6709;&#x4E00;&#x4E2A;&#x8FF7;&#x4EBA;&#x7684;&#x62BD;&#x8C61;&#x90A3;&#x5C31;&#x662F;&#x5C06;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5206;&#x89E3;&#x4E3A;&#x5B50;&#x95EE;&#x9898;&#x5E76;&#x4E14;&#x8BA9;&#x5B83;&#x4EEC;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x662F;&#x8D64;&#x88F8;&#x88F8;&#x7684;&#x73B0;&#x5B9E;&#x3002;&#x7269;&#x7406;&#x73B0;&#x5B9E;&#x4E00;&#x6B21;&#x53C8;&#x4E00;&#x6B21;&#x5730;&#x6253;&#x4E86;&#x8FD9;&#x79CD;&#x62BD;&#x8C61;&#x7684;&#x8138;&#x3002;</p>
<p>&#x8FD9;&#x53EA;&#x662F;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x8003;&#x8651;&#x4E00;&#x4E2A;&#x5236;&#x4F5C;&#x86CB;&#x7CD5;&#x7684;&#x5DE5;&#x5382;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x77E5;&#x4F55;&#x6545;&#x5728;&#x5DE5;&#x4EBA;&#x4E2D;&#x5206;&#x53D1;&#x4E86;&#x86CB;&#x7CD5;&#x5236;&#x4F5C;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x662F;&#x73B0;&#x5728;&#x662F;&#x65F6;&#x5019;&#x8BA9;&#x5DE5;&#x4EBA;&#x628A;&#x86CB;&#x7CD5;&#x653E;&#x5728;&#x76D2;&#x5B50;&#x91CC;&#x4E86;&#x3002;&#x90A3;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x76D2;&#x5B50;&#xFF0C;&#x51C6;&#x5907;&#x5B58;&#x653E;&#x86CB;&#x7CD5;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x5DE5;&#x4EBA;&#x5C06;&#x86CB;&#x7CD5;&#x653E;&#x5165;&#x76D2;&#x5B50;&#x4E4B;&#x524D;&#xFF0C;&#x53E6;&#x4E00;&#x540D;&#x5DE5;&#x4EBA;&#x6295;&#x5165;&#x5E76;&#x5C06;&#x86CB;&#x7CD5;&#x653E;&#x5165;&#x76D2;&#x5B50;&#x4E2D;&#xFF01;&#x6211;&#x4EEC;&#x7684;&#x5DE5;&#x4EBA;&#x5DF2;&#x7ECF;&#x628A;&#x86CB;&#x7CD5;&#x653E;&#x8FDB;&#x53BB;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x5F00;&#x59CB;&#x4E86;&#xFF01;&#x8FD9;&#x4E24;&#x4E2A;&#x86CB;&#x7CD5;&#x88AB;&#x7838;&#x788E;&#x5E76;&#x6BC1;&#x4E86;&#x3002;&#x8FD9;&#x662F;&#x5E38;&#x89C1;&#x7684;&#x201C;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x201D;&#x95EE;&#x9898;&#xFF0C;&#x4EA7;&#x751F;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x53D6;&#x51B3;&#x4E8E;&#x54EA;&#x4E2A;&#x5DE5;&#x4F5C;&#x4EBA;&#x5458;&#x53EF;&#x4EE5;&#x9996;&#x5148;&#x5C06;&#x86CB;&#x7CD5;&#x653E;&#x5165;&#x76D2;&#x5B50;&#x4E2D;&#xFF08;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x9501;&#x673A;&#x5236;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x4EBA;&#x5458;&#x53EF;&#x4EE5;&#x5148;&#x62FF;&#x5230;&#x76D2;&#x5B50;&#x5E76;&#x9632;&#x6B62;&#x86CB;&#x7CD5;&#x88AB;&#x7838;&#x70C2;&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x201C;&#x540C;&#x65F6;&#x201D;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x76F8;&#x4E92;&#x5E72;&#x6270;&#x65F6;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x4EE5;&#x5982;&#x6B64;&#x5FAE;&#x5999;&#x548C;&#x5076;&#x7136;&#x7684;&#x65B9;&#x5F0F;&#x53D1;&#x751F;&#xFF0C;&#x53EF;&#x80FD;&#x516C;&#x5E73;&#x5730;&#x8BF4;&#xFF0C;&#x5E76;&#x53D1;&#x6027;&#x201C;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x786E;&#x5B9A;&#x6027;&#x7684;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x975E;&#x786E;&#x5B9A;&#x6027;&#x7684;&#x3002;&#x201D;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5047;&#x8BBE;&#x7F16;&#x5199;&#x901A;&#x8FC7;&#x7EF4;&#x62A4;&#x548C;&#x4EE3;&#x7801;&#x68C0;&#x67E5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7F16;&#x5199;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x4F3C;&#x4E4E;&#x90FD;&#x80FD;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x9002;&#x5F53;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x5C06;&#x4F1A;&#x5931;&#x8D25;&#x3002;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#xFF0C;&#x6216;&#x8005;&#x5728;&#x4F60;&#x5728;&#x6D4B;&#x8BD5;&#x671F;&#x95F4;&#x51E0;&#x4E4E;&#x5F88;&#x96BE;&#x53D1;&#x73B0;&#x5B83;&#x4EEC;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x7F16;&#x5199;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x901A;&#x5E38;&#x65E0;&#x6CD5;&#x4E3A;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x751F;&#x6210;&#x6545;&#x969C;&#x6761;&#x4EF6;&#x3002;&#x7531;&#x6B64;&#x4EA7;&#x751F;&#x7684;&#x5931;&#x8D25;&#x53EA;&#x4F1A;&#x5076;&#x5C14;&#x53D1;&#x751F;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x4EE5;&#x5BA2;&#x6237;&#x6295;&#x8BC9;&#x7684;&#x5F62;&#x5F0F;&#x51FA;&#x73B0;&#x3002;<br>
&#x8FD9;&#x662F;&#x5B66;&#x4E60;&#x5E76;&#x53D1;&#x4E2D;&#x6700;&#x5F3A;&#x6709;&#x529B;&#x7684;&#x8BBA;&#x70B9;&#x4E4B;&#x4E00;&#xFF1A;&#x5982;&#x679C;&#x4F60;&#x5FFD;&#x7565;&#x5B83;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x53D7;&#x4F24;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x5E76;&#x53D1;&#x4F3C;&#x4E4E;&#x5145;&#x6EE1;&#x4E86;&#x5371;&#x9669;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x8BA9;&#x4F60;&#x6709;&#x70B9;&#x5BB3;&#x6015;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4EF6;&#x597D;&#x4E8B;&#x3002;&#x5C3D;&#x7BA1;Java 8&#x5728;&#x5E76;&#x53D1;&#x6027;&#x65B9;&#x9762;&#x505A;&#x51FA;&#x4E86;&#x5F88;&#x5927;&#x6539;&#x8FDB;&#xFF0C;&#x4F46;&#x4ECD;&#x7136;&#x6CA1;&#x6709;&#x50CF;&#x7F16;&#x8BD1;&#x65F6;&#x9A8C;&#x8BC1;(compile-time verification)&#x6216;&#x53D7;&#x68C0;&#x67E5;&#x7684;&#x5F02;&#x5E38;(checked exceptions)&#x90A3;&#x6837;&#x7684;&#x5B89;&#x5168;&#x7F51;&#x6765;&#x544A;&#x8BC9;&#x4F60;&#x4F55;&#x65F6;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#x3002;&#x901A;&#x8FC7;&#x5E76;&#x53D1;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x4F9D;&#x9760;&#x81EA;&#x5DF1;&#xFF0C;&#x53EA;&#x6709;&#x77E5;&#x8BC6;&#x6E0A;&#x535A;&#xFF0C;&#x4FDD;&#x6301;&#x6000;&#x7591;&#x548C;&#x79EF;&#x6781;&#x8FDB;&#x53D6;&#x7684;&#x4EBA;&#xFF0C;&#x624D;&#x80FD;&#x7528;Java&#x7F16;&#x5199;&#x53EF;&#x9760;&#x7684;&#x5E76;&#x53D1;&#x4EE3;&#x7801;&#x3002;</p>
<h2 class="mume-header" id="%E5%B9%B6%E5%8F%91%E4%B8%BA%E9%80%9F%E5%BA%A6%E8%80%8C%E7%94%9F">&#x5E76;&#x53D1;&#x4E3A;&#x901F;&#x5EA6;&#x800C;&#x751F;</h2>

<p>&#x5728;&#x542C;&#x8BF4;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x95EE;&#x9898;&#x4E4B;&#x540E;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x60F3;&#x77E5;&#x9053;&#x5B83;&#x662F;&#x5426;&#x503C;&#x5F97;&#x8FD9;&#x4E48;&#x9EBB;&#x70E6;&#x3002;&#x7B54;&#x6848;&#x662F;&#x201C;&#x4E0D;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x4E0D;&#x591F;&#x5FEB;&#x3002;&#x201D;&#x5E76;&#x4E14;&#x5728;&#x51B3;&#x5B9A;&#x7528;&#x5B83;&#x4E4B;&#x524D;&#x4F60;&#x4F1A;&#x60F3;&#x8981;&#x4ED4;&#x7EC6;&#x601D;&#x8003;&#x3002;&#x4E0D;&#x8981;&#x968F;&#x4FBF;&#x8DF3;&#x8FDB;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x60B2;&#x75DB;&#x4E4B;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x5728;&#x66F4;&#x5FEB;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C;&#x4F60;&#x53EF;&#x4EE5;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x5206;&#x6790;&#x5E76;&#x53D1;&#x73B0;&#x74F6;&#x9888;&#x5E76;&#x5728;&#x8BE5;&#x4F4D;&#x7F6E;&#x66FF;&#x6362;&#x66F4;&#x5FEB;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x8BF7;&#x6267;&#x884C;&#x6B64;&#x64CD;&#x4F5C;&#x3002;&#x53EA;&#x6709;&#x5728;&#x663E;&#x7136;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x9009;&#x62E9;&#x65F6;&#x624D;&#x5F00;&#x59CB;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#xFF0C;&#x7136;&#x540E;&#x4EC5;&#x5728;&#x5FC5;&#x8981;&#x7684;&#x5730;&#x65B9;&#x53BB;&#x4F7F;&#x7528;&#x5B83;&#x3002;</p>
<p>&#x901F;&#x5EA6;&#x95EE;&#x9898;&#x4E00;&#x5F00;&#x59CB;&#x542C;&#x8D77;&#x6765;&#x5F88;&#x7B80;&#x5355;&#xFF1A;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8981;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x5FEB;&#xFF0C;&#x5C06;&#x5176;&#x5206;&#x89E3;&#x6210;&#x788E;&#x7247;&#x5E76;&#x5728;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x6BCF;&#x4E2A;&#x90E8;&#x5206;&#x3002;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x63D0;&#x9AD8;&#x65F6;&#x949F;&#x901F;&#x5EA6;&#x6D41;&#xFF08;&#x81F3;&#x5C11;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x82AF;&#x7247;&#xFF09;&#xFF0C;&#x901F;&#x5EA6;&#x7684;&#x63D0;&#x9AD8;&#x662F;&#x51FA;&#x73B0;&#x5728;&#x591A;&#x6838;&#x5904;&#x7406;&#x5668;&#x7684;&#x5F62;&#x5F0F;&#x800C;&#x4E0D;&#x662F;&#x66F4;&#x5FEB;&#x7684;&#x82AF;&#x7247;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x5FEB;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5B66;&#x4F1A;&#x5982;&#x4F55;&#x5229;&#x7528;&#x90A3;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x8FD9;&#x662F;&#x5E76;&#x53D1;&#x6027;&#x7ED9;&#x4F60;&#x7684;&#x4E00;&#x4E2A;&#x5EFA;&#x8BAE;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x591A;&#x5904;&#x7406;&#x5668;&#x673A;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E9B;&#x5904;&#x7406;&#x5668;&#x4E4B;&#x95F4;&#x5206;&#x914D;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x53EF;&#x4EE5;&#x663E;&#x7740;&#x63D0;&#x9AD8;&#x541E;&#x5410;&#x91CF;&#x3002;&#x5F3A;&#x5927;&#x7684;&#x591A;&#x5904;&#x7406;&#x5668;Web&#x670D;&#x52A1;&#x5668;&#x901A;&#x5E38;&#x5C31;&#x662F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x4E3A;CPU&#x5206;&#x914D;&#x5927;&#x91CF;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#xFF0C;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x5E76;&#x53D1;&#x6027;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x5728;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x7684;&#x6027;&#x80FD;&#x3002;&#x8FD9;&#x542C;&#x8D77;&#x6765;&#x6709;&#x70B9;&#x8FDD;&#x53CD;&#x76F4;&#x89C9;&#x3002;&#x5982;&#x679C;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#xFF0C;&#x7531;&#x4E8E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x7684;&#x6210;&#x672C;&#x589E;&#x52A0;&#xFF08;&#x4ECE;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x66F4;&#x6539;&#x4E3A;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF09;&#xFF0C;&#x5728;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x5B9E;&#x9645;&#x4E0A;&#x5E94;&#x8BE5;&#x6BD4;&#x7A0B;&#x5E8F;&#x7684;&#x6240;&#x6709;&#x90E8;&#x5206;&#x987A;&#x5E8F;&#x8FD0;&#x884C;&#x5177;&#x6709;&#x66F4;&#x591A;&#x7684;&#x5F00;&#x9500;&#x3002;&#x5728;&#x8868;&#x9762;&#x4E0A;&#xFF0C;&#x5C06;&#x7A0B;&#x5E8F;&#x7684;&#x6240;&#x6709;&#x90E8;&#x5206;&#x4F5C;&#x4E3A;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x8FD0;&#x884C;&#x5E76;&#x8282;&#x7701;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x7684;&#x6210;&#x672C;&#x4F3C;&#x4E4E;&#x66F4;&#x4FBF;&#x5B9C;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x4EA7;&#x751F;&#x5F71;&#x54CD;&#x7684;&#x95EE;&#x9898;&#x662F;&#x963B;&#x585E;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x7531;&#x4E8E;&#x7A0B;&#x5E8F;&#x63A7;&#x5236;&#x4E4B;&#x5916;&#x7684;&#x67D0;&#x4E9B;&#x6761;&#x4EF6;&#xFF08;&#x901A;&#x5E38;&#x662F;I/O&#xFF09;&#x800C;&#x65E0;&#x6CD5;&#x7EE7;&#x7EED;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x8BF4;&#x4EFB;&#x52A1;&#x6216;&#x7EBF;&#x7A0B;&#x963B;&#x585E;&#xFF08;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x79D1;&#x5E7B;&#x6545;&#x4E8B;&#x4E2D;&#xFF0C;&#x514B;&#x9686;&#x4F53;&#x5DF2;&#x6572;&#x95E8;&#x800C;&#x4E14;&#x662F;&#x7B49;&#x5F85;&#x5B83;&#x6253;&#x5F00;&#xFF09;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x5C31;&#x4F1A;&#x505C;&#x6B62;&#xFF0C;&#x76F4;&#x5230;&#x5916;&#x90E8;&#x6761;&#x4EF6;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x7F16;&#x5199;&#x7A0B;&#x5E8F;&#xFF0C;&#x5219;&#x5F53;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x88AB;&#x963B;&#x6B62;&#x65F6;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x7A0B;&#x5E8F;&#x7EE7;&#x7EED;&#x5411;&#x524D;&#x79FB;&#x52A8;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x4ECE;&#x6027;&#x80FD;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x5728;&#x5355;&#x5904;&#x7406;&#x5668;&#x673A;&#x5668;&#x4E0A;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;&#xFF0C;&#x9664;&#x975E;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x53EF;&#x80FD;&#x963B;&#x585E;&#x3002;</p>
<p>&#x5355;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#x6027;&#x80FD;&#x6539;&#x8FDB;&#x7684;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x4F8B;&#x5B50;&#x662F;&#x4E8B;&#x4EF6;&#x9A71;&#x52A8;&#x7F16;&#x7A0B;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x7528;&#x6237;&#x754C;&#x9762;&#x7F16;&#x7A0B;&#x3002;&#x8003;&#x8651;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x4ECE;&#x800C;&#x6700;&#x7EC8;&#x5FFD;&#x7565;&#x7528;&#x6237;&#x8F93;&#x5165;&#x548C;&#x65E0;&#x54CD;&#x5E94;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6709;&#x4E00;&#x4E2A;&#x201C;&#x9000;&#x51FA;&#x201D;&#x6309;&#x94AE;&#xFF0C;&#x4F60;&#x4E0D;&#x60F3;&#x5728;&#x4F60;&#x7F16;&#x5199;&#x7684;&#x6BCF;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#x8F6E;&#x8BE2;&#x5B83;&#x3002;&#x8FD9;&#x4F1A;&#x4EA7;&#x751F;&#x7B28;&#x62D9;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x4F1A;&#x5FD8;&#x8BB0;&#x6267;&#x884C;&#x68C0;&#x67E5;&#x3002;&#x6CA1;&#x6709;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x751F;&#x6210;&#x54CD;&#x5E94;&#x5F0F;&#x7528;&#x6237;&#x754C;&#x9762;&#x7684;&#x552F;&#x4E00;&#x65B9;&#x6CD5;&#x662F;&#x8BA9;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x5B9A;&#x671F;&#x68C0;&#x67E5;&#x7528;&#x6237;&#x8F93;&#x5165;&#x3002;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x5355;&#x72EC;&#x7684;&#x6267;&#x884C;&#x7EBF;&#x7A0B;&#x6765;&#x54CD;&#x5E94;&#x7528;&#x6237;&#x8F93;&#x5165;&#xFF0C;&#x8BE5;&#x7A0B;&#x5E8F;&#x4FDD;&#x8BC1;&#x4E86;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x7684;&#x54CD;&#x5E94;&#x3002;</p>
<p>&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x7684;&#x76F4;&#x63A5;&#x65B9;&#x6CD5;&#x662F;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7EA7;&#x522B;&#xFF0C;&#x4F7F;&#x7528;&#x4E0E;&#x7EBF;&#x7A0B;&#x4E0D;&#x540C;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x8FDB;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5185;&#x8FD0;&#x884C;&#x7684;&#x81EA;&#x5305;&#x542B;&#x7A0B;&#x5E8F;&#x3002;&#x8FDB;&#x7A0B;&#x5F88;&#x6709;&#x5438;&#x5F15;&#x529B;&#xFF0C;&#x56E0;&#x4E3A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x901A;&#x5E38;&#x5C06;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E0E;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x9694;&#x79BB;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x76F8;&#x4E92;&#x5E72;&#x6270;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x76F8;&#x5BF9;&#x5BB9;&#x6613;&#x3002;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x548C;I/O&#x7B49;&#x8D44;&#x6E90;&#xFF0C;&#x56E0;&#x6B64;&#x7F16;&#x5199;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x65F6;&#x9047;&#x5230;&#x7684;&#x56F0;&#x96BE;&#x662F;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x9A71;&#x52A8;&#x7684;&#x4EFB;&#x52A1;&#x4E4B;&#x95F4;&#x534F;&#x8C03;&#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#xFF0C;&#x4E00;&#x6B21;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x8BBF;&#x95EE;&#x5B83;&#x4EEC;&#x3002;</p>
<p>&#x6709;&#x4E9B;&#x4EBA;&#x751A;&#x81F3;&#x63D0;&#x5021;&#x5C06;&#x8FDB;&#x7A0B;&#x4F5C;&#x4E3A;&#x5E76;&#x53D1;&#x7684;&#x552F;&#x4E00;&#x5408;&#x7406;&#x65B9;&#x6CD5;<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>&#xFF0C;&#x4F46;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x901A;&#x5E38;&#x5B58;&#x5728;&#x6570;&#x91CF;&#x548C;&#x5F00;&#x9500;&#x9650;&#x5236;&#xFF0C;&#x4ECE;&#x800C;&#x963B;&#x6B62;&#x4E86;&#x5728;&#x5E76;&#x53D1;&#x8303;&#x56F4;&#x5185;&#x7684;&#x9002;&#x7528;&#x6027;&#xFF08;&#x6700;&#x7EC8;&#x4F60;&#x4F1A;&#x4E60;&#x60EF;&#x6807;&#x51C6;&#x7684;&#x5E76;&#x53D1;&#x9650;&#x5236;&#xFF0C;&#x201C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x9002;&#x7528;&#x4E8E;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4F46;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x201D;&#xFF09;</p>
<p>&#x4E00;&#x4E9B;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x65E8;&#x5728;&#x5C06;&#x5E76;&#x53D1;&#x4EFB;&#x52A1;&#x5F7C;&#x6B64;&#x9694;&#x79BB;&#x3002;&#x8FD9;&#x4E9B;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;_&#x51FD;&#x6570;&#x5F0F;&#x8BED;&#x8A00;_&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E0D;&#x4EA7;&#x751F;&#x5176;&#x4ED6;&#x5F71;&#x54CD;&#xFF08;&#x56E0;&#x6B64;&#x4E0D;&#x80FD;&#x4E0E;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x5E72;&#x6D89;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x72EC;&#x7ACB;&#x7684;&#x4EFB;&#x52A1;&#x6765;&#x9A71;&#x52A8;&#x3002;Erlang&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x8BED;&#x8A00;&#xFF0C;&#x5B83;&#x5305;&#x62EC;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x4E0E;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#x5B89;&#x5168;&#x673A;&#x5236;&#x3002;&#x5982;&#x679C;&#x4F60;&#x53D1;&#x73B0;&#x7A0B;&#x5E8F;&#x7684;&#x67D0;&#x4E00;&#x90E8;&#x5206;&#x5FC5;&#x987B;&#x5927;&#x91CF;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x6027;&#x5E76;&#x4E14;&#x4F60;&#x5728;&#x5C1D;&#x8BD5;&#x6784;&#x5EFA;&#x8BE5;&#x90E8;&#x5206;&#x65F6;&#x9047;&#x5230;&#x4E86;&#x8FC7;&#x591A;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x4E13;&#x7528;&#x5E76;&#x53D1;&#x8BED;&#x8A00;&#x521B;&#x5EFA;&#x7A0B;&#x5E8F;&#x7684;&#x90A3;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<p>Java&#x91C7;&#x7528;&#x4E86;&#x66F4;&#x4F20;&#x7EDF;&#x7684;&#x65B9;&#x6CD5;<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>&#xFF0C;&#x5373;&#x5728;&#x987A;&#x5E8F;&#x8BED;&#x8A00;&#x4E4B;&#x4E0A;&#x6DFB;&#x52A0;&#x5BF9;&#x7EBF;&#x7A0B;&#x7684;&#x652F;&#x6301;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x591A;&#x4EFB;&#x52A1;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#x5206;&#x914D;&#x5916;&#x90E8;&#x8FDB;&#x7A0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5355;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4EFB;&#x52A1;&#x4EA4;&#x6362;&#x3002;</p>
<p>&#x5E76;&#x53D1;&#x6027;&#x4F1A;&#x5E26;&#x6765;&#x6210;&#x672C;&#xFF0C;&#x5305;&#x62EC;&#x590D;&#x6742;&#x6027;&#x6210;&#x672C;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#xFF0C;&#x8D44;&#x6E90;&#x5E73;&#x8861;&#x548C;&#x7528;&#x6237;&#x4FBF;&#x5229;&#x6027;&#x7684;&#x6539;&#x8FDB;&#x6765;&#x62B5;&#x6D88;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x5E76;&#x53D1;&#x6027;&#x4F7F;&#x4F60;&#x80FD;&#x591F;&#x521B;&#x5EFA;&#x66F4;&#x52A0;&#x677E;&#x6563;&#x8026;&#x5408;&#x7684;&#x8BBE;&#x8BA1;&#xFF1B;&#x9664;&#x6B64;&#x4EE5;&#x5916;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x7279;&#x522B;&#x5173;&#x6CE8;&#x90A3;&#x4E9B;&#x4F7F;&#x7528;&#x4E86;&#x5E76;&#x53D1;&#x64CD;&#x4F5C;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<h2 class="mume-header" id="%E5%9B%9B%E5%8F%A5%E6%A0%BC%E8%A8%80">&#x56DB;&#x53E5;&#x683C;&#x8A00;</h2>

<p>&#x5728;&#x7ECF;&#x5386;&#x4E86;&#x591A;&#x5E74;&#x7684;Java&#x5E76;&#x53D1;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x603B;&#x7ED3;&#x4E86;&#x4EE5;&#x4E0B;&#x56DB;&#x4E2A;&#x683C;&#x8A00;&#xFF1A;</p>
<blockquote>
<p>1.&#x4E0D;&#x8981;&#x8FD9;&#x6837;&#x505A;</p>
<p>2.&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x662F;&#x771F;&#x7684;&#xFF0C;&#x4E00;&#x5207;&#x53EF;&#x80FD;&#x90FD;&#x6709;&#x95EE;&#x9898;</p>
<p>3.&#x5B83;&#x8D77;&#x4F5C;&#x7528;,&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x6CA1;&#x6709;&#x95EE;&#x9898;</p>
<p>4.&#x4F60;&#x4ECD;&#x7136;&#x5FC5;&#x987B;&#x7406;&#x89E3;&#x5B83;</p>
</blockquote>
<p>&#x8FD9;&#x4E9B;&#x683C;&#x8A00;&#x4E13;&#x95E8;&#x9488;&#x5BF9;Java&#x7684;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x95EE;&#x9898;&#xFF0C;&#x5C3D;&#x7BA1;&#x5B83;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x9002;&#x7528;&#x4E8E;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x8BED;&#x8A00;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x786E;&#x5B9E;&#x5B58;&#x5728;&#x65E8;&#x5728;&#x9632;&#x6B62;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x7684;&#x8BED;&#x8A00;&#x3002;</p>
<h3 class="mume-header" id="1%E4%B8%8D%E8%A6%81%E8%BF%99%E6%A0%B7%E5%81%9A">1.&#x4E0D;&#x8981;&#x8FD9;&#x6837;&#x505A;</h3>

<p>&#xFF08;&#x4E0D;&#x8981;&#x81EA;&#x5DF1;&#x52A8;&#x624B;&#xFF09;</p>
<p>&#x907F;&#x514D;&#x7EA0;&#x7F20;&#x4E8E;&#x5E76;&#x53D1;&#x4EA7;&#x751F;&#x7684;&#x6DF1;&#x5C42;&#x95EE;&#x9898;&#x7684;&#x6700;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x4E0D;&#x8981;&#x8FD9;&#x6837;&#x505A;&#x3002;&#x867D;&#x7136;&#x5B83;&#x662F;&#x8BF1;&#x4EBA;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x505A;&#x4E00;&#x4E9B;&#x7B80;&#x5355;&#x7684;&#x4E8B;&#x60C5;&#x65F6;&#x4F3C;&#x4E4E;&#x8DB3;&#x591F;&#x5B89;&#x5168;&#xFF0C;&#x4F46;&#x5B83;&#x5B58;&#x5728;&#x65E0;&#x6570;&#x3001;&#x5FAE;&#x5999;&#x7684;&#x9677;&#x9631;&#x3002;&#x5982;&#x679C;&#x4F60;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5B83;&#xFF0C;&#x4F60;&#x7684;&#x751F;&#x6D3B;&#x4F1A;&#x66F4;&#x5BB9;&#x6613;&#x3002;</p>
<p>&#x8BC1;&#x660E;&#x5E76;&#x53D1;&#x6027;&#x7684;&#x552F;&#x4E00;&#x56E0;&#x7D20;&#x662F;&#x901F;&#x5EA6;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x4E0D;&#x591F;&#x5FEB; - &#x5728;&#x8FD9;&#x91CC;&#x8981;&#x5C0F;&#x5FC3;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x662F;&#x5E0C;&#x671B;&#x5B83;&#x8FD0;&#x884C;&#x5F97;&#x66F4;&#x5FEB;&#x662F;&#x4E0D;&#x5408;&#x7406;&#x7684; - &#x5E94;&#x8BE5;&#x9996;&#x5148;&#x7528;&#x4E00;&#x4E2A;&#x5206;&#x6790;&#x5668;&#xFF08;&#x53C2;&#x89C1;&#x4EE3;&#x7801;&#x6821;&#x9A8C;&#x7AE0;&#x4E2D;&#x5206;&#x6790;&#x548C;&#x4F18;&#x5316;&#xFF09;&#x6765;&#x53D1;&#x73B0;&#x4F60;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x4F18;&#x5316;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x88AB;&#x8FEB;&#x8FDB;&#x884C;&#x5E76;&#x53D1;&#xFF0C;&#x8BF7;&#x91C7;&#x53D6;&#x6700;&#x7B80;&#x5355;&#xFF0C;&#x6700;&#x5B89;&#x5168;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;&#x4F7F;&#x7528;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5E93;&#x5E76;&#x5C3D;&#x53EF;&#x80FD;&#x5C11;&#x5730;&#x7F16;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x6709;&#x4E86;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x5C31;&#x6CA1;&#x6709;&#x201C;&#x592A;&#x7B80;&#x5355;&#x4E86;&#x201D;&#x3002;&#x81EA;&#x8D1F;&#x624D;&#x662F;&#x4F60;&#x7684;&#x654C;&#x4EBA;&#x3002;</p>
<h3 class="mume-header" id="2%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%9C%9F%E7%9A%84%E4%B8%80%E5%88%87%E5%8F%AF%E8%83%BD%E9%83%BD%E6%9C%89%E9%97%AE%E9%A2%98">2.&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x662F;&#x771F;&#x7684;&#xFF0C;&#x4E00;&#x5207;&#x53EF;&#x80FD;&#x90FD;&#x6709;&#x95EE;&#x9898;</h3>

<p>&#x6CA1;&#x6709;&#x5E76;&#x53D1;&#x6027;&#x7684;&#x7F16;&#x7A0B;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x4F60;&#x7684;&#x4E16;&#x754C;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x987A;&#x5E8F;&#x548C;&#x4E00;&#x81F4;&#x6027;&#x3002;&#x901A;&#x8FC7;&#x7B80;&#x5355;&#x5730;&#x5C06;&#x53D8;&#x91CF;&#x8D4B;&#x503C;&#x7ED9;&#x67D0;&#x4E2A;&#x503C;&#xFF0C;&#x5F88;&#x660E;&#x663E;&#x5B83;&#x5E94;&#x8BE5;&#x59CB;&#x7EC8;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x5728;&#x5E76;&#x53D1;&#x9886;&#x57DF;&#xFF0C;&#x6709;&#x4E9B;&#x4E8B;&#x60C5;&#x53EF;&#x80FD;&#x662F;&#x771F;&#x7684;&#x800C;&#x6709;&#x4E9B;&#x4E8B;&#x60C5;&#x5374;&#x4E0D;&#x662F;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x8BA4;&#x4E3A;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x662F;&#x771F;&#x7684;&#x3002;&#x4F60;&#x5FC5;&#x987B;&#x8D28;&#x7591;&#x4E00;&#x5207;&#x3002;&#x5373;&#x4F7F;&#x5C06;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;&#x4E3A;&#x67D0;&#x4E2A;&#x503C;&#x4E5F;&#x53EF;&#x80FD;&#x6216;&#x8005;&#x53EF;&#x80FD;&#x4E0D;&#x4F1A;&#x6309;&#x9884;&#x671F;&#x7684;&#x65B9;&#x5F0F;&#x5DE5;&#x4F5C;&#xFF0C;&#x5E76;&#x4E14;&#x4ECE;&#x90A3;&#x91CC;&#x5F00;&#x59CB;&#x8D70;&#x4E0B;&#x5761;&#x8DEF;&#x3002;&#x5BF9;&#x4E8E;&#x5728;&#x5E76;&#x53D1;&#x4E2D;&#x9047;&#x5230;&#x90A3;&#x4E9B;&#x770B;&#x8D77;&#x6765;&#x6709;&#x6548;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x65E0;&#x6548;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x6211;&#x5DF2;&#x7ECF;&#x5F88;&#x4E60;&#x60EF;&#x4E86;&#x3002;</p>
<p>&#x5728;&#x975E;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F60;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x7684;&#x5404;&#x79CD;&#x4E8B;&#x60C5;&#x5728;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x4E2D;&#x7A81;&#x7136;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x77E5;&#x9053;&#x5904;&#x7406;&#x5668;&#x7F13;&#x5B58;&#x4EE5;&#x53CA;&#x4FDD;&#x6301;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x4E0E;&#x4E3B;&#x5185;&#x5B58;&#x4E00;&#x81F4;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F60;&#x5FC5;&#x987B;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x5BF9;&#x8C61;&#x6784;&#x9020;&#x7684;&#x590D;&#x6742;&#x6027;&#xFF0C;&#x4EE5;&#x4FBF;&#x4F60;&#x7684;&#x6784;&#x9020;&#x5668;&#x4E0D;&#x4F1A;&#x610F;&#x5916;&#x5730;&#x5C06;&#x6570;&#x636E;&#x66B4;&#x9732;&#x7ED9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x66F4;&#x6539;&#x3002;&#x95EE;&#x9898;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x4E3B;&#x9898;&#x592A;&#x590D;&#x6742;&#xFF0C;&#x672C;&#x7AE0;&#x65E0;&#x6CD5;&#x4E3A;&#x4F60;&#x63D0;&#x4F9B;&#x66F4;&#x4E13;&#x4E1A;&#x7684;&#x77E5;&#x8BC6;&#xFF08;&#x518D;&#x6B21;&#x53C2;&#x89C1;Java Concurrency in Practice&#xFF09;&#xFF0C;&#x4F46;&#x4F60;&#x5FC5;&#x987B;&#x4E86;&#x89E3;&#x5B83;&#x4EEC;&#x3002;</p>
<h3 class="mume-header" id="3%E5%AE%83%E8%B5%B7%E4%BD%9C%E7%94%A8%E5%B9%B6%E4%B8%8D%E6%84%8F%E5%91%B3%E7%9D%80%E5%AE%83%E6%B2%A1%E6%9C%89%E9%97%AE%E9%A2%98">3.&#x5B83;&#x8D77;&#x4F5C;&#x7528;,&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x6CA1;&#x6709;&#x95EE;&#x9898;</h3>

<p>&#x6211;&#x4EEC;&#x5F88;&#x5BB9;&#x6613;&#x7F16;&#x5199;&#x51FA;&#x4E00;&#x4E2A;&#x770B;&#x4F3C;&#x5B8C;&#x7F8E;&#x5B9E;&#x5219;&#x6709;&#x95EE;&#x9898;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x5E76;&#x4E14;&#x5F80;&#x5F80;&#x95EE;&#x9898;&#x76F4;&#x5728;&#x6781;&#x7AEF;&#x60C5;&#x51B5;&#x4E0B;&#x624D;&#x66B4;&#x9732;&#x51FA;&#x6765; - &#x5728;&#x7A0B;&#x5E8F;&#x90E8;&#x7F72;&#x540E;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x5730;&#x4F1A;&#x51FA;&#x73B0;&#x7528;&#x6237;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>&#x4F60;&#x4E0D;&#x80FD;&#x8BC1;&#x660E;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#xFF08;&#x6709;&#x65F6;&#xFF09;&#x8BC1;&#x660E;&#x5B83;&#x662F;&#x4E0D;&#x6B63;&#x786E;&#x7684;&#x3002;</li>
<li>&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x4F60;&#x751A;&#x81F3;&#x4E0D;&#x80FD;&#x8FD9;&#x6837;&#x505A;&#xFF1A;&#x5982;&#x679C;&#x5B83;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x68C0;&#x6D4B;&#x5230;&#x5B83;&#x3002;</li>
<li>&#x4F60;&#x901A;&#x5E38;&#x4E0D;&#x80FD;&#x7F16;&#x5199;&#x6709;&#x7528;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x6B64;&#x4F60;&#x5FC5;&#x987B;&#x4F9D;&#x9760;&#x4EE3;&#x7801;&#x68C0;&#x67E5;&#x7ED3;&#x5408;&#x6DF1;&#x5165;&#x7684;&#x5E76;&#x53D1;&#x77E5;&#x8BC6;&#x6765;&#x53D1;&#x73B0;&#x9519;&#x8BEF;&#x3002;</li>
<li>&#x5373;&#x4F7F;&#x662F;&#x6709;&#x6548;&#x7684;&#x7A0B;&#x5E8F;&#x4E5F;&#x53EA;&#x80FD;&#x5728;&#x5176;&#x8BBE;&#x8BA1;&#x53C2;&#x6570;&#x4E0B;&#x5DE5;&#x4F5C;&#x3002;&#x5F53;&#x8D85;&#x51FA;&#x8FD9;&#x4E9B;&#x8BBE;&#x8BA1;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x4F1A;&#x4EE5;&#x67D0;&#x79CD;&#x65B9;&#x5F0F;&#x5931;&#x8D25;&#x3002;</li>
</ul>
<p>&#x5728;&#x5176;&#x4ED6; Java &#x4E3B;&#x9898;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x57F9;&#x517B;&#x4E86;&#x4E00;&#x79CD;&#x611F;&#x89C9;-&#x51B3;&#x5B9A;&#x8BBA;&#x3002;&#x4E00;&#x5207;&#x90FD;&#x6309;&#x7167;&#x8BED;&#x8A00;&#x7684;&#x627F;&#x8BFA;&#xFF08;&#x6216;&#x9690;&#x542B;&#xFF09;&#x8FDB;&#x884C;&#xFF0C;&#x8FD9;&#x662F;&#x4EE4;&#x4EBA;&#x6B23;&#x6170;&#x548C;&#x671F;&#x5F85;&#x7684; - &#x6BD5;&#x7ADF;&#xFF0C;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x7684;&#x76EE;&#x7684;&#x662F;&#x8BA9;&#x673A;&#x5668;&#x505A;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x3002;&#x4ECE;&#x786E;&#x5B9A;&#x6027;&#x7F16;&#x7A0B;&#x7684;&#x4E16;&#x754C;&#x8FDB;&#x5165;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x9886;&#x57DF;&#xFF0C;&#x6211;&#x4EEC;&#x9047;&#x5230;&#x4E86;&#x4E00;&#x79CD;&#x79F0;&#x4E3A;<a href="https://en.wikipedia.org/wiki/Dunning%E2%80%93Kruger_effect">Dunning-Kruger</a>&#x6548;&#x5E94;&#x7684;&#x8BA4;&#x77E5;&#x504F;&#x5DEE;&#xFF0C;&#x53EF;&#x4EE5;&#x6982;&#x62EC;&#x4E3A;&#x201C;&#x65E0;&#x77E5;&#x8005;&#x65E0;&#x754F;&#x3002;&#x201D;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x201C;......&#x76F8;&#x5BF9;&#x4E0D;&#x719F;&#x7EC3;&#x7684;&#x4EBA;&#x62E5;&#x6709;&#x7740;&#x865A;&#x5E7B;&#x7684;&#x4F18;&#x8D8A;&#x611F;&#xFF0C;&#x9519;&#x8BEF;&#x5730;&#x8BC4;&#x4F30;&#x4ED6;&#x4EEC;&#x7684;&#x80FD;&#x529B;&#x8FDC;&#x9AD8;&#x4E8E;&#x5B9E;&#x9645;&#x3002;</p>
<p>&#x6211;&#x81EA;&#x5DF1;&#x7684;&#x7ECF;&#x9A8C;&#x662F;&#xFF0C;&#x65E0;&#x8BBA;&#x4F60;&#x662F;&#x591A;&#x4E48;&#x786E;&#x5B9A;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5B83;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x65E0;&#x6548;&#x4E86;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x4E86;&#x89E3;&#x6240;&#x6709;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x51E0;&#x4E2A;&#x6708;&#x6216;&#x51E0;&#x5E74;&#x540E;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x4E00;&#x4E9B;&#x6982;&#x5FF5;&#x8BA9;&#x4F60;&#x610F;&#x8BC6;&#x5230;&#x4F60;&#x7F16;&#x5199;&#x7684;&#x5927;&#x591A;&#x6570;&#x5185;&#x5BB9;&#x5B9E;&#x9645;&#x4E0A;&#x90FD;&#x5BB9;&#x6613;&#x53D7;&#x5230;&#x5E76;&#x53D1;&#x9519;&#x8BEF;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x5F53;&#x67D0;&#x4E9B;&#x5185;&#x5BB9;&#x4E0D;&#x6B63;&#x786E;&#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x4E0D;&#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x5B83;&#x6B63;&#x786E;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5728;&#x7814;&#x7A76;&#x4EE3;&#x7801;&#x524D;&#x4E86;&#x89E3;&#x6240;&#x6709;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5728;Java&#x7684;&#x6240;&#x6709;&#x975E;&#x5E76;&#x53D1;&#x9886;&#x57DF;&#xFF0C;&#x201C;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x7684;&#x9519;&#x8BEF;&#x548C;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x7684;&#x7F16;&#x8BD1;&#x9519;&#x8BEF;&#x201D;&#x4F3C;&#x4E4E;&#x610F;&#x5473;&#x7740;&#x4E00;&#x5207;&#x90FD;&#x597D;&#x3002;&#x5BF9;&#x4E8E;&#x5E76;&#x53D1;&#xFF0C;&#x5B83;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x610F;&#x4E49;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4F60;&#x6700;&#x7CDF;&#x7CD5;&#x7684;&#x8868;&#x73B0;&#x5C31;&#x662F;&#x201C;&#x81EA;&#x4FE1;&#x201D;&#x3002;</p>
<h3 class="mume-header" id="4%E4%BD%A0%E5%BF%85%E9%A1%BB%E4%BB%8D%E7%84%B6%E7%90%86%E8%A7%A3">4.&#x4F60;&#x5FC5;&#x987B;&#x4ECD;&#x7136;&#x7406;&#x89E3;</h3>

<p>&#x5728;&#x683C;&#x8A00;1-3&#x4E4B;&#x540E;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x5E76;&#x53D1;&#x6027;&#x611F;&#x5230;&#x5BB3;&#x6015;&#xFF0C;&#x5E76;&#x4E14;&#x8BA4;&#x4E3A;&#xFF0C;&#x201C;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x5DF2;&#x7ECF;&#x907F;&#x514D;&#x4E86;&#x5B83;&#xFF0C;&#x4E5F;&#x8BB8;&#x6211;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x907F;&#x514D;&#x5B83;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7406;&#x6027;&#x7684;&#x53CD;&#x5E94;&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x77E5;&#x9053;&#x5176;&#x4ED6;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x66F4;&#x597D;&#x5730;&#x8BBE;&#x8BA1;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F; - &#x751A;&#x81F3;&#x662F;&#x5728;JVM&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#xFF08;&#x4ECE;&#x800C;&#x63D0;&#x4F9B;&#x4E0E;Java&#x7684;&#x8F7B;&#x677E;&#x901A;&#x4FE1;&#xFF09;&#xFF0C;&#x4F8B;&#x5982;Clojure&#x6216;Scala&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x7528;&#x8FD9;&#x4E9B;&#x8BED;&#x8A00;&#x7F16;&#x5199;&#x5E76;&#x53D1;&#x90E8;&#x5206;&#x5E76;&#x5C06;Java&#x7528;&#x4E8E;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x90E8;&#x5206;&#x5462;&#xFF1F;</p>
<p>&#x5509;&#xFF0C;&#x4F60;&#x4E0D;&#x80FD;&#x8F7B;&#x6613;&#x9003;&#x8131;&#xFF1A;</p>
<ul>
<li>&#x5373;&#x4F7F;&#x4F60;&#x4ECE;&#x672A;&#x660E;&#x786E;&#x5730;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F7F;&#x7528;&#x7684;&#x6846;&#x67B6; - &#x4F8B;&#x5982;&#xFF0C;Swing&#x56FE;&#x5F62;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF08;GUI&#xFF09;&#x5E93;&#xFF0C;&#x6216;&#x8005;&#x50CF;<strong>Timer</strong> class&#x90A3;&#x6837;&#x7B80;&#x5355;&#x7684;&#x4E1C;&#x897F;&#x3002;</li>
<li>&#x8FD9;&#x662F;&#x6700;&#x7CDF;&#x7CD5;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;&#x5F53;&#x4F60;&#x521B;&#x5EFA;&#x7EC4;&#x4EF6;&#x65F6;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5047;&#x8BBE;&#x8FD9;&#x4E9B;&#x7EC4;&#x4EF6;&#x53EF;&#x80FD;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E2D;&#x91CD;&#x7528;&#x3002;&#x5373;&#x4F7F;&#x4F60;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x653E;&#x5F03;&#x5E76;&#x58F0;&#x660E;&#x4F60;&#x7684;&#x7EC4;&#x4EF6;&#x201C;&#x4E0D;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x201D;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x5FC5;&#x987B;&#x77E5;&#x9053;&#x8FD9;&#x6837;&#x7684;&#x58F0;&#x660E;&#x662F;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5B83;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;</li>
</ul>
<p>&#x4EBA;&#x4EEC;&#x6709;&#x65F6;&#x4F1A;&#x8BA4;&#x4E3A;&#x5E76;&#x53D1;&#x6027;&#x592A;&#x96BE;&#xFF0C;&#x4E0D;&#x80FD;&#x5305;&#x542B;&#x5728;&#x4ECB;&#x7ECD;&#x8BE5;&#x8BED;&#x8A00;&#x7684;&#x4E66;&#x4E2D;&#x3002;&#x4ED6;&#x4EEC;&#x8BA4;&#x4E3A;&#x5E76;&#x53D1;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x5BF9;&#x5F85;&#x7684;&#x72EC;&#x7ACB;&#x4E3B;&#x9898;&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x5728;&#x65E5;&#x5E38;&#x7F16;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x5C11;&#x6570;&#x60C5;&#x51B5;&#xFF08;&#x4F8B;&#x5982;&#x56FE;&#x5F62;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF09;&#x53EF;&#x4EE5;&#x7528;&#x7279;&#x6B8A;&#x7684;&#x4E60;&#x8BED;&#x6765;&#x5904;&#x7406;&#x3002;&#x5982;&#x679C;&#x4F60;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5B83;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4ECB;&#x7ECD;&#x8FD9;&#x6837;&#x7684;&#x590D;&#x6742;&#x7684;&#x4E3B;&#x9898;&#x3002;</p>
<p>&#x5509;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x5C31;&#x592A;&#x597D;&#x4E86;&#x3002;&#x4F46;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x4F60;&#x65E0;&#x6CD5;&#x9009;&#x62E9;&#x4F55;&#x65F6;&#x5728;Java&#x7A0B;&#x5E8F;&#x4E2D;&#x51FA;&#x73B0;&#x7EBF;&#x7A0B;&#x3002;&#x4EC5;&#x4EC5;&#x4F60;&#x4ECE;&#x672A;&#x5199;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x4F60;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7F16;&#x5199;&#x7EBF;&#x7A0B;&#x4EE3;&#x7801;&#x3002;&#x4F8B;&#x5982;&#xFF0C;Web&#x7CFB;&#x7EDF;&#x662F;&#x6700;&#x5E38;&#x89C1;&#x7684;Java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x4E00;&#xFF0C;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7684;Web&#x670D;&#x52A1;&#x5668;&#x901A;&#x5E38;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x800C;&#x5E76;&#x884C;&#x6027;&#x662F;&#x5229;&#x7528;&#x8FD9;&#x4E9B;&#x5904;&#x7406;&#x5668;&#x7684;&#x7406;&#x60F3;&#x65B9;&#x5F0F;&#x3002;&#x5C31;&#x50CF;&#x8FD9;&#x6837;&#x7684;&#x7CFB;&#x7EDF;&#x770B;&#x8D77;&#x6765;&#x90A3;&#x4E48;&#x7B80;&#x5355;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x7406;&#x89E3;&#x5E76;&#x53D1;&#x624D;&#x80FD;&#x6B63;&#x786E;&#x5730;&#x7F16;&#x5199;&#x5B83;&#x3002;</p>
<p>Java&#x662F;&#x4E00;&#x79CD;&#x591A;&#x7EBF;&#x7A0B;&#x8BED;&#x8A00;&#xFF0C;&#x4E0D;&#x7BA1;&#x4F60;&#x6709;&#x6CA1;&#x6709;&#x610F;&#x8BC6;&#x5230;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x5B83;&#x5C31;&#x5728;&#x90A3;&#x91CC;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6709;&#x8BB8;&#x591A;Java&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#xFF0C;&#x6216;&#x8005;&#x53EA;&#x662F;&#x5076;&#x7136;&#x5DE5;&#x4F5C;&#xFF0C;&#x6216;&#x8005;&#x5927;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x5DE5;&#x4F5C;&#x5E76;&#x4E14;&#x4E0D;&#x65F6;&#x5730;&#x53D1;&#x751F;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x3002;&#x6709;&#x65F6;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#x662F;&#x76F8;&#x5BF9;&#x826F;&#x6027;&#x7684;&#xFF0C;&#x4F46;&#x6709;&#x65F6;&#x5B83;&#x610F;&#x5473;&#x7740;&#x4E22;&#x5931;&#x6709;&#x4EF7;&#x503C;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x610F;&#x8BC6;&#x5230;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x4F60;&#x6700;&#x7EC8;&#x53EF;&#x80FD;&#x4F1A;&#x628A;&#x95EE;&#x9898;&#x653E;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x800C;&#x4E0D;&#x662F;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x5C06;&#x7A0B;&#x5E8F;&#x79FB;&#x52A8;&#x5230;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x66B4;&#x9732;&#x6216;&#x653E;&#x5927;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#x3002;&#x57FA;&#x672C;&#x4E0A;&#xFF0C;&#x4E86;&#x89E3;&#x5E76;&#x53D1;&#x6027;&#x4F7F;&#x4F60;&#x610F;&#x8BC6;&#x5230;&#x6B63;&#x786E;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x8868;&#x73B0;&#x51FA;&#x9519;&#x8BEF;&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<h2 class="mume-header" id="span-id-the-brutal-truth%E6%AE%8B%E9%85%B7%E7%9A%84%E7%9C%9F%E7%9B%B8span"><span id="The-Brutal-Truth">&#x6B8B;&#x9177;&#x7684;&#x771F;&#x76F8;</span></h2>

<p>&#x5F53;&#x4EBA;&#x7C7B;&#x5F00;&#x59CB;&#x70F9;&#x996A;&#x4ED6;&#x4EEC;&#x7684;&#x98DF;&#x7269;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x5927;&#x5927;&#x51CF;&#x5C11;&#x4E86;&#x4ED6;&#x4EEC;&#x7684;&#x8EAB;&#x4F53;&#x5206;&#x89E3;&#x548C;&#x6D88;&#x5316;&#x98DF;&#x7269;&#x6240;&#x9700;&#x7684;&#x80FD;&#x91CF;&#x3002;&#x70F9;&#x996A;&#x521B;&#x9020;&#x4E86;&#x4E00;&#x4E2A;&#x201C;&#x5916;&#x5316;&#x7684;&#x80C3;&#x201D;&#xFF0C;&#x4ECE;&#x800C;&#x91CA;&#x653E;&#x51FA;&#x80FD;&#x91CF;&#x53BB;&#x53D1;&#x5C55;&#x5176;&#x4ED6;&#x7684;&#x80FD;&#x529B;&#x3002;&#x706B;&#x7684;&#x4F7F;&#x7528;&#x4FC3;&#x6210;&#x4E86;&#x6587;&#x660E;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#x673A;&#x548C;&#x7F51;&#x7EDC;&#x6280;&#x672F;&#x521B;&#x9020;&#x4E86;&#x4E00;&#x4E2A;&#x201C;&#x5916;&#x5316;&#x5927;&#x8111;&#x201D;&#xFF0C;&#x5F00;&#x59CB;&#x4E86;&#x7B2C;&#x4E8C;&#x6B21;&#x57FA;&#x672C;&#x8F6C;&#x53D8;&#x3002;&#x867D;&#x7136;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x89E6;&#x53CA;&#x8868;&#x9762;&#xFF0C;&#x4F46;&#x5DF2;&#x7ECF;&#x5F15;&#x53D1;&#x4E86;&#x5176;&#x4ED6;&#x8F6C;&#x53D8;&#xFF0C;&#x4F8B;&#x5982;&#x8BBE;&#x8BA1;&#x751F;&#x7269;&#x673A;&#x5236;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x5E76;&#x4E14;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x6587;&#x5316;&#x6F14;&#x53D8;&#x7684;&#x663E;&#x8457;&#x52A0;&#x901F;&#xFF08;&#x8FC7;&#x53BB;&#xFF0C;&#x4EBA;&#x4EEC;&#x901A;&#x8FC7;&#x65C5;&#x6E38;&#x8FDB;&#x884C;&#x6587;&#x5316;&#x4EA4;&#x6D41;&#xFF0C;&#x4F46;&#x73B0;&#x5728;&#x4ED6;&#x4EEC;&#x5F00;&#x59CB;&#x5728;&#x4E92;&#x8054;&#x7F51;&#x4E0A;&#x505A;&#x8FD9;&#x4EF6;&#x4E8B;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x8F6C;&#x53D8;&#x7684;&#x5F71;&#x54CD;&#x548C;&#x597D;&#x5904;&#x5DF2;&#x7ECF;&#x8D85;&#x51FA;&#x4E86;&#x79D1;&#x5E7B;&#x4F5C;&#x5BB6;&#x9884;&#x6D4B;&#x5B83;&#x4EEC;&#x7684;&#x80FD;&#x529B;&#xFF08;&#x4ED6;&#x4EEC;&#x5728;&#x9884;&#x6D4B;&#x6587;&#x5316;&#x548C;&#x4E2A;&#x4EBA;&#x53D8;&#x5316;&#xFF0C;&#x751A;&#x81F3;&#x6280;&#x672F;&#x8F6C;&#x53D8;&#x7684;&#x6B21;&#x8981;&#x5F71;&#x54CD;&#x65B9;&#x9762;&#x90FD;&#x7279;&#x522B;&#x56F0;&#x96BE;&#xFF09;&#x3002;</p>
<p>&#x6709;&#x4E86;&#x8FD9;&#x79CD;&#x6839;&#x672C;&#x6027;&#x7684;&#x4EBA;&#x7C7B;&#x53D8;&#x5316;&#xFF0C;&#x770B;&#x5230;&#x8BB8;&#x591A;&#x7834;&#x574F;&#x548C;&#x5931;&#x8D25;&#x7684;&#x5B9E;&#x9A8C;&#x5E76;&#x4E0D;&#x4EE4;&#x4EBA;&#x60CA;&#x8BB6;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FDB;&#x5316;&#x4F9D;&#x8D56;&#x4E8E;&#x65E0;&#x6570;&#x7684;&#x5B9E;&#x9A8C;&#xFF0C;&#x5176;&#x4E2D;&#x5927;&#x591A;&#x6570;&#x90FD;&#x5931;&#x8D25;&#x4E86;&#x3002;&#x8FD9;&#x4E9B;&#x5B9E;&#x9A8C;&#x662F;&#x5411;&#x524D;&#x53D1;&#x5C55;&#x7684;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#x3002;</p>
<p>Java&#x662F;&#x5728;&#x5145;&#x6EE1;&#x81EA;&#x4FE1;&#xFF0C;&#x70ED;&#x60C5;&#x548C;&#x777F;&#x667A;&#x7684;&#x6C1B;&#x56F4;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x3002;&#x5728;&#x53D1;&#x660E;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x65F6;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x611F;&#x89C9;&#x8BED;&#x8A00;&#x7684;&#x521D;&#x59CB;&#x53EF;&#x5851;&#x6027;&#x4F1A;&#x6301;&#x7EED;&#x5B58;&#x5728;&#x4E00;&#x6837;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x628A;&#x67D0;&#x4E9B;&#x4E1C;&#x897F;&#x62FF;&#x51FA;&#x6765;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x80FD;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4FEE;&#x590D;&#x5B83;&#x3002;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x72EC;&#x4E00;&#x65E0;&#x4E8C;&#x7684; - &#x5B83;&#x4EEC;&#x7ECF;&#x5386;&#x4E86;&#x7C7B;&#x4F3C;&#x6C34;&#x7684;&#x6539;&#x53D8;&#xFF1A;&#x6C14;&#x6001;&#xFF0C;&#x6DB2;&#x6001;&#x548C;&#x6700;&#x7EC8;&#x7684;&#x56FA;&#x6001;&#x3002;&#x5728;&#x6C14;&#x6001;&#x9636;&#x6BB5;&#xFF0C;&#x7075;&#x6D3B;&#x6027;&#x4F3C;&#x4E4E;&#x662F;&#x65E0;&#x9650;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5F88;&#x5BB9;&#x6613;&#x8BA4;&#x4E3A;&#x5B83;&#x603B;&#x662F;&#x90A3;&#x6837;&#x3002;&#x4E00;&#x65E6;&#x4EBA;&#x4EEC;&#x5F00;&#x59CB;&#x4F7F;&#x7528;&#x4F60;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x53D8;&#x5316;&#x5C31;&#x4F1A;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x4E25;&#x91CD;&#xFF0C;&#x73AF;&#x5883;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x7C98;&#x7A20;&#x3002;&#x8BED;&#x8A00;&#x8BBE;&#x8BA1;&#x7684;&#x8FC7;&#x7A0B;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E00;&#x95E8;&#x827A;&#x672F;&#x3002;</p>
<p>&#x7D27;&#x8FEB;&#x611F;&#x6765;&#x81EA;&#x4E92;&#x8054;&#x7F51;&#x7684;&#x6700;&#x521D;&#x5174;&#x8D77;&#x3002;&#x5B83;&#x4F3C;&#x4E4E;&#x662F;&#x4E00;&#x573A;&#x6BD4;&#x8D5B;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x901A;&#x8FC7;&#x8D77;&#x8DD1;&#x7EBF;&#x7684;&#x4EBA;&#x5C06;&#x201C;&#x83B7;&#x80DC;&#x201D;&#xFF08;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;Java&#xFF0C;JavaScript&#x548C;PHP&#x7B49;&#x8BED;&#x8A00;&#x7684;&#x6D41;&#x884C;&#x7A0B;&#x5EA6;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;&#x8FD9;&#x4E00;&#x70B9;&#xFF09;&#x3002;&#x5509;&#xFF0C;&#x901A;&#x8FC7;&#x5306;&#x5FD9;&#x8BBE;&#x8BA1;&#x8BED;&#x8A00;&#x800C;&#x4EA7;&#x751F;&#x7684;&#x8BA4;&#x77E5;&#x8D1F;&#x8377;&#x548C;&#x6280;&#x672F;&#x503A;&#x52A1;&#x6700;&#x7EC8;&#x4F1A;&#x8D76;&#x4E0A;&#x6211;&#x4EEC;&#x3002;</p>
<p><a href="https://en.wikipedia.org/wiki/Turing_completeness">Turing completeness</a>&#x662F;&#x4E0D;&#x8DB3;&#x591F;&#x7684;;&#x8BED;&#x8A00;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x4E1C;&#x897F;&#xFF1A;&#x5B83;&#x4EEC;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x521B;&#x9020;&#x6027;&#x5730;&#x8868;&#x8FBE;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7528;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x4E1C;&#x897F;&#x6765;&#x8861;&#x91CF;&#x6211;&#x4EEC;&#x3002;&#x89E3;&#x653E;&#x6211;&#x4EEC;&#x7684;&#x5FC3;&#x7406;&#x80FD;&#x529B;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x626D;&#x8F6C;&#x5E76;&#x518D;&#x6B21;&#x9677;&#x5165;&#x56F0;&#x5883;&#xFF0C;&#x8FD9;&#x662F;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x7684;&#x3002;&#x6211;&#x627F;&#x8BA4;&#xFF0C;&#x5C3D;&#x7BA1;&#x5B58;&#x5728;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;&#x4EE4;&#x4EBA;&#x60CA;&#x5947;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x6211;&#x4E5F;&#x77E5;&#x9053;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x6211;&#x4EEC;&#x80FD;&#x505A;&#x5F97;&#x66F4;&#x591A;&#x3002;</p>
<p>&#x70ED;&#x60C5;&#x4F7F;&#x539F;&#x59CB;Java&#x8BBE;&#x8BA1;&#x5E08;&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E9B;&#x4F3C;&#x4E4E;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x7279;&#x6027;&#x3002;&#x4FE1;&#x5FC3;&#xFF08;&#x4EE5;&#x53CA;&#x6C14;&#x6001;&#x7684;&#x521D;&#x59CB;&#x8BED;&#x8A00;&#xFF09;&#x8BA9;&#x4ED6;&#x4EEC;&#x8BA4;&#x4E3A;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#x968F;&#x540E;&#x90FD;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x3002;&#x5728;&#x65F6;&#x95F4;&#x8F74;&#x7684;&#x67D0;&#x4E2A;&#x5730;&#x65B9;&#xFF0C;&#x6709;&#x4EBA;&#x8BA4;&#x4E3A;&#x4EFB;&#x4F55;&#x52A0;&#x5165;Java&#x7684;&#x4E1C;&#x897F;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#x548C;&#x6C38;&#x4E45;&#x6027;&#x7684; -&#x4ED6;&#x4EEC;&#x975E;&#x5E38;&#x6709;&#x4FE1;&#x5FC3;&#xFF0C;&#x5E76;&#x76F8;&#x4FE1;&#x7B2C;&#x4E00;&#x4E2A;&#x51B3;&#x5B9A;&#x6C38;&#x8FDC;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x770B;&#x5230;Java&#x7684;&#x4F53;&#x7CFB;&#x4E2D;&#x5145;&#x65A5;&#x7740;&#x7CDF;&#x7CD5;&#x7684;&#x51B3;&#x7B56;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x51B3;&#x5B9A;&#x6700;&#x7EC8;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x540E;&#x679C;;&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x544A;&#x8BC9;&#x4EBA;&#x4EEC;&#x4E0D;&#x8981;&#x4F7F;&#x7528;Vector&#xFF0C;&#x4F46;&#x53EA;&#x80FD;&#x5728;&#x8BED;&#x8A00;&#x4E2D;&#x7EE7;&#x7EED;&#x4FDD;&#x7559;&#x5B83;&#x4EE5;&#x4FBF;&#x5BF9;&#x4E4B;&#x524D;&#x7248;&#x672C;&#x7684;&#x652F;&#x6301;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x5305;&#x542B;&#x5728;Java 1.0&#x4E2D;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x5BF9;java&#x6765;&#x8BF4;&#x652F;&#x6301;&#x5E76;&#x53D1;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x57FA;&#x672C;&#x7684;&#x8BBE;&#x8BA1;&#x51B3;&#x5B9A;&#xFF0C;&#x8BE5;&#x7279;&#x6027;&#x5F71;&#x54CD;&#x4E86;&#x8FD9;&#x4E2A;&#x8BED;&#x8A00;&#x7684;&#x5404;&#x4E2A;&#x89D2;&#x843D;&#xFF0C;&#x6211;&#x4EEC;&#x5F88;&#x96BE;&#x60F3;&#x8C61;&#x4EE5;&#x540E;&#x5728;&#x4EE5;&#x540E;&#x7684;&#x7248;&#x672C;&#x6DFB;&#x52A0;&#x5B83;&#x3002;&#x516C;&#x5E73;&#x5730;&#x8BF4;&#xFF0C;&#x5F53;&#x65F6;&#x5E76;&#x4E0D;&#x6E05;&#x695A;&#x57FA;&#x672C;&#x7684;&#x5E76;&#x53D1;&#x6027;&#x662F;&#x591A;&#x5C11;&#x3002;&#x50CF;C&#x8FD9;&#x6837;&#x7684;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x80FD;&#x591F;&#x5C06;&#x7EBF;&#x7A0B;&#x89C6;&#x4E3A;&#x4E00;&#x4E2A;&#x9644;&#x52A0;&#x529F;&#x80FD;&#xFF0C;&#x56E0;&#x6B64;Java&#x8BBE;&#x8BA1;&#x5E08;&#x4E5F;&#x7EB7;&#x7EB7;&#x6548;&#x4EFF;&#xFF0C;&#x5305;&#x62EC;&#x4E00;&#x4E2A;Thread&#x7C7B;&#x548C;&#x5FC5;&#x8981;&#x7684;JVM&#x652F;&#x6301;&#xFF08;&#x8FD9;&#x6BD4;&#x4F60;&#x60F3;&#x8C61;&#x7684;&#x8981;&#x590D;&#x6742;&#x5F97;&#x591A;&#xFF09;&#x3002;</p>
<p>C&#x8BED;&#x8A00;&#x662F;&#x9762;&#x5411;&#x8FC7;&#x7A0B;&#x8BED;&#x8A00;&#xFF0C;&#x8FD9;&#x9650;&#x5236;&#x4E86;&#x5B83;&#x7684;&#x91CE;&#x5FC3;&#x3002;&#x8FD9;&#x4E9B;&#x9650;&#x5236;&#x4F7F;&#x9644;&#x52A0;&#x7EBF;&#x7A0B;&#x5E93;&#x5408;&#x7406;&#x3002;&#x5F53;&#x91C7;&#x7528;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x5E76;&#x5C06;&#x5176;&#x7C98;&#x8D34;&#x5230;&#x590D;&#x6742;&#x8BED;&#x8A00;&#x4E2D;&#x65F6;&#xFF0C;Java&#x7684;&#x5927;&#x89C4;&#x6A21;&#x6269;&#x5C55;&#x8FC5;&#x901F;&#x66B4;&#x9732;&#x4E86;&#x57FA;&#x672C;&#x95EE;&#x9898;&#x3002;&#x5728;Thread&#x7C7B;&#x4E2D;&#x7684;&#x8BB8;&#x591A;&#x65B9;&#x6CD5;&#x7684;&#x5F03;&#x7528;&#x4EE5;&#x53CA;&#x540E;&#x7EED;&#x7684;&#x9AD8;&#x7EA7;&#x5E93;&#x6D6A;&#x6F6E;&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53D8;&#x5F97;&#x660E;&#x663E;&#xFF0C;&#x8FD9;&#x4E9B;&#x5E93;&#x8BD5;&#x56FE;&#x63D0;&#x4F9B;&#x66F4;&#x597D;&#x7684;&#x5E76;&#x53D1;&#x62BD;&#x8C61;&#x3002;</p>
<p>&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x4E3A;&#x4E86;&#x5728;&#x66F4;&#x9AD8;&#x7EA7;&#x522B;&#x7684;&#x8BED;&#x8A00;&#x4E2D;&#x83B7;&#x5F97;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x6240;&#x6709;&#x8BED;&#x8A00;&#x529F;&#x80FD;&#x90FD;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#xFF0C;&#x5305;&#x62EC;&#x6700;&#x57FA;&#x672C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F8B;&#x5982;&#x6807;&#x8BC6;&#x7B26;&#x4EE3;&#x8868;&#x53EF;&#x53D8;&#x503C;&#x3002;&#x5728;&#x7B80;&#x5316;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x51FD;&#x6570;&#x548C;&#x65B9;&#x6CD5;&#x4E2D;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x4E8B;&#x7269;&#x4E0D;&#x53D8;&#x548C;&#x9632;&#x6B62;&#x526F;&#x4F5C;&#x7528;&#x90FD;&#x8981;&#x505A;&#x51FA;&#x5DE8;&#x5927;&#x7684;&#x6539;&#x53D8;&#xFF08;&#x8FD9;&#x4E9B;&#x662F;&#x7EAF;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x7684;&#x57FA;&#x7840;&#xFF09;&#xFF0C;&#x4F46;&#x5F53;&#x65F6;&#x5BF9;&#x4E8E;&#x4E3B;&#x6D41;&#x8BED;&#x8A00;&#x7684;&#x521B;&#x5EFA;&#x8005;&#x6765;&#x8BF4;&#x4F3C;&#x4E4E;&#x662F;&#x5947;&#x602A;&#x7684;&#x60F3;&#x6CD5;&#x3002;&#x6700;&#x521D;&#x7684;Java&#x8BBE;&#x8BA1;&#x5E08;&#x8981;&#x4E48;&#x6CA1;&#x6709;&#x610F;&#x8BC6;&#x5230;&#x8FD9;&#x4E9B;&#x9009;&#x62E9;&#xFF0C;&#x8981;&#x4E48;&#x8BA4;&#x4E3A;&#x5B83;&#x4EEC;&#x592A;&#x4E0D;&#x540C;&#x4E86;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x529D;&#x9000;&#x8BB8;&#x591A;&#x6F5C;&#x5728;&#x7684;&#x8BED;&#x8A00;&#x4F7F;&#x7528;&#x8005;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6177;&#x6168;&#x5730;&#x8BF4;&#xFF0C;&#x8BED;&#x8A00;&#x8BBE;&#x8BA1;&#x793E;&#x533A;&#x5F53;&#x65F6;&#x6839;&#x672C;&#x6CA1;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7ECF;&#x9A8C;&#x6765;&#x7406;&#x89E3;&#x8C03;&#x6574;&#x5728;&#x7EBF;&#x7A0B;&#x5E93;&#x4E2D;&#x7684;&#x5F71;&#x54CD;&#x3002;</p>
<p>Java&#x5B9E;&#x9A8C;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#xFF0C;&#x7ED3;&#x679C;&#x662F;&#x6084;&#x7136;&#x707E;&#x96BE;&#x6027;&#x7684;&#x3002;&#x7A0B;&#x5E8F;&#x5458;&#x5F88;&#x5BB9;&#x6613;&#x9677;&#x5165;&#x8BA4;&#x4E3A;Java &#x7EBF;&#x7A0B;&#x5E76;&#x4E0D;&#x90A3;&#x4E48;&#x56F0;&#x96BE;&#x7684;&#x9677;&#x9631;&#x3002;&#x8868;&#x9762;&#x4E0A;&#x770B;&#x8D77;&#x6765;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x7684;&#x7A0B;&#x5E8F;&#x5B9E;&#x9645;&#x4E0A;&#x5145;&#x6EE1;&#x4E86;&#x5FAE;&#x5999;&#x7684;&#x5E76;&#x53D1;bug&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x83B7;&#x5F97;&#x6B63;&#x786E;&#x7684;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x8BED;&#x8A00;&#x529F;&#x80FD;&#x5FC5;&#x987B;&#x4ECE;&#x5934;&#x5F00;&#x59CB;&#x8BBE;&#x8BA1;&#x5E76;&#x8003;&#x8651;&#x5E76;&#x53D1;&#x6027;&#x3002;&#x6728;&#x5DF2;&#x6210;&#x821F;&#xFF1B;Java &#x5C06;&#x4E0D;&#x518D;&#x662F;&#x4E3A;&#x5E76;&#x53D1;&#x800C;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x800C;&#x53EA;&#x662F;&#x4E00;&#x79CD;&#x5141;&#x8BB8;&#x5E76;&#x53D1;&#x7684;&#x8BED;&#x8A00;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x6709;&#x8FD9;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x4E0D;&#x53EF;&#x4FEE;&#x590D;&#x7684;&#x7F3A;&#x9677;&#xFF0C;&#x4F46;&#x4EE4;&#x4EBA;&#x5370;&#x8C61;&#x6DF1;&#x523B;&#x7684;&#x662F;&#x5B83;&#x5DF2;&#x7ECF;&#x8D70;&#x4E86;&#x8FD9;&#x4E48;&#x8FDC;&#x3002;Java&#x7684;&#x540E;&#x7EED;&#x7248;&#x672C;&#x6DFB;&#x52A0;&#x4E86;&#x5E93;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x65F6;&#x63D0;&#x5347;&#x62BD;&#x8C61;&#x7EA7;&#x522B;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x6211;&#x6839;&#x672C;&#x4E0D;&#x4F1A;&#x60F3;&#x5230;&#x6709;&#x53EF;&#x80FD;&#x5728;Java 8&#x4E2D;&#x8FDB;&#x884C;&#x6539;&#x8FDB;&#xFF1A;&#x5E76;&#x884C;&#x6D41;&#x548C;<strong>CompletableFutures</strong> - &#x8FD9;&#x662F;&#x60CA;&#x4EBA;&#x7684;&#x53F2;&#x8BD7;&#x822C;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x6211;&#x4F1A;&#x60CA;&#x5947;&#x5730;&#x91CD;&#x590D;&#x7684;&#x67E5;&#x770B;&#x5B83;<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x6539;&#x8FDB;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x672C;&#x7AE0;&#x91CD;&#x70B9;&#x4ECB;&#x7ECD;&#x5E76;&#x884C;&#x6D41;&#x548C;<strong>CompletableFutures</strong>&#x3002;&#x867D;&#x7136;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x7B80;&#x5316;&#x4F60;&#x5BF9;&#x5E76;&#x53D1;&#x548C;&#x540E;&#x7EED;&#x4EE3;&#x7801;&#x7684;&#x601D;&#x8003;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x57FA;&#x672C;&#x95EE;&#x9898;&#x4ECD;&#x7136;&#x5B58;&#x5728;&#xFF1A;&#x7531;&#x4E8E;Java&#x7684;&#x539F;&#x59CB;&#x8BBE;&#x8BA1;&#xFF0C;&#x4EE3;&#x7801;&#x7684;&#x6240;&#x6709;&#x90E8;&#x5206;&#x4ECD;&#x7136;&#x5F88;&#x8106;&#x5F31;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x5FC5;&#x987B;&#x7406;&#x89E3;&#x8FD9;&#x4E9B;&#x590D;&#x6742;&#x548C;&#x5FAE;&#x5999;&#x7684;&#x95EE;&#x9898;&#x3002;Java&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x7EDD;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x6216;&#x5B89;&#x5168;&#x7684;;&#x90A3;&#x79CD;&#x7ECF;&#x5386;&#x5FC5;&#x987B;&#x964D;&#x7EA7;&#x4E3A;&#x53E6;&#x4E00;&#x79CD;&#x66F4;&#x65B0;&#x7684;&#x8BED;&#x8A00;&#x3002;</p>
<h2 class="mume-header" id="%E6%9C%AC%E7%AB%A0%E5%85%B6%E4%BD%99%E9%83%A8%E5%88%86">&#x672C;&#x7AE0;&#x5176;&#x4F59;&#x90E8;&#x5206;</h2>

<p>&#x8FD9;&#x662F;&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x672C;&#x7AE0;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x4ECB;&#x7ECD;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x8BF7;&#x8BB0;&#x4F4F;&#xFF0C;&#x672C;&#x7AE0;&#x7684;&#x91CD;&#x70B9;&#x662F;&#x4F7F;&#x7528;&#x6700;&#x65B0;&#x7684;&#x9AD8;&#x7EA7;Java&#x5E76;&#x53D1;&#x7ED3;&#x6784;&#x3002;&#x76F8;&#x6BD4;&#x4E8E;&#x65E7;&#x7684;&#x66FF;&#x4EE3;&#x54C1;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x4F1A;&#x4F7F;&#x4F60;&#x7684;&#x751F;&#x6D3B;&#x66F4;&#x52A0;&#x8F7B;&#x677E;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4F60;&#x4ECD;&#x4F1A;&#x5728;&#x9057;&#x7559;&#x4EE3;&#x7801;&#x4E2D;&#x9047;&#x5230;&#x4E00;&#x4E9B;&#x4F4E;&#x7EA7;&#x5DE5;&#x5177;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x8FEB;&#x81EA;&#x5DF1;&#x4F7F;&#x7528;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x3002;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x5E76;&#x53D1;&#x5E95;&#x5C42;&#x539F;&#x7406;</a>&#x5305;&#x542B;&#x4E00;&#x4E9B;&#x66F4;&#x539F;&#x59CB;&#x7684;Java&#x5E76;&#x53D1;&#x5143;&#x7D20;&#x7684;&#x4ECB;&#x7ECD;&#x3002;</p>
<ul>
<li>Parallel Streams&#xFF08;&#x5E76;&#x884C;&#x6D41;&#xFF09;<br>
&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x5DF2;&#x7ECF;&#x5F3A;&#x8C03;&#x4E86;Java 8 Streams&#x63D0;&#x4F9B;&#x7684;&#x6539;&#x8FDB;&#x8BED;&#x6CD5;&#x3002;&#x73B0;&#x5728;&#x8BE5;&#x8BED;&#x6CD5;&#xFF08;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7C89;&#x4E1D;&#xFF0C;&#x6211;&#x5E0C;&#x671B;&#xFF09;&#x4F1A;&#x4F7F;&#x4F60;&#x611F;&#x5230;&#x8212;&#x9002;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x989D;&#x5916;&#x7684;&#x597D;&#x5904;&#xFF1A;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7B80;&#x5355;&#x5730;&#x5C06;parallel()&#x6DFB;&#x52A0;&#x5230;&#x8868;&#x8FBE;&#x5F0F;&#x6765;&#x5E76;&#x884C;&#x5316;&#x6D41;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#xFF0C;&#x5F3A;&#x5927;&#xFF0C;&#x5766;&#x7387;&#x5730;&#x8BF4;&#x662F;&#x5229;&#x7528;&#x591A;&#x5904;&#x7406;&#x5668;&#x7684;&#x60CA;&#x4EBA;&#x65B9;&#x5F0F;</li>
</ul>
<p>&#x6DFB;&#x52A0;parallel()&#x6765;&#x63D0;&#x9AD8;&#x901F;&#x5EA6;&#x4F3C;&#x4E4E;&#x662F;&#x5FAE;&#x4E0D;&#x8DB3;&#x9053;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x5509;&#xFF0C;&#x5B83;&#x5C31;&#x50CF;&#x4F60;&#x521A;&#x521A;&#x5728;<a href="#The-Brutal-Truth">&#x6B8B;&#x9177;&#x7684;&#x771F;&#x76F8;</a>&#x4E2D;&#x5B66;&#x5230;&#x7684;&#x90A3;&#x6837;&#x7B80;&#x5355;&#x3002;&#x6211;&#x5C06;&#x6F14;&#x793A;&#x5E76;&#x89E3;&#x91CA;&#x4E00;&#x4E9B;&#x76F2;&#x76EE;&#x6DFB;&#x52A0;parallel()&#x5230;Stream&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7F3A;&#x9677;&#x3002;</p>
<ul>
<li>&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;<br>
&#x4EFB;&#x52A1;&#x662F;&#x4E00;&#x6BB5;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x4E3A;&#x4E86;&#x89E3;&#x91CA;&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#xFF0C;&#x672C;&#x8282;&#x4ECB;&#x7ECD;&#x4E86;&#x4E00;&#x79CD;&#x6BD4;&#x5E76;&#x884C;&#x6D41;&#x6216;CompletableFutures&#x66F4;&#x7B80;&#x5355;&#x7684;&#x673A;&#x5236;&#xFF1A;Executor&#x3002;&#x6267;&#x884C;&#x8005;&#x7BA1;&#x7406;&#x4E00;&#x4E9B;&#x4F4E;&#x7EA7;Thread&#x5BF9;&#x8C61;&#xFF08;Java&#x4E2D;&#x6700;&#x539F;&#x59CB;&#x7684;&#x5E76;&#x53D1;&#x5F62;&#x5F0F;&#xFF09;&#x3002;&#x4F60;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x4EA4;&#x7ED9;Executor&#x53BB;&#x8FD0;&#x884C;&#x3002;</li>
</ul>
<p>&#x6709;&#x591A;&#x79CD;&#x7C7B;&#x578B;&#x7684;Executor&#x7528;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x76EE;&#x7684;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5C55;&#x793A;&#x89C4;&#x8303;&#x5F62;&#x5F0F;&#xFF0C;&#x4EE3;&#x8868;&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x6700;&#x7B80;&#x5355;&#x548C;&#x6700;&#x4F73;&#x65B9;&#x6CD5;&#x3002;</p>
<ul>
<li>&#x7EC8;&#x6B62;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#x4EFB;&#x52A1;<br>
&#x4EFB;&#x52A1;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x4E00;&#x79CD;&#x673A;&#x5236;&#x6765;&#x5173;&#x95ED;&#x5B83;&#x4EEC;&#x3002;&#x5178;&#x578B;&#x7684;&#x65B9;&#x6CD5;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x6807;&#x5FD7;&#xFF0C;&#x8FD9;&#x5F15;&#x5165;&#x4E86;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;Java&#x7684;&#x201C;Atomic&#x201D;&#x5E93;&#x6765;&#x56DE;&#x907F;&#x5B83;&#x3002;</li>
<li>Completable Futures<br>
&#x5F53;&#x4F60;&#x5C06;&#x8863;&#x670D;&#x5E26;&#x5230;&#x5E72;&#x6D17;&#x5E97;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x4F1A;&#x7ED9;&#x4F60;&#x4E00;&#x5F20;&#x6536;&#x636E;&#x3002;&#x4F60;&#x7EE7;&#x7EED;&#x5B8C;&#x6210;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#xFF0C;&#x5F53;&#x4F60;&#x7684;&#x8863;&#x670D;&#x6D17;&#x5E72;&#x51C0;&#x65F6;&#x4F60;&#x53EF;&#x4EE5;&#x628A;&#x5B83;&#x53D6;&#x8D70;&#x3002;&#x6536;&#x636E;&#x662F;&#x4F60;&#x4E0E;&#x5E72;&#x6D17;&#x5E97;&#x5728;&#x540E;&#x53F0;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x7684;&#x8FDE;&#x63A5;&#x3002;&#x8FD9;&#x662F;Java 5&#x4E2D;&#x5F15;&#x5165;&#x7684;Future&#x7684;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<p>Future&#x6BD4;&#x4EE5;&#x524D;&#x7684;&#x65B9;&#x6CD5;&#x66F4;&#x65B9;&#x4FBF;&#xFF0C;&#x4F46;&#x4F60;&#x4ECD;&#x7136;&#x5FC5;&#x987B;&#x51FA;&#x73B0;&#x5E76;&#x7528;&#x6536;&#x636E;&#x53D6;&#x51FA;&#x5E72;&#x6D17;&#xFF0C;&#x5982;&#x679C;&#x4EFB;&#x52A1;&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#x4F60;&#x8FD8;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x7CFB;&#x5217;&#x64CD;&#x4F5C;&#xFF0C;Futures&#x5E76;&#x6CA1;&#x6709;&#x771F;&#x6B63;&#x5E2E;&#x52A9;&#x90A3;&#x4E48;&#x591A;&#x3002;</p>
<p>Java 8 CompletableFuture&#x662F;&#x4E00;&#x4E2A;&#x66F4;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;&#x5B83;&#x5141;&#x8BB8;&#x4F60;&#x5C06;&#x64CD;&#x4F5C;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x56E0;&#x6B64;&#x4F60;&#x4E0D;&#x5FC5;&#x5C06;&#x4EE3;&#x7801;&#x5199;&#x5165;&#x63A5;&#x53E3;&#x6392;&#x5E8F;&#x64CD;&#x4F5C;&#x3002;&#x6709;&#x4E86;CompletableFuture&#x5B8C;&#x7F8E;&#x7684;&#x7ED3;&#x5408;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x66F4;&#x5BB9;&#x6613;&#x5730;&#x505A;&#x51FA;&#x201C;&#x91C7;&#x8D2D;&#x539F;&#x6599;&#xFF0C;&#x7EC4;&#x5408;&#x6210;&#x5206;&#xFF0C;&#x70F9;&#x996A;&#x98DF;&#x7269;&#xFF0C;&#x63D0;&#x4F9B;&#x98DF;&#x7269;&#xFF0C;&#x6536;&#x62FE;&#x9910;&#x5177;&#xFF0C;&#x50A8;&#x5B58;&#x9910;&#x5177;&#x201D;&#x7B49;&#x4E00;&#x7CFB;&#x5217;&#x94FE;&#x5F0F;&#x64CD;&#x4F5C;&#x3002;</p>
<ul>
<li>&#x6B7B;&#x9501;<br>
&#x67D0;&#x4E9B;&#x4EFB;&#x52A1;&#x5FC5;&#x987B;&#x53BB;<strong>&#x7B49;&#x5F85; - &#x963B;&#x585E;</strong>&#x6765;&#x83B7;&#x5F97;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x88AB;&#x963B;&#x6B62;&#x7684;&#x4EFB;&#x52A1;&#x6709;&#x53EF;&#x80FD;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x4E2A;&#x88AB;&#x963B;&#x6B62;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x88AB;&#x963B;&#x6B62;&#x7684;&#x4EFB;&#x52A1;&#x4E5F;&#x5728;&#x7B49;&#x5F85;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#xFF0C;&#x7B49;&#x7B49;&#x3002;&#x5982;&#x679C;&#x88AB;&#x963B;&#x6B62;&#x7684;&#x4EFB;&#x52A1;&#x94FE;&#x5FAA;&#x73AF;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#xFF0C;&#x6CA1;&#x6709;&#x4EBA;&#x53EF;&#x4EE5;&#x53D6;&#x5F97;&#x4EFB;&#x4F55;&#x8FDB;&#x5C55;&#xFF0C;&#x4F60;&#x5C31;&#x4F1A;&#x9677;&#x5165;&#x6B7B;&#x9501;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x5728;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x65F6;&#x6CA1;&#x6709;&#x7ACB;&#x5373;&#x51FA;&#x73B0;&#x6B7B;&#x9501;&#xFF0C;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x6700;&#x5927;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F60;&#x7684;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x5BB9;&#x6613;&#x51FA;&#x73B0;&#x6B7B;&#x9501;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x4F1A;&#x5728;&#x67D0;&#x4E9B;&#x6761;&#x4EF6;&#x4E0B;&#x6B7B;&#x9501;&#x3002;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x5728;&#x67D0;&#x4E2A;&#x5E73;&#x53F0;&#x4E0A;&#xFF08;&#x4F8B;&#x5982;&#x5728;&#x4F60;&#x7684;&#x5F00;&#x53D1;&#x673A;&#x5668;&#xFF09;&#x8FD0;&#x884C;&#x6B63;&#x5E38;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x4F60;&#x5C06;&#x5176;&#x90E8;&#x7F72;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x786C;&#x4EF6;&#x65F6;&#x4F1A;&#x5F00;&#x59CB;&#x6B7B;&#x9501;&#x3002;</p>
<p>&#x6B7B;&#x9501;&#x901A;&#x5E38;&#x6E90;&#x4E8E;&#x7EC6;&#x5FAE;&#x7684;&#x7F16;&#x7A0B;&#x9519;&#x8BEF;;&#x4E00;&#x7CFB;&#x5217;&#x65E0;&#x8F9C;&#x7684;&#x51B3;&#x5B9A;&#xFF0C;&#x6700;&#x7EC8;&#x610F;&#x5916;&#x5730;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x4F9D;&#x8D56;&#x5FAA;&#x73AF;&#x3002;&#x672C;&#x8282;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x7ECF;&#x5178;&#x793A;&#x4F8B;&#xFF0C;&#x6F14;&#x793A;&#x4E86;&#x6B7B;&#x9501;&#x7684;&#x7279;&#x6027;&#x3002;</p>
<ul>
<li>&#x52AA;&#x529B;&#xFF0C;&#x590D;&#x6742;&#xFF0C;&#x6210;&#x672C;</li>
</ul>
<p>&#x6211;&#x4EEC;&#x5C06;&#x901A;&#x8FC7;&#x6A21;&#x62DF;&#x521B;&#x5EFA;&#x62AB;&#x8428;&#x7684;&#x8FC7;&#x7A0B;&#x5B8C;&#x6210;&#x672C;&#x7AE0;&#xFF0C;&#x9996;&#x5148;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x6D41;&#x5B9E;&#x73B0;&#x5B83;&#xFF0C;&#x7136;&#x540E;&#x662F;CompletableFutures&#x3002;&#x8FD9;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x6BD4;&#x8F83;&#xFF0C;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#x63A2;&#x7D22;&#x4F60;&#x5E94;&#x8BE5;&#x6295;&#x5165;&#x591A;&#x5C11;&#x5DE5;&#x4F5C;&#x6765;&#x4F7F;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x53D8;&#x5F97;&#x66F4;&#x5FEB;&#x3002;</p>
<h2 class="mume-header" id="%E5%B9%B6%E8%A1%8C%E6%B5%81">&#x5E76;&#x884C;&#x6D41;</h2>

<p>Java 8&#x6D41;&#x7684;&#x4E00;&#x4E2A;&#x663E;&#x8457;&#x4F18;&#x70B9;&#x662F;&#xFF0C;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x5E76;&#x884C;&#x5316;&#x3002;&#x8FD9;&#x6765;&#x81EA;&#x4ED4;&#x7EC6;&#x7684;&#x5E93;&#x8BBE;&#x8BA1;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x6D41;&#x4F7F;&#x7528;&#x5185;&#x90E8;&#x8FED;&#x4EE3;&#x7684;&#x65B9;&#x5F0F; - &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5B83;&#x4EEC;&#x63A7;&#x5236;&#x7740;&#x81EA;&#x5DF1;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x4ED6;&#x4EEC;&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#xFF0C;&#x79F0;&#x4E3A;Spliterator&#xFF0C;&#x5B83;&#x88AB;&#x9650;&#x5236;&#x4E3A;&#x6613;&#x4E8E;&#x81EA;&#x52A8;&#x5206;&#x5272;&#x3002;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5FF5; <code>.parallel()</code> &#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x9B54;&#x6CD5;&#x822C;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x6D41;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x90FD;&#x4F5C;&#x4E3A;&#x4E00;&#x7EC4;&#x5E76;&#x884C;&#x4EFB;&#x52A1;&#x8FD0;&#x884C;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x4F7F;&#x7528;Streams&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5E76;&#x884C;&#x5316;&#x4EE5;&#x63D0;&#x9AD8;&#x901F;&#x5EA6;&#x4F3C;&#x4E4E;&#x662F;&#x4E00;&#x79CD;&#x7410;&#x4E8B;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x8003;&#x8651;&#x6765;&#x81EA;Streams&#x7684;Prime.java&#x3002;&#x67E5;&#x627E;&#x8D28;&#x6570;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x8017;&#x65F6;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8BE5;&#x7A0B;&#x5E8F;&#x7684;&#x8BA1;&#x65F6;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/ParallelPrime.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span><span class="token class-name">LongStream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ParallelPrime</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> COUNT <span class="token operator">=</span> <span class="token number">100_000</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token keyword">long</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> n <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> primes <span class="token operator">=</span>
            <span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>              <span class="token comment">// [1]</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ParallelPrime</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">isPrime</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>COUNT<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">toString</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;primes.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> primes<span class="token punctuation">,</span> <span class="token class-name">StandardOpenOption</span><span class="token punctuation">.</span>CREATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    Output:
    1224
</code></pre><p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x5FAE;&#x57FA;&#x51C6;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x8BA1;&#x65F6;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5728;&#x78C1;&#x76D8;&#x4E0A;&#x4EE5;&#x9632;&#x6B62;&#x7F16;&#x8BD1;&#x5668;&#x8FC7;&#x6FC0;&#x7684;&#x4F18;&#x5316;;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x5BF9;&#x7ED3;&#x679C;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x4E2A;&#x9AD8;&#x7EA7;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x89C2;&#x5BDF;&#x5230;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x5E76;&#x4E14;&#x7EC8;&#x6B62;&#x4E86;&#x8BA1;&#x7B97;&#xFF08;&#x8FD9;&#x4E0D;&#x592A;&#x53EF;&#x80FD;&#xFF0C;&#x4F46;&#x5E76;&#x975E;&#x4E0D;&#x53EF;&#x80FD;&#xFF09;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#x4F7F;&#x7528;nio2&#x5E93;&#x7F16;&#x5199;&#x6587;&#x4EF6;&#x7684;&#x7B80;&#x5355;&#x6027;&#xFF08;&#x5728;<a href="./17-Files.md">&#x6587;&#x4EF6;</a>&#x4E00;&#x7AE0;&#x4E2D;&#x6709;&#x63CF;&#x8FF0;&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x6211;&#x6CE8;&#x91CA;&#x6389;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a> parallel()&#x884C;&#x65F6;&#xFF0C;&#x6211;&#x7684;&#x7ED3;&#x679C;&#x7528;&#x65F6;&#x5927;&#x7EA6;&#x662F;parallel()&#x7684;&#x4E09;&#x500D;&#x3002;</p>
<p>&#x5E76;&#x884C;&#x6D41;&#x4F3C;&#x4E4E;&#x662F;&#x4E00;&#x4E2A;&#x751C;&#x871C;&#x7684;&#x4EA4;&#x6613;&#x3002;&#x4F60;&#x6240;&#x9700;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x5C06;&#x7F16;&#x7A0B;&#x95EE;&#x9898;&#x8F6C;&#x6362;&#x4E3A;&#x6D41;&#xFF0C;&#x7136;&#x540E;&#x63D2;&#x5165;parallel()&#x4EE5;&#x52A0;&#x5FEB;&#x901F;&#x5EA6;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x8FD9;&#x5F88;&#x5BB9;&#x6613;&#x3002;&#x4F46;&#x9057;&#x61BE;&#x7684;&#x662F;&#xFF0C;&#x6709;&#x8BB8;&#x591A;&#x9677;&#x9631;&#x3002;</p>
<ul>
<li>parallel()&#x4E0D;&#x662F;&#x7075;&#x4E39;&#x5999;&#x836F;</li>
</ul>
<p>&#x4F5C;&#x4E3A;&#x5BF9;&#x6D41;&#x548C;&#x5E76;&#x884C;&#x6D41;&#x7684;&#x4E0D;&#x786E;&#x5B9A;&#x6027;&#x7684;&#x63A2;&#x7D22;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E2A;&#x770B;&#x4F3C;&#x7B80;&#x5355;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x5BF9;&#x589E;&#x957F;&#x7684;&#x6570;&#x5B57;&#x5E8F;&#x5217;&#x8FDB;&#x884C;&#x6C42;&#x548C;&#x3002;&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#x6709;&#x5927;&#x91CF;&#x7684;&#x65B9;&#x5F0F;&#x53BB;&#x5B9E;&#x73B0;&#x5B83;&#xFF0C;&#x5E76;&#x4E14;&#x6211;&#x5C06;&#x5192;&#x9669;&#x7528;&#x8BA1;&#x65F6;&#x5668;&#x5C06;&#x5B83;&#x4EEC;&#x8FDB;&#x884C;&#x6BD4;&#x8F83; - &#x6211;&#x4F1A;&#x5C3D;&#x91CF;&#x5C0F;&#x5FC3;&#xFF0C;&#x4F46;&#x6211;&#x627F;&#x8BA4;&#x6211;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x8BA1;&#x65F6;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x65F6;&#x9047;&#x5230;&#x8BB8;&#x591A;&#x57FA;&#x672C;&#x9677;&#x9631;&#x4E4B;&#x4E00;&#x3002;&#x7ED3;&#x679C;&#x53EF;&#x80FD;&#x6709;&#x4E00;&#x4E9B;&#x7F3A;&#x9677;&#xFF08;&#x4F8B;&#x5982;JVM&#x6CA1;&#x6709;&#x201C;&#x70ED;&#x8EAB;&#x201D;&#xFF09;&#xFF0C;&#x4F46;&#x6211;&#x8BA4;&#x4E3A;&#x5B83;&#x4ECD;&#x7136;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x6709;&#x7528;&#x7684;&#x6307;&#x793A;&#x3002;</p>
<p>&#x6211;&#x5C06;&#x4ECE;&#x4E00;&#x4E2A;&#x8BA1;&#x65F6;&#x65B9;&#x6CD5;<strong>timeTest()<strong>&#x5F00;&#x59CB;&#xFF0C;&#x5B83;&#x91C7;&#x7528;</strong>LongSupplier</strong>&#xFF0C;&#x6D4B;&#x91CF;<strong>getAsLong()<strong>&#x8C03;&#x7528;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5C06;&#x7ED3;&#x679C;&#x4E0E;</strong>checkValue</strong>&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x5E76;&#x663E;&#x793A;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4E00;&#x5207;&#x90FD;&#x5FC5;&#x987B;&#x4E25;&#x683C;&#x4F7F;&#x7528;<strong>long</strong>&#xFF1B;&#x6211;&#x82B1;&#x4E86;&#x4E00;&#x4E9B;&#x65F6;&#x95F4;&#x53D1;&#x73B0;&#x9690;&#x853D;&#x7684;&#x6EA2;&#x51FA;&#xFF0C;&#x7136;&#x540E;&#x624D;&#x610F;&#x8BC6;&#x5230;&#x5728;&#x91CD;&#x8981;&#x7684;&#x5730;&#x65B9;&#x9519;&#x8FC7;&#x4E86;<strong>long</strong>&#x3002;</p>
<p>&#x6240;&#x6709;&#x5173;&#x4E8E;&#x65F6;&#x95F4;&#x548C;&#x5185;&#x5B58;&#x7684;&#x6570;&#x5B57;&#x548C;&#x8BA8;&#x8BBA;&#x90FD;&#x662F;&#x6307;&#x201C;&#x6211;&#x7684;&#x673A;&#x5668;&#x201D;&#x3002;&#x4F60;&#x7684;&#x7ECF;&#x5386;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x6240;&#x4E0D;&#x540C;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Summing.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Summing</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">long</span> checkValue<span class="token punctuation">,</span>    <span class="token class-name">LongSupplier</span> operation<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> result <span class="token operator">=</span> operation<span class="token punctuation">.</span><span class="token function">getAsLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">==</span> checkValue<span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;result: %d%ncheckValue: %d%n&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> checkValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SZ <span class="token operator">=</span> <span class="token number">100_000_000</span><span class="token punctuation">;</span>
    <span class="token comment">// This even works:</span>
    <span class="token comment">// public static final int SZ = 1_000_000_000;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> CHECK <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// Gauss&apos;s formula</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>CHECK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Sum Stream&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">LongStream</span><span class="token punctuation">.</span><span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SZ<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Sum Stream Parallel&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">LongStream</span><span class="token punctuation">.</span><span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SZ<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Sum Iterated&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">LongStream</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>SZ<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Slower &amp; runs out of memory above 1_000_000:</span>
        <span class="token comment">// timeTest(&quot;Sum Iterated Parallel&quot;, CHECK, () -&gt;</span>
        <span class="token comment">//   LongStream.iterate(0, i -&gt; i + 1)</span>
        <span class="token comment">//     .parallel()</span>
        <span class="token comment">//     .limit(SZ+1).sum());</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>5000000050000000
Sum Stream: 167ms
Sum Stream Parallel: 46ms
Sum Iterated: 284ms
</code></pre><p><strong>CHECK</strong>&#x503C;&#x662F;&#x4F7F;&#x7528;Carl Friedrich Gauss&#xFF08;&#x9AD8;&#x65AF;&#xFF09;&#x5728;1700&#x5E74;&#x4EE3;&#x540E;&#x671F;&#x8FD8;&#x5728;&#x4E0A;&#x5C0F;&#x5B66;&#x7684;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x7684;&#x516C;&#x5F0F;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;.</p>
<p><strong>main()</strong> &#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x4F7F;&#x7528;&#x76F4;&#x63A5;&#x751F;&#x6210; <strong>Stream</strong> &#x5E76;&#x8C03;&#x7528; <strong>sum()</strong> &#x7684;&#x65B9;&#x6CD5;&#x3002;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x6D41;&#x7684;&#x597D;&#x5904;&#x5728;&#x4E8E;&#x5373;&#x4F7F;SZ&#x4E3A;&#x5341;&#x4EBF;&#xFF08;1_000_000_000&#xFF09;&#x7A0B;&#x5E8F;&#x4E5F;&#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x5730;&#x5904;&#x7406;&#x800C;&#x6CA1;&#x6709;&#x6EA2;&#x51FA;&#xFF08;&#x4E3A;&#x4E86;&#x8BA9;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x5F97;&#x5FEB;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4F7F;&#x7528;&#x4E86;&#x8F83;&#x5C0F;&#x7684;&#x6570;&#x5B57;&#xFF09;&#x3002;&#x4F7F;&#x7528; <strong>parallel()</strong> &#x7684;&#x57FA;&#x672C;&#x8303;&#x56F4;&#x64CD;&#x4F5C;&#x660E;&#x663E;&#x66F4;&#x5FEB;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;<strong>iterate()<strong>&#x6765;&#x751F;&#x6210;&#x5E8F;&#x5217;&#xFF0C;&#x5219;&#x51CF;&#x901F;&#x662F;&#x76F8;&#x5F53;&#x660E;&#x663E;&#x7684;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x6BCF;&#x6B21;&#x751F;&#x6210;&#x6570;&#x5B57;&#x65F6;&#x90FD;&#x5FC5;&#x987B;&#x8C03;&#x7528;lambda&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5E76;&#x884C;&#x5316;&#xFF0C;&#x5F53;</strong>SZ</strong>&#x8D85;&#x8FC7;&#x4E00;&#x767E;&#x4E07;&#x65F6;&#xFF0C;&#x7ED3;&#x679C;&#x4E0D;&#x4EC5;&#x6BD4;&#x975E;&#x5E76;&#x884C;&#x7248;&#x672C;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x66F4;&#x957F;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x4F1A;&#x8017;&#x5C3D;&#x5185;&#x5B58;&#xFF08;&#x5728;&#x67D0;&#x4E9B;&#x673A;&#x5668;&#x4E0A;&#xFF09;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x5F53;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<strong>range()<strong>&#x65F6;&#xFF0C;&#x4F60;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;</strong>iterate()</strong>&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x751F;&#x6210;&#x7684;&#x4E1C;&#x897F;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x4F7F;&#x7528;<strong>iterate()</strong>&#x3002;&#x5E94;&#x7528;**parallel()**&#x662F;&#x4E00;&#x4E2A;&#x5408;&#x7406;&#x7684;&#x5C1D;&#x8BD5;&#xFF0C;&#x4F46;&#x4F1A;&#x4EA7;&#x751F;&#x4EE4;&#x4EBA;&#x60CA;&#x8BB6;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x540E;&#x9762;&#x7684;&#x90E8;&#x5206;&#x4E2D;&#x63A2;&#x8BA8;&#x5185;&#x5B58;&#x9650;&#x5236;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5BF9;&#x6D41;&#x5E76;&#x884C;&#x7B97;&#x6CD5;&#x8FDB;&#x884C;&#x521D;&#x6B65;&#x89C2;&#x5BDF;&#xFF1A;</p>
<ul>
<li>&#x6D41;&#x5E76;&#x884C;&#x6027;&#x5C06;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x6B64;&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x90A3;&#x4E9B;&#x5355;&#x72EC;&#x7684;&#x90E8;&#x5206;&#x3002;</li>
<li>&#x6570;&#x7EC4;&#x5206;&#x5272;&#x6210;&#x672C;&#x4F4E;&#xFF0C;&#x5206;&#x5272;&#x5747;&#x5300;&#x4E14;&#x5BF9;&#x5206;&#x5272;&#x7684;&#x5927;&#x5C0F;&#x6709;&#x7740;&#x5B8C;&#x7F8E;&#x7684;&#x638C;&#x63A7;&#x3002;</li>
<li>&#x94FE;&#x8868;&#x6CA1;&#x6709;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;;&#x201C;&#x62C6;&#x5206;&#x201D;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#x4EC5;&#x4EC5;&#x610F;&#x5473;&#x7740;&#x628A;&#x5B83;&#x5206;&#x6210;&#x201C;&#x7B2C;&#x4E00;&#x5143;&#x7D20;&#x201D;&#x548C;&#x201C;&#x5176;&#x4F59;&#x5143;&#x7D20;&#x201D;&#xFF0C;&#x8FD9;&#x76F8;&#x5BF9;&#x65E0;&#x7528;&#x3002;</li>
<li>&#x65E0;&#x72B6;&#x6001;&#x751F;&#x6210;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#x4E8E;&#x6570;&#x7EC4;;&#x4E0A;&#x9762;&#x4F7F;&#x7528;&#x7684; <strong>range()</strong> &#x5C31;&#x662F;&#x65E0;&#x72B6;&#x6001;&#x7684;&#x3002;</li>
<li>&#x8FED;&#x4EE3;&#x751F;&#x6210;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#x4E8E;&#x94FE;&#x8868;; <strong>iterate()</strong> &#x662F;&#x4E00;&#x4E2A;&#x8FED;&#x4EE3;&#x751F;&#x6210;&#x5668;&#x3002;</li>
</ul>
<p>&#x73B0;&#x5728;&#x8BA9;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x586B;&#x5145;&#x503C;&#x5E76;&#x5BF9;&#x6570;&#x7EC4;&#x6C42;&#x548C;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;&#x56E0;&#x4E3A;&#x6570;&#x7EC4;&#x53EA;&#x5206;&#x914D;&#x4E86;&#x4E00;&#x6B21;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x592A;&#x53EF;&#x80FD;&#x9047;&#x5230;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x5E8F;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x5C06;&#x5C1D;&#x8BD5;&#x4E00;&#x4E2A;&#x5145;&#x6EE1;&#x539F;&#x59CB;<strong>long</strong>&#x7684;&#x6570;&#x7EC4;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Summing2.java</span>
<span class="token comment">// {ExcludeFromTravisCI}import java.util.*;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Summing2</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">basicSum</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> ia<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            sum <span class="token operator">+=</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Approximate largest value of SZ before</span>
    <span class="token comment">// running out of memory on mymachine:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SZ <span class="token operator">=</span> <span class="token number">20_000_000</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> CHECK <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>CHECK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> la <span class="token operator">=</span> newlong<span class="token punctuation">[</span>SZ<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">parallelSetAll</span><span class="token punctuation">(</span>la<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Array Stream Sum&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>la<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Parallel&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>la<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Basic Sum&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token function">basicSum</span><span class="token punctuation">(</span>la<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Destructive summation:</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;parallelPrefix&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">parallelPrefix</span><span class="token punctuation">(</span>la<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> la<span class="token punctuation">[</span>la<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>200000010000000
Array Stream
Sum: 104ms
Parallel: 81ms
Basic Sum: 106ms
parallelPrefix: 265ms
</code></pre><p>&#x7B2C;&#x4E00;&#x4E2A;&#x9650;&#x5236;&#x662F;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#xFF1B;&#x56E0;&#x4E3A;&#x6570;&#x7EC4;&#x662F;&#x9884;&#x5148;&#x5206;&#x914D;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x521B;&#x5EFA;&#x51E0;&#x4E4E;&#x4E0E;&#x4EE5;&#x524D;&#x7248;&#x672C;&#x4E00;&#x6837;&#x5927;&#x7684;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x3002;&#x5E76;&#x884C;&#x5316;&#x53EF;&#x4EE5;&#x52A0;&#x5FEB;&#x901F;&#x5EA6;&#xFF0C;&#x751A;&#x81F3;&#x6BD4;&#x4F7F;&#x7528; <strong>basicSum()</strong> &#x5FAA;&#x73AF;&#x66F4;&#x5FEB;&#x3002;&#x6709;&#x8DA3;&#x7684;&#x662F;&#xFF0C; <strong>Arrays.parallelPrefix()</strong> &#x4F3C;&#x4E4E;&#x5B9E;&#x9645;&#x4E0A;&#x51CF;&#x6162;&#x4E86;&#x901F;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x4E9B;&#x6280;&#x672F;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x79CD;&#x5728;&#x5176;&#x4ED6;&#x6761;&#x4EF6;&#x4E0B;&#x90FD;&#x53EF;&#x80FD;&#x66F4;&#x6709;&#x7528; - &#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x4F60;&#x4E0D;&#x80FD;&#x505A;&#x51FA;&#x4EFB;&#x4F55;&#x786E;&#x5B9A;&#x6027;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x9664;&#x4E86;&#x201C;&#x4F60;&#x5FC5;&#x987B;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x201D;&#x3002;</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x5305;&#x88C5;&#x7C7B;<strong>Long</strong>&#x7684;&#x6548;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Summing3.java</span>
<span class="token comment">// {ExcludeFromTravisCI}</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Summing3</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">basicSum</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> ia<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            sum <span class="token operator">+=</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Approximate largest value of SZ before</span>
    <span class="token comment">// running out of memory on my machine:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SZ <span class="token operator">=</span> <span class="token number">10_000_000</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> CHECK <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>SZ <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>CHECK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> aL <span class="token operator">=</span> newLong<span class="token punctuation">[</span>SZ<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">parallelSetAll</span><span class="token punctuation">(</span>aL<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Long Array Stream Reduce&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>aL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Long Basic Sum&quot;</span><span class="token punctuation">,</span> CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token function">basicSum</span><span class="token punctuation">(</span>aL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Destructive summation:</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Long parallelPrefix&quot;</span><span class="token punctuation">,</span>CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">parallelPrefix</span><span class="token punctuation">(</span>aL<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> aL<span class="token punctuation">[</span>aL<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>50000005000000
Long Array
Stream Reduce: 1038ms
Long Basic
Sum: 21ms
Long parallelPrefix: 3616ms
</code></pre><p>&#x73B0;&#x5728;&#x53EF;&#x7528;&#x7684;&#x5185;&#x5B58;&#x91CF;&#x5927;&#x7EA6;&#x51CF;&#x534A;&#xFF0C;&#x5E76;&#x4E14;&#x6240;&#x6709;&#x60C5;&#x51B5;&#x4E0B;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x90FD;&#x4F1A;&#x5F88;&#x957F;&#xFF0C;&#x9664;&#x4E86;<strong>basicSum()</strong>&#xFF0C;&#x5B83;&#x53EA;&#x662F;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6570;&#x7EC4;&#x3002;&#x4EE4;&#x4EBA;&#x60CA;&#x8BB6;&#x7684;&#x662F;&#xFF0C; <strong>Arrays.parallelPrefix()</strong> &#x6BD4;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x90FD;&#x8981;&#x82B1;&#x8D39;&#x66F4;&#x957F;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x6211;&#x5C06; <strong>parallel()</strong> &#x7248;&#x672C;&#x5206;&#x5F00;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x8FD0;&#x884C;&#x5B83;&#x5BFC;&#x81F4;&#x4E86;&#x4E00;&#x4E2A;&#x5197;&#x957F;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C;&#x626D;&#x66F2;&#x4E86;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Summing4.java</span>
<span class="token comment">// {ExcludeFromTravisCI}</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Summing4</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Summing3</span><span class="token punctuation">.</span>CHECK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> aL <span class="token operator">=</span> newLong<span class="token punctuation">[</span><span class="token class-name">Summing3</span><span class="token punctuation">.</span>SZ<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">parallelSetAll</span><span class="token punctuation">(</span>aL<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Summing</span><span class="token punctuation">.</span><span class="token function">timeTest</span><span class="token punctuation">(</span><span class="token string">&quot;Long Parallel&quot;</span><span class="token punctuation">,</span>
        <span class="token class-name">Summing3</span><span class="token punctuation">.</span>CHECK<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>aL<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">,</span><span class="token class-name">Long</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>50000005000000
Long Parallel: 1014ms
</code></pre><p>&#x5B83;&#x6BD4;&#x975E;parallel()&#x7248;&#x672C;&#x7565;&#x5FEB;&#xFF0C;&#x4F46;&#x5E76;&#x4E0D;&#x663E;&#x7740;&#x3002;</p>
<p>&#x5BFC;&#x81F4;&#x65F6;&#x95F4;&#x589E;&#x52A0;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x539F;&#x56E0;&#x662F;&#x5904;&#x7406;&#x5668;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x3002;&#x4F7F;&#x7528;<strong>Summing2.java</strong>&#x4E2D;&#x7684;&#x539F;&#x59CB;<strong>long</strong>&#xFF0C;&#x6570;&#x7EC4;<strong>la</strong>&#x662F;&#x8FDE;&#x7EED;&#x7684;&#x5185;&#x5B58;&#x3002;&#x5904;&#x7406;&#x5668;&#x53EF;&#x4EE5;&#x66F4;&#x5BB9;&#x6613;&#x5730;&#x9884;&#x6D4B;&#x8BE5;&#x9635;&#x5217;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x5E76;&#x4F7F;&#x7F13;&#x5B58;&#x5145;&#x6EE1;&#x4E0B;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x7684;&#x9635;&#x5217;&#x5143;&#x7D20;&#x3002;&#x8BBF;&#x95EE;&#x7F13;&#x5B58;&#x6BD4;&#x8BBF;&#x95EE;&#x4E3B;&#x5185;&#x5B58;&#x5FEB;&#x5F97;&#x591A;&#x3002;&#x4F3C;&#x4E4E; <strong>Long parallelPrefix</strong> &#x8BA1;&#x7B97;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E3A;&#x6BCF;&#x4E2A;&#x8BA1;&#x7B97;&#x8BFB;&#x53D6;&#x4E24;&#x4E2A;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x5199;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;&#x90FD;&#x4E3A;<strong>Long</strong>&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x8D85;&#x51FA;&#x7F13;&#x5B58;&#x7684;&#x5F15;&#x7528;&#x3002;</p>
<p>&#x4F7F;&#x7528;<strong>Summing3.java</strong>&#x548C;<strong>Summing4.java</strong>&#xFF0C;<strong>aL</strong>&#x662F;&#x4E00;&#x4E2A;<strong>Long</strong>&#x6570;&#x7EC4;&#xFF0C;&#x5B83;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x8FDE;&#x7EED;&#x7684;&#x6570;&#x636E;&#x6570;&#x7EC4;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x4E2A;&#x8FDE;&#x7EED;&#x7684;<strong>Long</strong>&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x6570;&#x7EC4;&#x3002;&#x5C3D;&#x7BA1;&#x8BE5;&#x6570;&#x7EC4;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x7F13;&#x5B58;&#x4E2D;&#x51FA;&#x73B0;&#xFF0C;&#x4F46;&#x6307;&#x5411;&#x7684;&#x5BF9;&#x8C61;&#x51E0;&#x4E4E;&#x603B;&#x662F;&#x4E0D;&#x5728;&#x7F13;&#x5B58;&#x4E2D;&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x793A;&#x4F8B;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;SZ&#x503C;&#x6765;&#x663E;&#x793A;&#x5185;&#x5B58;&#x9650;&#x5236;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x8FDB;&#x884C;&#x65F6;&#x95F4;&#x6BD4;&#x8F83;&#xFF0C;&#x4EE5;&#x4E0B;&#x662F;SZ&#x8BBE;&#x7F6E;&#x4E3A;&#x6700;&#x5C0F;&#x503C;1000&#x4E07;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><strong>Sum Stream: 69msSum<br>
Stream Parallel: 18msSum<br>
Iterated: 277ms<br>
Array Stream Sum: 57ms<br>
Parallel: 14ms<br>
Basic Sum: 16ms<br>
parallelPrefix: 28ms<br>
Long Array Stream Reduce: 1046ms<br>
Long Basic Sum: 21ms<br>
Long parallelPrefix: 3287ms<br>
Long Parallel: 1008ms</strong></p>
<p>&#x867D;&#x7136;Java 8&#x7684;&#x5404;&#x79CD;&#x5185;&#x7F6E;&#x201C;&#x5E76;&#x884C;&#x201D;&#x5DE5;&#x5177;&#x975E;&#x5E38;&#x68D2;&#xFF0C;&#x4F46;&#x6211;&#x8BA4;&#x4E3A;&#x5B83;&#x4EEC;&#x88AB;&#x89C6;&#x4E3A;&#x795E;&#x5947;&#x7684;&#x7075;&#x4E39;&#x5999;&#x836F;&#xFF1A;&#x201C;&#x53EA;&#x9700;&#x6DFB;&#x52A0;parallel()&#x5E76;&#x4E14;&#x5B83;&#x4F1A;&#x66F4;&#x5FEB;&#xFF01;&#x201D; &#x6211;&#x5E0C;&#x671B;&#x6211;&#x5DF2;&#x7ECF;&#x5F00;&#x59CB;&#x8868;&#x660E;&#x60C5;&#x51B5;&#x5E76;&#x975E;&#x6240;&#x6709;&#x90FD;&#x662F;&#x5982;&#x6B64;&#xFF0C;&#x5E76;&#x4E14;&#x76F2;&#x76EE;&#x5730;&#x5E94;&#x7528;&#x5185;&#x7F6E;&#x7684;&#x201C;&#x5E76;&#x884C;&#x201D;&#x64CD;&#x4F5C;&#x6709;&#x65F6;&#x751A;&#x81F3;&#x4F1A;&#x4F7F;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x660E;&#x663E;&#x53D8;&#x6162;&#x3002;</p>
<ul>
<li>parallel()/limit()&#x4EA4;&#x70B9;</li>
</ul>
<p>&#x4F7F;&#x7528;**parallel()**&#x65F6;&#x4F1A;&#x6709;&#x66F4;&#x590D;&#x6742;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4ECE;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x4E2D;&#x5438;&#x53D6;&#x7684;&#x6D41;&#x673A;&#x5236;&#x88AB;&#x8BBE;&#x8BA1;&#x4E3A;&#x5927;&#x7EA6;&#x662F;&#x4E00;&#x4E2A;&#x65E0;&#x9650;&#x7684;&#x6D41;&#x6A21;&#x578B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x62E5;&#x6709;&#x6709;&#x9650;&#x6570;&#x91CF;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x96C6;&#x5408;&#x4EE5;&#x53CA;&#x4E3A;&#x6709;&#x9650;&#x5927;&#x5C0F;&#x7684;&#x96C6;&#x5408;&#x8BBE;&#x8BA1;&#x7684;&#x5173;&#x8054;&#x7B97;&#x6CD5;&#x3002;&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528;&#x65E0;&#x9650;&#x6D41;&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x9488;&#x5BF9;&#x6D41;&#x4F18;&#x5316;&#x7684;&#x7B97;&#x6CD5;&#x3002;</p>
<p>Java 8&#x5C06;&#x4E24;&#x8005;&#x5408;&#x5E76;&#x8D77;&#x6765;&#x3002;&#x4F8B;&#x5982;&#xFF0C;<strong>Collections</strong>&#x6CA1;&#x6709;&#x5185;&#x7F6E;&#x7684;<strong>map()<strong>&#x64CD;&#x4F5C;&#x3002;&#x5728;</strong>Collection</strong>&#x548C;<strong>Map</strong>&#x4E2D;&#x552F;&#x4E00;&#x7C7B;&#x4F3C;&#x6D41;&#x7684;&#x6279;&#x5904;&#x7406;&#x64CD;&#x4F5C;&#x662F;<strong>forEach()</strong>&#x3002;&#x5982;&#x679C;&#x8981;&#x6267;&#x884C;<strong>map()<strong>&#x548C;</strong>reduce()<strong>&#x7B49;&#x64CD;&#x4F5C;&#xFF0C;&#x5FC5;&#x987B;&#x9996;&#x5148;&#x5C06;</strong>Collection</strong>&#x8F6C;&#x6362;&#x4E3A;&#x5B58;&#x5728;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7684;<strong>Stream</strong>:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CollectionIntoStream.java</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CollectionIntoStream</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strings <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Rand</span><span class="token punctuation">.</span><span class="token class-name">String</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Convert to a Stream for many more options:</span>
    <span class="token class-name">String</span> result <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">toUpperCase</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>btpen
pccux
szgvg
meinn
eeloz
tdvew
cippc
ygpoa
lkljl
bynxt
:PENCUXGVGINNLOZVEWPPCPOALJLNXT
</code></pre><p><strong>Collection</strong>&#x786E;&#x5B9E;&#x6709;&#x4E00;&#x4E9B;&#x6279;&#x5904;&#x7406;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;<strong>removeAll()</strong>&#xFF0C;<strong>removeIf()<strong>&#x548C;</strong>retainAll()</strong>&#xFF0C;&#x4F46;&#x8FD9;&#x4E9B;&#x90FD;&#x662F;&#x7834;&#x574F;&#x6027;&#x7684;&#x64CD;&#x4F5C;&#x3002;<strong>ConcurrentHashMap</strong>&#x5BF9;<strong>forEach</strong>&#x548C;<strong>reduce</strong>&#x64CD;&#x4F5C;&#x6709;&#x7279;&#x522B;&#x5E7F;&#x6CDB;&#x7684;&#x652F;&#x6301;&#x3002;</p>
<p>&#x5728;&#x8BB8;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EA;&#x5728;&#x96C6;&#x5408;&#x4E0A;&#x8C03;&#x7528;<strong>stream()<strong>&#x6216;&#x8005;</strong>parallelStream()<strong>&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6709;&#x65F6;&#x5C06;</strong>Stream</strong>&#x4E0E;<strong>Collection</strong>&#x6DF7;&#x5408;&#x4F1A;&#x4EA7;&#x751F;&#x610F;&#x60F3;&#x4E0D;&#x5230;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x8DA3;&#x7684;&#x96BE;&#x9898;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/ParallelStreamPuzzle.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ParallelStreamPuzzle</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IntGenerator</span>
    <span class="token keyword">implements</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> current<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> x <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token function">newIntGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// [1]</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Output:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
*/</span>
</pre><p>&#x5982;&#x679C;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x6CE8;&#x91CA;&#x8FD0;&#x884C;&#x5B83;&#xFF0C;&#x5B83;&#x4F1A;&#x4EA7;&#x751F;&#x9884;&#x671F;&#x7684;&#xFF1A;<br>
<strong>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</strong><br>
&#x6BCF;&#x6B21;&#x3002;&#x4F46;&#x662F;&#x5305;&#x542B;&#x4E86;parallel()&#xFF0C;&#x5B83;&#x770B;&#x8D77;&#x6765;&#x50CF;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x6570;&#x751F;&#x6210;&#x5668;&#xFF0C;&#x5E26;&#x6709;&#x8F93;&#x51FA;&#xFF08;&#x4ECE;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x5230;&#x4E0B;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x4E0D;&#x540C;&#xFF09;&#xFF0C;&#x5982;&#xFF1A;<br>
<strong>[0, 3, 6, 8, 11, 14, 17, 20, 23, 26]</strong><br>
&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7A0B;&#x5E8F;&#x600E;&#x4E48;&#x4F1A;&#x5982;&#x6B64;&#x7CDF;&#x7CD5;&#x5462;&#xFF1F;&#x8BA9;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x76EE;&#x6807;&#xFF1A;&#x201C;&#x5E76;&#x884C;&#x751F;&#x6210;&#x3002;&#x201D;&#x90A3;&#x610F;&#x5473;&#x7740;&#x4EC0;&#x4E48;&#xFF1F;&#x4E00;&#x5806;&#x7EBF;&#x7A0B;&#x90FD;&#x5728;&#x4ECE;&#x4E00;&#x4E2A;&#x751F;&#x6210;&#x5668;&#x53D6;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x4EE5;&#x67D0;&#x79CD;&#x65B9;&#x5F0F;&#x9009;&#x62E9;&#x6709;&#x9650;&#x7684;&#x7ED3;&#x679C;&#x96C6;&#xFF1F;&#x4EE3;&#x7801;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x5B83;&#x53D8;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x522B;&#x68D8;&#x624B;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x770B;&#x5230;&#x5B83;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x4EEA;&#x5668;&#x3002;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x6B63;&#x5728;&#x5904;&#x7406;&#x7EBF;&#x7A0B;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x5C06;&#x4EFB;&#x4F55;&#x8DDF;&#x8E2A;&#x4FE1;&#x606F;&#x6355;&#x83B7;&#x5230;&#x5E76;&#x53D1;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E2D;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;<strong>ConcurrentLinkedDeque</strong>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/ParallelStreamPuzzle2.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ParallelStreamPuzzle2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> TRACE <span class="token operator">=</span>
    <span class="token keyword">new</span> <span class="token class-name">ConcurrentLinkedDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span>
    <span class="token class-name">IntGenerator</span> <span class="token keyword">implements</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">AtomicInteger</span> current <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            TRACE<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>current<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> current<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> x <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token function">newIntGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;PSP2.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TRACE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</code></pre><p>current&#x662F;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684; <strong>AtomicInteger</strong> &#x7C7B;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF1B;<strong>parallel()<strong>&#x5141;&#x8BB8;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;</strong>get()</strong>&#x3002;</p>
<p>&#x5728;&#x67E5;&#x770B; <strong>PSP2.txt</strong>.<strong>IntGenerator.get()</strong> &#x88AB;&#x8C03;&#x7528;1024&#x6B21;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x611F;&#x5230;&#x60CA;&#x8BB6;&#x3002;</p>
<p><strong>0: main<br>
1: ForkJoinPool.commonPool-worker-1<br>
2: ForkJoinPool.commonPool-worker-2<br>
3: ForkJoinPool.commonPool-worker-2<br>
4: ForkJoinPool.commonPool-worker-1<br>
5: ForkJoinPool.commonPool-worker-1<br>
6: ForkJoinPool.commonPool-worker-1<br>
7: ForkJoinPool.commonPool-worker-1<br>
8: ForkJoinPool.commonPool-worker-4<br>
9: ForkJoinPool.commonPool-worker-4<br>
10: ForkJoinPool.commonPool-worker-4<br>
11: main<br>
12: main<br>
13: main<br>
14: main<br>
15: main...10<br>
17: ForkJoinPool.commonPool-worker-110<br>
18: ForkJoinPool.commonPool-worker-610<br>
19: ForkJoinPool.commonPool-worker-610<br>
20: ForkJoinPool.commonPool-worker-110<br>
21: ForkJoinPool.commonPool-worker-110<br>
22: ForkJoinPool.commonPool-worker-110<br>
23: ForkJoinPool.commonPool-worker-1</strong></p>
<p>&#x8FD9;&#x4E2A;&#x5757;&#x5927;&#x5C0F;&#x4F3C;&#x4E4E;&#x662F;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF08;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;<code>limit()</code> &#x7684;&#x4E0D;&#x540C;&#x53C2;&#x6570;&#x6765;&#x67E5;&#x770B;&#x4E0D;&#x540C;&#x7684;&#x5757;&#x5927;&#x5C0F;&#xFF09;&#x3002;&#x5C06;<code>parallel()</code>&#x4E0E;<code>limit()</code>&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x53EF;&#x4EE5;&#x9884;&#x53D6;&#x4E00;&#x4E32;&#x503C;&#xFF0C;&#x4F5C;&#x4E3A;&#x6D41;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x8BD5;&#x7740;&#x60F3;&#x8C61;&#x4E00;&#x4E0B;&#x8FD9;&#x91CC;&#x53D1;&#x751F;&#x4E86;&#x4EC0;&#x4E48;&#xFF1A;&#x4E00;&#x4E2A;&#x6D41;&#x62BD;&#x8C61;&#x51FA;&#x65E0;&#x9650;&#x5E8F;&#x5217;&#xFF0C;&#x6309;&#x9700;&#x751F;&#x6210;&#x3002;&#x5F53;&#x4F60;&#x8981;&#x6C42;&#x5B83;&#x5E76;&#x884C;&#x4EA7;&#x751F;&#x6D41;&#x65F6;&#xFF0C;&#x4F60;&#x8981;&#x6C42;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x7EBF;&#x7A0B;&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x8C03;&#x7528;<code>get()</code>&#x3002;&#x6DFB;&#x52A0;<code>limit()</code>&#xFF0C;&#x4F60;&#x8BF4;&#x201C;&#x53EA;&#x9700;&#x8981;&#x8FD9;&#x4E9B;&#x3002;&#x201D;&#x57FA;&#x672C;&#x4E0A;&#xFF0C;&#x5F53;&#x4F60;&#x4E3A;&#x4E86;&#x968F;&#x673A;&#x8F93;&#x51FA;&#x800C;&#x9009;&#x62E9;&#x5C06;<code>parallel()</code>&#x4E0E;<code>limit()</code>&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x5BF9;&#x4F60;&#x6B63;&#x5728;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x6709;&#x6548;&#x3002;&#x4F46;&#x662F;&#x5F53;&#x4F60;&#x8FD9;&#x6837;&#x505A;&#x65F6;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x660E;&#x767D;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4EC5;&#x9650;&#x4E13;&#x5BB6;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8981;&#x4E89;&#x8FA9;&#x8BF4;&#x201C;Java&#x5F04;&#x9519;&#x4E86;&#x201D;&#x3002;</p>
<p>&#x4EC0;&#x4E48;&#x662F;&#x66F4;&#x5408;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#xFF1F;&#x597D;&#x5427;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x751F;&#x6210;&#x4E00;&#x4E2A;int&#x6D41;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;IntStream.range()&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/ParallelStreamPuzzle3.java</span>
<span class="token comment">// {VisuallyInspectOutput}</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ParallelStreamPuzzle3</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> x <span class="token operator">=</span> <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>e <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">boxed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>8: main
6: ForkJoinPool.commonPool-worker-5
3: ForkJoinPool.commonPool-worker-7
5: ForkJoinPool.commonPool-worker-5
1: ForkJoinPool.commonPool-worker-3
2: ForkJoinPool.commonPool-worker-6
4: ForkJoinPool.commonPool-worker-1
0: ForkJoinPool.commonPool-worker-4
7: ForkJoinPool.commonPool-worker-1
9: ForkJoinPool.commonPool-worker-2
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</code></pre><p>&#x4E3A;&#x4E86;&#x8868;&#x660E;**parallel()<strong>&#x786E;&#x5B9E;&#x6709;&#x6548;&#xFF0C;&#x6211;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x5BF9;</strong>peek()**&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x7684;&#x6D41;&#x51FD;&#x6570;&#xFF1A;&#x5B83;&#x4ECE;&#x6D41;&#x4E2D;&#x63D0;&#x53D6;&#x4E00;&#x4E2A;&#x503C;&#x5E76;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x64CD;&#x4F5C;&#x4F46;&#x4E0D;&#x5F71;&#x54CD;&#x4ECE;&#x6D41;&#x5411;&#x4E0B;&#x4F20;&#x9012;&#x7684;&#x5143;&#x7D20;&#x3002;&#x6CE8;&#x610F;&#x8FD9;&#x4F1A;&#x5E72;&#x6270;&#x7EBF;&#x7A0B;&#x884C;&#x4E3A;&#xFF0C;&#x4F46;&#x6211;&#x53EA;&#x662F;&#x5C1D;&#x8BD5;&#x5728;&#x8FD9;&#x91CC;&#x505A;&#x4E00;&#x4E9B;&#x4E8B;&#x60C5;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5B9E;&#x9645;&#x8C03;&#x8BD5;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x3002;</p>
<p>&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x770B;&#x5230;<strong>boxed()<strong>&#x7684;&#x6DFB;&#x52A0;&#xFF0C;&#x5B83;&#x63A5;&#x53D7;</strong>int</strong>&#x6D41;&#x5E76;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;<strong>Integer</strong>&#x6D41;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x4EA7;&#x751F;&#x4E0D;&#x540C;&#x7684;&#x503C;&#xFF0C;&#x4F46;&#x5B83;&#x53EA;&#x4EA7;&#x751F;10&#x4E2A;&#x8BF7;&#x6C42;&#x7684;&#x503C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;1024&#x4E2A;&#x4EA7;&#x751F;10&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x5B83;&#x66F4;&#x5FEB;&#x5417;&#xFF1F;&#x4E00;&#x4E2A;&#x66F4;&#x597D;&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF1A;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x6709;&#x610F;&#x4E49;&#xFF1F;&#x5F53;&#x7136;&#x4E0D;&#x662F;&#x8FD9;&#x4E48;&#x5C0F;&#x7684;&#x4E00;&#x5957;&#xFF1B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x7684;&#x4EE3;&#x4EF7;&#x8FDC;&#x8FDC;&#x8D85;&#x8FC7;&#x5E76;&#x884C;&#x6027;&#x7684;&#x4EFB;&#x4F55;&#x52A0;&#x901F;&#x3002;&#x5F88;&#x96BE;&#x60F3;&#x8C61;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x7528;&#x5E76;&#x884C;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6570;&#x5B57;&#x5E8F;&#x5217;&#x4F1A;&#x6709;&#x610F;&#x4E49;&#x3002;&#x5982;&#x679C;&#x4F60;&#x8981;&#x751F;&#x6210;&#x7684;&#x4E1C;&#x897F;&#x9700;&#x8981;&#x5F88;&#x9AD8;&#x7684;&#x6210;&#x672C;&#xFF0C;&#x5B83;&#x53EF;&#x80FD;&#x6709;&#x610F;&#x4E49; - &#x4F46;&#x8FD9;&#x90FD;&#x662F;&#x731C;&#x6D4B;&#x3002;&#x53EA;&#x6709;&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;&#x6211;&#x4EEC;&#x624D;&#x80FD;&#x77E5;&#x9053;&#x7528;&#x5E76;&#x884C;&#x662F;&#x5426;&#x6709;&#x6548;&#x3002;&#x8BB0;&#x4F4F;&#x8FD9;&#x53E5;&#x683C;&#x8A00;&#xFF1A;&#x201C;&#x9996;&#x5148;&#x4F7F;&#x5B83;&#x5DE5;&#x4F5C;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x5B83;&#x66F4;&#x5FEB;&#x5730;&#x5DE5;&#x4F5C; - &#x53EA;&#x6709;&#x5F53;&#x4F60;&#x5FC5;&#x987B;&#x8FD9;&#x6837;&#x505A;&#x65F6;&#x3002;&#x201D;**parallel()<strong>&#x548C;</strong>limit()**&#x4EC5;&#x4F9B;&#x4E13;&#x5BB6;&#x4F7F;&#x7528;&#xFF08;&#x628A;&#x8BDD;&#x8BF4;&#x5728;&#x524D;&#x9762;&#xFF0C;&#x6211;&#x4E0D;&#x8BA4;&#x4E3A;&#x81EA;&#x5DF1;&#x662F;&#x8FD9;&#x91CC;&#x7684;&#x4E13;&#x5BB6;&#xFF09;&#x3002;</p>
<ul>
<li>&#x5E76;&#x884C;&#x6D41;&#x53EA;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x5BB9;&#x6613;</li>
</ul>
<p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5728;&#x8BB8;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E76;&#x884C;&#x6D41;&#x786E;&#x5B9E;&#x53EF;&#x4EE5;&#x6BEB;&#x4E0D;&#x8D39;&#x529B;&#x5730;&#x66F4;&#x5FEB;&#x5730;&#x4EA7;&#x751F;&#x7ED3;&#x679C;&#x3002;&#x4F46;&#x6B63;&#x5982;&#x4F60;&#x6240;&#x89C1;&#xFF0C;&#x4EC5;&#x4EC5;&#x5C06;**parallel()<strong>&#x52A0;&#x5230;&#x4F60;&#x7684;Stream&#x64CD;&#x4F5C;&#x4E0A;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x5B89;&#x5168;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#x5728;&#x4F7F;&#x7528;</strong>parallel()**&#x4E4B;&#x524D;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x4E86;&#x89E3;&#x5E76;&#x884C;&#x6027;&#x5982;&#x4F55;&#x5E2E;&#x52A9;&#x6216;&#x635F;&#x5BB3;&#x4F60;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x8BA4;&#x77E5;&#x9519;&#x8BEF;&#x5C31;&#x662F;&#x8BA4;&#x4E3A;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x6027;&#x603B;&#x662F;&#x4E00;&#x4E2A;&#x597D;&#x4E3B;&#x610F;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#x5E76;&#x4E0D;&#x662F;&#x3002;Stream&#x610F;&#x5473;&#x7740;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x91CD;&#x5199;&#x6240;&#x6709;&#x4EE3;&#x7801;&#x4FBF;&#x53EF;&#x4EE5;&#x5E76;&#x884C;&#x8FD0;&#x884C;&#x5B83;&#x3002;&#x4F46;&#x662F;&#x6D41;&#x7684;&#x51FA;&#x73B0;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x4F60;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x7406;&#x89E3;&#x5E76;&#x884C;&#x7684;&#x539F;&#x7406;&#x4EE5;&#x53CA;&#x4E0D;&#x7528;&#x8003;&#x8651;&#x5E76;&#x884C;&#x662F;&#x5426;&#x771F;&#x7684;&#x6709;&#x52A9;&#x4E8E;&#x5B9E;&#x73B0;&#x4F60;&#x7684;&#x76EE;&#x6807;&#x3002;</p>
<h2 class="mume-header" id="%E5%88%9B%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E4%BB%BB%E5%8A%A1">&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;</h2>

<p>&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x5E76;&#x884C;&#x6D41;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x521B;&#x5EFA;&#x5E76;&#x8FD0;&#x884C;&#x81EA;&#x5DF1;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x7A0D;&#x540E;&#x4F60;&#x5C06;&#x770B;&#x5230;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x7406;&#x60F3;Java 8&#x65B9;&#x6CD5;&#x662F;CompletableFuture&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x66F4;&#x57FA;&#x672C;&#x7684;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;&#x6982;&#x5FF5;&#x3002;</p>
<p>Java&#x5E76;&#x53D1;&#x7684;&#x5386;&#x53F2;&#x59CB;&#x4E8E;&#x975E;&#x5E38;&#x539F;&#x59CB;&#x548C;&#x6709;&#x95EE;&#x9898;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x5E76;&#x4E14;&#x5145;&#x6EE1;&#x4E86;&#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x7684;&#x6539;&#x8FDB;&#x3002;&#x8FD9;&#x4E9B;&#x4E3B;&#x8981;&#x5F52;&#x5165;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x4F4E;&#x7EA7;&#x5E76;&#x53D1;(Appendix: Low-Level Concurrency)</a>&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5C55;&#x793A;&#x4E00;&#x4E2A;&#x89C4;&#x8303;&#x5F62;&#x5F0F;&#xFF0C;&#x8868;&#x793A;&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x6700;&#x7B80;&#x5355;&#xFF0C;&#x6700;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4E0E;&#x5E76;&#x53D1;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x4E00;&#x6837;&#xFF0C;&#x5B58;&#x5728;&#x5404;&#x79CD;&#x53D8;&#x4F53;&#xFF0C;&#x4F46;&#x8FD9;&#x4E9B;&#x53D8;&#x4F53;&#x8981;&#x4E48;&#x964D;&#x7EA7;&#x5230;&#x8BE5;&#x9644;&#x5F55;&#xFF0C;&#x8981;&#x4E48;&#x8D85;&#x51FA;&#x672C;&#x4E66;&#x7684;&#x8303;&#x56F4;&#x3002;</p>
<ul>
<li>Tasks and Executors</li>
</ul>
<p>&#x5728;Java&#x7684;&#x65E9;&#x671F;&#x7248;&#x672C;&#x4E2D;&#xFF0C;&#x4F60;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;Thread&#x5BF9;&#x8C61;&#x6765;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x751A;&#x81F3;&#x5C06;&#x5B83;&#x4EEC;&#x5B50;&#x7C7B;&#x5316;&#x4EE5;&#x521B;&#x5EFA;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x7279;&#x5B9A;&#x201C;&#x4EFB;&#x52A1;&#x7EBF;&#x7A0B;&#x201D;&#x5BF9;&#x8C61;&#x3002;&#x4F60;&#x624B;&#x52A8;&#x8C03;&#x7528;&#x4E86;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5E76;&#x81EA;&#x5DF1;&#x542F;&#x52A8;&#x4E86;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x7EBF;&#x7A0B;&#x7684;&#x5F00;&#x9500;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x91CD;&#x8981;&#xFF0C;&#x73B0;&#x5728;&#x4E0D;&#x9F13;&#x52B1;&#x91C7;&#x7528;&#x624B;&#x52A8;&#x64CD;&#x4F5C;&#x65B9;&#x6CD5;&#x3002;&#x5728;Java 5&#x4E2D;&#xFF0C;&#x6DFB;&#x52A0;&#x4E86;&#x7C7B;&#x6765;&#x4E3A;&#x4F60;&#x5904;&#x7406;&#x7EBF;&#x7A0B;&#x6C60;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x4EFB;&#x52A1;&#x521B;&#x5EFA;&#x4E3A;&#x5355;&#x72EC;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x4EA4;&#x7ED9;ExecutorService&#x4EE5;&#x8FD0;&#x884C;&#x8BE5;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E3A;&#x6BCF;&#x79CD;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x4EFB;&#x52A1;&#x521B;&#x5EFA;&#x65B0;&#x7684;Thread&#x5B50;&#x7C7B;&#x578B;&#x3002;ExecutorService&#x4E3A;&#x4F60;&#x7BA1;&#x7406;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x540E;&#x91CD;&#x65B0;&#x5FAA;&#x73AF;&#x7EBF;&#x7A0B;&#x800C;&#x4E0D;&#x662F;&#x4E22;&#x5F03;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x51E0;&#x4E4E;&#x4E0D;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x5B83;&#x201C;sleep&#x201D;&#xFF08;&#x6682;&#x505C;&#x6267;&#x884C;&#xFF09;100&#x6BEB;&#x79D2;&#xFF0C;&#x663E;&#x793A;&#x5176;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x6B63;&#x5728;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x7EBF;&#x7A0B;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x7136;&#x540E;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/NapTask.java</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NapTask</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    finalint id<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">NapTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Seconds</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token operator">+</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token string">&quot;NapTask[&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x4E2A;<strong>Runnable</strong>&#xFF1A;&#x4E00;&#x4E2A;&#x5305;&#x542B;<strong>run()<strong>&#x65B9;&#x6CD5;&#x7684;&#x7C7B;&#x3002;&#x5B83;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x5B9E;&#x9645;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x673A;&#x5236;&#x3002;&#x6211;&#x4EEC;&#x4F7F;&#x7528;</strong>Nap</strong>&#x7C7B;&#x4E2D;&#x7684;&#x201C;sleep&#x201D;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// onjava/Nap.java</span>
<span class="token keyword">package</span> onjava<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Nap</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token keyword">double</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Seconds</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token keyword">double</span> t<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x4E3A;&#x4E86;&#x6D88;&#x9664;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x7684;&#x89C6;&#x89C9;&#x5E72;&#x6270;&#xFF0C;&#x8FD9;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;&#x5B9E;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5728;&#x8D85;&#x65F6;&#x65F6;&#x663E;&#x793A;&#x4E00;&#x6761;&#x6D88;&#x606F;</p>
<p>&#x5BF9;**TimeUnit.MILLISECONDS.sleep()<strong>&#x7684;&#x8C03;&#x7528;&#x83B7;&#x53D6;&#x201C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x201D;&#x5E76;&#x5728;&#x53C2;&#x6570;&#x4E2D;&#x5C06;&#x5176;&#x7F6E;&#x4E8E;&#x4F11;&#x7720;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x8BE5;&#x7EBF;&#x7A0B;&#x88AB;&#x6302;&#x8D77;&#x3002;&#x8FD9;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5E95;&#x5C42;&#x5904;&#x7406;&#x5668;&#x505C;&#x6B62;&#x3002;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5C06;&#x5176;&#x5207;&#x6362;&#x5230;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#xFF0C;&#x4F8B;&#x5982;&#x5728;&#x4F60;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x53E6;&#x4E00;&#x4E2A;&#x7A97;&#x53E3;&#x3002;OS&#x4EFB;&#x52A1;&#x7BA1;&#x7406;&#x5668;&#x5B9A;&#x671F;&#x68C0;&#x67E5;</strong>sleep()**&#x662F;&#x5426;&#x8D85;&#x65F6;&#x3002;&#x5F53;&#x5B83;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x88AB;&#x201C;&#x5524;&#x9192;&#x201D;&#x5E76;&#x7ED9;&#x4E88;&#x66F4;&#x591A;&#x5904;&#x7406;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;<strong>sleep()<strong>&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x53D7;&#x68C0;&#x7684;</strong>InterruptedException</strong>;&#x8FD9;&#x662F;&#x539F;&#x59CB;Java&#x8BBE;&#x8BA1;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5DE5;&#x4EF6;&#xFF0C;&#x5B83;&#x901A;&#x8FC7;&#x7A81;&#x7136;&#x65AD;&#x5F00;&#x5B83;&#x4EEC;&#x6765;&#x7EC8;&#x6B62;&#x4EFB;&#x52A1;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x5F80;&#x5F80;&#x4F1A;&#x4EA7;&#x751F;&#x4E0D;&#x7A33;&#x5B9A;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x6240;&#x4EE5;&#x540E;&#x6765;&#x4E0D;&#x9F13;&#x52B1;&#x7EC8;&#x6B62;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x5728;&#x9700;&#x8981;&#x6216;&#x4ECD;&#x7136;&#x53D1;&#x751F;&#x7EC8;&#x6B62;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6355;&#x83B7;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x8981;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4ECE;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;--SingleThreadExecutor&#x5F00;&#x59CB;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">//concurrent/SingleThreadExecutor.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleThreadExecutor</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> exec <span class="token operator">=</span>
            <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">NapTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>exec<span class="token operator">:</span><span class="token operator">:</span><span class="token function">execute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;All tasks submitted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>exec<span class="token punctuation">.</span><span class="token function">isTerminated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>
            <span class="token string">&quot; awaiting termination&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>All tasks submitted
main awaiting termination
main awaiting termination
NapTask[0] pool-1-thread-1
main awaiting termination
NapTask[1] pool-1-thread-1
main awaiting termination
NapTask[2] pool-1-thread-1
main awaiting termination
NapTask[3] pool-1-thread-1
main awaiting termination
NapTask[4] pool-1-thread-1
main awaiting termination
NapTask[5] pool-1-thread-1
main awaiting termination
NapTask[6] pool-1-thread-1
main awaiting termination
NapTask[7] pool-1-thread-1
main awaiting termination
NapTask[8] pool-1-thread-1
main awaiting termination
NapTask[9] pool-1-thread-1
</code></pre><p>&#x9996;&#x5148;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6CA1;&#x6709;<strong>SingleThreadExecutor</strong>&#x7C7B;&#x3002;<strong>newSingleThreadExecutor()<strong>&#x662F;</strong>Executors</strong>&#x4E2D;&#x7684;&#x5DE5;&#x5382;&#xFF0C;&#x5B83;&#x521B;&#x5EFA;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></p>
<p>&#x6211;&#x521B;&#x5EFA;&#x4E86;&#x5341;&#x4E2A;NapTasks&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x63D0;&#x4EA4;&#x7ED9;ExecutorService&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5B83;&#x4EEC;&#x5F00;&#x59CB;&#x81EA;&#x5DF1;&#x8FD0;&#x884C;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5728;&#x6B64;&#x671F;&#x95F4;&#xFF0C;main()&#x7EE7;&#x7EED;&#x505A;&#x4E8B;&#x3002;&#x5F53;&#x6211;&#x8FD0;&#x884C;callexec.shutdown()&#x65F6;&#xFF0C;&#x5B83;&#x544A;&#x8BC9;ExecutorService&#x5B8C;&#x6210;&#x5DF2;&#x7ECF;&#x63D0;&#x4EA4;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x4E0D;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x65B0;&#x4EFB;&#x52A1;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x4ECD;&#x7136;&#x5728;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x7B49;&#x5230;&#x5B83;&#x4EEC;&#x5728;&#x9000;&#x51FA;main()&#x4E4B;&#x524D;&#x5B8C;&#x6210;&#x3002;&#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x68C0;&#x67E5;exec.isTerminated()&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x8FD9;&#x5728;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x540E;&#x53D8;&#x4E3A;true&#x3002;</p>
<p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;main()&#x4E2D;&#x7EBF;&#x7A0B;&#x7684;&#x540D;&#x79F0;&#x662F;main&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;pool-1-thread-1&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x4EA4;&#x9519;&#x8F93;&#x51FA;&#x663E;&#x793A;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x786E;&#x5B9E;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x53EA;&#x662F;&#x8C03;&#x7528;exec.shutdown()&#xFF0C;&#x7A0B;&#x5E8F;&#x5C06;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x4E0D;&#x9700;&#x8981;<strong>while(!exec.isTerminated())</strong>&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/SingleThreadExecutor2.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleThreadExecutor2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> exec
        <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">NapTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>exec<span class="token operator">:</span><span class="token operator">:</span><span class="token function">execute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>NapTask[0] pool-1-thread-1
NapTask[1] pool-1-thread-1
NapTask[2] pool-1-thread-1
NapTask[3] pool-1-thread-1
NapTask[4] pool-1-thread-1
NapTask[5] pool-1-thread-1
NapTask[6] pool-1-thread-1
NapTask[7] pool-1-thread-1
NapTask[8] pool-1-thread-1
NapTask[9] pool-1-thread-1
</code></pre><p>&#x4E00;&#x65E6;&#x4F60;callexec.shutdown()&#xFF0C;&#x5C1D;&#x8BD5;&#x63D0;&#x4EA4;&#x65B0;&#x4EFB;&#x52A1;&#x5C06;&#x629B;&#x51FA;RejectedExecutionException&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/MoreTasksAfterShutdown.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MoreTasksAfterShutdown</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> exec
        <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token function">newNapTask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            exec<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token function">newNapTask</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">RejectedExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>java.util.concurrent.RejectedExecutionException: TaskNapTask[99] rejected from java.util.concurrent.ThreadPoolExecutor@4e25154f[Shutting down, pool size = 1,active threads = 1, queued tasks = 0, completed tasks =0]NapTask[1] pool-1-thread-1
</code></pre><p><strong>exec.shutdown()<strong>&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6CD5;&#x662F;</strong>exec.shutdownNow()</strong>&#xFF0C;&#x5B83;&#x9664;&#x4E86;&#x4E0D;&#x63A5;&#x53D7;&#x65B0;&#x4EFB;&#x52A1;&#x5916;&#xFF0C;&#x8FD8;&#x4F1A;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x4E2D;&#x65AD;&#x4EFB;&#x52A1;&#x6765;&#x505C;&#x6B62;&#x4EFB;&#x4F55;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x540C;&#x6837;&#xFF0C;&#x4E2D;&#x65AD;&#x662F;&#x9519;&#x8BEF;&#x7684;&#xFF0C;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#x5E76;&#x4E14;&#x4E0D;&#x9F13;&#x52B1;&#x3002;</p>
<ul>
<li>&#x4F7F;&#x7528;&#x66F4;&#x591A;&#x7EBF;&#x7A0B;</li>
</ul>
<p>&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x91CD;&#x70B9;&#x662F;&#xFF08;&#x51E0;&#x4E4E;&#x603B;&#x662F;&#xFF09;&#x66F4;&#x5FEB;&#x5730;&#x5B8C;&#x6210;&#x4EFB;&#x52A1;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x9650;&#x5236;&#x81EA;&#x5DF1;&#x4F7F;&#x7528;SingleThreadExecutor&#x5462;&#xFF1F;&#x67E5;&#x770B;&#x6267;&#x884C;<strong>Executors</strong>&#x7684;Javadoc&#xFF0C;&#x4F60;&#x5C06;&#x770B;&#x5230;&#x66F4;&#x591A;&#x9009;&#x9879;&#x3002;&#x4F8B;&#x5982;CachedThreadPool&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CachedThreadPool.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachedThreadPool</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> exec
        <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">NapTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>exec<span class="token operator">:</span><span class="token operator">:</span><span class="token function">execute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>NapTask[7] pool-1-thread-8
NapTask[4] pool-1-thread-5
NapTask[1] pool-1-thread-2
NapTask[3] pool-1-thread-4
NapTask[0] pool-1-thread-1
NapTask[8] pool-1-thread-9
NapTask[2] pool-1-thread-3
NapTask[9] pool-1-thread-10
NapTask[6] pool-1-thread-7
NapTask[5] pool-1-thread-6
</code></pre><p>&#x5F53;&#x4F60;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x5B83;&#x5B8C;&#x6210;&#x5F97;&#x66F4;&#x5FEB;&#x3002;&#x8FD9;&#x662F;&#x6709;&#x9053;&#x7406;&#x7684;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x90FD;&#x5E76;&#x884C;&#x8FD0;&#x884C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x6765;&#x987A;&#x5E8F;&#x8FD0;&#x884C;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;&#x8FD9;&#x4F3C;&#x4E4E;&#x6CA1;&#x6BDB;&#x75C5;&#xFF0C;&#x5F88;&#x96BE;&#x7406;&#x89E3;&#x4E3A;&#x4EC0;&#x4E48;&#x6709;&#x4EBA;&#x4F1A;&#x4F7F;&#x7528;SingleThreadExecutor&#x3002;</p>
<p>&#x8981;&#x7406;&#x89E3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x66F4;&#x590D;&#x6742;&#x7684;&#x4EFB;&#x52A1;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/InterferingTask.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InterferingTask</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> val <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">InterferingTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        val<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token operator">+</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre><p>&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x589E;&#x52A0;val&#x4E00;&#x767E;&#x6B21;&#x3002;&#x8FD9;&#x4F3C;&#x4E4E;&#x5F88;&#x7B80;&#x5355;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x7528;CachedThreadPool&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CachedThreadPool2.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachedThreadPool2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ExecutorService</span> exec
    <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">InterferingTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>exec<span class="token operator">:</span><span class="token operator">:</span><span class="token function">execute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>0 pool-1-thread-1 200
1 pool-1-thread-2 200
4 pool-1-thread-5 300
5 pool-1-thread-6 400
8 pool-1-thread-9 500
9 pool-1-thread-10 600
2 pool-1-thread-3 700
7 pool-1-thread-8 800
3 pool-1-thread-4 900
6 pool-1-thread-7 1000
</code></pre><p>&#x8F93;&#x51FA;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x6240;&#x671F;&#x671B;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4ECE;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x5230;&#x4E0B;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x4F1A;&#x6709;&#x6240;&#x4E0D;&#x540C;&#x3002;&#x95EE;&#x9898;&#x662F;&#x6240;&#x6709;&#x7684;&#x4EFB;&#x52A1;&#x90FD;&#x8BD5;&#x56FE;&#x5199;&#x5165;val&#x7684;&#x5355;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x4E14;&#x4ED6;&#x4EEC;&#x6B63;&#x5728;&#x8E29;&#x7740;&#x5F7C;&#x6B64;&#x7684;&#x811A;&#x8DBE;&#x3002;&#x6211;&#x4EEC;&#x79F0;&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x662F;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;SingleThreadExecutor&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/SingleThreadExecutor3.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleThreadExecutor3</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> exec
        <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">InterferingTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>exec<span class="token operator">:</span><span class="token operator">:</span><span class="token function">execute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>0 pool-1-thread-1 100
1 pool-1-thread-1 200
2 pool-1-thread-1 300
3 pool-1-thread-1 400
4 pool-1-thread-1 500
5 pool-1-thread-1 600
6 pool-1-thread-1 700
7 pool-1-thread-1 800
8 pool-1-thread-1 900
9 pool-1-thread-1 1000
</code></pre><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6BCF;&#x6B21;&#x90FD;&#x5F97;&#x5230;&#x4E00;&#x81F4;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5C3D;&#x7BA1;<strong>InterferingTask</strong>&#x7F3A;&#x4E4F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6027;&#x3002;&#x8FD9;&#x662F;SingleThreadExecutor&#x7684;&#x4E3B;&#x8981;&#x597D;&#x5904; - &#x56E0;&#x4E3A;&#x5B83;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x4E0D;&#x4F1A;&#x76F8;&#x4E92;&#x5E72;&#x6270;&#xFF0C;&#x56E0;&#x6B64;&#x5F3A;&#x52A0;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6027;&#x3002;&#x8FD9;&#x79CD;&#x73B0;&#x8C61;&#x79F0;&#x4E3A;&#x7EBF;&#x7A0B;&#x5C01;&#x95ED;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5355;&#x7EBF;&#x7A0B;&#x4E0A;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x9650;&#x5236;&#x4E86;&#x5B83;&#x4EEC;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x7EBF;&#x7A0B;&#x5C01;&#x95ED;&#x9650;&#x5236;&#x4E86;&#x52A0;&#x901F;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x5F88;&#x591A;&#x56F0;&#x96BE;&#x7684;&#x8C03;&#x8BD5;&#x548C;&#x91CD;&#x5199;&#x3002;</p>
<ul>
<li>&#x4EA7;&#x751F;&#x7ED3;&#x679C;</li>
</ul>
<p>&#x56E0;&#x4E3A;<strong>InterferingTask</strong>&#x662F;&#x4E00;&#x4E2A;<strong>Runnable</strong>&#xFF0C;&#x5B83;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x80FD;&#x4F7F;&#x7528;&#x526F;&#x4F5C;&#x7528;&#x4EA7;&#x751F;&#x7ED3;&#x679C; - &#x64CD;&#x7EB5;&#x7F13;&#x51B2;&#x503C;&#x800C;&#x4E0D;&#x662F;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002;&#x526F;&#x4F5C;&#x7528;&#x662F;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x4E3B;&#x8981;&#x95EE;&#x9898;&#x4E4B;&#x4E00;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x4E86;<strong>CachedThreadPool2.java</strong>&#x3002;<strong>InterferingTask</strong>&#x4E2D;&#x7684;<strong>val</strong>&#x88AB;&#x79F0;&#x4E3A;&#x53EF;&#x53D8;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x95EE;&#x9898;&#x6240;&#x5728;&#xFF1A;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x540C;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x4F1A;&#x4EA7;&#x751F;&#x7ADE;&#x4E89;&#x3002;&#x7ED3;&#x679C;&#x53D6;&#x51B3;&#x4E8E;&#x9996;&#x5148;&#x5728;&#x7EC8;&#x70B9;&#x7EBF;&#x4E0A;&#x6267;&#x884C;&#x54EA;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5E76;&#x4FEE;&#x6539;&#x53D8;&#x91CF;&#xFF08;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x53EF;&#x80FD;&#x6027;&#x7684;&#x5404;&#x79CD;&#x53D8;&#x5316;&#xFF09;&#x3002;</p>
<p>&#x907F;&#x514D;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x7684;&#x6700;&#x597D;&#x65B9;&#x6CD5;&#x662F;&#x907F;&#x514D;&#x53EF;&#x53D8;&#x7684;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x79F0;&#x4E4B;&#x4E3A;&#x81EA;&#x79C1;&#x7684;&#x5B69;&#x5B50;&#x539F;&#x5219;&#xFF1A;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x5206;&#x4EAB;&#x3002;</p>
<p>&#x4F7F;&#x7528;<strong>InterferingTask</strong>&#xFF0C;&#x6700;&#x597D;&#x5220;&#x9664;&#x526F;&#x4F5C;&#x7528;&#x5E76;&#x8FD4;&#x56DE;&#x4EFB;&#x52A1;&#x7ED3;&#x679C;&#x3002;&#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x521B;&#x5EFA;<strong>Callable</strong>&#x800C;&#x4E0D;&#x662F;<strong>Runnable</strong>&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CountingTask.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountingTask</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">CountingTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Integer</span> val <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        val<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre><p><strong>call()&#x5B8C;&#x5168;&#x72EC;&#x7ACB;&#x4E8E;&#x6240;&#x6709;&#x5176;&#x4ED6;CountingTasks&#x751F;&#x6210;&#x5176;&#x7ED3;&#x679C;</strong>&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6CA1;&#x6709;&#x53EF;&#x53D8;&#x7684;&#x5171;&#x4EAB;&#x72B6;&#x6001;</p>
<p><strong>ExecutorService</strong>&#x5141;&#x8BB8;&#x4F60;&#x4F7F;&#x7528;**invokeAll()**&#x542F;&#x52A8;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;Callable&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CachedThreadPool3.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachedThreadPool3</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">extractResult</span><span class="token punctuation">(</span><span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ExecutorService</span> exec <span class="token operator">=</span>
    <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CountingTask</span><span class="token punctuation">&gt;</span></span> tasks <span class="token operator">=</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">CountingTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Future</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> futures <span class="token operator">=</span>
            exec<span class="token punctuation">.</span><span class="token function">invokeAll</span><span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> sum <span class="token operator">=</span> futures<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CachedThreadPool3</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">extractResult</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;sum = &quot;</span> <span class="token operator">+</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>1 pool-1-thread-2 100
0 pool-1-thread-1 100
4 pool-1-thread-5 100
5 pool-1-thread-6 100
8 pool-1-thread-9 100
9 pool-1-thread-10 100
2 pool-1-thread-3 100
3 pool-1-thread-4 100
6 pool-1-thread-7 100
7 pool-1-thread-8 100
sum = 1000

</code></pre><p>&#x53EA;&#x6709;&#x5728;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x540E;&#xFF0C;<strong>invokeAll()<strong>&#x624D;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;</strong>Future</strong>&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x4E00;&#x4E2A;<strong>Future</strong>&#x3002;<strong>Future</strong>&#x662F;Java 5&#x4E2D;&#x5F15;&#x5165;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x5141;&#x8BB8;&#x4F60;&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;&#x800C;&#x65E0;&#x9700;&#x7B49;&#x5F85;&#x5B83;&#x5B8C;&#x6210;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<strong>ExecutorService.submit()</strong>:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Futures.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Futures</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ExecutorService</span> exec
        <span class="token operator">=</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> f <span class="token operator">=</span>
        exec<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token function">newCountingTask</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1]</span>
    exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>99 pool-1-thread-1 100
100
</code></pre><ul>
<li><a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a> &#x5F53;&#x4F60;&#x7684;&#x4EFB;&#x52A1;&#x5728;&#x5C1A;&#x672A;&#x5B8C;&#x6210;&#x7684;<strong>Future</strong>&#x4E0A;&#x8C03;&#x7528;**get()**&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x4F1A;&#x963B;&#x585E;&#xFF08;&#x7B49;&#x5F85;&#xFF09;&#x76F4;&#x5230;&#x7ED3;&#x679C;&#x53EF;&#x7528;&#x3002;</li>
</ul>
<p>&#x4F46;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5728;<strong>CachedThreadPool3.java</strong>&#x4E2D;&#xFF0C;<strong>Future</strong>&#x4F3C;&#x4E4E;&#x662F;&#x591A;&#x4F59;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;**invokeAll()**&#x751A;&#x81F3;&#x5728;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x90FD;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;Future&#x5E76;&#x4E0D;&#x7528;&#x4E8E;&#x5EF6;&#x8FDF;&#x7ED3;&#x679C;&#xFF0C;&#x800C;&#x662F;&#x7528;&#x4E8E;&#x6355;&#x83B7;&#x4EFB;&#x4F55;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x8FD8;&#x8981;&#x6CE8;&#x610F;&#x5728;**CachedThreadPool3.java.get()<strong>&#x4E2D;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x56E0;&#x6B64;</strong>extractResult()**&#x5728;Stream&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x63D0;&#x53D6;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x5F53;&#x4F60;&#x8C03;&#x7528;<strong>get()<strong>&#x65F6;&#xFF0C;<strong>Future</strong>&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x53EA;&#x80FD;&#x89E3;&#x51B3;&#x7B49;&#x5F85;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x624D;&#x66B4;&#x9732;&#x95EE;&#x9898;&#x3002;&#x6700;&#x7EC8;&#xFF0C;<strong>Futures</strong>&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x79CD;&#x65E0;&#x6548;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x73B0;&#x5728;&#x4E0D;&#x9F13;&#x52B1;&#xFF0C;&#x6211;&#x4EEC;&#x63A8;&#x8350;Java 8&#x7684;</strong>CompletableFuture</strong>&#xFF0C;&#x8FD9;&#x5C06;&#x5728;&#x672C;&#x7AE0;&#x540E;&#x9762;&#x63A2;&#x8BA8;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x4F60;&#x4ECD;&#x4F1A;&#x5728;&#x9057;&#x7559;&#x5E93;&#x4E2D;&#x9047;&#x5230;Futures&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5E76;&#x884C;Stream&#x4EE5;&#x66F4;&#x7B80;&#x5355;&#xFF0C;&#x66F4;&#x4F18;&#x96C5;&#x7684;&#x65B9;&#x5F0F;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CountingStream.java</span>
<span class="token comment">// {VisuallyInspectOutput}</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountingStream</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
            <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">CountingTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>ct <span class="token operator">-&gt;</span> ct<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>1 ForkJoinPool.commonPool-worker-3 100
8 ForkJoinPool.commonPool-worker-2 100
0 ForkJoinPool.commonPool-worker-6 100
2 ForkJoinPool.commonPool-worker-1 100
4 ForkJoinPool.commonPool-worker-5 100
9 ForkJoinPool.commonPool-worker-7 100
6 main 100
7 ForkJoinPool.commonPool-worker-4 100
5 ForkJoinPool.commonPool-worker-2 100
3 ForkJoinPool.commonPool-worker-3 100
1000
</code></pre><p>&#x8FD9;&#x4E0D;&#x4EC5;&#x66F4;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x5C06; <code>parallel()</code> &#x63D2;&#x5165;&#x5230;&#x5176;&#x4ED6;&#x987A;&#x5E8F;&#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x4E00;&#x5207;&#x90FD;&#x5728;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x3002;</p>
<ul>
<li>Lambda&#x548C;&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#x4F5C;&#x4E3A;&#x4EFB;&#x52A1;</li>
</ul>
<p>&#x5728; <strong>java8</strong> &#x6709;&#x4E86; <strong>lambdas</strong> &#x548C;&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#xFF0C;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x53D7;&#x9650;&#x4E8E;&#x53EA;&#x80FD;&#x4F7F;&#x7528;  <strong>Runnable</strong> &#x548C; <strong>Callable</strong> &#x3002;&#x56E0;&#x4E3A; java8 &#x7684;<strong>lambdas</strong> &#x548C;&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5339;&#x914D;&#x65B9;&#x6CD5;&#x7B7E;&#x540D;&#x6765;&#x4F7F;&#x7528;&#xFF08;&#x5373;&#xFF0C;&#x5B83;&#x652F;&#x6301;&#x7ED3;&#x6784;&#x4E00;&#x81F4;&#x6027;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x975E; <strong>Runnable</strong> &#x6216; <strong>Callable</strong> &#x7684;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9; <code>ExecutorService</code> :</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/LambdasAndMethodReferences.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">NotRunnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;NotRunnable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">NotCallable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;NotCallable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LambdasAndMethodReferences</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ExecutorService</span> exec <span class="token operator">=</span>
        <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Lambda1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NotRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">go</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Lambda2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NotCallable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">get</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exec<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Lambda1
NotCallable
NotRunnable
Lambda2

</code></pre><p>&#x8FD9;&#x91CC;&#xFF0C;&#x524D;&#x4E24;&#x4E2A;<strong>submit()<strong>&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x6539;&#x4E3A;&#x8C03;&#x7528;</strong>execute()</strong>&#x3002;&#x6240;&#x6709;<strong>submit()<strong>&#x8C03;&#x7528;&#x90FD;&#x8FD4;&#x56DE;</strong>Futures</strong>&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x540E;&#x4E24;&#x6B21;&#x8C03;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x63D0;&#x53D6;&#x7ED3;&#x679C;&#x3002;</p>
<h2 class="mume-header" id="%E7%BB%88%E6%AD%A2%E8%80%97%E6%97%B6%E4%BB%BB%E5%8A%A1">&#x7EC8;&#x6B62;&#x8017;&#x65F6;&#x4EFB;&#x52A1;</h2>

<p>&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x53EF;&#x8C03;&#x7528;&#x4EFB;&#x52A1;&#x5728;&#x5B8C;&#x6210;&#x65F6;&#x8FD4;&#x56DE;&#x503C;;&#x867D;&#x7136;&#x8FD9;&#x7ED9;&#x5B83;&#x4E00;&#x4E2A;&#x6709;&#x9650;&#x7684;&#x5BFF;&#x547D;&#xFF0C;&#x4F46;&#x4ECD;&#x7136;&#x53EF;&#x80FD;&#x5F88;&#x957F;&#x3002;&#x53EF;&#x8FD0;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x6709;&#x65F6;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;&#x6C38;&#x8FDC;&#x8FD0;&#x884C;&#x7684;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x3002;&#x4F60;&#x7ECF;&#x5E38;&#x9700;&#x8981;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x6B63;&#x5E38;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x505C;&#x6B62;<strong>Runnable</strong>&#x548C;<strong>Callable</strong>&#x4EFB;&#x52A1;&#xFF0C;&#x4F8B;&#x5982;&#x5F53;&#x4F60;&#x5173;&#x95ED;&#x7A0B;&#x5E8F;&#x65F6;&#x3002;</p>
<p>&#x6700;&#x521D;&#x7684;Java&#x8BBE;&#x8BA1;&#x63D0;&#x4F9B;&#x4E86;&#x4E2D;&#x65AD;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x673A;&#x5236;&#xFF08;&#x4E3A;&#x4E86;&#x5411;&#x540E;&#x517C;&#x5BB9;&#xFF0C;&#x4ECD;&#x7136;&#x5B58;&#x5728;&#xFF09;;&#x4E2D;&#x65AD;&#x673A;&#x5236;&#x5305;&#x62EC;&#x963B;&#x585E;&#x95EE;&#x9898;&#x3002;&#x4E2D;&#x65AD;&#x4EFB;&#x52A1;&#x65E2;&#x4E71;&#x53C8;&#x590D;&#x6742;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x5FC5;&#x987B;&#x4E86;&#x89E3;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x4E2D;&#x65AD;&#x7684;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x72B6;&#x6001;&#xFF0C;&#x4EE5;&#x53CA;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5931;&#x3002;&#x4F7F;&#x7528;&#x4E2D;&#x65AD;&#x88AB;&#x89C6;&#x4E3A;&#x53CD;&#x5BF9;&#x6A21;&#x5F0F;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x4ECD;&#x7136;&#x88AB;&#x8FEB;&#x63A5;&#x53D7;&#x3002;</p>
<p>InterruptedException&#xFF0C;&#x56E0;&#x4E3A;&#x8BBE;&#x8BA1;&#x7684;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x6027;&#x6B8B;&#x7559;&#x3002;</p>
<p>&#x4EFB;&#x52A1;&#x7EC8;&#x6B62;&#x7684;&#x6700;&#x4F73;&#x65B9;&#x6CD5;&#x662F;&#x8BBE;&#x7F6E;&#x4EFB;&#x52A1;&#x5468;&#x671F;&#x6027;&#x68C0;&#x67E5;&#x7684;&#x6807;&#x5FD7;&#x3002;&#x7136;&#x540E;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;shutdown&#x8FDB;&#x7A0B;&#x5E76;&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#x3002;&#x4E0D;&#x662F;&#x5728;&#x4EFB;&#x52A1;&#x4E2D;&#x968F;&#x673A;&#x5173;&#x95ED;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x662F;&#x8981;&#x6C42;&#x4EFB;&#x52A1;&#x5728;&#x5230;&#x8FBE;&#x4E86;&#x4E00;&#x4E2A;&#x8F83;&#x597D;&#x65F6;&#x81EA;&#x884C;&#x7EC8;&#x6B62;&#x3002;&#x8FD9;&#x603B;&#x662F;&#x4EA7;&#x751F;&#x6BD4;&#x4E2D;&#x65AD;&#x66F4;&#x597D;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4EE5;&#x53CA;&#x66F4;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#x7684;&#x66F4;&#x5408;&#x7406;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7EC8;&#x6B62;&#x4EFB;&#x52A1;&#x542C;&#x8D77;&#x6765;&#x5F88;&#x7B80;&#x5355;&#xFF1A;&#x8BBE;&#x7F6E;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7684;<strong>boolean</strong> flag&#x3002;&#x7F16;&#x5199;&#x4EFB;&#x52A1;&#xFF0C;&#x4EE5;&#x4FBF;&#x5B9A;&#x671F;&#x68C0;&#x67E5;&#x6807;&#x5FD7;&#x5E76;&#x6267;&#x884C;&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#x3002;&#x8FD9;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x4F60;&#x6240;&#x505A;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x6211;&#x4EEC;&#x7684;&#x65E7;&#x514B;&#x661F;&#xFF0C;&#x5171;&#x540C;&#x7684;&#x53EF;&#x53D8;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&#x8BE5;&#x6807;&#x5FD7;&#x53EF;&#x4EE5;&#x88AB;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x64CD;&#x7EB5;&#xFF0C;&#x5219;&#x5B58;&#x5728;&#x78B0;&#x649E;&#x53EF;&#x80FD;&#x6027;&#x3002;</p>
<p>&#x5728;&#x7814;&#x7A76;Java&#x6587;&#x732E;&#x65F6;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x5F88;&#x591A;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;<strong>volatile</strong>&#x5173;&#x952E;&#x5B57;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x6280;&#x672F;&#x5E76;&#x907F;&#x514D;&#x6240;&#x6709;&#x6613;&#x53D8;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x5728;<a href="./Appendix-Low-Level-Concurrency.md">&#x9644;&#x5F55;&#xFF1A;&#x4F4E;&#x7EA7;&#x5E76;&#x53D1;</a>&#x4E2D;&#x6709;&#x6240;&#x6D89;&#x53CA;&#x3002;</p>
<p>Java 5&#x5F15;&#x5165;&#x4E86;<strong>Atomic</strong>&#x7C7B;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7EC4;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x62C5;&#x5FC3;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x6DFB;&#x52A0;<strong>AtomicBoolean</strong>&#x6807;&#x5FD7;&#xFF0C;&#x544A;&#x8BC9;&#x4EFB;&#x52A1;&#x6E05;&#x7406;&#x81EA;&#x5DF1;&#x5E76;&#x9000;&#x51FA;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/QuittableTask.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span><span class="token class-name">AtomicBoolean</span><span class="token punctuation">;</span><span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuittableTask</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">QuittableTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">AtomicBoolean</span> running <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">AtomicBoolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        running<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>running<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment">// [1]</span>
            <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// [2]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre><p>&#x867D;&#x7136;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x4E0A;&#x6210;&#x529F;&#x8C03;&#x7528;<strong>quit()</strong>&#xFF0C;&#x4F46;&#x662F;<strong>AtomicBoolean</strong>&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x540C;&#x65F6;&#x5B9E;&#x9645;&#x4FEE;&#x6539;<strong>running</strong>&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;**quit()**&#x65B9;&#x6CD5;&#x6210;&#x4E3A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<ul>
<li></li>
<li></li>
</ul>
<p>&#x9700;&#x8981;<strong>running AtomicBoolean</strong>&#x8BC1;&#x660E;&#x7F16;&#x5199;Java program&#x5E76;&#x53D1;&#x65F6;&#x6700;&#x57FA;&#x672C;&#x7684;&#x56F0;&#x96BE;&#x4E4B;&#x4E00;&#x662F;&#xFF0C;&#x5982;&#x679C;<strong>running</strong>&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x5E03;&#x5C14;&#x503C;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x5728;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4E2D;&#x770B;&#x5230;&#x95EE;&#x9898;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x6709;&#x4EFB;&#x4F55;&#x95EE;&#x9898; - &#x4F46;&#x662F;&#x4EE3;&#x7801;&#x4ECD;&#x7136;&#x662F;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x3002;&#x7F16;&#x5199;&#x8868;&#x660E;&#x8BE5;&#x95EE;&#x9898;&#x7684;&#x6D4B;&#x8BD5;&#x53EF;&#x80FD;&#x5F88;&#x56F0;&#x96BE;&#x6216;&#x4E0D;&#x53EF;&#x80FD;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x53CD;&#x9988;&#x6765;&#x544A;&#x8BC9;&#x4F60;&#x5DF2;&#x7ECF;&#x505A;&#x9519;&#x4E86;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x4F60;&#x7F16;&#x5199;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x4EE3;&#x7801;&#x7684;&#x552F;&#x4E00;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x4E86;&#x89E3;&#x4E8B;&#x60C5;&#x53EF;&#x80FD;&#x51FA;&#x9519;&#x7684;&#x6240;&#x6709;&#x7EC6;&#x5FAE;&#x4E4B;&#x5904;&#x3002;</p>
<p>&#x4F5C;&#x4E3A;&#x6D4B;&#x8BD5;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x542F;&#x52A8;&#x5F88;&#x591A;QuittableTasks&#x7136;&#x540E;&#x5173;&#x95ED;&#x5B83;&#x4EEC;&#x3002;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x8F83;&#x5927;&#x7684;COUNT&#x503C;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/QuittingTasks.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuittingTasks</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> COUNT <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ExecutorService</span> es <span class="token operator">=</span>
    <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QuittableTask</span><span class="token punctuation">&gt;</span></span> tasks <span class="token operator">=</span>
    <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> COUNT<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">QuittableTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>qt <span class="token operator">-&gt;</span> es<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>qt<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tasks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">QuittableTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">quit</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    es<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>24 27 31 8 11 7 19 12 16 4 23 3 28 32 15 20 63 60 68 6764 39 47 52 51 55 40 43 48 59 44 56 36 35 71 72 83 10396 92 88 99 100 87 91 79 75 84 76 115 108 112 104 107111 95 80 147 120 127 119 123 144 143 116 132 124 128
136 131 135 139 148 140 2 126 6 5 1 18 129 17 14 13 2122 9 10 30 33 58 37 125 26 34 133 145 78 137 141 138 6274 142 86 65 73 146 70 42 149 121 110 134 105 82 117106 113 122 45 114 118 38 50 29 90 101 89 57 53 94 4161 66 130 69 77 81 85 93 25 102 54 109 98 49 46 97
</code></pre><p>&#x6211;&#x4F7F;&#x7528;<strong>peek()<strong>&#x5C06;</strong>QuittableTasks</strong>&#x4F20;&#x9012;&#x7ED9;<strong>ExecutorService</strong>&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x6536;&#x96C6;&#x5230;**List.main()**&#x4E2D;&#xFF0C;&#x53EA;&#x8981;&#x4EFB;&#x4F55;&#x4EFB;&#x52A1;&#x4ECD;&#x5728;&#x8FD0;&#x884C;&#xFF0C;&#x5C31;&#x4F1A;&#x963B;&#x6B62;&#x7A0B;&#x5E8F;&#x9000;&#x51FA;&#x3002;&#x5373;&#x4F7F;&#x4E3A;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x6309;&#x987A;&#x5E8F;&#x8C03;&#x7528;quit()&#x65B9;&#x6CD5;&#xFF0C;&#x4EFB;&#x52A1;&#x4E5F;&#x4E0D;&#x4F1A;&#x6309;&#x7167;&#x5B83;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x987A;&#x5E8F;&#x5173;&#x95ED;&#x3002;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x4E0D;&#x4F1A;&#x786E;&#x5B9A;&#x6027;&#x5730;&#x54CD;&#x5E94;&#x4FE1;&#x53F7;&#x3002;</p>
<h2 class="mume-header" id="completablefuture%E7%B1%BB">CompletableFuture&#x7C7B;</h2>

<p>&#x4F5C;&#x4E3A;&#x4ECB;&#x7ECD;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x4F7F;&#x7528;CompletableFutures&#x5728;QuittingTasks.java&#x4E2D;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/QuittingCompletable.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuittingCompletable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QuittableTask</span><span class="token punctuation">&gt;</span></span> tasks <span class="token operator">=</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">QuittingTasks</span><span class="token punctuation">.</span>COUNT<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">QuittableTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cfutures <span class="token operator">=</span>
        tasks<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">runAsync</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tasks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">QuittableTask</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">quit</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfutures<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">join</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 2526 27 28 29 30 31 32 33 34 6 35 4 38 39 40 41 42 43 4445 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 6263 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 8081 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 9899 100 101 102 103 104 105 106 107 108 109 110 111 1121 113 114 116 117 118 119 120 121 122 123 124 125 126127 128 129 130 131 132 133 134 135 136 137 138 139 140141 142 143 144 145 146 147 148 149 5 115 37 36 2 3
</code></pre><p>&#x4EFB;&#x52A1;&#x662F;&#x4E00;&#x4E2A; <code>List&lt;QuittableTask&gt;</code>&#xFF0C;&#x5C31;&#x50CF;&#x5728; <code>QuittingTasks.java</code> &#x4E2D;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6CA1;&#x6709; <code>peek()</code> &#x5C06;&#x6BCF;&#x4E2A; <code>QuittableTask</code> &#x63D0;&#x4EA4;&#x7ED9; <code>ExecutorService</code>&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5728;&#x521B;&#x5EFA; <code>cfutures</code> &#x671F;&#x95F4;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x90FD;&#x4EA4;&#x7ED9; <code>CompletableFuture::runAsync</code>&#x3002;&#x8FD9;&#x6267;&#x884C; <code>VerifyTask.run()</code> &#x5E76;&#x8FD4;&#x56DE; <code>CompletableFuture&lt;Void&gt;</code> &#x3002;&#x56E0;&#x4E3A; <code>run()</code> &#x4E0D;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x5185;&#x5BB9;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x6211;&#x53EA;&#x4F7F;&#x7528; <code>CompletableFuture</code> &#x8C03;&#x7528; <code>join()</code> &#x6765;&#x7B49;&#x5F85;&#x5B83;&#x5B8C;&#x6210;&#x3002;</p>
<p>&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x91CD;&#x8981;&#x4E00;&#x70B9;&#x662F;&#xFF0C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;&#x4E0D;&#x9700;&#x8981;&#x4F7F;&#x7528; <code>ExecutorService</code>&#x3002;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x4EA4;&#x7ED9; <code>CompletableFuture</code> &#x7BA1;&#x7406; (&#x4E0D;&#x8FC7;&#x4F60;&#x53EF;&#x4EE5;&#x5411;&#x5B83;&#x63D0;&#x4F9B;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684; <code>ExectorService</code>)&#x3002;&#x60A8;&#x4E5F;&#x4E0D;&#x9700;&#x8981;&#x8C03;&#x7528; <code>shutdown()</code>;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x50CF;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x6240;&#x505A;&#x7684;&#x90A3;&#x6837;&#x663E;&#x5F0F;&#x5730;&#x8C03;&#x7528; <code>join()</code>&#xFF0C;&#x5426;&#x5219;&#x7A0B;&#x5E8F;&#x5C06;&#x5C3D;&#x5FEB;&#x9000;&#x51FA;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x7B49;&#x5F85;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x8D77;&#x70B9;&#x3002;&#x4F60;&#x5F88;&#x5FEB;&#x5C31;&#x4F1A;&#x770B;&#x5230; <code>ComplempleFuture</code> &#x80FD;&#x591F;&#x505A;&#x5F97;&#x66F4;&#x591A;&#x3002;</p>
<h3 class="mume-header" id="%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">&#x57FA;&#x672C;&#x7528;&#x6CD5;</h3>

<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5E26;&#x6709;&#x9759;&#x6001;&#x65B9;&#x6CD5;**work()**&#x7684;&#x7C7B;&#xFF0C;&#x5B83;&#x5BF9;&#x8BE5;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x5DE5;&#x4F5C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Machina.java</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Machina</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
        START<span class="token punctuation">,</span> ONE<span class="token punctuation">,</span> TWO<span class="token punctuation">,</span> THREE<span class="token punctuation">,</span> END<span class="token punctuation">;</span>
        <span class="token class-name">State</span> <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">equals</span><span class="token punctuation">(</span>END<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> END<span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">ordinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">State</span> state <span class="token operator">=</span> <span class="token class-name">State</span><span class="token punctuation">.</span>START<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Machina</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Machina</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token class-name">Machina</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>m<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">State</span><span class="token punctuation">.</span>END<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            m<span class="token punctuation">.</span>state <span class="token operator">=</span> m<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token string">&quot;Machina&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">State</span><span class="token punctuation">.</span>END<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token string">&quot;complete&quot;</span> <span class="token operator">:</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre><p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x9650;&#x72B6;&#x6001;&#x673A;&#xFF0C;&#x4E00;&#x4E2A;&#x5FAE;&#x4E0D;&#x8DB3;&#x9053;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x6CA1;&#x6709;&#x5206;&#x652F;......&#x5B83;&#x53EA;&#x662F;&#x4ECE;&#x5934;&#x5230;&#x5C3E;&#x904D;&#x5386;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#x3002;**work()**&#x65B9;&#x6CD5;&#x5C06;&#x673A;&#x5668;&#x4ECE;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x79FB;&#x52A8;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E14;&#x9700;&#x8981;100&#x6BEB;&#x79D2;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x201C;&#x5DE5;&#x4F5C;&#x201D;&#x3002;</p>
<p><strong>CompletableFuture</strong>&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x505A;&#x7684;&#x4E00;&#x4EF6;&#x4E8B;&#x662F;, &#x4F7F;&#x7528;**completedFuture()**&#x5C06;&#x5B83;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x5305;&#x88C5;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletedMachina.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletedMachina</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf <span class="token operator">=</span>
        <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Machina</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Machina</span> m <span class="token operator">=</span> cf<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Doesn&apos;t block</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span>
            <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><strong>completedFuture()<strong>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x201C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x201D;&#x7684;</strong>CompletableFuture</strong>&#x3002;&#x5BF9;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x672A;&#x6765;&#x505A;&#x7684;&#x552F;&#x4E00;&#x6709;&#x7528;&#x7684;&#x4E8B;&#x60C5;&#x662F;<strong>get()<strong>&#x91CC;&#x9762;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x4F3C;&#x4E4E;&#x6CA1;&#x6709;&#x7528;&#x3002;&#x6CE8;&#x610F;</strong>CompletableFuture</strong>&#x88AB;&#x8F93;&#x5165;&#x5230;&#x5B83;&#x5305;&#x542B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x4E2A;&#x5F88;&#x91CD;&#x8981;&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;<strong>get()<strong>&#x5728;&#x7B49;&#x5F85;&#x7ED3;&#x679C;&#x65F6;&#x963B;&#x585E;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x3002;&#x6B64;&#x5757;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;</strong>InterruptedException</strong>&#x6216;<strong>ExecutionException</strong>&#x4E2D;&#x65AD;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x963B;&#x6B62;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#xFF0C;&#x56E0;&#x4E3A;CompletableFutureis&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#xFF0C;&#x6240;&#x4EE5;&#x7B54;&#x6848;&#x7ACB;&#x5373;&#x53EF;&#x7528;&#x3002;</p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x5C06;<strong>handle()<strong>&#x5305;&#x88C5;&#x5728;</strong>CompletableFuture</strong>&#x4E2D;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;<strong>CompletableFuture</strong>&#x4E0A;&#x6DFB;&#x52A0;&#x64CD;&#x4F5C;&#x6765;&#x5904;&#x7406;&#x6240;&#x5305;&#x542B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4F7F;&#x5F97;&#x4E8B;&#x60C5;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x6709;&#x8DA3;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletableApply.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableApply</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf <span class="token operator">=</span>
        <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Machina</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf2 <span class="token operator">=</span>
            cf<span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf3 <span class="token operator">=</span>
            cf2<span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf4 <span class="token operator">=</span>
            cf3<span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf5 <span class="token operator">=</span>
            cf4<span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><strong>&#x8F93;&#x51FA;&#x7ED3;&#x679C;</strong>&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Machina0: ONE
Machina0: TWO
Machina0: THREE
Machina0: complete
</code></pre><p><code>thenApply()</code> &#x5E94;&#x7528;&#x4E00;&#x4E2A;&#x63A5;&#x6536;&#x8F93;&#x5165;&#x5E76;&#x4EA7;&#x751F;&#x8F93;&#x51FA;&#x7684;&#x51FD;&#x6570;&#x3002;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;<code>work()</code> &#x51FD;&#x6570;&#x4EA7;&#x751F;&#x7684;&#x7C7B;&#x578B;&#x4E0E;&#x5B83;&#x6240;&#x63A5;&#x6536;&#x7684;&#x7C7B;&#x578B;&#x76F8;&#x540C; &#xFF08;<code>Machina</code>&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x6BCF;&#x4E2A; <code>CompletableFuture</code>&#x6DFB;&#x52A0;&#x7684;&#x64CD;&#x4F5C;&#x7684;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x90FD;&#x4E3A; <code>Machina</code>&#xFF0C;&#x4F46;&#x662F;(&#x7C7B;&#x4F3C;&#x4E8E;&#x6D41;&#x4E2D;&#x7684; <code>map()</code> )&#x51FD;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x8FD9;&#x5C06;&#x4F53;&#x73B0;&#x5728;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x4E0A;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x5904;&#x770B;&#x5230;&#x6709;&#x5173;<strong>CompletableFutures</strong>&#x7684;&#x91CD;&#x8981;&#x4FE1;&#x606F;&#xFF1A;&#x5B83;&#x4EEC;&#x4F1A;&#x5728;&#x4F60;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x65F6;&#x81EA;&#x52A8;&#x89E3;&#x5305;&#x5E76;&#x91CD;&#x65B0;&#x5305;&#x88C5;&#x5B83;&#x4EEC;&#x6240;&#x643A;&#x5E26;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x4F7F;&#x5F97;&#x7F16;&#x5199;&#x548C;&#x7406;&#x89E3;&#x4EE3;&#x7801;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#xFF0C; &#x800C;&#x4E0D;&#x4F1A;&#x5728;&#x9677;&#x5165;&#x5728;&#x9EBB;&#x70E6;&#x7684;&#x7EC6;&#x8282;&#x4E2D;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6D88;&#x9664;&#x4E2D;&#x95F4;&#x53D8;&#x91CF;&#x5E76;&#x5C06;&#x64CD;&#x4F5C;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x5C31;&#x50CF;&#x6211;&#x4EEC;&#x4F7F;&#x7528;Streams&#x4E00;&#x6837;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletableApplyChained.javaimport java.util.concurrent.*;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableApplyChained</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf <span class="token operator">=</span>
        <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Machina</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                  <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                  <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                  <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                  <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Machina0: ONE
Machina0: TWO
Machina0: THREE
Machina0: complete
514
</code></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x8FD8;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A; <code>Timer</code>&#xFF0C;&#x5B83;&#x7684;&#x529F;&#x80FD;&#x5728;&#x6BCF;&#x4E00;&#x6B65;&#x90FD;&#x663E;&#x6027;&#x5730;&#x589E;&#x52A0; 100ms &#x7B49;&#x5F85;&#x65F6;&#x95F4;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x5C06; <code>CompletableFuture</code> &#x5185;&#x90E8; <code>thenApply</code> &#x5E26;&#x6765;&#x7684;&#x989D;&#x5916;&#x5F00;&#x9500;&#x7ED9;&#x4F53;&#x73B0;&#x51FA;&#x6765;&#x4E86;&#x3002;<br>
<strong>CompletableFutures</strong> &#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x597D;&#x5904;&#x662F;&#x5B83;&#x4EEC;&#x9F13;&#x52B1;&#x4F7F;&#x7528;&#x79C1;&#x6709;&#x5B50;&#x7C7B;&#x539F;&#x5219;&#xFF08;&#x4E0D;&#x5171;&#x4EAB;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#xFF09;&#x3002;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528; <strong>thenApply()</strong> &#x6765;&#x5E94;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x5BF9;&#x5916;&#x901A;&#x4FE1;&#x7684;&#x51FD;&#x6570; - &#x5B83;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x3002;&#x8FD9;&#x662F;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x5728;&#x5E76;&#x53D1;&#x7279;&#x6027;&#x65B9;&#x9762;&#x975E;&#x5E38;&#x6709;&#x6548;<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>&#x3002;&#x5E76;&#x884C;&#x6D41;&#x548C; <code>ComplempleFutures</code> &#x65E8;&#x5728;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x539F;&#x5219;&#x3002;&#x53EA;&#x8981;&#x4F60;&#x4E0D;&#x51B3;&#x5B9A;&#x5171;&#x4EAB;&#x6570;&#x636E;&#xFF08;&#x5171;&#x4EAB;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x610F;&#x5916;&#x53D1;&#x751F;&#xFF09;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x51FA;&#x76F8;&#x5BF9;&#x5B89;&#x5168;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x56DE;&#x8C03; <code>thenApply()</code> &#x4E00;&#x65E6;&#x5F00;&#x59CB;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x5728;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x4E4B;&#x524D;&#xFF0C;&#x4E0D;&#x4F1A;&#x5B8C;&#x6210; <strong>CompletableFuture</strong> &#x7684;&#x6784;&#x5EFA;&#x3002;&#x867D;&#x7136;&#x8FD9;&#x6709;&#x65F6;&#x5F88;&#x6709;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x5F00;&#x59CB;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x901A;&#x5E38;&#x66F4;&#x6709;&#x4EF7;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x7EE7;&#x7EED;&#x524D;&#x8FDB;&#x5E76;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x901A;&#x8FC7;<code>thenApplyAsync()</code> &#x6765;&#x5B9E;&#x73B0;&#x6B64;&#x76EE;&#x7684;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletableApplyAsync.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableApplyAsync</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Machina</span><span class="token punctuation">&gt;</span></span> cf <span class="token operator">=</span>
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">Machina</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Machina</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cf<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>116
Machina0: ONE
Machina0: TWO
Machina0:THREE
Machina0: complete
Machina0: complete
552
</code></pre><p>&#x540C;&#x6B65;&#x8C03;&#x7528;(&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x90A3;&#x79CD;)&#x610F;&#x5473;&#x7740;&#xFF1A;&#x201C;&#x5F53;&#x4F60;&#x5B8C;&#x6210;&#x5DE5;&#x4F5C;&#x65F6;&#xFF0C;&#x624D;&#x8FD4;&#x56DE;&#x201D;&#xFF0C;&#x800C;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#x4EE5;&#x610F;&#x5473;&#x7740;&#xFF1A; &#x201C;&#x7ACB;&#x523B;&#x8FD4;&#x56DE;&#x5E76;&#x7EE7;&#x7EED;&#x540E;&#x7EED;&#x5DE5;&#x4F5C;&#x201D;&#x3002; &#x6B63;&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;<code>cf</code> &#x7684;&#x521B;&#x5EFA;&#x73B0;&#x5728;&#x53D1;&#x751F;&#x7684;&#x66F4;&#x5FEB;&#x3002;&#x6BCF;&#x6B21;&#x8C03;&#x7528; <code>thenApplyAsync()</code> &#x90FD;&#x4F1A;&#x7ACB;&#x523B;&#x8FD4;&#x56DE;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#xFF0C;&#x6574;&#x4E2A;&#x8C03;&#x7528;&#x94FE;&#x8DEF;&#x5B8C;&#x6210;&#x901F;&#x5EA6;&#x6BD4;&#x4EE5;&#x524D;&#x5FEB;&#x5F97;&#x591A;&#x3002;</p>
<p>&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x56DE;&#x8C03; <code>cf.join()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x5728;&#x5B8C;&#x6210;&#x5176;&#x5DE5;&#x4F5C;&#x4E4B;&#x524D;&#x9000;&#x51FA;&#x3002;&#x800C; <code>cf.join()</code> &#x76F4;&#x5230;cf&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#xFF0C;&#x963B;&#x6B62; <code>main()</code> &#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x3002;&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x672C;&#x793A;&#x4F8B;&#x5927;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x6D88;&#x8017;&#x5728; <code>cf.join()</code> &#x8FD9;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x201C;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x201D;&#x7684;&#x5F02;&#x6B65;&#x80FD;&#x529B;&#x9700;&#x8981; <code>CompletableFuture</code> &#x5E93;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x79D8;&#x5BC6;&#xFF08;<code>client</code> &#x65E0;&#x611F;&#xFF09;&#x5DE5;&#x4F5C;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x5B83;&#x5C06;&#x4F60;&#x9700;&#x8981;&#x7684;&#x64CD;&#x4F5C;&#x94FE;&#x5B58;&#x50A8;&#x4E3A;&#x4E00;&#x7EC4;&#x56DE;&#x8C03;&#x3002;&#x5F53;&#x64CD;&#x4F5C;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x94FE;&#x8DEF;&#xFF08;&#x540E;&#x53F0;&#x64CD;&#x4F5C;&#xFF09;&#x5B8C;&#x6210;&#x5E76;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x94FE;&#x8DEF;&#xFF08;&#x540E;&#x53F0;&#x64CD;&#x4F5C;&#xFF09;&#x5FC5;&#x987B;&#x83B7;&#x53D6;&#x751F;&#x6210;&#x7684; <code>Machina</code> &#x5E76;&#x5F00;&#x59CB;&#x5DE5;&#x4F5C;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF01; &#x4F46;&#x8FD9;&#x79CD;&#x5F02;&#x6B65;&#x673A;&#x5236;&#x6CA1;&#x6709;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;&#x6808;&#x63A7;&#x5236;&#x7684;&#x666E;&#x901A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5E8F;&#x5217;&#xFF0C;&#x5B83;&#x7684;&#x8C03;&#x7528;&#x94FE;&#x8DEF;&#x987A;&#x5E8F;&#x4F1A;&#x4E22;&#x5931;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5730;&#x5740;&#x6765;&#x5B58;&#x50A8;&#x7684;&#x56DE;&#x8C03;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x4F60;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x7684;&#x6709;&#x5173;&#x56DE;&#x8C03;&#x7684;&#x5168;&#x90E8;&#x4FE1;&#x606F;&#x3002;&#x7A0B;&#x5E8F;&#x5458;&#x5C06;&#x8FD9;&#x79CD;&#x4EBA;&#x4E3A;&#x5236;&#x9020;&#x7684;&#x6DF7;&#x4E71;&#x79F0;&#x4E3A; callback hell(&#x56DE;&#x8C03;&#x5730;&#x72F1;)&#x3002;&#x901A;&#x8FC7;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#xFF0C;<code>CompletableFuture</code> &#x5E2E;&#x4F60;&#x7BA1;&#x7406;&#x6240;&#x6709;&#x56DE;&#x8C03;&#x3002; &#x9664;&#x975E;&#x4F60;&#x77E5;&#x9053;&#x7CFB;&#x7EDF;&#x7684;&#x4E00;&#x4E9B;&#x5177;&#x4F53;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x5426;&#x5219;&#x4F60;&#x66F4;&#x60F3;&#x4F7F;&#x7528;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x7A0B;&#x5E8F;&#x3002;</p>
<ul>
<li>&#x5176;&#x4ED6;&#x64CD;&#x4F5C;</li>
</ul>
<p>&#x5F53;&#x4F60;&#x67E5;&#x770B;<code>CompletableFuture</code>&#x7684; <code>Javadoc</code> &#x65F6;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5B83;&#x6709;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x5927;&#x90E8;&#x5206;&#x6765;&#x81EA;&#x4E0D;&#x540C;&#x64CD;&#x4F5C;&#x7684;&#x53D8;&#x4F53;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x6709; <code>thenApply()</code>&#xFF0C;<code>thenApplyAsync()</code> &#x548C;&#x7B2C;&#x4E8C;&#x79CD;&#x5F62;&#x5F0F;&#x7684; <code>thenApplyAsync()</code>&#xFF0C;&#x5B83;&#x4EEC;&#x4F7F;&#x7528; <code>Executor</code> &#x6765;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;(&#x5728;&#x672C;&#x4E66;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5FFD;&#x7565;&#x4E86; <code>Executor</code> &#x9009;&#x9879;)&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x5C55;&#x793A;&#x4E86;&#x6240;&#x6709;&quot;&#x57FA;&#x672C;&quot;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x65E2;&#x4E0D;&#x6D89;&#x53CA;&#x7EC4;&#x5408;&#x4E24;&#x4E2A; <code>CompletableFuture</code>&#xFF0C;&#x4E5F;&#x4E0D;&#x6D89;&#x53CA;&#x5F02;&#x5E38;(&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x540E;&#x9762;&#x4ECB;&#x7ECD;)&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x7B80;&#x6D01;&#x6027;&#x548C;&#x65B9;&#x4FBF;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x91CD;&#x7528;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x5B9E;&#x7528;&#x7A0B;&#x5E8F;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">package</span> onjava<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableUtilities</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get and show value stored in a CF:</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">showr</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span>
            <span class="token operator">|</span> <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// For CF operations that have no value:</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">voidr</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      c<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns void</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span>
            <span class="token operator">|</span> <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><code>showr()</code> &#x5728; <code>CompletableFuture&lt;Integer&gt;</code> &#x4E0A;&#x8C03;&#x7528; <code>get()</code>&#xFF0C;&#x5E76;&#x663E;&#x793A;&#x7ED3;&#x679C;&#xFF0C;<code>try/catch</code> &#x4E24;&#x4E2A;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x7684;&#x5F02;&#x5E38;&#x3002;</p>
<p><code>voidr()</code> &#x662F; <code>CompletableFuture&lt;Void&gt;</code> &#x7684; <code>showr()</code> &#x7248;&#x672C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<code>CompletableFutures</code> &#x53EA;&#x4E3A;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x6216;&#x5931;&#x8D25;&#x65F6;&#x663E;&#x793A;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x4E3A;&#x7B80;&#x5355;&#x8D77;&#x89C1;&#xFF0C;&#x4E0B;&#x9762;&#x7684; <code>CompletableFutures</code> &#x53EA;&#x5305;&#x88C5;&#x6574;&#x6570;&#x3002;<code>cfi()</code> &#x662F;&#x4E00;&#x4E2A;&#x4FBF;&#x5229;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x628A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5305;&#x88C5;&#x5728;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684; <code>CompletableFuture&lt;Integer&gt;</code> :</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletableOperations.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> onjava<span class="token punctuation">.</span><span class="token class-name">CompletableUtilities</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableOperations</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">cfi</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
                <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
                        <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">showr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Basic test</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;runAsync&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thenRunAsync&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;runAsync is static&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenAcceptAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thenAcceptAsync: &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">+</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenComposeAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token function">cfi</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">obtrudeValue</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span><span class="token function">cfi</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCompletableFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cancelled: &quot;</span> <span class="token operator">+</span>
                c<span class="token punctuation">.</span><span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;completed exceptionally: &quot;</span> <span class="token operator">+</span>
                c<span class="token punctuation">.</span><span class="token function">isCompletedExceptionally</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;done: &quot;</span> <span class="token operator">+</span> c<span class="token punctuation">.</span><span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getNow</span><span class="token punctuation">(</span><span class="token number">777</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">+</span> <span class="token number">42</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">*</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dependents: &quot;</span> <span class="token operator">+</span>
                c<span class="token punctuation">.</span><span class="token function">getNumberOfDependents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dependents: &quot;</span> <span class="token operator">+</span>
                c<span class="token punctuation">.</span><span class="token function">getNumberOfDependents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><strong>&#x8F93;&#x51FA;&#x7ED3;&#x679C;</strong> &#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>1
runAsync
thenRunAsync
runAsync is static
99
thenAcceptAsync: 4
47
105
111
8
9
cancelled: true
completed exceptionally: true
done: true
java.util.concurrent.CompletableFuture@6d311334[Complet ed exceptionally]
777
dependents: 1
dependents: 2
</code></pre><ul>
<li><code>main()</code> &#x5305;&#x542B;&#x4E00;&#x7CFB;&#x5217;&#x53EF;&#x7531;&#x5176; <code>int</code> &#x503C;&#x5F15;&#x7528;&#x7684;&#x6D4B;&#x8BD5;&#x3002;
<ul>
<li><code>cfi(1)</code> &#x6F14;&#x793A;&#x4E86; <code>showr()</code> &#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;</li>
<li><code>cfi(2)</code> &#x662F;&#x8C03;&#x7528; <code>runAsync()</code> &#x7684;&#x793A;&#x4F8B;&#x3002;&#x7531;&#x4E8E; <code>Runnable</code> &#x4E0D;&#x4EA7;&#x751F;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x4F7F;&#x7528;&#x4E86;&#x8FD4;&#x56DE; <code>CompletableFuture &lt;Void&gt;</code> &#x7684;<code>voidr()</code> &#x65B9;&#x6CD5;&#x3002;</li>
<li>&#x6CE8;&#x610F;&#x4F7F;&#x7528; <code>cfi(3)</code>,<code>thenRunAsync()</code> &#x6548;&#x679C;&#x4F3C;&#x4E4E;&#x4E0E; &#x4E0A;&#x4F8B; <code>cfi(2)</code> &#x4F7F;&#x7528;&#x7684; <code>runAsync()</code>&#x76F8;&#x540C;&#xFF0C;&#x5DEE;&#x5F02;&#x5728;&#x540E;&#x7EED;&#x7684;&#x6D4B;&#x8BD5;&#x4E2D;&#x4F53;&#x73B0;&#xFF1A;
<ul>
<li><code>runAsync()</code> &#x662F;&#x4E00;&#x4E2A; <code>static</code> &#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x901A;&#x5E38;&#x4E0D;&#x4F1A;&#x50CF;<code>cfi(2)</code>&#x4E00;&#x6837;&#x8C03;&#x7528;&#x5B83;&#x3002;&#x76F8;&#x53CD;&#x4F60;&#x53EF;&#x4EE5;&#x5728; <code>QuittingCompletable.java</code> &#x4E2D;&#x4F7F;&#x7528;&#x5B83;&#x3002;</li>
<li>&#x540E;&#x7EED;&#x6D4B;&#x8BD5;&#x4E2D;&#x8868;&#x660E; <code>supplyAsync()</code> &#x4E5F;&#x662F;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5B83;&#x9700;&#x8981;&#x4E00;&#x4E2A; <code>Supplier</code> &#x800C;&#x4E0D;&#x662F;<code>Runnable</code>, &#x5E76;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;<code>CompletableFuture&lt;Integer&gt;</code> &#x800C;&#x4E0D;&#x662F; <code>CompletableFuture&lt;Void&gt;</code>&#x3002;</li>
</ul>
</li>
<li><code>then</code> &#x7CFB;&#x5217;&#x65B9;&#x6CD5;&#x5C06;&#x5BF9;&#x73B0;&#x6709;&#x7684; <code>CompletableFuture&lt;Integer&gt;</code> &#x8FDB;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;&#x3002;
<ul>
<li>&#x4E0E; <code>thenRunAsync()</code> &#x4E0D;&#x540C;&#xFF0C;<code>cfi(4)</code>&#xFF0C;<code>cfi(5)</code> &#x548C;<code>cfi(6)</code> &quot;then&quot; &#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x662F;&#x672A;&#x5305;&#x88C5;&#x7684; <code>Integer</code>&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x4F7F;&#x7528; <code>voidr()</code>&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x770B;&#x5230;:
<ul>
<li><code>AcceptAsync()</code>&#x63A5;&#x6536;&#x4E86;&#x4E00;&#x4E2A; <code>Consumer</code>&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x7ED3;&#x679C;&#x3002;</li>
<li><code>thenApplyAsync()</code> &#x63A5;&#x6536;&#x4E00;&#x4E2A;<code>Function</code>, &#x5E76;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#xFF08;&#x8BE5;&#x7ED3;&#x679C;&#x7684;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x4E0D;&#x540C;&#x4E8E;&#x5176;&#x8F93;&#x5165;&#x7C7B;&#x578B;&#xFF09;&#x3002;</li>
<li><code>thenComposeAsync()</code> &#x4E0E; <code>thenApplyAsync()</code>&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#xFF0C;&#x552F;&#x4E00;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5176; <code>Function</code> &#x5FC5;&#x987B;&#x4EA7;&#x751F;&#x5DF2;&#x7ECF;&#x5305;&#x88C5;&#x5728;<code>CompletableFuture</code>&#x4E2D;&#x7684;&#x7ED3;&#x679C;&#x3002;</li>
</ul>
</li>
</ul>
</li>
<li><code>cfi(7)</code> &#x793A;&#x4F8B;&#x6F14;&#x793A;&#x4E86; <code>obtrudeValue()</code>&#xFF0C;&#x5B83;&#x5F3A;&#x5236;&#x5C06;&#x503C;&#x4F5C;&#x4E3A;&#x7ED3;&#x679C;&#x3002;</li>
<li><code>cfi(8)</code> &#x4F7F;&#x7528; <code>toCompletableFuture()</code> &#x4ECE; <code>CompletionStage</code> &#x751F;&#x6210;&#x4E00;&#x4E2A;<code>CompletableFuture</code>&#x3002;</li>
<li><code>c.complete(9)</code> &#x663E;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x901A;&#x8FC7;&#x7ED9;&#x5B83;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x6765;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;<code>task</code>&#xFF08;<code>future</code>&#xFF09;&#xFF08;&#x4E0E; <code>obtrudeValue()</code> &#x76F8;&#x5BF9;&#xFF0C;&#x540E;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x8FEB;&#x4F7F;&#x5176;&#x7ED3;&#x679C;&#x66FF;&#x6362;&#x8BE5;&#x7ED3;&#x679C;&#xFF09;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4F60;&#x8C03;&#x7528; <code>CompletableFuture</code>&#x4E2D;&#x7684; <code>cancel()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x6B64;&#x4EFB;&#x52A1;&#xFF0C;&#x5219;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#x3002; &#x5982;&#x679C;&#x5C1A;&#x672A;&#x5B8C;&#x6210;&#xFF0C;&#x5219;&#x4F7F;&#x7528; <code>CancellationException</code> &#x5B8C;&#x6210;&#x6B64; <code>CompletableFuture</code>&#x3002;</li>
<li>&#x5982;&#x679C;&#x4EFB;&#x52A1;&#xFF08;<code>future</code>&#xFF09;&#x5B8C;&#x6210;&#xFF0C;&#x5219;**getNow()**&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;<code>CompletableFuture</code>&#x7684;&#x5B8C;&#x6210;&#x503C;&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;<code>getNow()</code>&#x7684;&#x66FF;&#x6362;&#x53C2;&#x6570;&#x3002;</li>
<li>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;&#x4F9D;&#x8D56;(<code>dependents</code>)&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;&#x4E24;&#x4E2A;<code>thenApplyAsync()</code>&#x8C03;&#x7528;&#x94FE;&#x8DEF;&#x5230;<code>CompletableFuture</code>&#x4E0A;&#xFF0C;&#x5219;&#x4F9D;&#x8D56;&#x9879;&#x7684;&#x6570;&#x91CF;&#x4E0D;&#x4F1A;&#x589E;&#x52A0;&#xFF0C;&#x4FDD;&#x6301;&#x4E3A;1&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x53E6;&#x5916;&#x5C06;&#x53E6;&#x4E00;&#x4E2A;<code>thenApplyAsync()</code>&#x76F4;&#x63A5;&#x9644;&#x52A0;&#x5230;<code>c</code>&#xFF0C;&#x5219;&#x73B0;&#x5728;&#x6709;&#x4E24;&#x4E2A;&#x4F9D;&#x8D56;&#x9879;&#xFF1A;&#x4E24;&#x4E2A;&#x4E00;&#x8D77;&#x7684;&#x94FE;&#x8DEF;&#x548C;&#x53E6;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x9644;&#x52A0;&#x7684;&#x94FE;&#x8DEF;&#x3002;
<ul>
<li>&#x8FD9;&#x8868;&#x660E;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;<code>CompletionStage</code>&#xFF0C;&#x5F53;&#x5B83;&#x5B8C;&#x6210;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5176;&#x7ED3;&#x679C;&#x6D3E;&#x751F;&#x591A;&#x4E2A;&#x65B0;&#x4EFB;&#x52A1;&#x3002;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="%E7%BB%93%E5%90%88-completablefuture">&#x7ED3;&#x5408; CompletableFuture</h3>

<p>&#x7B2C;&#x4E8C;&#x79CD;&#x7C7B;&#x578B;&#x7684; <code>CompletableFuture</code> &#x65B9;&#x6CD5;&#x91C7;&#x7528;&#x4E24;&#x79CD; <code>CompletableFuture</code> &#x5E76;&#x4EE5;&#x5404;&#x5F02;&#x65B9;&#x5F0F;&#x5C06;&#x5B83;&#x4EEC;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x5C31;&#x50CF;&#x4E24;&#x4E2A;&#x4EBA;&#x5728;&#x6BD4;&#x8D5B;&#x4E00;&#x6837;, &#x4E00;&#x4E2A;<code>CompletableFuture</code>&#x901A;&#x5E38;&#x6BD4;&#x53E6;&#x4E00;&#x4E2A;&#x66F4;&#x65E9;&#x5730;&#x5230;&#x8FBE;&#x7EC8;&#x70B9;&#x3002;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x5141;&#x8BB8;&#x4F60;&#x4EE5;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x5904;&#x7406;&#x7ED3;&#x679C;&#x3002;<br>
&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5B83;&#x6709;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x5B9A;&#x4E49;&#x4E86;&#x5B8C;&#x6210;&#x4EFB;&#x52A1;&#x6240;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x91CF;&#x7684;&#x53C2;&#x6570;&#x3002;<br>
CompletableFuture &#x5148;&#x5B8C;&#x6210;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Workable.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Workable</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">double</span> duration<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Workable</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">double</span> duration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>duration <span class="token operator">=</span> duration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Workable[&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Workable</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token class-name">Workable</span> tt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Seconds</span>
        tt<span class="token punctuation">.</span>id <span class="token operator">=</span> tt<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">&quot;W&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Workable</span><span class="token punctuation">&gt;</span></span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">double</span> duration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">Workable</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> duration<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Workable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5728; <code>make()</code>&#x4E2D;&#xFF0C;<code>work()</code>&#x65B9;&#x6CD5;&#x5E94;&#x7528;&#x4E8E;<code>CompletableFuture</code>&#x3002;<code>work()</code>&#x9700;&#x8981;&#x4E00;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#xFF0C;&#x7136;&#x540E;&#x5B83;&#x5C06;&#x5B57;&#x6BCD;W&#x9644;&#x52A0;&#x5230;id&#x4E0A;&#xFF0C;&#x8868;&#x793A;&#x5DE5;&#x4F5C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x7ADE;&#x4E89;&#x7684; <code>CompletableFuture</code>&#xFF0C;&#x5E76;&#x4F7F;&#x7528; <code>CompletableFuture</code> &#x5E93;&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/DualCompletableOperations.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> onjava<span class="token punctuation">.</span><span class="token class-name">CompletableUtilities</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DualCompletableOperations</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Workable</span><span class="token punctuation">&gt;</span></span> cfA<span class="token punctuation">,</span> cfB<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cfA <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfB <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token number">0.10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Always wins</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cfA<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfB<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*****************&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">runAfterEitherAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;runAfterEither&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">runAfterBothAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;runAfterBoth&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">applyToEitherAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> w <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;applyToEither: &quot;</span> <span class="token operator">+</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> w<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">acceptEitherAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> w <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;acceptEither: &quot;</span> <span class="token operator">+</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">voidr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">thenAcceptBothAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> <span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thenAcceptBoth: &quot;</span>
                    <span class="token operator">+</span> w1 <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> w2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showr</span><span class="token punctuation">(</span>cfA<span class="token punctuation">.</span><span class="token function">thenCombineAsync</span><span class="token punctuation">(</span>cfB<span class="token punctuation">,</span> <span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thenCombine: &quot;</span>
                    <span class="token operator">+</span> w1 <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> w2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> w1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Workable</span><span class="token punctuation">&gt;</span></span>
                cfC <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token number">0.08</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                cfD <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token number">0.09</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">anyOf</span><span class="token punctuation">(</span>cfA<span class="token punctuation">,</span> cfB<span class="token punctuation">,</span> cfC<span class="token punctuation">,</span> cfD<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;anyOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfC <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token number">0.08</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfD <span class="token operator">=</span> <span class="token class-name">Workable</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token number">0.09</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">allOf</span><span class="token punctuation">(</span>cfA<span class="token punctuation">,</span> cfB<span class="token punctuation">,</span> cfC<span class="token punctuation">,</span> cfD<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenRunAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;allOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><strong>&#x8F93;&#x51FA;&#x7ED3;&#x679C;</strong>&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Workable[BW]
runAfterEither
Workable[AW]
*****************
Workable[BW]
Workable[AW]
runAfterBoth
*****************
Workable[BW]
applyToEither: Workable[BW]
Workable[BW]
Workable[AW]
*****************
Workable[BW]
acceptEither: Workable[BW]
Workable[AW]
*****************
Workable[BW]
Workable[AW]
thenAcceptBoth: Workable[AW], Workable[BW]
****************
 Workable[BW]
 Workable[AW]
 thenCombine: Workable[AW], Workable[BW]
 Workable[AW]
 *****************
 Workable[CW]
 anyOf
 Workable[DW]
 Workable[BW]
 Workable[AW]
 *****************
 Workable[CW]
 Workable[DW]
 Workable[BW]
 Workable[AW]
 *****************
 allOf
</code></pre><ul>
<li>&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x8BBF;&#x95EE;&#xFF0C; &#x5C06; <code>cfA</code> &#x548C; <code>cfB</code> &#x5B9A;&#x4E49;&#x4E3A; <code>static</code>&#x7684;&#x3002;
<ul>
<li><code>init()</code>&#x65B9;&#x6CD5;&#x7528;&#x4E8E; <code>A</code>, <code>B</code> &#x521D;&#x59CB;&#x5316;&#x8FD9;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x56E0;&#x4E3A; <code>B</code> &#x603B;&#x662F;&#x7ED9;&#x51FA;&#x6BD4;<code>A</code>&#x8F83;&#x77ED;&#x7684;&#x5EF6;&#x8FDF;&#xFF0C;&#x6240;&#x4EE5;&#x603B;&#x662F; <code>win</code> &#x7684;&#x4E00;&#x65B9;&#x3002;</li>
<li><code>join()</code> &#x662F;&#x5728;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0A;&#x8C03;&#x7528; <code>join()</code> &#x5E76;&#x663E;&#x793A;&#x8FB9;&#x6846;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x4FBF;&#x5229;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
</li>
<li>&#x6240;&#x6709;&#x8FD9;&#x4E9B; &#x201C;<code>dual</code>&#x201D; &#x65B9;&#x6CD5;&#x90FD;&#x4EE5;&#x4E00;&#x4E2A; <code>CompletableFuture</code> &#x4F5C;&#x4E3A;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A; <code>CompletableFuture</code> &#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x8981;&#x6267;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x4F7F;&#x7528; <code>showr()</code> &#x548C; <code>voidr()</code> &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x201C;<code>run</code>&#x201D;&#x548C;&#x201C;<code>accept</code>&#x201D;&#x662F;&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x201C;<code>apply</code>&#x201D;&#x548C;&#x201C;<code>combine</code>&#x201D;&#x5219;&#x751F;&#x6210;&#x65B0;&#x7684; <code>payload-bearing</code> (&#x627F;&#x8F7D;&#x8D1F;&#x8F7D;)&#x7684; <code>CompletableFuture</code>&#x3002;</li>
<li>&#x65B9;&#x6CD5;&#x7684;&#x540D;&#x79F0;&#x4E0D;&#x8A00;&#x81EA;&#x660E;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x67E5;&#x770B;&#x8F93;&#x51FA;&#x6765;&#x9A8C;&#x8BC1;&#x8FD9;&#x4E00;&#x70B9;&#x3002;&#x4E00;&#x4E2A;&#x7279;&#x522B;&#x6709;&#x8DA3;&#x7684;&#x65B9;&#x6CD5;&#x662F; <code>combineAsync()</code>&#xFF0C;&#x5B83;&#x7B49;&#x5F85;&#x4E24;&#x4E2A; <code>CompletableFuture</code> &#x5B8C;&#x6210;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5B83;&#x4EEC;&#x90FD;&#x4EA4;&#x7ED9;&#x4E00;&#x4E2A; <code>BiFunction</code>&#xFF0C;&#x8FD9;&#x4E2A; <code>BiFunction</code> &#x53EF;&#x4EE5;&#x5C06;&#x7ED3;&#x679C;&#x52A0;&#x5165;&#x5230;&#x6700;&#x7EC8;&#x7684; <code>CompletableFuture</code> &#x7684;&#x6709;&#x6548;&#x8D1F;&#x8F7D;&#x4E2D;&#x3002;</li>
</ul>
<h3 class="mume-header" id="%E6%A8%A1%E6%8B%9F">&#x6A21;&#x62DF;</h3>

<p>&#x4F5C;&#x4E3A;&#x4F7F;&#x7528; <code>CompletableFuture</code> &#x5C06;&#x4E00;&#x7CFB;&#x5217;&#x64CD;&#x4F5C;&#x7EC4;&#x5408;&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x6A21;&#x62DF;&#x4E00;&#x4E0B;&#x5236;&#x4F5C;&#x86CB;&#x7CD5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x5728;&#x7B2C;&#x4E00;&#x9636;&#x6BB5;&#xFF0C;&#x6211;&#x4EEC;&#x51C6;&#x5907;&#x5E76;&#x5C06;&#x539F;&#x6599;&#x6DF7;&#x5408;&#x6210;&#x9762;&#x7CCA;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Batter.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Batter</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Eggs</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Milk</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Sugar</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Flour</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token class-name">T</span> ingredient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ingredient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">prep</span><span class="token punctuation">(</span><span class="token class-name">T</span> ingredient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>ingredient<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Batter</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">prepare</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Batter</span><span class="token punctuation">&gt;</span></span> <span class="token function">mix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Eggs</span><span class="token punctuation">&gt;</span></span> eggs <span class="token operator">=</span> <span class="token function">prep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Eggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Milk</span><span class="token punctuation">&gt;</span></span> milk <span class="token operator">=</span> <span class="token function">prep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Milk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Sugar</span><span class="token punctuation">&gt;</span></span> sugar <span class="token operator">=</span> <span class="token function">prep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Sugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Flour</span><span class="token punctuation">&gt;</span></span> flour <span class="token operator">=</span> <span class="token function">prep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Flour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">allOf</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> milk<span class="token punctuation">,</span> sugar<span class="token punctuation">,</span> flour<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mixing time</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Batter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x6BCF;&#x79CD;&#x539F;&#x6599;&#x90FD;&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x65F6;&#x95F4;&#x6765;&#x51C6;&#x5907;&#x3002;<code>allOf()</code> &#x7B49;&#x5F85;&#x6240;&#x6709;&#x7684;&#x914D;&#x6599;&#x90FD;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x66F4;&#x591A;&#x4E9B;&#x7684;&#x65F6;&#x95F4;&#x5C06;&#x5176;&#x6DF7;&#x5408;&#x6210;&#x9762;&#x7CCA;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x5355;&#x6279;&#x9762;&#x7CCA;&#x653E;&#x5165;&#x56DB;&#x4E2A;&#x5E73;&#x5E95;&#x9505;&#x4E2D;&#x70D8;&#x70E4;&#x3002;&#x4EA7;&#x54C1;&#x4F5C;&#x4E3A; <code>CompletableFutures</code>  &#x6D41;&#x8FD4;&#x56DE;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Baked.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Baked</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Pan</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">Pan</span> <span class="token function">pan</span><span class="token punctuation">(</span><span class="token class-name">Batter</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">Baked</span> <span class="token function">heat</span><span class="token punctuation">(</span><span class="token class-name">Pan</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Baked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Baked</span><span class="token punctuation">&gt;</span></span> <span class="token function">bake</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Batter</span><span class="token punctuation">&gt;</span></span> cfb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> cfb
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Baked</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">pan</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Baked</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">heat</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">&lt;</span><span class="token class-name">Baked</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">batch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Batter</span><span class="token punctuation">&gt;</span></span> batter <span class="token operator">=</span> <span class="token class-name">Batter</span><span class="token punctuation">.</span><span class="token function">mix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                <span class="token function">bake</span><span class="token punctuation">(</span>batter<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">bake</span><span class="token punctuation">(</span>batter<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">bake</span><span class="token punctuation">(</span>batter<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">bake</span><span class="token punctuation">(</span>batter<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5236;&#x4F5C;&#x4E86;&#x4E00;&#x6279;&#x7CD6;&#xFF0C;&#x5E76;&#x7528;&#x5B83;&#x5BF9;&#x86CB;&#x7CD5;&#x8FDB;&#x884C;&#x7CD6;&#x5316;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/FrostedCake.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Frosting</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Frosting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Frosting</span><span class="token punctuation">&gt;</span></span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Frosting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FrostedCake</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">FrostedCake</span><span class="token punctuation">(</span><span class="token class-name">Baked</span> baked<span class="token punctuation">,</span> <span class="token class-name">Frosting</span> frosting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;FrostedCake&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Baked</span><span class="token punctuation">.</span><span class="token function">batch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
                baked <span class="token operator">-&gt;</span> baked
                        <span class="token punctuation">.</span><span class="token function">thenCombineAsync</span><span class="token punctuation">(</span><span class="token class-name">Frosting</span><span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token punctuation">(</span>cake<span class="token punctuation">,</span> frosting<span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
                                        <span class="token keyword">new</span> <span class="token class-name">FrostedCake</span><span class="token punctuation">(</span>cake<span class="token punctuation">,</span> frosting<span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">thenAcceptAsync</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x4E00;&#x65E6;&#x4F60;&#x4E60;&#x60EF;&#x4E86;&#x8FD9;&#x79CD;&#x80CC;&#x540E;&#x7684;&#x60F3;&#x6CD5;, <code>CompletableFuture</code> &#x5B83;&#x4EEC;&#x76F8;&#x5BF9;&#x6613;&#x4E8E;&#x4F7F;&#x7528;&#x3002;</p>
<h3 class="mume-header" id="%E5%BC%82%E5%B8%B8">&#x5F02;&#x5E38;</h3>

<p>&#x4E0E; <code>CompletableFuture</code> &#x5728;&#x5904;&#x7406;&#x94FE;&#x4E2D;&#x5305;&#x88C5;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x76F8;&#x540C;&#xFF0C;&#x5B83;&#x4E5F;&#x4F1A;&#x7F13;&#x51B2;&#x5F02;&#x5E38;&#x3002;&#x8FD9;&#x4E9B;&#x5728;&#x5904;&#x7406;&#x65F6;&#x8C03;&#x7528;&#x8005;&#x662F;&#x65E0;&#x611F;&#x7684;&#xFF0C;&#x4F46;&#x4EC5;&#x5F53;&#x4F60;&#x5C1D;&#x8BD5;&#x63D0;&#x53D6;&#x7ED3;&#x679C;&#x65F6;&#x624D;&#x4F1A;&#x88AB;&#x544A;&#x77E5;&#x3002;&#x4E3A;&#x4E86;&#x8BF4;&#x660E;&#x5B83;&#x4EEC;&#x662F;&#x5982;&#x4F55;&#x5DE5;&#x4F5C;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x5B83;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Breakable.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Breakable</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> failcount<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Breakable</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> failcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>failcount <span class="token operator">=</span> failcount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Breakable_&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot; [&quot;</span> <span class="token operator">+</span> failcount <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Breakable</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>b<span class="token punctuation">.</span>failcount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Throwing Exception for &quot;</span> <span class="token operator">+</span> b<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;Breakable_&quot;</span> <span class="token operator">+</span> b<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">&quot; failed&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5F53;<code>failcount</code> &gt; 0&#xFF0C;&#x4E14;&#x6BCF;&#x6B21;&#x5C06;&#x5BF9;&#x8C61;&#x4F20;&#x9012;&#x7ED9; <code>work()</code> &#x65B9;&#x6CD5;&#x65F6;&#xFF0C; <code>failcount - 1</code> &#x3002;&#x5F53;<code>failcount - 1 = 0</code> &#x65F6;&#xFF0C;<code>work()</code> &#x5C06;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x3002;&#x5982;&#x679C;&#x4F20;&#x7ED9; <code>work()</code> &#x7684; <code>failcount = 0</code> &#xFF0C;<code>work()</code> &#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#x88AB;&#x629B;&#x51FA;&#xFF08; <code>RuntimeException</code> )</p>
<p>&#x5728;&#x4E0B;&#x9762;&#x793A;&#x4F8B;  <code>test()</code> &#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;<code>work()</code> &#x591A;&#x6B21;&#x5E94;&#x7528;&#x4E8E; <code>Breakable</code>&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C; <code>failcount</code> &#x5728;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5728;&#x6D4B;&#x8BD5;<code>A</code>&#x5230;<code>E</code>&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4ECE;&#x8F93;&#x51FA;&#x4E2D;&#x770B;&#x5230;&#x629B;&#x51FA;&#x4E86;&#x5F02;&#x5E38;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x4ECE;&#x672A;&#x51FA;&#x73B0;:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletableExceptions.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletableExceptions</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Breakable</span><span class="token punctuation">&gt;</span></span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> failcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">Breakable</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> failcount<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Exceptions don&apos;t appear ...</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;E&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ... until you try to fetch the value:</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// or join()</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Test for exceptions:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;G&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCompletedExceptionally</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Counts as &quot;done&quot;:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;H&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Force an exception:</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> cfi <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;done? &quot;</span> <span class="token operator">+</span> cfi<span class="token punctuation">.</span><span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cfi<span class="token punctuation">.</span><span class="token function">completeExceptionally</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;forced&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            cfi<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Throwing Exception for A
Breakable_B [1]
Throwing Exception for B
Breakable_C [2]
Breakable_C [1]
Throwing Exception for C
Breakable_D [3]
Breakable_D [2]
Breakable_D [1]
Throwing Exception for D
Breakable_E [4]
Breakable_E [3]
Breakable_E [2]
Breakable_E [1]
Breakable_F [1]
Throwing Exception for F
java.lang.RuntimeException: Breakable_F failed
Breakable_G [1]
Throwing Exception for G
true
Breakable_H [1]
Throwing Exception for H
true
done? false
java.lang.RuntimeException: forced
</code></pre><p>&#x6D4B;&#x8BD5; <code>A</code> &#x5230; <code>E</code> &#x8FD0;&#x884C;&#x5230;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x7136;&#x540E;&#x2026;&#x5E76;&#x6CA1;&#x6709;&#x5C06;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x66B4;&#x9732;&#x7ED9;&#x8C03;&#x7528;&#x65B9;&#x3002;&#x53EA;&#x6709;&#x5728;&#x6D4B;&#x8BD5;F&#x4E2D;&#x8C03;&#x7528; <code>get()</code> &#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x624D;&#x4F1A;&#x770B;&#x5230;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x3002;<br>
&#x6D4B;&#x8BD5; <code>G</code> &#x8868;&#x660E;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x9996;&#x5148;&#x68C0;&#x67E5;&#x5728;&#x5904;&#x7406;&#x671F;&#x95F4;&#x662F;&#x5426;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x800C;&#x4E0D;&#x629B;&#x51FA;&#x8BE5;&#x5F02;&#x5E38;&#x3002;&#x7136;&#x800C;&#xFF0C;test <code>H</code> &#x544A;&#x8BC9;&#x6211;&#x4EEC;&#xFF0C;&#x4E0D;&#x7BA1;&#x5F02;&#x5E38;&#x662F;&#x5426;&#x6210;&#x529F;&#xFF0C;&#x5B83;&#x4ECD;&#x7136;&#x88AB;&#x89C6;&#x4E3A;&#x5DF2;&#x201C;&#x5B8C;&#x6210;&#x201D;&#x3002;<br>
&#x4EE3;&#x7801;&#x7684;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x5C06;&#x5F02;&#x5E38;&#x63D2;&#x5165;&#x5230; <code>CompletableFuture</code> &#x4E2D;&#xFF0C;&#x800C;&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x5931;&#x8D25;&#x3002;<br>
&#x5728;&#x8FDE;&#x63A5;&#x6216;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; <code>CompletableFuture</code> &#x63D0;&#x4F9B;&#x7684;&#x66F4;&#x590D;&#x6742;&#x7684;&#x673A;&#x5236;&#x6765;&#x81EA;&#x52A8;&#x54CD;&#x5E94;&#x5F02;&#x5E38;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4F7F;&#x7528;&#x7C97;&#x7CD9;&#x7684; <code>try-catch</code>&#x3002;<br>
&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0E;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x6240;&#x6709; <code>CompletableFuture</code>  &#x76F8;&#x540C;&#x7684;&#x8868;&#x5355;&#x6765;&#x5B8C;&#x6210;&#x6B64;&#x64CD;&#x4F5C;:&#x5728;&#x94FE;&#x4E2D;&#x63D2;&#x5165;&#x4E00;&#x4E2A;  <code>CompletableFuture</code> &#x8C03;&#x7528;&#x3002;&#x6709;&#x4E09;&#x4E2A;&#x9009;&#x9879; <code>exceptionally()</code>&#xFF0C;<code>handle()</code>&#xFF0C; <code>whenComplete()</code>:</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CatchCompletableExceptions.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CatchCompletableExceptions</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token keyword">int</span> failcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Call the Function only if there&apos;s an</span>
        <span class="token comment">// exception, must produce same type as came in:</span>
        <span class="token class-name">CompletableExceptions</span>
                <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;exceptionally&quot;</span><span class="token punctuation">,</span> failcount<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">exceptionally</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// Function</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;I don&apos;t get it yet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Breakable</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;result: &quot;</span> <span class="token operator">+</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Create a new result (recover):</span>
        <span class="token class-name">CompletableExceptions</span>
                <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;handle&quot;</span><span class="token punctuation">,</span> failcount<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> fail<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// BiFunction</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>fail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> <span class="token string">&quot;Failure recovery object&quot;</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span>
                        <span class="token keyword">return</span> result <span class="token operator">+</span> <span class="token string">&quot; is good&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;result: &quot;</span> <span class="token operator">+</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Do something but pass the same result through:</span>
        <span class="token class-name">CompletableExceptions</span>
                <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;whenComplete&quot;</span><span class="token punctuation">,</span> failcount<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> fail<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// BiConsumer</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>fail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;It failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result <span class="token operator">+</span> <span class="token string">&quot; OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span>r <span class="token operator">-&gt;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;result: &quot;</span> <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;**** Failure Mode ****&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;**** Success Mode ****&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>**** Failure Mode ****
Breakable_exceptionally [1]
Throwing Exception for exceptionally
result: Breakable_java.lang.RuntimeException:
Breakable_exceptionally failed [0]
Breakable_handle [1]
Throwing Exception for handle
result: Failure recovery object
Breakable_whenComplete [1]
Throwing Exception for whenComplete
It failed
**** Success Mode ****
Breakable_exceptionally [-1]
Breakable_exceptionally [-2]
Breakable_exceptionally [-3]
Breakable_exceptionally [-4]
result: Breakable_exceptionally [-4]
Breakable_handle [-1]
Breakable_handle [-2]
Breakable_handle [-3]
Breakable_handle [-4]
result: Breakable_handle [-4] is good
Breakable_whenComplete [-1]
Breakable_whenComplete [-2]
Breakable_whenComplete [-3]
Breakable_whenComplete [-4]
Breakable_whenComplete [-4] OK
result: Breakable_whenComplete [-4]
</code></pre><ul>
<li>
<p><code>exceptionally()</code>  &#x53C2;&#x6570;&#x4EC5;&#x5728;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x65F6;&#x624D;&#x8FD0;&#x884C;&#x3002;<code>exceptionally()</code>  &#x5C40;&#x9650;&#x6027;&#x5728;&#x4E8E;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x53EA;&#x80FD;&#x8FD4;&#x56DE;&#x8F93;&#x5165;&#x7C7B;&#x578B;&#x76F8;&#x540C;&#x7684;&#x503C;&#x3002;</p>
</li>
<li>
<p><code>exceptionally()</code> &#x901A;&#x8FC7;&#x5C06;&#x4E00;&#x4E2A;&#x597D;&#x7684;&#x5BF9;&#x8C61;&#x63D2;&#x5165;&#x5230;&#x6D41;&#x4E2D;&#x6765;&#x6062;&#x590D;&#x5230;&#x4E00;&#x4E2A;&#x53EF;&#x884C;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
</li>
<li>
<p><code>handle()</code> &#x4E00;&#x81F4;&#x88AB;&#x8C03;&#x7528;&#x6765;&#x67E5;&#x770B;&#x662F;&#x5426;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#xFF08;&#x5FC5;&#x987B;&#x68C0;&#x67E5;fail&#x662F;&#x5426;&#x4E3A;true&#xFF09;&#x3002;</p>
<ul>
<li>
<p>&#x4F46;&#x662F; <code>handle()</code> &#x53EF;&#x4EE5;&#x751F;&#x6210;&#x4EFB;&#x4F55;&#x65B0;&#x7C7B;&#x578B;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x5141;&#x8BB8;&#x6267;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x50CF;&#x4F7F;&#x7528; <code>exceptionally()</code>&#x90A3;&#x6837;&#x7B80;&#x5355;&#x5730;&#x6062;&#x590D;&#x3002;</p>
</li>
<li>
<p><code>whenComplete()</code> &#x7C7B;&#x4F3C;&#x4E8E;handle()&#xFF0C;&#x540C;&#x6837;&#x5FC5;&#x987B;&#x6D4B;&#x8BD5;&#x5B83;&#x662F;&#x5426;&#x5931;&#x8D25;&#xFF0C;&#x4F46;&#x662F;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4FEE;&#x6539;&#x4F20;&#x9012;&#x7ED9;&#x5B83;&#x7684;&#x7ED3;&#x679C;&#x5BF9;&#x8C61;&#x3002;</p>
</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="%E6%B5%81%E5%BC%82%E5%B8%B8stream-exception">&#x6D41;&#x5F02;&#x5E38;&#xFF08;Stream Exception&#xFF09;</h3>

<p>&#x901A;&#x8FC7;&#x4FEE;&#x6539;<strong>CompletableExceptions.java</strong>&#xFF0C;&#x770B;&#x770B; <strong>CompletableFuture</strong>&#x5F02;&#x5E38;&#x4E0E;&#x6D41;&#x5F02;&#x5E38;&#x6709;&#x4F55;&#x4E0D;&#x540C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/StreamExceptions.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamExceptions</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">static</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Breakable</span><span class="token punctuation">&gt;</span></span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> failcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Breakable</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> failcount<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Breakable</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">work</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// No operations are even applied ...</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Breakable</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;E&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ... until there&apos;s a terminal operation:</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Entering try&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            c<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// [1]</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Entering try
Breakable_C [2]
Breakable_C [1]
Throwing Exception for C
Breakable_C failed
</code></pre><p>&#x4F7F;&#x7528; <code>CompletableFuture</code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6D4B;&#x8BD5;A&#x5230;E&#x7684;&#x8FDB;&#x5C55;&#xFF0C;&#x4F46;&#x662F;&#x4F7F;&#x7528;&#x6D41;&#xFF0C;&#x5728;&#x4F60;&#x5E94;&#x7528;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF08;e.g. <code>forEach()</code>&#xFF09;&#xFF0C;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x4F1A;&#x66B4;&#x9732;&#x7ED9; Client</p>
<p><code>CompletableFuture</code> &#x6267;&#x884C;&#x5DE5;&#x4F5C;&#x5E76;&#x6355;&#x83B7;&#x4EFB;&#x4F55;&#x5F02;&#x5E38;&#x4F9B;&#x4EE5;&#x540E;&#x68C0;&#x7D22;&#x3002;&#x6BD4;&#x8F83;&#x8FD9;&#x4E24;&#x8005;&#x5E76;&#x4E0D;&#x5BB9;&#x6613;&#xFF0C;&#x56E0;&#x4E3A; <code>Stream</code> &#x5728;&#x6CA1;&#x6709;&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6839;&#x672C;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#x2014;&#x2014;&#x4F46;&#x662F;&#x6D41;&#x7EDD;&#x5BF9;&#x4E0D;&#x4F1A;&#x5B58;&#x50A8;&#x5B83;&#x7684;&#x5F02;&#x5E38;&#x3002;</p>
<h3 class="mume-header" id="%E6%A3%80%E6%9F%A5%E6%80%A7%E5%BC%82%E5%B8%B8">&#x68C0;&#x67E5;&#x6027;&#x5F02;&#x5E38;</h3>

<p><code>CompletableFuture</code> &#x548C; <code>parallel Stream</code> &#x90FD;&#x4E0D;&#x652F;&#x6301;&#x5305;&#x542B;&#x68C0;&#x67E5;&#x6027;&#x5F02;&#x5E38;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5728;&#x8C03;&#x7528;&#x64CD;&#x4F5C;&#x65F6;&#x5904;&#x7406;&#x68C0;&#x67E5;&#x5230;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x8FD9;&#x4F1A;&#x4EA7;&#x751F;&#x4E0D;&#x592A;&#x4F18;&#x96C5;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/ThrowsChecked.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThrowsChecked</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Checked</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">ThrowsChecked</span> <span class="token function">nochecked</span><span class="token punctuation">(</span><span class="token class-name">ThrowsChecked</span> tc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> tc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">ThrowsChecked</span> <span class="token function">withchecked</span><span class="token punctuation">(</span><span class="token class-name">ThrowsChecked</span> tc<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Checked</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> tc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThrowsChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">ThrowsChecked</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">nochecked</span><span class="token punctuation">)</span>
                <span class="token comment">// .map(ThrowsChecked::withchecked); // [1]</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
                        tc <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                                <span class="token keyword">return</span> <span class="token function">withchecked</span><span class="token punctuation">(</span>tc<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Checked</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testCompletableFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThrowsChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span><span class="token class-name">ThrowsChecked</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">nochecked</span><span class="token punctuation">)</span>
                <span class="token comment">// .thenApply(ThrowsChecked::withchecked); // [2]</span>
                <span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span>
                        tc <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                                <span class="token keyword">return</span> <span class="token function">withchecked</span><span class="token punctuation">(</span>tc<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Checked</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5982;&#x679C;&#x4F60;&#x8BD5;&#x56FE;&#x50CF;&#x4F7F;&#x7528; <code>nochecked()</code> &#x90A3;&#x6837;&#x4F7F;&#x7528;<code>withchecked()</code> &#x7684;&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x5728; <code>[1]</code> &#x548C; <code>[2]</code> &#x4E2D;&#x62A5;&#x9519;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5199;&#x51FA;lambda&#x8868;&#x8FBE;&#x5F0F;(&#x6216;&#x8005;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x4E0D;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x7684;&#x5305;&#x88C5;&#x5668;&#x65B9;&#x6CD5;)&#x3002;</p>
<h2 class="mume-header" id="%E6%AD%BB%E9%94%81">&#x6B7B;&#x9501;</h2>

<p>&#x7531;&#x4E8E;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x88AB;&#x963B;&#x585E;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6709;&#x53EF;&#x80FD;&#x5361;&#x5728;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x4E0A;&#xFF0C;&#x800C;&#x540E;&#x8005;&#x53C8;&#x5728;&#x7B49;&#x5F85;&#x522B;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x76F4;&#x4E0B;&#x53BB;&#xFF0C;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x94FE;&#x6761;&#x4E0A;&#x7684;&#x4EFB;&#x52A1;&#x53C8;&#x5728;&#x7B49;&#x5F85;&#x7B2C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x91CA;&#x653E;&#x9501;&#x3002;&#x8FD9;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x7B49;&#x5F85;&#x7684;&#x8FDE;&#x7EED;&#x5FAA;&#x73AF;&#xFF0C; &#x6CA1;&#x6709;&#x54EA;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x7EE7;&#x7EED;&#xFF0C; &#x8FD9;&#x79F0;&#x4E4B;&#x4E3A;&#x6B7B;&#x9501;<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup><br>
&#x5982;&#x679C;&#x4F60;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x800C;&#x5B83;&#x9A6C;&#x4E0A;&#x5C31;&#x6B7B;&#x9501;&#x4E86;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x7ACB;&#x5373;&#x8DDF;&#x8E2A;&#x4E0B;&#x53BB;&#x3002;&#x771F;&#x6B63;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x7A0B;&#x5E8F;&#x770B;&#x8D77;&#x6765;&#x5DE5;&#x4F5C;&#x826F;&#x597D;&#xFF0C; &#x4F46;&#x662F;&#x5177;&#x6709;&#x6F5C;&#x5728;&#x7684;&#x6B7B;&#x9501;&#x5371;&#x9669;&#x3002;&#x8FD9;&#x65F6;&#xFF0C; &#x6B7B;&#x9501;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#xFF0C;&#x800C;&#x4E8B;&#x5148;&#x5374;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F81;&#x5146;&#xFF0C; &#x6240;&#x4EE5; <code>bug</code> &#x4F1A;&#x6F5C;&#x4F0F;&#x5728;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x4F8B;&#xFF0C;&#x76F4;&#x5230;&#x5BA2;&#x6237;&#x53D1;&#x73B0;&#x5B83;&#x51FA;&#x4E4E;&#x610F;&#x6599;&#x7684;&#x53D1;&#x751F;&#xFF08;&#x4EE5;&#x4E00;&#x79CD;&#x51E0;&#x4E4E;&#x80AF;&#x5B9A;&#x662F;&#x5F88;&#x96BE;&#x91CD;&#x73B0;&#x7684;&#x65B9;&#x5F0F;&#x53D1;&#x751F;&#xFF09;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x7F16;&#x5199;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FDB;&#x884C;&#x4ED4;&#x7EC6;&#x7684;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x4EE5;&#x9632;&#x6B62;&#x6B7B;&#x9501;&#x662F;&#x5173;&#x952E;&#x90E8;&#x5206;&#x3002;<br>
&#x57C3;&#x5FB7;&#x65AF;&#xB7;&#x8FEA;&#x514B;&#x65AF;&#x7279;&#x62C9;&#xFF08;<code>Essger Dijkstra</code>&#xFF09;&#x53D1;&#x660E;&#x7684;&#x201C;&#x54F2;&#x5B66;&#x5BB6;&#x8FDB;&#x9910;&quot;&#x95EE;&#x9898;&#x662F;&#x7ECF;&#x5178;&#x7684;&#x6B7B;&#x9501;&#x4F8B;&#x8BC1;&#x3002;&#x57FA;&#x672C;&#x63CF;&#x8FF0;&#x6307;&#x5B9A;&#x4E86;&#x4E94;&#x4F4D;&#x54F2;&#x5B66;&#x5BB6;&#xFF08;&#x6B64;&#x5904;&#x663E;&#x793A;&#x7684;&#x793A;&#x4F8B;&#x5141;&#x8BB8;&#x4EFB;&#x4F55;&#x6570;&#x76EE;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x54F2;&#x5B66;&#x5BB6;&#x5C06;&#x82B1;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x601D;&#x8003;&#xFF0C;&#x82B1;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x5C31;&#x9910;&#x3002;&#x4ED6;&#x4EEC;&#x5728;&#x601D;&#x8003;&#x7684;&#x65F6;&#x5019;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x4EFB;&#x4F55;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF1B;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x4F7F;&#x7528;&#x7684;&#x9910;&#x5177;&#x6570;&#x91CF;&#x6709;&#x9650;&#x3002;&#x5728;&#x6700;&#x521D;&#x7684;&#x95EE;&#x9898;&#x63CF;&#x8FF0;&#x4E2D;&#xFF0C;&#x9910;&#x5177;&#x662F;&#x53C9;&#x5B50;&#xFF0C;&#x9700;&#x8981;&#x4E24;&#x4E2A;&#x53C9;&#x5B50;&#x624D;&#x80FD;&#x4ECE;&#x684C;&#x5B50;&#x4E2D;&#x95F4;&#x7684;&#x7897;&#x91CC;&#x53D6;&#x51FA;&#x610F;&#x5927;&#x5229;&#x9762;&#x3002;&#x5E38;&#x89C1;&#x7684;&#x7248;&#x672C;&#x662F;&#x4F7F;&#x7528;&#x7B77;&#x5B50;&#xFF0C; &#x663E;&#x7136;&#xFF0C;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x9700;&#x8981;&#x4E24;&#x6839;&#x7B77;&#x5B50;&#x624D;&#x80FD;&#x5403;&#x996D;&#x3002;<br>
&#x5F15;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x56F0;&#x96BE;&#xFF1A;&#x4F5C;&#x4E3A;&#x54F2;&#x5B66;&#x5BB6;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;&#x94B1;&#x5F88;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x4ED6;&#x4EEC;&#x53EA;&#x80FD;&#x4E70;&#x4E94;&#x6839;&#x7B77;&#x5B50;&#xFF08;&#x66F4;&#x4E00;&#x822C;&#x5730;&#x8BB2;&#xFF0C;&#x7B77;&#x5B50;&#x7684;&#x6570;&#x91CF;&#x4E0E;&#x54F2;&#x5B66;&#x5BB6;&#x76F8;&#x540C;&#xFF09;&#x3002;&#x4ED6;&#x4EEC;&#x56F4;&#x5728;&#x684C;&#x5B50;&#x5468;&#x56F4;&#xFF0C;&#x6BCF;&#x4EBA;&#x4E4B;&#x95F4;&#x653E;&#x4E00;&#x6839;&#x7B77;&#x5B50;&#x3002; &#x5F53;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x8981;&#x5C31;&#x9910;&#x65F6;&#xFF0C;&#x8BE5;&#x54F2;&#x5B66;&#x5BB6;&#x5FC5;&#x987B;&#x540C;&#x65F6;&#x6301;&#x6709;&#x5DE6;&#x8FB9;&#x548C;&#x53F3;&#x8FB9;&#x7684;&#x7B77;&#x5B50;&#x3002;&#x5982;&#x679C;&#x4EFB;&#x4E00;&#x4FA7;&#x7684;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x5728;&#x4F7F;&#x7528;&#x6240;&#x9700;&#x7684;&#x7B77;&#x5B50;&#xFF0C;&#x5219;&#x6211;&#x4EEC;&#x7684;&#x54F2;&#x5B66;&#x5BB6;&#x5FC5;&#x987B;&#x7B49;&#x5F85;&#xFF0C;&#x76F4;&#x5230;&#x53EF;&#x5F97;&#x5230;&#x5FC5;&#x987B;&#x7684;&#x7B77;&#x5B50;&#x3002;</p>
<p><strong>StickHolder</strong> &#x7C7B;&#x901A;&#x8FC7;&#x5C06;&#x5355;&#x6839;&#x7B77;&#x5B50;&#x4FDD;&#x6301;&#x5728;&#x5927;&#x5C0F;&#x4E3A;1&#x7684;<strong>BlockingQueue</strong>&#x4E2D;&#x6765;&#x7BA1;&#x7406;&#x5B83;&#x3002;<strong>BlockingQueue</strong>&#x662F;&#x4E00;&#x4E2A;&#x8BBE;&#x8BA1;&#x7528;&#x4E8E;&#x5728;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B89;&#x5168;&#x4F7F;&#x7528;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8C03;&#x7528;take()&#x5E76;&#x4E14;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x5B83;&#x5C06;&#x963B;&#x585E;&#xFF08;&#x7B49;&#x5F85;&#xFF09;&#x3002;&#x5C06;&#x65B0;&#x5143;&#x7D20;&#x653E;&#x5165;&#x961F;&#x5217;&#x540E;&#xFF0C;&#x5C06;&#x91CA;&#x653E;&#x8BE5;&#x5757;&#x5E76;&#x8FD4;&#x56DE;&#x8BE5;&#x503C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/StickHolder.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StickHolder</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Chopstick</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Chopstick</span> stick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chopstick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Chopstick</span><span class="token punctuation">&gt;</span></span> holder <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StickHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">putDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pickUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            holder<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Blocks if unavailable</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">putDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            holder<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>stick<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x4E3A;&#x7B80;&#x5355;&#x8D77;&#x89C1;&#xFF0C;<code>Chopstick</code>(<code>static</code>) &#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x662F;&#x7531; <code>StickHolder</code> &#x751F;&#x4EA7;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5176;&#x7C7B;&#x4E2D;&#x4FDD;&#x6301;&#x79C1;&#x6709;&#x7684;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60A8;&#x8C03;&#x7528;&#x4E86;<code>pickUp()</code>&#xFF0C;&#x800C; <code>stick</code> &#x4E0D;&#x53EF;&#x7528;&#xFF0C;&#x90A3;&#x4E48;<code>pickUp()</code>&#x5C06;&#x963B;&#x585E;&#x8BE5; <code>stick</code>&#xFF0C;&#x76F4;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x8C03;&#x7528;<code>putDown()</code> &#x5C06; <code>stick</code> &#x8FD4;&#x56DE;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x8BE5;&#x7C7B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x90FD;&#x662F;&#x901A;&#x8FC7; <code>BlockingQueue</code> &#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x662F;&#x4E00;&#x9879;&#x4EFB;&#x52A1;&#xFF0C;&#x4ED6;&#x4EEC;&#x8BD5;&#x56FE;&#x628A;&#x7B77;&#x5B50;&#x5206;&#x522B; <code>pickUp()</code> &#x5728;&#x5DE6;&#x624B;&#x548C;&#x53F3;&#x624B;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x7B77;&#x5B50;&#x624D;&#x80FD;&#x5403;&#x4E1C;&#x897F;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7; <code>putDown()</code> &#x653E;&#x4E0B; <code>stick</code>&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Philosopher.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Philosopher</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> seat<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">StickHolder</span> left<span class="token punctuation">,</span> right<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Philosopher</span><span class="token punctuation">(</span><span class="token keyword">int</span> seat<span class="token punctuation">,</span> <span class="token class-name">StickHolder</span> left<span class="token punctuation">,</span> <span class="token class-name">StickHolder</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>seat <span class="token operator">=</span> seat<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>left <span class="token operator">=</span> left<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>right <span class="token operator">=</span> right<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;P&quot;</span> <span class="token operator">+</span> seat<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// System.out.println(&quot;Thinking&quot;);   // [1]</span>
            right<span class="token punctuation">.</span><span class="token function">pickUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            left<span class="token punctuation">.</span><span class="token function">pickUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot; eating&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            right<span class="token punctuation">.</span><span class="token function">putDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            left<span class="token punctuation">.</span><span class="token function">putDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x6CA1;&#x6709;&#x4E24;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x6210;&#x529F;&#x8C03;&#x7528;take()&#x540C;&#x4E00;&#x53EA;&#x7B77;&#x5B50;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x5DF2;&#x7ECF;&#x62FF;&#x8FC7;&#x7B77;&#x5B50;&#xFF0C;&#x90A3;&#x4E48;&#x4E0B;&#x4E00;&#x4E2A;&#x8BD5;&#x56FE;&#x62FF;&#x8D77;&#x540C;&#x4E00;&#x6839;&#x7B77;&#x5B50;&#x7684;&#x54F2;&#x5B66;&#x5BB6;&#x5C06;&#x963B;&#x585E;&#xFF0C;&#x7B49;&#x5F85;&#x5176;&#x88AB;&#x91CA;&#x653E;&#x3002;</p>
<p>&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x770B;&#x4F3C;&#x65E0;&#x8F9C;&#x7684;&#x7A0B;&#x5E8F;&#x9677;&#x5165;&#x4E86;&#x6B7B;&#x9501;&#x3002;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x6570;&#x7EC4;&#x800C;&#x4E0D;&#x662F;&#x96C6;&#x5408;&#xFF0C;&#x53EA;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x8BED;&#x6CD5;&#x66F4;&#x7B80;&#x6D01;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/DiningPhilosophers.java</span>
<span class="token comment">// Hidden deadlock</span>
<span class="token comment">// {ExcludeFromGradle} Gradle has trouble</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DiningPhilosophers</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">StickHolder</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sticks<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Philosopher</span><span class="token punctuation">[</span><span class="token punctuation">]</span> philosophers<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sticks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StickHolder</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">setAll</span><span class="token punctuation">(</span>sticks<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">StickHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        philosophers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Philosopher</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">setAll</span><span class="token punctuation">(</span>philosophers<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span>
                <span class="token keyword">new</span> <span class="token class-name">Philosopher</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>
                        sticks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> sticks<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// [1]</span>
        <span class="token comment">// Fix by reversing stick order for this one:</span>
        <span class="token comment">// philosophers[1] =                     // [2]</span>
        <span class="token comment">//   new Philosopher(0, sticks[0], sticks[1]);</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>philosophers<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">runAsync</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Returns right away:</span>
        <span class="token keyword">new</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// [4]</span>
        <span class="token comment">// Keeps main() from exiting:</span>
        <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Shutdown&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><ul>
<li>&#x5F53;&#x4F60;&#x505C;&#x6B62;&#x67E5;&#x770B;&#x8F93;&#x51FA;&#x65F6;&#xFF0C;&#x8BE5;&#x7A0B;&#x5E8F;&#x5C06;&#x6B7B;&#x9501;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6839;&#x636E;&#x4F60;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x914D;&#x7F6E;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4E0D;&#x4F1A;&#x770B;&#x5230;&#x6B7B;&#x9501;&#x3002;&#x770B;&#x6765;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x7684;&#x5185;&#x6838;&#x6570;<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>&#x3002;&#x4E24;&#x4E2A;&#x6838;&#x5FC3;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x6B7B;&#x9501;&#xFF0C;&#x4F46;&#x4E24;&#x6838;&#x4EE5;&#x4E0A;&#x5374;&#x5F88;&#x5BB9;&#x6613;&#x4EA7;&#x751F;&#x6B7B;&#x9501;&#x3002;</li>
<li>&#x6B64;&#x884C;&#x4E3A;&#x4F7F;&#x8BE5;&#x793A;&#x4F8B;&#x66F4;&#x597D;&#x5730;&#x8BF4;&#x660E;&#x4E86;&#x6B7B;&#x9501;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x53EF;&#x80FD;&#x6B63;&#x5728;&#x5177;&#x6709;2&#x6838;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x7F16;&#x5199;&#x7A0B;&#x5E8F;&#xFF08;&#x5982;&#x679C;&#x786E;&#x5B9E;&#x662F;&#x5BFC;&#x81F4;&#x95EE;&#x9898;&#x7684;&#x539F;&#x56E0;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x4FE1;&#x8BE5;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#xFF0C;&#x53EA;&#x80FD;&#x542F;&#x52A8;&#x5B83;&#x5C06;&#x5176;&#x5B89;&#x88C5;&#x5728;&#x53E6;&#x4E00;&#x53F0;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x65F6;&#x51FA;&#x73B0;&#x6B7B;&#x9501;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x80FD;&#x56E0;&#x4E3A;&#x4F60;&#x6CA1;&#x6216;&#x4E0D;&#x5BB9;&#x6613;&#x770B;&#x5230;&#x6B7B;&#x9501;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x6B64;&#x7A0B;&#x5E8F;&#x4E0D;&#x4F1A;&#x5728;2&#x6838;&#x673A;&#x5668;&#x4E0A;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x3002; &#x8BE5;&#x7A0B;&#x5E8F;&#x4ECD;&#x7136;&#x6709;&#x6B7B;&#x9501;&#x503E;&#x5411;&#xFF0C;&#x53EA;&#x662F;&#x5F88;&#x5C11;&#x53D1;&#x751F;&#x2014;&#x2014;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x6700;&#x7CDF;&#x7CD5;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x56E0;&#x4E3A;&#x95EE;&#x9898;&#x4E0D;&#x5BB9;&#x6613;&#x51FA;&#x73B0;&#x3002;</li>
<li>&#x5728; <code>DiningPhilosophers</code> &#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x83B7;&#x5F97;&#x4E00;&#x4E2A;&#x5DE6;&#x53F3;&#x7B77;&#x5B50;&#x7684;&#x5F15;&#x7528;&#x3002;&#x9664;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x5916;&#xFF0C;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x628A;&#x54F2;&#x5B66;&#x5BB6;&#x653E;&#x5728;&#x4E0B;&#x4E00;&#x53CC;&#x7A7A;&#x95F2;&#x7B77;&#x5B50;&#x4E4B;&#x95F4;&#x6765;&#x521D;&#x59CB;&#x5316;&#xFF1A;
<ul>
<li>&#x6700;&#x540E;&#x4E00;&#x4F4D;&#x54F2;&#x5B66;&#x5BB6;&#x5F97;&#x5230;&#x4E86;&#x7B2C;0&#x6839;&#x7B77;&#x5B50;&#x4F5C;&#x4E3A;&#x4ED6;&#x7684;&#x53F3;&#x7B77;&#x5B50;&#xFF0C;&#x6240;&#x4EE5;&#x5706;&#x684C;&#x5C31;&#x5B8C;&#x6210;&#x3002;</li>
<li>&#x90A3;&#x662F;&#x56E0;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x4F4D;&#x54F2;&#x5B66;&#x5BB6;&#x6B63;&#x5750;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x7684;&#x65C1;&#x8FB9;&#xFF0C;&#x800C;&#x4E14;&#x4ED6;&#x4EEC;&#x4FE9;&#x90FD;&#x5171;&#x7528;&#x96F6;&#x7B77;&#x5B50;&#x3002;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x663E;&#x793A;&#x4E86;&#x4EE5;n&#x4E3A;&#x6A21;&#x6570;&#x9009;&#x62E9;&#x7684;&#x53F3;&#x7B77;&#x5B50;&#xFF0C;&#x5C06;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x7ED5;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x7684;&#x65C1;&#x8FB9;&#x3002;</li>
</ul>
</li>
<li>&#x73B0;&#x5728;&#xFF0C;&#x6240;&#x6709;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x5403;&#x996D;&#xFF0C;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x5728;&#x65C1;&#x8FB9;&#x7B49;&#x5F85;&#x54F2;&#x5B66;&#x5BB6;&#x653E;&#x4E0B;&#x7B77;&#x5B50;&#x3002;
<ul>
<li>&#x4E3A;&#x4E86;&#x8BA9;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x5728;[3]&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x8C03;&#x7528; <code>runAsync()</code>&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;DiningPhilosophers&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x5230;[4]&#x3002;</li>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x963B;&#x6B62; <code>main()</code> &#x5B8C;&#x6210;&#xFF0C;&#x7A0B;&#x5E8F;&#x5C31;&#x4F1A;&#x9000;&#x51FA;&#xFF0C;&#x4E0D;&#x4F1A;&#x505A;&#x592A;&#x591A;&#x4E8B;&#x60C5;&#x3002;</li>
<li><code>Nap</code> &#x5BF9;&#x8C61;&#x963B;&#x6B62; <code>main()</code> &#x9000;&#x51FA;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x4E09;&#x79D2;&#x540E;&#x5F3A;&#x5236;&#x9000;&#x51FA;(&#x5047;&#x8BBE;/&#x53EF;&#x80FD;&#x662F;)&#x6B7B;&#x9501;&#x7A0B;&#x5E8F;&#x3002;</li>
<li>&#x5728;&#x7ED9;&#x5B9A;&#x7684;&#x914D;&#x7F6E;&#x4E2D;&#xFF0C;&#x54F2;&#x5B66;&#x5BB6;&#x51E0;&#x4E4E;&#x4E0D;&#x82B1;&#x65F6;&#x95F4;&#x601D;&#x8003;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4ED6;&#x4EEC;&#x5728;&#x5403;&#x4E1C;&#x897F;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x4E89;&#x7740;&#x7528;&#x7B77;&#x5B50;&#xFF0C;&#x800C;&#x4E14;&#x5F80;&#x5F80;&#x5F88;&#x5FEB;&#x5C31;&#x4F1A;&#x9677;&#x5165;&#x50F5;&#x5C40;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;:</li>
</ul>
</li>
</ul>
<ol>
<li>
<p>&#x901A;&#x8FC7;&#x589E;&#x52A0;[4]&#x7684;&#x503C;&#x6765;&#x6DFB;&#x52A0;&#x66F4;&#x591A;&#x54F2;&#x5B66;&#x5BB6;&#x3002;</p>
</li>
<li>
<p>&#x5728;Philosopher.java&#x4E2D;&#x53D6;&#x6D88;&#x6CE8;&#x91CA;&#x884C;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x3002;</p>
</li>
</ol>
<p>&#x4EFB;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x51CF;&#x5C11;&#x6B7B;&#x9501;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF0C;&#x8FD9;&#x8868;&#x660E;&#x7F16;&#x5199;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x5E76;&#x8BA4;&#x4E3A;&#x5B83;&#x662F;&#x5B89;&#x5168;&#x7684;&#x5371;&#x9669;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4F3C;&#x4E4E;&#x201C;&#x5728;&#x6211;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x6B63;&#x5E38;&#x201D;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5730;&#x8BF4;&#x670D;&#x81EA;&#x5DF1;&#x8BE5;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x6B7B;&#x9501;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x4E0D;&#x662F;&#x3002;&#x8FD9;&#x4E2A;&#x793A;&#x4F8B;&#x76F8;&#x5F53;&#x6709;&#x8DA3;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x6F14;&#x793A;&#x4E86;&#x770B;&#x8D77;&#x6765;&#x53EF;&#x4EE5;&#x6B63;&#x786E;&#x8FD0;&#x884C;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x4F1A;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x7684;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x8981;&#x4FEE;&#x6B63;&#x6B7B;&#x9501;&#x95EE;&#x9898;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x660E;&#x767D;&#xFF0C;&#x5F53;&#x4EE5;&#x4E0B;&#x56DB;&#x4E2A;&#x6761;&#x4EF6;&#x540C;&#x65F6;&#x6EE1;&#x8DB3;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#xFF1A;</p>
<ol>
<li>&#x4E92;&#x65A5;&#x6761;&#x4EF6;&#x3002;&#x4EFB;&#x52A1;&#x4F7F;&#x7528;&#x7684;&#x8D44;&#x6E90;&#x4E2D;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x4E0D;&#x80FD;&#x5171;&#x4EAB;&#x7684;&#x3002; &#x8FD9;&#x91CC;&#xFF0C;&#x4E00;&#x6839;&#x7B77;&#x5B50;&#x4E00;&#x6B21;&#x5C31;&#x53EA;&#x80FD;&#x88AB;&#x4E00;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x4F7F;&#x7528;&#x3002;</li>
<li>&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x5B83;&#x5FC5;&#x987B;&#x6301;&#x6709;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x4E14;&#x6B63;&#x5728;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x88AB;&#x5F53;&#x524D;&#x522B;&#x7684;&#x4EFB;&#x52A1;&#x6301;&#x6709;&#x7684;&#x8D44;&#x6E90;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x8981;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#xFF0C;&#x54F2;&#x5B66;&#x5BB6;&#x5FC5;&#x987B;&#x62FF;&#x7740;&#x4E00;&#x6839;&#x7B77;&#x5B50;&#x5E76;&#x4E14;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x6839;&#x3002;</li>
<li>&#x8D44;&#x6E90;&#x4E0D;&#x80FD;&#x88AB;&#x4EFB;&#x52A1;&#x62A2;&#x5360;&#xFF0C; &#x4EFB;&#x52A1;&#x5FC5;&#x987B;&#x628A;&#x8D44;&#x6E90;&#x91CA;&#x653E;&#x5F53;&#x4F5C;&#x666E;&#x901A;&#x4E8B;&#x4EF6;&#x3002;&#x54F2;&#x5B66;&#x5BB6;&#x5F88;&#x6709;&#x793C;&#x8C8C;&#xFF0C;&#x4ED6;&#x4EEC;&#x4E0D;&#x4F1A;&#x4ECE;&#x5176;&#x5B83;&#x54F2;&#x5B66;&#x5BB6;&#x90A3;&#x91CC;&#x62A2;&#x7B77;&#x5B50;&#x3002;</li>
<li>&#x5FC5;&#x987B;&#x6709;&#x5FAA;&#x73AF;&#x7B49;&#x5F85;&#xFF0C; &#x8FD9;&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x7B49;&#x5F85;&#x5176;&#x5B83;&#x4EFB;&#x52A1;&#x6240;&#x6301;&#x6709;&#x7684;&#x8D44;&#x6E90;&#xFF0C; &#x540E;&#x8005;&#x53C8;&#x5728;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6240;&#x6301;&#x6709;&#x7684;&#x8D44;&#x6E90;&#xFF0C; &#x8FD9;&#x6837;&#x4E00;&#x76F4;&#x4E0B;&#x53BB;&#xFF0C;&#x77E5;&#x9053;&#x6709;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x5728;&#x7B49;&#x5F85;&#x7B2C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6240;&#x6301;&#x6709;&#x7684;&#x8D44;&#x6E90;&#xFF0C; &#x4F7F;&#x5F97;&#x5927;&#x5BB6;&#x90FD;&#x88AB;&#x9501;&#x4F4F;&#x3002; &#x5728; <code>DiningPhilosophers.java</code> &#x4E2D;&#xFF0C; &#x56E0;&#x4E3A;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x8BD5;&#x56FE;&#x5148;&#x5F97;&#x5230;&#x53F3;&#x8FB9;&#x7684; &#x7B77;&#x5B50;, &#x7136;&#x540E;&#x5F97;&#x5230;&#x5DE6;&#x8FB9;&#x7684; &#x7B77;&#x5B50;, &#x6240;&#x4EE5;&#x53D1;&#x751F;&#x4E86;&#x5FAA;&#x73AF;&#x7B49;&#x5F85;&#x3002;</li>
</ol>
<p>&#x56E0;&#x4E3A;&#x5FC5;&#x987B;&#x6EE1;&#x8DB3;&#x6240;&#x6709;&#x6761;&#x4EF6;&#x624D;&#x80FD;&#x5BFC;&#x81F4;&#x6B7B;&#x9501;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x963B;&#x6B62;&#x6B7B;&#x9501;&#x7684;&#x8BDD;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x7834;&#x574F;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5373;&#x53EF;&#x3002;&#x5728;&#x6B64;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x9632;&#x6B62;&#x6B7B;&#x9501;&#x7684;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x662F;&#x6253;&#x7834;&#x7B2C;&#x56DB;&#x4E2A;&#x6761;&#x4EF6;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x5C1D;&#x8BD5;&#x6309;&#x7167;&#x7279;&#x5B9A;&#x7684;&#x987A;&#x5E8F;&#x62FE;&#x8D77;&#x81EA;&#x5DF1;&#x7684;&#x7B77;&#x5B50;&#xFF1A;&#x5148;&#x53F3;&#x540E;&#x5DE6;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6BCF;&#x4E2A;&#x54F2;&#x5B66;&#x5BB6;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x5728;&#x7B49;&#x5F85;&#x5DE6;&#x624B;&#x7684;&#x540C;&#x65F6;&#x63E1;&#x4F4F;&#x53F3;&#x624B;&#x7684;&#x7B77;&#x5B50;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5FAA;&#x73AF;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x5176;&#x4E2D;&#x4E00;&#x4F4D;&#x54F2;&#x5B66;&#x5BB6;&#x5C1D;&#x8BD5;&#x9996;&#x5148;&#x62FF;&#x8D77;&#x5DE6;&#x7B77;&#x5B50;&#xFF0C;&#x5219;&#x8BE5;&#x54F2;&#x5B66;&#x5BB6;&#x51B3;&#x4E0D;&#x4F1A;&#x963B;&#x6B62;&#x7D27;&#x90BB;&#x53F3;&#x65B9;&#x7684;&#x54F2;&#x5B66;&#x5BB6;&#x62FF;&#x8D77;&#x7B77;&#x5B50;&#xFF0C;&#x4ECE;&#x800C;&#x6392;&#x9664;&#x4E86;&#x5FAA;&#x73AF;&#x7B49;&#x5F85;&#x3002;</p>
<p>&#x5728;<strong>DiningPhilosophers.java</strong>&#x4E2D;&#xFF0C;&#x53D6;&#x6D88;&#x6CE8;&#x91CA;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x548C;&#x5176;&#x540E;&#x7684;&#x4E00;&#x884C;&#x3002;&#x8FD9;&#x5C06;&#x539F;&#x6765;&#x7684;&#x54F2;&#x5B66;&#x5BB6;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x66FF;&#x6362;&#x4E3A;&#x7B77;&#x5B50;&#x98A0;&#x5012;&#x7684;&#x54F2;&#x5B66;&#x5BB6;&#x3002;&#x901A;&#x8FC7;&#x786E;&#x4FDD;&#x7B2C;&#x4E8C;&#x4F4D;&#x54F2;&#x5B66;&#x5BB6;&#x62FE;&#x8D77;&#x5E76;&#x5728;&#x53F3;&#x624B;&#x4E4B;&#x524D;&#x653E;&#x4E0B;&#x5DE6;&#x7B77;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x6D88;&#x9664;&#x4E86;&#x6B7B;&#x9501;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x3002;<br>
&#x8FD9;&#x53EA;&#x662F;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x3002;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9632;&#x6B62;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E4B;&#x4E00;&#x6765;&#x89E3;&#x51B3;&#x5B83;&#x3002;<br>
&#x6CA1;&#x6709;&#x8BED;&#x8A00;&#x652F;&#x6301;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x9632;&#x6B62;&#x6B7B;&#x9501;&#xFF1B;&#x4F60;&#x6709;&#x8D23;&#x4EFB;&#x901A;&#x8FC7;&#x7CBE;&#x5FC3;&#x8BBE;&#x8BA1;&#x6765;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#x5BF9;&#x4E8E;&#x8BD5;&#x56FE;&#x8C03;&#x8BD5;&#x6B7B;&#x9501;&#x7A0B;&#x5E8F;&#x7684;&#x4EBA;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x4E0D;&#x662F;&#x5B89;&#x6170;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x907F;&#x514D;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x7684;&#x6700;&#x7B80;&#x5355;&#xFF0C;&#x6700;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x6C38;&#x8FDC;&#x4E0D;&#x8981;&#x5171;&#x4EAB;&#x8D44;&#x6E90;-&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x603B;&#x662F;&#x53EF;&#x80FD;&#x7684;&#x3002;</p>
<h2 class="mume-header" id="%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E9%9D%9E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8">&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</h2>

<p>&#x5F53;&#x4F60;&#x5728;&#x8111;&#x5B50;&#x91CC;&#x60F3;&#x8C61;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6784;&#x9020;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4F60;&#x4F1A;&#x5F88;&#x5BB9;&#x6613;&#x8BA4;&#x4E3A;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;&#x6BD5;&#x7ADF;&#xFF0C;&#x5728;&#x5BF9;&#x8C61;&#x521D;&#x59CB;&#x5316;&#x5B8C;&#x6210;&#x524D;&#x5BF9;&#x5916;&#x4E0D;&#x53EF;&#x89C1;&#xFF0C;&#x6240;&#x4EE5;&#x53C8;&#x600E;&#x4F1A;&#x5BF9;&#x6B64;&#x4EA7;&#x751F;&#x4E89;&#x8BAE;&#x5462;&#xFF1F;&#x786E;&#x5B9E;&#xFF0C;<a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.8.3">Java &#x8BED;&#x8A00;&#x89C4;&#x8303;</a> (JLS)&#x81EA;&#x4FE1;&#x6EE1;&#x6EE1;&#x5730;&#x9648;&#x8FF0;&#x9053;&#xFF1A;&#x201C;<em>&#x6CA1;&#x5FC5;&#x8981;&#x4F7F;&#x6784;&#x9020;&#x5668;&#x7684;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4F1A;&#x9501;&#x5B9A;&#x6B63;&#x5728;&#x6784;&#x9020;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x76F4;&#x5230;&#x6784;&#x9020;&#x5668;&#x5B8C;&#x6210;&#x521D;&#x59CB;&#x5316;&#x540E;&#x624D;&#x5BF9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#x3002;</em>&#x201D;</p>
<p>&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x8FC7;&#x7A0B;&#x5982;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x4E00;&#x6837;&#xFF0C;&#x4E5F;&#x4F1A;&#x53D7;&#x5230;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x53EA;&#x662F;&#x4F5C;&#x7528;&#x673A;&#x5236;&#x53EF;&#x80FD;&#x66F4;&#x5FAE;&#x5999;&#x7F62;&#x4E86;&#x3002;</p>
<p>&#x8BBE;&#x60F3;&#x4E0B;&#x4F7F;&#x7528;&#x4E00;&#x4E2A; <strong>static</strong> &#x5B57;&#x6BB5;&#x4E3A;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x5176;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x5F00;&#x59CB;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">//concurrent/HasID.java</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HasID</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>&#x7136;&#x540E; <strong>StaticIDField</strong> &#x7C7B;&#x663E;&#x5F0F;&#x5730;&#x5B9E;&#x73B0;&#x8BE5;&#x63A5;&#x53E3;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/StaticIDField.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticIDField</span> <span class="token keyword">implements</span> <span class="token class-name">HasID</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id <span class="token operator">=</span> counter<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x5982;&#x4F60;&#x6240;&#x60F3;&#xFF0C;&#x8BE5;&#x7C7B;&#x662F;&#x4E2A;&#x7B80;&#x5355;&#x65E0;&#x5BB3;&#x7684;&#x7C7B;&#xFF0C;&#x5B83;&#x751A;&#x81F3;&#x90FD;&#x6CA1;&#x4E00;&#x4E2A;&#x663E;&#x5F0F;&#x7684;&#x6784;&#x9020;&#x5668;&#x6765;&#x5F15;&#x53D1;&#x95EE;&#x9898;&#x3002;&#x5F53;&#x6211;&#x4EEC;&#x8FD0;&#x884C;&#x591A;&#x4E2A;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x6B64;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x7A76;&#x7ADF;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1F;&#x4E3A;&#x4E86;&#x641E;&#x6E05;&#x695A;&#x8FD9;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x505A;&#x4E86;&#x4EE5;&#x4E0B;&#x6D4B;&#x8BD5;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/IDChecker.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>collect</span><span class="token punctuation">.</span><span class="token class-name">Sets</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IDChecker</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SIZE <span class="token operator">=</span> <span class="token number">100_000</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MakeObjects</span> <span class="token keyword">implements</span>
        <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HasID</span><span class="token punctuation">&gt;</span></span> gen<span class="token punctuation">;</span>

        <span class="token class-name">MakeObjects</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HasID</span><span class="token punctuation">&gt;</span></span> gen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>gen <span class="token operator">=</span> gen<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>SIZE<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">HasID</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">getID</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HasID</span><span class="token punctuation">&gt;</span></span> gen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span>
        groupA <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span>
            <span class="token class-name">MakeObjects</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        groupB <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span>
            <span class="token class-name">MakeObjects</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        groupA<span class="token punctuation">.</span><span class="token function">thenAcceptBoth</span><span class="token punctuation">(</span>groupB<span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
                <span class="token class-name">Sets</span><span class="token punctuation">.</span><span class="token function">intersection</span><span class="token punctuation">(</span>
                <span class="token class-name">Sets</span><span class="token punctuation">.</span><span class="token function">newHashSet</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Sets</span><span class="token punctuation">.</span><span class="token function">newHashSet</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p><strong>MakeObjects</strong> &#x7C7B;&#x662F;&#x4E00;&#x4E2A;&#x751F;&#x4EA7;&#x8005;&#x7C7B;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x80FD;&#x591F;&#x4EA7;&#x751F; List&lt;Integer&gt; &#x7C7B;&#x578B;&#x7684;&#x5217;&#x8868;&#x5BF9;&#x8C61;&#x7684; <code>get()</code> &#x65B9;&#x6CD5;&#x3002;&#x901A;&#x8FC7;&#x4ECE;&#x6BCF;&#x4E2A; <code>HasID</code> &#x5BF9;&#x8C61;&#x63D0;&#x53D6; <code>ID</code> &#x5E76;&#x653E;&#x5165;&#x5217;&#x8868;&#x4E2D;&#x6765;&#x751F;&#x6210;&#x8FD9;&#x4E2A;&#x5217;&#x8868;&#x5BF9;&#x8C61;&#xFF0C;&#x800C; <code>test()</code> &#x65B9;&#x6CD5;&#x5219;&#x521B;&#x5EFA;&#x4E86;&#x4E24;&#x4E2A;&#x5E76;&#x884C;&#x7684; <strong>CompletableFuture</strong> &#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x8FD0;&#x884C; <strong>MakeObjects</strong> &#x751F;&#x4EA7;&#x8005;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x4F7F;&#x7528; Guava &#x5E93;&#x4E2D;&#x7684; **Sets.<code>intersection()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8BA1;&#x7B97;&#x51FA;&#x8FD9;&#x4E24;&#x4E2A;&#x8FD4;&#x56DE;&#x7684; List&lt;Integer&gt; &#x5BF9;&#x8C61;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x76F8;&#x540C;&#x7684; <code>ID</code>&#xFF08;&#x4F7F;&#x7528;&#x8C37;&#x6B4C; Guava &#x5E93;&#x91CC;&#x7684;&#x65B9;&#x6CD5;&#x6BD4;&#x4F7F;&#x7528;&#x5B98;&#x65B9;&#x7684; <code>retainAll()</code> &#x65B9;&#x6CD5;&#x901F;&#x5EA6;&#x5FEB;&#x5F97;&#x591A;&#xFF09;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6D4B;&#x8BD5;&#x4E0A;&#x9762;&#x7684; <strong>StaticIDField</strong> &#x7C7B;&#x4E86;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/TestStaticIDField.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestStaticIDField</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">StaticIDField</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    13287
</code></pre><p>&#x7ED3;&#x679C;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x5F88;&#x591A;&#x91CD;&#x590D;&#x9879;&#x3002;&#x5F88;&#x663E;&#x7136;&#xFF0C;&#x7EAF;&#x9759;&#x6001; <code>int</code> &#x7528;&#x4E8E;&#x6784;&#x9020;&#x8FC7;&#x7A0B;&#x5E76;&#x4E0D;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x4F7F;&#x7528; <strong>AtomicInteger</strong> &#x6765;&#x4F7F;&#x5176;&#x53D8;&#x4E3A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/GuardedIDField.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GuardedIDField</span> <span class="token keyword">implements</span> <span class="token class-name">HasID</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicInteger</span> counter <span class="token operator">=</span> <span class="token keyword">new</span>
        <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> id <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">GuardedIDField</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    0
</code></pre><p>&#x6784;&#x9020;&#x5668;&#x6709;&#x4E00;&#x79CD;&#x66F4;&#x5FAE;&#x5999;&#x7684;&#x72B6;&#x6001;&#x5171;&#x4EAB;&#x65B9;&#x5F0F;&#xFF1A;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x5668;&#x53C2;&#x6570;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/SharedConstructorArgument.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">SharedArg</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Unsafe</span> <span class="token keyword">implements</span> <span class="token class-name">SharedArg</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Safe</span> <span class="token keyword">implements</span> <span class="token class-name">SharedArg</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicInteger</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> counter<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SharedUser</span> <span class="token keyword">implements</span> <span class="token class-name">HasID</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>

    <span class="token class-name">SharedUser</span><span class="token punctuation">(</span><span class="token class-name">SharedArg</span> sa<span class="token punctuation">)</span><span class="token punctuation">{</span>
        id <span class="token operator">=</span> sa<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SharedConstructorArgument</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Unsafe</span> unsafe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Unsafe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SharedUser</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Safe</span> safe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Safe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SharedUser</span><span class="token punctuation">(</span>safe<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    24838
    0
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;<strong>SharedUser</strong> &#x6784;&#x9020;&#x5668;&#x5B9E;&#x9645;&#x4E0A;&#x5171;&#x4EAB;&#x4E86;&#x76F8;&#x540C;&#x7684;&#x53C2;&#x6570;&#x3002;&#x5373;&#x4F7F; <strong>SharedUser</strong> &#x4EE5;&#x5B8C;&#x5168;&#x65E0;&#x5BB3;&#x4E14;&#x5408;&#x7406;&#x7684;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#x5176;&#x81EA;&#x5DF1;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5176;&#x6784;&#x9020;&#x5668;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E5F;&#x4F1A;&#x5F15;&#x8D77;&#x51B2;&#x7A81;&#x3002;<strong>SharedUser</strong> &#x751A;&#x81F3;&#x4E0D;&#x77E5;&#x9053;&#x5B83;&#x662F;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x7684;&#xFF0C;&#x66F4;&#x4E0D;&#x5FC5;&#x8BF4;&#x63A7;&#x5236;&#x5B83;&#x4E86;&#x3002;</p>
<p>&#x540C;&#x6B65;&#x6784;&#x9020;&#x5668;&#x5E76;&#x4E0D;&#x88AB;java&#x8BED;&#x8A00;&#x6240;&#x652F;&#x6301;&#xFF0C;&#x4F46;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x540C;&#x6B65;&#x8BED;&#x5757;&#x6765;&#x521B;&#x5EFA;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x540C;&#x6B65;&#x6784;&#x9020;&#x5668;&#x662F;&#x53EF;&#x80FD;&#x7684;&#xFF08;&#x8BF7;&#x53C2;&#x9605;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x5E76;&#x53D1;&#x5E95;&#x5C42;&#x539F;&#x7406;</a>&#xFF0C;&#x6765;&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#x540C;&#x6B65;&#x5173;&#x952E;&#x5B57;&#x2014;&#x2014; <code>synchronized</code>&#xFF09;&#x3002;&#x5C3D;&#x7BA1;JLS&#xFF08;java&#x8BED;&#x8A00;&#x89C4;&#x8303;&#xFF09;&#x8FD9;&#x6837;&#x9648;&#x8FF0;&#x9053;&#xFF1A;&#x201C;&#x2026;&#x2026;&#x5B83;&#x4F1A;&#x9501;&#x5B9A;&#x6B63;&#x5728;&#x6784;&#x9020;&#x7684;&#x5BF9;&#x8C61;&#x201D;&#xFF0C;&#x4F46;&#x8FD9;&#x5E76;&#x4E0D;&#x662F;&#x771F;&#x7684;&#x2014;&#x2014;&#x6784;&#x9020;&#x5668;&#x5B9E;&#x9645;&#x4E0A;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x540C;&#x6B65;&#x6784;&#x9020;&#x5668;&#x5B9E;&#x9645;&#x4E0A;&#x4F1A;&#x9501;&#x5B9A;&#x8BE5;&#x7C7B;&#x7684;Class&#x5BF9;&#x8C61;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x9759;&#x6001;&#x5BF9;&#x8C61;&#x5E76;&#x9501;&#x5B9A;&#x5B83;&#xFF0C;&#x6765;&#x8FBE;&#x5230;&#x4E0E;&#x540C;&#x6B65;&#x6784;&#x9020;&#x5668;&#x76F8;&#x540C;&#x7684;&#x6548;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/SynchronizedConstructor.java</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SyncConstructor</span> <span class="token keyword">implements</span> <span class="token class-name">HasID</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> constructorLock <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">SyncConstructor</span><span class="token punctuation">(</span><span class="token class-name">SharedArg</span> sa<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>constructorLock<span class="token punctuation">)</span><span class="token punctuation">{</span>
            id <span class="token operator">=</span> sa<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SynchronizedConstructor</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Unsafe</span> unsafe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Unsafe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SyncConstructor</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    0
</code></pre><p><strong>Unsafe</strong>&#x7C7B;&#x7684;&#x5171;&#x4EAB;&#x4F7F;&#x7528;&#x73B0;&#x5728;&#x5C31;&#x53D8;&#x5F97;&#x5B89;&#x5168;&#x4E86;&#x3002;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x662F;&#x5C06;&#x6784;&#x9020;&#x5668;&#x8BBE;&#x4E3A;&#x79C1;&#x6709;&#xFF08;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x7EE7;&#x627F;&#xFF09;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x9759;&#x6001;Factory&#x65B9;&#x6CD5;&#x6765;&#x751F;&#x6210;&#x65B0;&#x5BF9;&#x8C61;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/SynchronizedFactory.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SyncFactory</span> <span class="token keyword">implements</span> <span class="token class-name">HasID</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">SyncFactory</span><span class="token punctuation">(</span><span class="token class-name">SharedArg</span> sa<span class="token punctuation">)</span><span class="token punctuation">{</span>
        id <span class="token operator">=</span> sa<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">SyncFactory</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token class-name">SharedArg</span> sa<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SyncFactory</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SynchronizedFactory</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Unsafe</span> unsafe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Unsafe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IDChecker</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">SyncFactory</span><span class="token punctuation">.</span><span class="token function">factory</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>    0
</code></pre><p>&#x901A;&#x8FC7;&#x540C;&#x6B65;&#x9759;&#x6001;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x6784;&#x9020;&#x8FC7;&#x7A0B;&#x4E2D;&#x9501;&#x5B9A; <strong>Class</strong> &#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x793A;&#x4F8B;&#x5145;&#x5206;&#x8868;&#x660E;&#x4E86;&#x5728;&#x5E76;&#x53D1;Java&#x7A0B;&#x5E8F;&#x4E2D;&#x68C0;&#x6D4B;&#x548C;&#x7BA1;&#x7406;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#x6709;&#x591A;&#x56F0;&#x96BE;&#x3002;&#x5373;&#x4F7F;&#x4F60;&#x91C7;&#x53D6;&#x201C;&#x4E0D;&#x5171;&#x4EAB;&#x4EFB;&#x4F55;&#x5185;&#x5BB9;&#x201D;&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x4E5F;&#x5F88;&#x5BB9;&#x6613;&#x4EA7;&#x751F;&#x610F;&#x5916;&#x7684;&#x5171;&#x4EAB;&#x4E8B;&#x4EF6;&#x3002;</p>
<h2 class="mume-header" id="%E5%A4%8D%E6%9D%82%E6%80%A7%E5%92%8C%E4%BB%A3%E4%BB%B7">&#x590D;&#x6742;&#x6027;&#x548C;&#x4EE3;&#x4EF7;</h2>

<p>&#x5047;&#x8BBE;&#x4F60;&#x6B63;&#x5728;&#x505A;&#x62AB;&#x8428;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x4ECE;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x6B65;&#x9AA4;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x6240;&#x9700;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x4E00;&#x4E00;&#x8868;&#x793A;&#x4E3A;&#x679A;&#x4E3E;&#x53D8;&#x91CF;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/Pizza.java import java.util.function.*;</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Nap</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pizza</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Step</span><span class="token punctuation">{</span>
        <span class="token function">DOUGH</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ROLLED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SAUCED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CHEESED</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">TOPPED</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">BAKED</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SLICED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">BOXED</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> effort<span class="token punctuation">;</span><span class="token comment">// Needed to get to the next step </span>

        <span class="token class-name">Step</span><span class="token punctuation">(</span><span class="token keyword">int</span> effort<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>effort <span class="token operator">=</span> effort<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Step</span> <span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">equals</span><span class="token punctuation">(</span>BOXED<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> BOXED<span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">Nap</span><span class="token punctuation">(</span>effort <span class="token operator">*</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">ordinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Step</span> step <span class="token operator">=</span> <span class="token class-name">Step</span><span class="token punctuation">.</span>DOUGH<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        step <span class="token operator">=</span> step<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Pizza &quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span> previousStep<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>step<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>previousStep<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;Expected &quot;</span> <span class="token operator">+</span>
                      previousStep <span class="token operator">+</span> <span class="token string">&quot; but found &quot;</span> <span class="token operator">+</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">roll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>DOUGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">sauce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>ROLLED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">cheese</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>SAUCED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">toppings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>CHEESED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">bake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>TOPPED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>BAKED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Pizza</span> <span class="token function">box</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>SLICED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> step<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>BOXED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Pizza&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>step<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Step</span><span class="token punctuation">.</span>BOXED<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&quot;complete&quot;</span> <span class="token operator">:</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8FD9;&#x53EA;&#x7B97;&#x5F97;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x5E73;&#x51E1;&#x7684;&#x72B6;&#x6001;&#x673A;&#xFF0C;&#x5C31;&#x50CF;<strong>Machina</strong>&#x7C7B;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x62AB;&#x8428;&#xFF0C;&#x5F53;&#x62AB;&#x8428;&#x997C;&#x6700;&#x7EC8;&#x88AB;&#x653E;&#x5728;&#x76D2;&#x5B50;&#x4E2D;&#x65F6;&#xFF0C;&#x5C31;&#x7B97;&#x5B8C;&#x6210;&#x6700;&#x7EC8;&#x4EFB;&#x52A1;&#x4E86;&#x3002; &#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4EBA;&#x5728;&#x505A;&#x4E00;&#x4E2A;&#x62AB;&#x8428;&#x997C;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x6709;&#x6B65;&#x9AA4;&#x90FD;&#x662F;&#x7EBF;&#x6027;&#x8FDB;&#x884C;&#x7684;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;&#x63A5;&#x4E00;&#x4E2A;&#x5730;&#x8FDB;&#x884C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/OnePizza.java </span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OnePizza</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Pizza</span> za <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pizza</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>za<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> za<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Pizza 0: ROLLED 
Pizza 0: SAUCED 
Pizza 0: CHEESED 
Pizza 0: TOPPED 
Pizza 0: BAKED 
Pizza 0: SLICED 
Pizza 0: BOXED 
	1622 
</code></pre><p>&#x65F6;&#x95F4;&#x4EE5;&#x6BEB;&#x79D2;&#x4E3A;&#x5355;&#x4F4D;&#xFF0C;&#x52A0;&#x603B;&#x6240;&#x6709;&#x6B65;&#x9AA4;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#xFF0C;&#x4F1A;&#x5F97;&#x51FA;&#x4E0E;&#x6211;&#x4EEC;&#x7684;&#x671F;&#x671B;&#x503C;&#x76F8;&#x7B26;&#x7684;&#x6570;&#x5B57;&#x3002; &#x5982;&#x679C;&#x4F60;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5236;&#x4F5C;&#x4E86;&#x4E94;&#x4E2A;&#x62AB;&#x8428;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x4F1A;&#x8BA4;&#x4E3A;&#x5B83;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x662F;&#x539F;&#x6765;&#x7684;&#x4E94;&#x500D;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x8FD8;&#x4E0D;&#x591F;&#x5FEB;&#x600E;&#x4E48;&#x529E;&#xFF1F; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x5C1D;&#x8BD5;&#x5E76;&#x884C;&#x6D41;&#x65B9;&#x6CD5;&#x5F00;&#x59CB;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/PizzaStreams.java</span>
<span class="token comment">// import java.util.*; import java.util.stream.*;</span>

<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PizzaStreams</span><span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> QUANTITY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> QUANTITY<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//[1]</span>
        	<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>za <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>za<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> za<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Pizza 2: ROLLED
Pizza 0: ROLLED
Pizza 1: ROLLED
Pizza 4: ROLLED
Pizza 3:ROLLED
Pizza 2:SAUCED
Pizza 1:SAUCED
Pizza 0:SAUCED
Pizza 4:SAUCED
Pizza 3:SAUCED
Pizza 2:CHEESED
Pizza 1:CHEESED
Pizza 0:CHEESED
Pizza 4:CHEESED
Pizza 3:CHEESED
Pizza 2:TOPPED
Pizza 1:TOPPED
Pizza 0:TOPPED
Pizza 4:TOPPED
Pizza 3:TOPPED
Pizza 2:BAKED
Pizza 1:BAKED
Pizza 0:BAKED
Pizza 4:BAKED
Pizza 3:BAKED
Pizza 2:SLICED
Pizza 1:SLICED
Pizza 0:SLICED
Pizza 4:SLICED
Pizza 3:SLICED
Pizza 2:BOXED
Pizza 1:BOXED
Pizza 0:BOXED
Pizza 4:BOXED
Pizza 3:BOXED
1739
</code></pre><p>&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x5236;&#x4F5C;&#x4E94;&#x4E2A;&#x62AB;&#x8428;&#x7684;&#x65F6;&#x95F4;&#x4E0E;&#x5236;&#x4F5C;&#x5355;&#x4E2A;&#x62AB;&#x8428;&#x7684;&#x65F6;&#x95F4;&#x5C31;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#x3002; &#x5C1D;&#x8BD5;&#x5220;&#x9664;&#x6807;&#x8BB0;&#x4E3A;<a href="%E5%8F%AA%E8%A6%81%E8%BF%90%E8%A1%8C%E6%A0%87%E5%BF%97%E4%B8%BAtrue%EF%BC%8C%E6%AD%A4%E4%BB%BB%E5%8A%A1%E7%9A%84run()%E6%96%B9%E6%B3%95%E5%B0%86%E7%BB%A7%E7%BB%AD%E3%80%82">1</a>&#x7684;&#x884C;&#x540E;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x5B83;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x662F;&#x539F;&#x6765;&#x7684;&#x4E94;&#x500D;&#x3002; &#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x5C06;<strong>QUANTITY</strong>&#x66F4;&#x6539;&#x4E3A;4&#x3001;8&#x3001;10&#x3001;16&#x548C;17&#xFF0C;&#x770B;&#x770B;&#x4F1A;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF0C;&#x5E76;&#x731C;&#x731C;&#x770B;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x8FD9;&#x6837;&#x3002;</p>
<p><strong>PizzaStreams</strong> &#x7C7B;&#x4EA7;&#x751F;&#x7684;&#x6BCF;&#x4E2A;&#x5E76;&#x884C;&#x6D41;&#x5728;&#x5B83;&#x7684;<code>forEach()</code>&#x5185;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x5DE5;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x5404;&#x4E2A;&#x6B65;&#x9AA4;&#x7528;&#x6620;&#x5C04;&#x7684;&#x65B9;&#x5F0F;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x60C5;&#x51B5;&#x4F1A;&#x6709;&#x6240;&#x4E0D;&#x540C;&#x5417;&#xFF1F;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/PizzaParallelSteps.java </span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PizzaParallelSteps</span><span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> QUANTITY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> QUANTITY<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">roll</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sauce</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">cheese</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">toppings</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">bake</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">slice</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">box</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>za <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>za<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>Pizza 2: ROLLED 
Pizza 0: ROLLED 
Pizza 1: ROLLED 
Pizza 4: ROLLED 
Pizza 3: ROLLED 
Pizza 1: SAUCED 
Pizza 0: SAUCED 
Pizza 2: SAUCED 
Pizza 3: SAUCED 
Pizza 4: SAUCED 
Pizza 1: CHEESED 
Pizza 0: CHEESED 
Pizza 2: CHEESED 
Pizza 3: CHEESED 
Pizza 4: CHEESED 
Pizza 0: TOPPED 
Pizza 2: TOPPED
Pizza 1: TOPPED 
Pizza 3: TOPPED 
Pizza 4: TOPPED 
Pizza 1: BAKED 
Pizza 2: BAKED 
Pizza 0: BAKED 
Pizza 4: BAKED 
Pizza 3: BAKED 
Pizza 0: SLICED 
Pizza 2: SLICED 
Pizza 1: SLICED 
Pizza 3: SLICED 
Pizza 4: SLICED 
Pizza 1: BOXED 
Pizza1: complete 
Pizza 2: BOXED 
Pizza 0: BOXED 
Pizza2: complete 
Pizza0: complete 
Pizza 3: BOXED
Pizza 4: BOXED 
Pizza4: complete 
Pizza3: complete 
1738 
</code></pre><p>&#x7B54;&#x6848;&#x662F;&#x201C;&#x5426;&#x201D;&#xFF0C;&#x4E8B;&#x540E;&#x770B;&#x6765;&#x8FD9;&#x5E76;&#x4E0D;&#x5947;&#x602A;&#xFF0C;&#x56E0;&#x4E3A;&#x6BCF;&#x4E2A;&#x62AB;&#x8428;&#x90FD;&#x9700;&#x8981;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x6B65;&#x9AA4;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6CA1;&#x6CD5;&#x901A;&#x8FC7;&#x5206;&#x6B65;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x6765;&#x8FDB;&#x4E00;&#x6B65;&#x63D0;&#x9AD8;&#x901F;&#x5EA6;&#xFF0C;&#x5C31;&#x50CF;&#x4E0A;&#x6587;&#x7684; <code>PizzaParallelSteps.java</code> &#x91CC;&#x9762;&#x5C55;&#x793A;&#x7684;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <strong>CompletableFutures</strong> &#x91CD;&#x5199;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token comment">// concurrent/CompletablePizza.java </span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> onjava<span class="token punctuation">.</span><span class="token class-name">Timer</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompletablePizza</span><span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> QUANTITY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pizza</span><span class="token punctuation">&gt;</span></span> <span class="token function">makeCF</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span> za<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span>
                <span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>za<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">roll</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">sauce</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">cheese</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">toppings</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">bake</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">slice</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">box</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pizza</span><span class="token punctuation">&gt;</span></span> cf<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cf<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Timer</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">&lt;</span><span class="token class-name">Pizza</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> pizzas <span class="token operator">=</span>
                <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> QUANTITY<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span><span class="token class-name">Pizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CompletablePizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">makeCF</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pizzas<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">CompletablePizza</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">show</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre data-role="codeBlock" data-info class="language-"><code>169 
Pizza 0: ROLLED 
Pizza 1: ROLLED 
Pizza 2: ROLLED 
Pizza 4: ROLLED 
Pizza 3: ROLLED 
Pizza 1: SAUCED 
Pizza 0: SAUCED 
Pizza 2: SAUCED 
Pizza 4: SAUCED
Pizza 3: SAUCED 
Pizza 0: CHEESED 
Pizza 4: CHEESED 
Pizza 1: CHEESED 
Pizza 2: CHEESED 
Pizza 3: CHEESED 
Pizza 0: TOPPED 
Pizza 4: TOPPED 
Pizza 1: TOPPED 
Pizza 2: TOPPED 
Pizza 3: TOPPED 
Pizza 0: BAKED 
Pizza 4: BAKED 
Pizza 1: BAKED 
Pizza 3: BAKED 
Pizza 2: BAKED 
Pizza 0: SLICED 
Pizza 4: SLICED 
Pizza 1: SLICED 
Pizza 3: SLICED
Pizza 2: SLICED 
Pizza 4: BOXED 
Pizza 0: BOXED 
Pizza0: complete 
Pizza 1: BOXED 
Pizza1: complete 
Pizza 3: BOXED 
Pizza 2: BOXED 
Pizza2: complete 
Pizza3: complete 
Pizza4: complete 
1797 
</code></pre><p>&#x5E76;&#x884C;&#x6D41;&#x548C; <strong>CompletableFutures</strong> &#x662F; Java &#x5E76;&#x53D1;&#x5DE5;&#x5177;&#x7BB1;&#x4E2D;&#x6700;&#x5148;&#x8FDB;&#x53D1;&#x8FBE;&#x7684;&#x6280;&#x672F;&#x3002; &#x4F60;&#x5E94;&#x8BE5;&#x59CB;&#x7EC8;&#x9996;&#x5148;&#x9009;&#x62E9;&#x5176;&#x4E2D;&#x4E4B;&#x4E00;&#x3002; &#x5F53;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5F88;&#x5BB9;&#x6613;&#x5E76;&#x884C;&#x5904;&#x7406;&#x65F6;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x628A;&#x6570;&#x636E;&#x5206;&#x89E3;&#x6210;&#x76F8;&#x540C;&#x7684;&#x3001;&#x6613;&#x4E8E;&#x5904;&#x7406;&#x7684;&#x5404;&#x4E2A;&#x90E8;&#x5206;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x6D41;&#x65B9;&#x6CD5;&#x5904;&#x7406;&#x6700;&#x4E3A;&#x5408;&#x9002;&#xFF08;&#x800C;&#x5982;&#x679C;&#x4F60;&#x51B3;&#x5B9A;&#x4E0D;&#x501F;&#x52A9;&#x5B83;&#x800C;&#x7531;&#x81EA;&#x5DF1;&#x5B8C;&#x6210;&#xFF0C;&#x4F60;&#x5C31;&#x5FC5;&#x987B;&#x64B8;&#x8D77;&#x8896;&#x5B50;&#xFF0C;&#x6DF1;&#x5165;&#x7814;&#x7A76;<strong>Spliterator</strong>&#x7684;&#x6587;&#x6863;&#xFF09;&#x3002;</p>
<p>&#x800C;&#x5F53;&#x5DE5;&#x4F5C;&#x7684;&#x5404;&#x4E2A;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x5404;&#x4E0D;&#x76F8;&#x540C;&#x65F6;&#xFF0C;&#x4F7F;&#x7528; <strong>CompletableFutures</strong> &#x662F;&#x6700;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;&#x6BD4;&#x8D77;&#x9762;&#x5411;&#x6570;&#x636E;&#xFF0C;<strong>CompletableFutures</strong> &#x66F4;&#x50CF;&#x662F;&#x9762;&#x5411;&#x4EFB;&#x52A1;&#x7684;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x62AB;&#x8428;&#x95EE;&#x9898;&#xFF0C;&#x7ED3;&#x679C;&#x4F3C;&#x4E4E;&#x4E5F;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5E76;&#x884C;&#x6D41;&#x65B9;&#x6CD5;&#x770B;&#x8D77;&#x6765;&#x66F4;&#x7B80;&#x6D01;&#xFF0C;&#x4EC5;&#x51FA;&#x4E8E;&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#xFF0C;&#x6211;&#x8BA4;&#x4E3A;&#x5E76;&#x884C;&#x6D41;&#x4F5C;&#x4E3A;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x9996;&#x6B21;&#x5C1D;&#x8BD5;&#x65B9;&#x6CD5;&#x66F4;&#x5177;&#x5438;&#x5F15;&#x529B;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5236;&#x4F5C;&#x62AB;&#x8428;&#x603B;&#x9700;&#x8981;&#x4E00;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x65E0;&#x8BBA;&#x4F60;&#x4F7F;&#x7528;&#x54EA;&#x79CD;&#x5E76;&#x53D1;&#x65B9;&#x6CD5;&#xFF0C;&#x4F60;&#x80FD;&#x505A;&#x5230;&#x7684;&#x6700;&#x597D;&#x60C5;&#x51B5;&#xFF0C;&#x662F;&#x5728;&#x5236;&#x4F5C;&#x4E00;&#x4E2A;&#x62AB;&#x8428;&#x7684;&#x76F8;&#x540C;&#x65F6;&#x95F4;&#x5185;&#x5236;&#x4F5C;n&#x4E2A;&#x62AB;&#x8428;&#x3002; &#x5728;&#x8FD9;&#x91CC;&#x5F53;&#x7136;&#x5F88;&#x5BB9;&#x6613;&#x770B;&#x51FA;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x4F60;&#x5904;&#x7406;&#x66F4;&#x590D;&#x6742;&#x7684;&#x95EE;&#x9898;&#x65F6;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x80FD;&#x5FD8;&#x8BB0;&#x8FD9;&#x4E00;&#x70B9;&#x3002; &#x901A;&#x5E38;&#xFF0C;&#x5728;&#x9879;&#x76EE;&#x5F00;&#x59CB;&#x65F6;&#x8FDB;&#x884C;&#x7C97;&#x7565;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x5C31;&#x80FD;&#x5F88;&#x5FEB;&#x5F04;&#x6E05;&#x695A;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x7684;&#x5E76;&#x884C;&#x541E;&#x5410;&#x91CF;&#xFF0C;&#x8FD9;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x4F60;&#x56E0;&#x4E3A;&#x91C7;&#x53D6;&#x65E0;&#x7528;&#x7684;&#x52A0;&#x5FEB;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x7684;&#x4E3E;&#x63AA;&#x800C;&#x5FD9;&#x5F97;&#x56E2;&#x56E2;&#x8F6C;&#x3002;</p>
<p>&#x4F7F;&#x7528; <strong>CompletableFutures</strong> &#x6216;&#x8BB8;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x5730;&#x5E26;&#x6765;&#x91CD;&#x5927;&#x6536;&#x76CA;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5C1D;&#x8BD5;&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#x65F6;&#x9700;&#x8981;&#x500D;&#x52A0;&#x5C0F;&#x5FC3;&#xFF0C;&#x56E0;&#x4E3A;&#x989D;&#x5916;&#x589E;&#x52A0;&#x7684;&#x6210;&#x672C;&#x548C;&#x5DE5;&#x4F5C;&#x91CF;&#x4F1A;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x8FDC;&#x8FDC;&#x8D85;&#x51FA;&#x4F60;&#x4E4B;&#x524D;&#x62FC;&#x547D;&#x6324;&#x51FA;&#x7684;&#x90A3;&#x4E00;&#x70B9;&#x70B9;&#x6536;&#x76CA;&#x3002;</p>
<h2 class="mume-header" id="%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</h2>

<p>&#x9700;&#x8981;&#x5E76;&#x53D1;&#x7684;&#x552F;&#x4E00;&#x7406;&#x7531;&#x662F;&#x201C;&#x7B49;&#x5F85;&#x592A;&#x591A;&#x201D;&#x3002;&#x8FD9;&#x4E5F;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x7528;&#x6237;&#x754C;&#x9762;&#x7684;&#x54CD;&#x5E94;&#x901F;&#x5EA6;&#xFF0C;&#x4F46;&#x662F;&#x7531;&#x4E8E;Java&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x7528;&#x6237;&#x754C;&#x9762;&#x65F6;&#x5E76;&#x4E0D;&#x9AD8;&#x6548;&#xFF0C;&#x56E0;&#x6B64;<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>&#x8FD9;&#x4EC5;&#x4EC5;&#x610F;&#x5473;&#x7740;&#x201C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x8FD8;&#x4E0D;&#x591F;&#x5FEB;&#x201D;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5E76;&#x53D1;&#x5F88;&#x5BB9;&#x6613;&#xFF0C;&#x5219;&#x6CA1;&#x6709;&#x7406;&#x7531;&#x62D2;&#x7EDD;&#x5E76;&#x53D1;&#x3002; &#x6B63;&#x56E0;&#x4E3A;&#x5E76;&#x53D1;&#x5B9E;&#x9645;&#x4E0A;&#x5F88;&#x96BE;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x5E94;&#x8BE5;&#x4ED4;&#x7EC6;&#x8003;&#x8651;&#x662F;&#x5426;&#x503C;&#x5F97;&#x4E3A;&#x6B64;&#x4ED8;&#x51FA;&#x52AA;&#x529B;&#xFF0C;&#x5E76;&#x8003;&#x8651;&#x4F60;&#x80FD;&#x5426;&#x4EE5;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x63D0;&#x5347;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x8FC1;&#x79FB;&#x5230;&#x66F4;&#x5FEB;&#x7684;&#x786C;&#x4EF6;&#xFF08;&#x8FD9;&#x53EF;&#x80FD;&#x6BD4;&#x6D88;&#x8017;&#x7A0B;&#x5E8F;&#x5458;&#x7684;&#x65F6;&#x95F4;&#x8981;&#x4FBF;&#x5B9C;&#x5F97;&#x591A;&#xFF09;&#x6216;&#x8005;&#x5C06;&#x7A0B;&#x5E8F;&#x5206;&#x89E3;&#x6210;&#x591A;&#x4E2A;&#x90E8;&#x5206;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x90E8;&#x5206;&#x3002;</p>
<p>&#x5965;&#x5361;&#x59C6;&#x5243;&#x5200;&#x662F;&#x4E00;&#x4E2A;&#x7ECF;&#x5E38;&#x88AB;&#x8BEF;&#x89E3;&#x7684;&#x539F;&#x5219;&#x3002; &#x6211;&#x770B;&#x8FC7;&#x81F3;&#x5C11;&#x4E00;&#x90E8;&#x7535;&#x5F71;&#xFF0C;&#x4ED6;&#x4EEC;&#x5C06;&#x5176;&#x5B9A;&#x4E49;&#x4E3A;&#x201D;&#x6700;&#x7B80;&#x5355;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x6B63;&#x786E;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x201C;&#xFF0C;&#x5C31;&#x597D;&#x50CF;&#x8FD9;&#x662F;&#x67D0;&#x79CD;&#x6BCB;&#x5EB8;&#x7F6E;&#x7591;&#x7684;&#x6CD5;&#x5F8B;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x51C6;&#x5219;&#xFF1A;&#x9762;&#x5BF9;&#x591A;&#x79CD;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x8BF7;&#x5148;&#x5C1D;&#x8BD5;&#x9700;&#x8981;&#x6700;&#x5C11;&#x5047;&#x8BBE;&#x7684;&#x65B9;&#x6CD5;&#x3002; &#x5728;&#x7F16;&#x7A0B;&#x4E16;&#x754C;&#x4E2D;&#xFF0C;&#x8FD9;&#x5DF2;&#x6F14;&#x53D8;&#x4E3A;&#x201C;&#x5C1D;&#x8BD5;&#x53EF;&#x80FD;&#x53EF;&#x884C;&#x7684;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x201D;&#x3002;&#x5F53;&#x4F60;&#x4E86;&#x89E3;&#x4E86;&#x7279;&#x5B9A;&#x5DE5;&#x5177;&#x7684;&#x77E5;&#x8BC6;&#x65F6;&#x2014;&#x2014;&#x5C31;&#x50CF;&#x4F60;&#x73B0;&#x5728;&#x4E86;&#x89E3;&#x4E86;&#x6709;&#x5173;&#x5E76;&#x53D1;&#x6027;&#x7684;&#x77E5;&#x8BC6;&#x4E00;&#x6837;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x5F88;&#x60F3;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x6216;&#x8005;&#x63D0;&#x524D;&#x89C4;&#x5B9A;&#x4F60;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x201C;&#x901F;&#x5EA6;&#x98DE;&#x5FEB;&#x201D;&#xFF0C;&#x4ECE;&#x800C;&#x6765;&#x8BC1;&#x660E;&#x4ECE;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x8FDB;&#x884C;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x662F;&#x5408;&#x7406;&#x7684;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x5965;&#x5361;&#x59C6;&#x5243;&#x5200;&#x7F16;&#x7A0B;&#x7248;&#x672C;&#x8868;&#x793A;&#x4F60;&#x5E94;&#x8BE5;&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#xFF08;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x5F00;&#x53D1;&#x8D77;&#x6765;&#x4E5F;&#x66F4;&#x4FBF;&#x5B9C;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x770B;&#x770B;&#x5B83;&#x662F;&#x5426;&#x8DB3;&#x591F;&#x597D;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x6211;&#x51FA;&#x8EAB;&#x4E8E;&#x5E95;&#x5C42;&#x5B66;&#x672F;&#x80CC;&#x666F;&#xFF08;&#x7269;&#x7406;&#x5B66;&#x548C;&#x8BA1;&#x7B97;&#x673A;&#x5DE5;&#x7A0B;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5F88;&#x5BB9;&#x6613;&#x60F3;&#x5230;&#x6240;&#x6709;&#x5C0F;&#x8F6E;&#x5B50;&#x8F6C;&#x52A8;&#x7684;&#x6210;&#x672C;&#x3002;&#x6211;&#x786E;&#x5B9A;&#x4F7F;&#x7528;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x591F;&#x5FEB;&#x7684;&#x573A;&#x666F;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#x5DF2;&#x7ECF;&#x6570;&#x4E0D;&#x8FC7;&#x6765;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5C1D;&#x8BD5;&#x540E;&#x5374;&#x53D1;&#x73B0;&#x5B83;&#x5B9E;&#x9645;&#x4E0A;&#x7EF0;&#x7EF0;&#x6709;&#x4F59;&#x3002;</p>
<h3 class="mume-header" id="%E7%BC%BA%E7%82%B9">&#x7F3A;&#x70B9;</h3>

<p>&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x4E3B;&#x8981;&#x7F3A;&#x70B9;&#x662F;&#xFF1A;</p>
<ol>
<li>
<p>&#x5728;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x65F6;&#x4F1A;&#x964D;&#x4F4E;&#x901F;&#x5EA6;&#x3002;</p>
</li>
<li>
<p>&#x7EBF;&#x7A0B;&#x7BA1;&#x7406;&#x4EA7;&#x751F;&#x989D;&#x5916;CPU&#x5F00;&#x9500;&#x3002;</p>
</li>
<li>
<p>&#x7CDF;&#x7CD5;&#x7684;&#x8BBE;&#x8BA1;&#x51B3;&#x7B56;&#x5E26;&#x6765;&#x65E0;&#x6CD5;&#x5F25;&#x8865;&#x7684;&#x590D;&#x6742;&#x6027;&#x3002;</p>
</li>
<li>
<p>&#x8BF8;&#x5982;&#x9965;&#x997F;&#xFF0C;&#x7ADE;&#x901F;&#xFF0C;&#x6B7B;&#x9501;&#x548C;&#x6D3B;&#x9501;&#xFF08;&#x591A;&#x7EBF;&#x7A0B;&#x5404;&#x81EA;&#x5904;&#x7406;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x800C;&#x6574;&#x4F53;&#x5374;&#x65E0;&#x6CD5;&#x5B8C;&#x6210;&#xFF09;&#x4E4B;&#x7C7B;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
</li>
<li>
<p>&#x8DE8;&#x5E73;&#x53F0;&#x7684;&#x4E0D;&#x4E00;&#x81F4;&#x3002; &#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x793A;&#x4F8B;&#xFF0C;&#x6211;&#x53D1;&#x73B0;&#x4E86;&#x67D0;&#x4E9B;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x5F88;&#x5FEB;&#x51FA;&#x73B0;&#x7684;&#x7ADE;&#x4E89;&#x72B6;&#x51B5;&#xFF0C;&#x800C;&#x5728;&#x5176;&#x4ED6;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x5374;&#x6CA1;&#x6709;&#x3002; &#x5982;&#x679C;&#x4F60;&#x5728;&#x540E;&#x8005;&#x4E0A;&#x5F00;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x5219;&#x5728;&#x5206;&#x53D1;&#x7A0B;&#x5E8F;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x611F;&#x5230;&#x975E;&#x5E38;&#x60CA;&#x8BB6;&#x3002;</p>
</li>
</ol>
<p>&#x53E6;&#x5916;&#xFF0C;&#x5E76;&#x53D1;&#x7684;&#x5E94;&#x7528;&#x662F;&#x4E00;&#x95E8;&#x827A;&#x672F;&#x3002; Java&#x65E8;&#x5728;&#x5141;&#x8BB8;&#x4F60;&#x521B;&#x5EFA;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x6240;&#x9700;&#x8981;&#x7684;&#x5BF9;&#x8C61;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x2014;&#x2014;&#x81F3;&#x5C11;&#x5728;&#x7406;&#x8BBA;&#x4E0A;&#x662F;&#x8FD9;&#x6837;&#x3002;<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>&#x4F46;&#x662F;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E0D;&#x662F;&#x5178;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF1A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x5176;&#x81EA;&#x5DF1;&#x7684;&#x6267;&#x884C;&#x73AF;&#x5883;&#xFF0C;&#x5305;&#x62EC;&#x5806;&#x6808;&#x548C;&#x5176;&#x4ED6;&#x5FC5;&#x8981;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x4F7F;&#x5176;&#x6BD4;&#x666E;&#x901A;&#x5BF9;&#x8C61;&#x5927;&#x5F97;&#x591A;&#x3002; &#x5728;&#x5927;&#x591A;&#x6570;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x53EA;&#x80FD;&#x5728;&#x5185;&#x5B58;&#x7528;&#x5149;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x6570;&#x5343;&#x4E2A;<strong>Thread</strong>&#x5BF9;&#x8C61;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x51E0;&#x4E2A;&#x7EBF;&#x7A0B;&#x5373;&#x53EF;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x9650;&#x5236;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x8BBE;&#x8BA1;&#x800C;&#x8A00;&#xFF0C;&#x5B83;&#x4F1A;&#x6210;&#x4E3A;&#x4E00;&#x79CD;&#x7EA6;&#x675F;&#xFF0C;&#x53EF;&#x80FD;&#x8FEB;&#x4F7F;&#x4F60;&#x4F7F;&#x7528;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6848;&#x3002;</p>
<h3 class="mume-header" id="%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E9%99%B7%E9%98%B1">&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x9677;&#x9631;</h3>

<p>&#x5E76;&#x53D1;&#x6027;&#x7684;&#x4E3B;&#x8981;&#x56F0;&#x96BE;&#x4E4B;&#x4E00;&#x662F;&#x56E0;&#x4E3A;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#xFF08;&#x4F8B;&#x5982;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x4F60;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x4E0D;&#x4F1A;&#x540C;&#x65F6;&#x8BFB;&#x53D6;&#x548C;&#x66F4;&#x6539;&#x8BE5;&#x8D44;&#x6E90;&#x3002;</p>
<p>&#x6211;&#x82B1;&#x4E86;&#x591A;&#x5E74;&#x7684;&#x65F6;&#x95F4;&#x7814;&#x7A76;&#x5E76;&#x53D1;&#x3002; &#x6211;&#x4E86;&#x89E3;&#x5230;&#x4F60;&#x6C38;&#x8FDC;&#x65E0;&#x6CD5;&#x76F8;&#x4FE1;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5E76;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x53D1;&#x73B0;&#x5B83;&#x662F;&#x9519;&#x8BEF;&#x7684;&#xFF0C;&#x4F46;&#x6C38;&#x8FDC;&#x65E0;&#x6CD5;&#x8BC1;&#x660E;&#x5B83;&#x662F;&#x6B63;&#x786E;&#x7684;&#x3002; &#x8FD9;&#x662F;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5E76;&#x53D1;&#x539F;&#x5219;&#x4E4B;&#x4E00;&#x3002;<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup></p>
<p>&#x6211;&#x9047;&#x5230;&#x4E86;&#x8BB8;&#x591A;&#x4EBA;&#xFF0C;&#x4ED6;&#x4EEC;&#x5BF9;&#x7F16;&#x5199;&#x6B63;&#x786E;&#x7684;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x7684;&#x80FD;&#x529B;&#x5145;&#x6EE1;&#x4FE1;&#x5FC3;&#x3002; &#x6211;&#x5076;&#x5C14;&#x5F00;&#x59CB;&#x8BA4;&#x4E3A;&#x6211;&#x4E5F;&#x53EF;&#x4EE5;&#x505A;&#x597D;&#x3002; &#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x6211;&#x6700;&#x521D;&#x662F;&#x5728;&#x53EA;&#x6709;&#x5355;&#x4E2A;CPU&#x7684;&#x673A;&#x5668;&#x4E0A;&#x7F16;&#x5199;&#x7684;&#x3002; &#x90A3;&#x65F6;&#x6211;&#x80FD;&#x591F;&#x8BF4;&#x670D;&#x81EA;&#x5DF1;&#x8BE5;&#x7A0B;&#x5E8F;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EE5;&#x4E3A;&#x6211;&#x5BF9;Java&#x5DE5;&#x5177;&#x5F88;&#x4E86;&#x89E3;&#x3002; &#x800C;&#x4E14;&#x5728;&#x6211;&#x7684;&#x5355;CPU&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x4E5F;&#x6CA1;&#x6709;&#x5931;&#x8D25;&#x3002;&#x800C;&#x5230;&#x4E86;&#x5177;&#x6709;&#x591A;&#x4E2A;CPU&#x7684;&#x8BA1;&#x7B97;&#x673A;&#xFF0C;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x4E0D;&#x80FD;&#x8FD0;&#x884C;&#x540E;&#xFF0C;&#x6211;&#x611F;&#x5230;&#x5F88;&#x60CA;&#x8BB6;&#xFF0C;&#x4F46;&#x8FD9;&#x8FD8;&#x53EA;&#x662F;&#x4F17;&#x591A;&#x95EE;&#x9898;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x800C;&#x5DF2;&#x3002; &#x8FD9;&#x4E0D;&#x662F;Java&#x7684;&#x9519;&#xFF1B; &#x201C;&#x5199;&#x4E00;&#x6B21;&#xFF0C;&#x5230;&#x5904;&#x8FD0;&#x884C;&#x201D;&#xFF0C;&#x5728;&#x5355;&#x6838;&#x4E0E;&#x591A;&#x6838;&#x8BA1;&#x7B97;&#x673A;&#x95F4;&#x65E0;&#x6CD5;&#x6269;&#x5C55;&#x5230;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x9886;&#x57DF;&#x3002;&#x8FD9;&#x662F;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x57FA;&#x672C;&#x95EE;&#x9898;&#x3002; &#x5B9E;&#x9645;&#x4E0A;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5355;CPU&#x673A;&#x5668;&#x4E0A;&#x53D1;&#x73B0;&#x4E00;&#x4E9B;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x9645;&#x4E0A;&#x771F;&#x7684;&#x5728;&#x5E76;&#x884C;&#x8FD0;&#x884C;&#x7684;&#x591A;CPU&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x518D;&#x4E3E;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x54F2;&#x5B66;&#x5BB6;&#x5C31;&#x9910;&#x7684;&#x95EE;&#x9898;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x8FDB;&#x884C;&#x8C03;&#x6574;&#xFF0C;&#x56E0;&#x6B64;&#x51E0;&#x4E4E;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x6B7B;&#x9501;&#xFF0C;&#x8FD9;&#x4F1A;&#x7ED9;&#x4F60;&#x4E00;&#x79CD;&#x4E00;&#x5207;&#x90FD;&#x68D2;&#x6781;&#x4E86;&#x7684;&#x5370;&#x8C61;&#x3002;&#x5F53;&#x6D89;&#x53CA;&#x5230;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x65F6;&#xFF0C;&#x4F60;&#x6C38;&#x8FDC;&#x4E0D;&#x5E94;&#x8BE5;&#x5BF9;&#x81EA;&#x5DF1;&#x7684;&#x7F16;&#x7A0B;&#x80FD;&#x529B;&#x53D8;&#x5F97;&#x8FC7;&#x4E8E;&#x81EA;&#x4FE1;&#x3002;</p>
<h3 class="mume-header" id="this-albatross-is-big">This Albatross is Big</h3>

<p>&#x5982;&#x679C;&#x4F60;&#x5BF9;Java&#x5E76;&#x53D1;&#x611F;&#x5230;&#x4E0D;&#x77E5;&#x6240;&#x63AA;&#xFF0C;&#x90A3;&#x8BF4;&#x660E;&#x4F60;&#x8EAB;&#x5904;&#x5728;&#x4E00;&#x5BB6;&#x51FA;&#x8272;&#x7684;&#x516C;&#x53F8;&#x91CC;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;<strong>Thread</strong>&#x7C7B;&#x7684;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html">Javadoc</a>&#x9875;&#x9762;&#xFF0C; &#x770B;&#x4E00;&#x4E0B;&#x54EA;&#x4E9B;&#x65B9;&#x6CD5;&#x73B0;&#x5728;&#x662F;<strong>Deprecated</strong>&#xFF08;&#x5E9F;&#x5F03;&#x7684;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x662F;Java&#x8BED;&#x8A00;&#x8BBE;&#x8BA1;&#x8005;&#x72AF;&#x8FC7;&#x9519;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x56E0;&#x4E3A;&#x4ED6;&#x4EEC;&#x5728;&#x8BBE;&#x8BA1;&#x8BED;&#x8A00;&#x65F6;&#x5BF9;&#x5E76;&#x53D1;&#x6027;&#x4E86;&#x89E3;&#x4E0D;&#x8DB3;&#x3002;</p>
<p>&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#xFF0C;&#x5728;Java&#x7684;&#x540E;&#x7EED;&#x7248;&#x672C;&#x4E2D;&#x6DFB;&#x52A0;&#x7684;&#x8BB8;&#x591A;&#x5E93;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x90FD;&#x662F;&#x65E0;&#x6548;&#x7684;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x65E0;&#x7528;&#x7684;&#x3002; &#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;Java 8&#x4E2D;&#x7684;&#x5E76;&#x884C;<strong>Streams</strong>&#x548C;<strong>CompletableFutures</strong>&#x90FD;&#x975E;&#x5E38;&#x6709;&#x4EF7;&#x503C;&#x3002;&#x4F46;&#x662F;&#x5F53;&#x4F60;&#x4F7F;&#x7528;&#x65E7;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x4ECD;&#x7136;&#x4F1A;&#x9047;&#x5230;&#x65E7;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;</p>
<p>&#x5728;&#x672C;&#x4E66;&#x7684;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#xFF0C;&#x6211;&#x8C08;&#x5230;&#x4E86;Java&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x95EE;&#x9898;&#xFF1A;&#x6BCF;&#x4E2A;&#x5931;&#x8D25;&#x7684;&#x5B9E;&#x9A8C;&#x90FD;&#x6C38;&#x8FDC;&#x5D4C;&#x5165;&#x5728;&#x8BED;&#x8A00;&#x6216;&#x5E93;&#x4E2D;&#x3002; Java&#x5E76;&#x53D1;&#x5F3A;&#x8C03;&#x4E86;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x5C3D;&#x7BA1;&#x6709;&#x4E0D;&#x5C11;&#x9519;&#x8BEF;&#xFF0C;&#x4F46;&#x9519;&#x8BEF;&#x5E76;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x591A;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x5F88;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x5C1D;&#x8BD5;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002; &#x597D;&#x7684;&#x65B9;&#x9762;&#x662F;&#xFF0C;&#x8FD9;&#x4E9B;&#x5C1D;&#x8BD5;&#x4EA7;&#x751F;&#x4E86;&#x66F4;&#x597D;&#xFF0C;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x8BBE;&#x8BA1;&#x3002; &#x4E0D;&#x5229;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF0C;&#x5728;&#x627E;&#x5230;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#xFF0C;&#x4F60;&#x5F88;&#x5BB9;&#x6613;&#x8FF7;&#x5931;&#x4E8E;&#x65E7;&#x7684;&#x8BBE;&#x8BA1;&#x4E2D;&#x3002;</p>
<h3 class="mume-header" id="%E5%85%B6%E4%BB%96%E7%B1%BB%E5%BA%93">&#x5176;&#x4ED6;&#x7C7B;&#x5E93;</h3>

<p>&#x672C;&#x7AE0;&#x91CD;&#x70B9;&#x4ECB;&#x7ECD;&#x4E86;&#x76F8;&#x5BF9;&#x5B89;&#x5168;&#x6613;&#x7528;&#x7684;&#x5E76;&#x884C;&#x5DE5;&#x5177;&#x6D41;&#x548C;<strong>CompletableFutures</strong>&#xFF0C;&#x5E76;&#x4E14;&#x4EC5;&#x6D89;&#x53CA;Java&#x6807;&#x51C6;&#x5E93;&#x4E2D;&#x4E00;&#x4E9B;&#x66F4;&#x7EC6;&#x7C92;&#x5EA6;&#x7684;&#x5DE5;&#x5177;&#x3002; &#x4E3A;&#x907F;&#x514D;&#x4F60;&#x4E0D;&#x77E5;&#x6240;&#x63AA;&#xFF0C;&#x6211;&#x6CA1;&#x6709;&#x4ECB;&#x7ECD;&#x4F60;&#x53EF;&#x80FD;&#x5B9E;&#x9645;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x67D0;&#x4E9B;&#x5E93;&#x3002;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x51E0;&#x4E2A;<strong>Atomic</strong>&#xFF08;&#x539F;&#x5B50;&#xFF09;&#x7C7B;&#xFF0C;<strong>ConcurrentLinkedDeque</strong>&#xFF0C;<strong>ExecutorService</strong>&#x548C;<strong>ArrayBlockingQueue</strong>&#x3002;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x5E76;&#x53D1;&#x5E95;&#x5C42;&#x539F;&#x7406;</a>&#x6DB5;&#x76D6;&#x4E86;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x5185;&#x5BB9;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x8FD8;&#x60F3;&#x63A2;&#x7D22;<strong>java.util.concurrent</strong>&#x7684;Javadocs&#x3002; &#x4F46;&#x662F;&#x8981;&#x5C0F;&#x5FC3;&#xFF0C;&#x56E0;&#x4E3A;&#x67D0;&#x4E9B;&#x5E93;&#x7EC4;&#x4EF6;&#x5DF2;&#x88AB;&#x65B0;&#x7684;&#x66F4;&#x597D;&#x7684;&#x7EC4;&#x4EF6;&#x6240;&#x53D6;&#x4EE3;&#x3002;</p>
<h3 class="mume-header" id="%E8%80%83%E8%99%91%E4%B8%BA%E5%B9%B6%E5%8F%91%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%AF%AD%E8%A8%80">&#x8003;&#x8651;&#x4E3A;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;</h3>

<p>&#x901A;&#x5E38;&#xFF0C;&#x8BF7;&#x8C28;&#x614E;&#x5730;&#x4F7F;&#x7528;&#x5E76;&#x53D1;&#x3002; &#x5982;&#x679C;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x8BF7;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x6700;&#x73B0;&#x4EE3;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;&#x5E76;&#x884C;&#x6D41;&#x6216;<strong>CompletableFutures</strong>&#x3002; &#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#x65E8;&#x5728;&#xFF08;&#x5047;&#x8BBE;&#x4F60;&#x4E0D;&#x5C1D;&#x8BD5;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF09;&#x4F7F;&#x4F60;&#x6446;&#x8131;&#x9EBB;&#x70E6;&#xFF08;&#x5728;Java&#x7684;&#x4E16;&#x754C;&#x8303;&#x56F4;&#x5185;&#xFF09;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x53D8;&#x5F97;&#x6BD4;&#x9AD8;&#x7EA7;Java&#x6784;&#x9020;&#x6240;&#x652F;&#x6301;&#x7684;&#x95EE;&#x9898;&#x66F4;&#x5927;&#x4E14;&#x66F4;&#x590D;&#x6742;&#xFF0C;&#x8BF7;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x4E13;&#x4E3A;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x4EC5;&#x5728;&#x9700;&#x8981;&#x5E76;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;&#x90E8;&#x5206;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x8BED;&#x8A00;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x7684;&#x3002; &#x5728;&#x64B0;&#x5199;&#x672C;&#x6587;&#x65F6;&#xFF0C;JVM&#x4E0A;&#x6700;&#x7EAF;&#x7CB9;&#x7684;&#x529F;&#x80FD;&#x8BED;&#x8A00;&#x662F;Clojure&#xFF08;Lisp&#x7684;&#x4E00;&#x79CD;&#x7248;&#x672C;&#xFF09;&#x548C;Frege&#xFF08;Haskell&#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x4F7F;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5176;&#x4E2D;&#x7F16;&#x5199;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5E76;&#x53D1;&#x90E8;&#x5206;&#x8BED;&#x8A00;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;JVM&#x8F7B;&#x677E;&#x5730;&#x4E0E;&#x4F60;&#x7684;&#x4E3B;&#x8981;Java&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x3002; &#x6216;&#x8005;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x66F4;&#x590D;&#x6742;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x901A;&#x8FC7;&#x5916;&#x90E8;&#x529F;&#x80FD;&#x63A5;&#x53E3;&#xFF08;FFI&#xFF09;&#x5C06;JVM&#x4E4B;&#x5916;&#x7684;&#x8BED;&#x8A00;&#x4E0E;&#x53E6;&#x4E00;&#x79CD;&#x4E3A;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;<sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup></p>
<p>&#x4F60;&#x5F88;&#x5BB9;&#x6613;&#x88AB;&#x4E00;&#x79CD;&#x8BED;&#x8A00;&#x7ED1;&#x5B9A;&#xFF0C;&#x8FEB;&#x4F7F;&#x81EA;&#x5DF1;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x8BE5;&#x8BED;&#x8A00;&#x6765;&#x505A;&#x6240;&#x6709;&#x4E8B;&#x60C5;&#x3002; &#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x7684;&#x793A;&#x4F8B;&#x662F;&#x6784;&#x5EFA;HTML / JavaScript&#x7528;&#x6237;&#x754C;&#x9762;&#x3002; &#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x786E;&#x5B9E;&#x5F88;&#x96BE;&#x4F7F;&#x7528;&#xFF0C;&#x4EE4;&#x4EBA;&#x8BA8;&#x538C;&#xFF0C;&#x5E76;&#x4E14;&#x6709;&#x8BB8;&#x591A;&#x5E93;&#x5141;&#x8BB8;&#x4F60;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x559C;&#x6B22;&#x7684;&#x8BED;&#x8A00;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x6765;&#x751F;&#x6210;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;<strong>Scala.js</strong>&#x5141;&#x8BB8;&#x4F60;&#x5728;Scala&#x4E2D;&#x5B8C;&#x6210;&#x4EE3;&#x7801;&#xFF09;&#x3002;</p>
<p>&#x5FC3;&#x7406;&#x4E0A;&#x7684;&#x4FBF;&#x5229;&#x662F;&#x4E00;&#x4E2A;&#x5408;&#x7406;&#x7684;&#x8003;&#x8651;&#x56E0;&#x7D20;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x6211;&#x5E0C;&#x671B;&#x6211;&#x5728;&#x672C;&#x7AE0;&#xFF08;&#x4EE5;&#x53CA;&#x9644;&#x5F55;&#xFF1A;<a href="./Appendix-Low-Level-Concurrency.md">&#x5E76;&#x53D1;&#x5E95;&#x5C42;&#x539F;&#x7406;</a>&#xFF09;&#x4E2D;&#x5DF2;&#x7ECF;&#x8868;&#x660E;Java&#x5E76;&#x53D1;&#x662F;&#x4E00;&#x4E2A;&#x4F60;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x9003;&#x79BB;&#x5F88;&#x6DF1;&#x7684;&#x6D1E;&#x3002; &#x4E0E;Java&#x8BED;&#x8A00;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x90E8;&#x5206;&#x76F8;&#x6BD4;&#xFF0C;&#x5728;&#x89C6;&#x89C9;&#x4E0A;&#x68C0;&#x67E5;&#x4EE3;&#x7801;&#x540C;&#x65F6;&#x8BB0;&#x4F4F;&#x6240;&#x6709;&#x9677;&#x9631;&#x6240;&#x9700;&#x8981;&#x7684;&#x7684;&#x77E5;&#x8BC6;&#x8981;&#x56F0;&#x96BE;&#x5F97;&#x591A;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x7684;&#x8BED;&#x8A00;&#x3001;&#x5E93;&#x4F7F;&#x5F97;&#x5E76;&#x53D1;&#x770B;&#x8D77;&#x6765;&#x591A;&#x4E48;&#x7B80;&#x5355;&#xFF0C;&#x90FD;&#x8981;&#x5C06;&#x5176;&#x89C6;&#x4E3A;&#x4E00;&#x79CD;&#x5996;&#x672F;&#xFF0C;&#x56E0;&#x4E3A;&#x603B;&#x662F;&#x6709;&#x4E1C;&#x897F;&#x4F1A;&#x5728;&#x4F60;&#x6700;&#x4E0D;&#x671F;&#x671B;&#x51FA;&#x73B0;&#x7684;&#x65F6;&#x5019;&#x54AC;&#x4F60;&#x3002;</p>
<h3 class="mume-header" id="%E6%8B%93%E5%B1%95%E9%98%85%E8%AF%BB">&#x62D3;&#x5C55;&#x9605;&#x8BFB;</h3>

<p>&#x300A;Java Concurrency in Practice&#x300B;&#xFF0C;&#x51FA;&#x81EA;Brian Goetz&#xFF0C;Tim Peierls&#xFF0C; Joshua Bloch&#xFF0C;Joseph Bowbeer&#xFF0C;David Holmes&#x548C; Doug Lea (Addison Wesley&#xFF0C;2006&#x5E74;)&#x2014;&#x2014;&#x8FD9;&#x4E9B;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;Java&#x5E76;&#x53D1;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x540D;&#x4EBA;&#x540D;&#x5355;&#x4E86;&#x300A;Java Concurrency in Practice&#x300B;&#x7B2C;&#x4E8C;&#x7248;&#xFF0C;&#x51FA;&#x81EA; Doug Lea (Addison-Wesley&#xFF0C;2000&#x5E74;)&#x3002;&#x5C3D;&#x7BA1;&#x8FD9;&#x672C;&#x4E66;&#x51FA;&#x7248;&#x65F6;&#x95F4;&#x8FDC;&#x8FDC;&#x65E9;&#x4E8E;Java 5&#x53D1;&#x5E03;&#xFF0C;&#x4F46;Doug&#x7684;&#x5927;&#x90E8;&#x5206;&#x5DE5;&#x4F5C;&#x90FD;&#x5199;&#x5165;&#x4E86;<strong>java.util.concurrent</strong>&#x5E93;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x672C;&#x4E66;&#x5BF9;&#x4E8E;&#x5168;&#x9762;&#x7406;&#x89E3;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x81F3;&#x5173;&#x91CD;&#x8981;&#x3002; &#x5B83;&#x8D85;&#x8D8A;&#x4E86;Java&#xFF0C;&#x8BA8;&#x8BBA;&#x4E86;&#x8DE8;&#x8BED;&#x8A00;&#x548C;&#x6280;&#x672F;&#x7684;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x3002; &#x5C3D;&#x7BA1;&#x5B83;&#x5728;&#x67D0;&#x4E9B;&#x5730;&#x65B9;&#x53EF;&#x80FD;&#x5F88;&#x949D;&#xFF0C;&#x4F46;&#x503C;&#x5F97;&#x591A;&#x6B21;&#x91CD;&#x8BFB;&#xFF08;&#x6700;&#x597D;&#x662F;&#x5728;&#x4E24;&#x4E2A;&#x6708;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x6D88;&#x5316;&#xFF09;&#x3002; &#x9053;&#x683C;&#xFF08;Doug&#xFF09;&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x4E3A;&#x6570;&#x4E0D;&#x591A;&#x7684;&#x771F;&#x6B63;&#x4E86;&#x89E3;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x4EBA;&#x4E4B;&#x4E00;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x662F;&#x503C;&#x5F97;&#x7684;&#x3002;</p>
<div style="page-break-after: always;"></div>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>&#x4F8B;&#x5982;,Eric-Raymond&#x5728;&#x201C;Unix&#x7F16;&#x7A0B;&#x827A;&#x672F;&#x201D;&#xFF08;Addison-Wesley&#xFF0C;2004&#xFF09;&#x4E2D;&#x63D0;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x6848;&#x4F8B;&#x3002; <a href="#fnref1" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn2" class="footnote-item"><p>&#x53EF;&#x4EE5;&#x8BF4;&#xFF0C;&#x8BD5;&#x56FE;&#x5C06;&#x5E76;&#x53D1;&#x6027;&#x7528;&#x4E8E;&#x540E;&#x7EED;&#x8BED;&#x8A00;&#x662F;&#x4E00;&#x79CD;&#x6CE8;&#x5B9A;&#x8981;&#x5931;&#x8D25;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x4F60;&#x5FC5;&#x987B;&#x5F97;&#x51FA;&#x81EA;&#x5DF1;&#x7684;&#x7ED3;&#x8BBA; <a href="#fnref2" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn3" class="footnote-item"><p>&#x6709;&#x4EBA;&#x8C08;&#x8BBA;&#x5728;Java&#x2014;&#x2014;10&#x4E2D;&#x56F4;&#x7ED5;&#x6CDB;&#x578B;&#x505A;&#x4E00;&#x4E9B;&#x7C7B;&#x4F3C;&#x7684;&#x57FA;&#x672C;&#x6539;&#x8FDB;&#xFF0C;&#x8FD9;&#x5C06;&#x662F;&#x975E;&#x5E38;&#x4EE4;&#x4EBA;&#x96BE;&#x4EE5;&#x7F6E;&#x4FE1;&#x7684;&#x3002; <a href="#fnref3" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn4" class="footnote-item"><p>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x8DA3;&#x7684;&#xFF0C;&#x867D;&#x7136;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x6211;&#x4EEC;&#x671F;&#x671B;&#x5728;&#x516C;&#x5171;&#x63A5;&#x53E3;&#x4E0A;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x7C7B;&#x8868;&#x793A;&#x4E0D;&#x540C;&#x7684;&#x884C;&#x4E3A; <a href="#fnref4" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn5" class="footnote-item"><p>&#x4E0D;&#xFF0C;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x6709;&#x7EAF;&#x7CB9;&#x7684;&#x529F;&#x80FD;&#x6027;Java&#x3002;&#x6211;&#x4EEC;&#x6240;&#x80FD;&#x671F;&#x671B;&#x7684;&#x6700;&#x597D;&#x7684;&#x662F;&#x4E00;&#x79CD;&#x5728;JVM&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x5168;&#x65B0;&#x8BED;&#x8A00;&#x3002; <a href="#fnref5" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn6" class="footnote-item"><p>&#x5F53;&#x4E24;&#x4E2A;&#x4EFB;&#x52A1;&#x80FD;&#x591F;&#x66F4;&#x6539;&#x5176;&#x72B6;&#x6001;&#x4EE5;&#x4F7F;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x88AB;&#x963B;&#x6B62;&#x4F46;&#x5B83;&#x4EEC;&#x4ECE;&#x672A;&#x53D6;&#x5F97;&#x4EFB;&#x4F55;&#x6709;&#x7528;&#x7684;&#x8FDB;&#x5C55;&#x65F6;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6D3B;&#x52A8;&#x9501;&#x3002; <a href="#fnref6" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn7" class="footnote-item"><p>&#x800C;&#x4E0D;&#x662F;&#x8D85;&#x7EBF;&#x7A0B;&#xFF1B;&#x901A;&#x5E38;&#x6BCF;&#x4E2A;&#x5185;&#x6838;&#x6709;&#x4E24;&#x4E2A;&#x8D85;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8BE2;&#x95EE;&#x5185;&#x6838;&#x6570;&#x91CF;&#x65F6;&#xFF0C;&#x672C;&#x4E66;&#x6240;&#x4F7F;&#x7528;&#x7684;Java&#x7248;&#x672C;&#x4F1A;&#x62A5;&#x544A;&#x8D85;&#x7EBF;&#x7A0B;&#x7684;&#x6570;&#x91CF;&#x3002;&#x8D85;&#x7EBF;&#x7A0B;&#x4EA7;&#x751F;&#x4E86;&#x66F4;&#x5FEB;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#xFF0C;&#x4F46;&#x662F;&#x53EA;&#x6709;&#x5B9E;&#x9645;&#x7684;&#x5185;&#x6838;&#x624D;&#x771F;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8D85;&#x7EBF;&#x7A0B;&#x3002; &#x21A9; <a href="#fnref7" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn8" class="footnote-item"><p>&#x5E93;&#x5C31;&#x5728;&#x90A3;&#x91CC;&#x7528;&#x4E8E;&#x8C03;&#x7528;&#xFF0C;&#x800C;&#x8BED;&#x8A00;&#x672C;&#x8EAB;&#x5C31;&#x88AB;&#x8BBE;&#x8BA1;&#x7528;&#x4E8E;&#x6B64;&#x76EE;&#x7684;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5B83;&#x5F88;&#x5C11;&#x53D1;&#x751F;&#xFF0C;&#x4EE5;&#x81F3;&#x4E8E;&#x53EF;&#x4EE5;&#x8BF4;&#x201D;&#x6CA1;&#x6709;&#x201C;&#x3002;&#x21A9; <a href="#fnref8" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn9" class="footnote-item"><p>&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;Flyweight&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#xFF0C;&#x5728;&#x5DE5;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x6570;&#x767E;&#x4E07;&#x4E2A;&#x5BF9;&#x8C61;&#x7528;&#x4E8E;&#x6709;&#x9650;&#x5143;&#x5206;&#x6790;&#x53EF;&#x80FD;&#x5728;Java&#x4E2D;&#x4E0D;&#x53EF;&#x884C;&#x3002;&#x21A9; <a href="#fnref9" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn10" class="footnote-item"><p>&#x5728;&#x79D1;&#x5B66;&#x4E2D;&#xFF0C;&#x867D;&#x7136;&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x4E00;&#x79CD;&#x7406;&#x8BBA;&#x88AB;&#x8BC1;&#x5B9E;&#x8FC7;&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x79CD;&#x7406;&#x8BBA;&#x5FC5;&#x987B;&#x662F;&#x53EF;&#x8BC1;&#x4F2A;&#x7684;&#x624D;&#x6709;&#x610F;&#x4E49;&#x3002;&#x800C;&#x5BF9;&#x4E8E;&#x5E76;&#x53D1;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x5927;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x751A;&#x81F3;&#x90FD;&#x65E0;&#x6CD5;&#x5F97;&#x5230;&#x8FD9;&#x79CD;&#x53EF;&#x8BC1;&#x4F2A;&#x6027;&#x3002;&#x21A9; <a href="#fnref10" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
<li id="fn11" class="footnote-item"><p>&#x5C3D;&#x7BA1;<strong>Go</strong>&#x8BED;&#x8A00;&#x663E;&#x793A;&#x4E86;FFI&#x7684;&#x524D;&#x666F;&#xFF0C;&#x4F46;&#x5728;&#x64B0;&#x5199;&#x672C;&#x6587;&#x65F6;&#xFF0C;&#x5B83;&#x5E76;&#x672A;&#x63D0;&#x4F9B;&#x8DE8;&#x6240;&#x6709;&#x5E73;&#x53F0;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002; <a href="#fnref11" class="footnote-backref">&#x21A9;&#xFE0E;</a></p>
</li>
</ol>
</section>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B">&#x7B2C;&#x4E8C;&#x5341;&#x56DB;&#x7AE0; &#x5E76;&#x53D1;&#x7F16;&#x7A0B;</a>
<ul>
<li><a href="#%E6%9C%AF%E8%AF%AD%E9%97%AE%E9%A2%98">&#x672F;&#x8BED;&#x95EE;&#x9898;</a>
<ul>
<li><a href="#%E5%B9%B6%E5%8F%91%E7%9A%84%E6%96%B0%E5%AE%9A%E4%B9%89">&#x5E76;&#x53D1;&#x7684;&#x65B0;&#x5B9A;&#x4E49;</a></li>
</ul>
</li>
<li><a href="#%E5%B9%B6%E5%8F%91%E7%9A%84%E8%B6%85%E8%83%BD%E5%8A%9B">&#x5E76;&#x53D1;&#x7684;&#x8D85;&#x80FD;&#x529B;</a></li>
<li><a href="#%E5%B9%B6%E5%8F%91%E4%B8%BA%E9%80%9F%E5%BA%A6%E8%80%8C%E7%94%9F">&#x5E76;&#x53D1;&#x4E3A;&#x901F;&#x5EA6;&#x800C;&#x751F;</a></li>
<li><a href="#%E5%9B%9B%E5%8F%A5%E6%A0%BC%E8%A8%80">&#x56DB;&#x53E5;&#x683C;&#x8A00;</a>
<ul>
<li><a href="#1%E4%B8%8D%E8%A6%81%E8%BF%99%E6%A0%B7%E5%81%9A">1.&#x4E0D;&#x8981;&#x8FD9;&#x6837;&#x505A;</a></li>
<li><a href="#2%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%9C%9F%E7%9A%84%E4%B8%80%E5%88%87%E5%8F%AF%E8%83%BD%E9%83%BD%E6%9C%89%E9%97%AE%E9%A2%98">2.&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x662F;&#x771F;&#x7684;&#xFF0C;&#x4E00;&#x5207;&#x53EF;&#x80FD;&#x90FD;&#x6709;&#x95EE;&#x9898;</a></li>
<li><a href="#3%E5%AE%83%E8%B5%B7%E4%BD%9C%E7%94%A8%E5%B9%B6%E4%B8%8D%E6%84%8F%E5%91%B3%E7%9D%80%E5%AE%83%E6%B2%A1%E6%9C%89%E9%97%AE%E9%A2%98">3.&#x5B83;&#x8D77;&#x4F5C;&#x7528;,&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x6CA1;&#x6709;&#x95EE;&#x9898;</a></li>
<li><a href="#4%E4%BD%A0%E5%BF%85%E9%A1%BB%E4%BB%8D%E7%84%B6%E7%90%86%E8%A7%A3">4.&#x4F60;&#x5FC5;&#x987B;&#x4ECD;&#x7136;&#x7406;&#x89E3;</a></li>
</ul>
</li>
<li><a href="#span-id-the-brutal-truth%E6%AE%8B%E9%85%B7%E7%9A%84%E7%9C%9F%E7%9B%B8span">&#x6B8B;&#x9177;&#x7684;&#x771F;&#x76F8;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%85%B6%E4%BD%99%E9%83%A8%E5%88%86">&#x672C;&#x7AE0;&#x5176;&#x4F59;&#x90E8;&#x5206;</a></li>
<li><a href="#%E5%B9%B6%E8%A1%8C%E6%B5%81">&#x5E76;&#x884C;&#x6D41;</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E4%BB%BB%E5%8A%A1">&#x521B;&#x5EFA;&#x548C;&#x8FD0;&#x884C;&#x4EFB;&#x52A1;</a></li>
<li><a href="#%E7%BB%88%E6%AD%A2%E8%80%97%E6%97%B6%E4%BB%BB%E5%8A%A1">&#x7EC8;&#x6B62;&#x8017;&#x65F6;&#x4EFB;&#x52A1;</a></li>
<li><a href="#completablefuture%E7%B1%BB">CompletableFuture&#x7C7B;</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">&#x57FA;&#x672C;&#x7528;&#x6CD5;</a></li>
<li><a href="#%E7%BB%93%E5%90%88-completablefuture">&#x7ED3;&#x5408; CompletableFuture</a></li>
<li><a href="#%E6%A8%A1%E6%8B%9F">&#x6A21;&#x62DF;</a></li>
<li><a href="#%E5%BC%82%E5%B8%B8">&#x5F02;&#x5E38;</a></li>
<li><a href="#%E6%B5%81%E5%BC%82%E5%B8%B8stream-exception">&#x6D41;&#x5F02;&#x5E38;&#xFF08;Stream Exception&#xFF09;</a></li>
<li><a href="#%E6%A3%80%E6%9F%A5%E6%80%A7%E5%BC%82%E5%B8%B8">&#x68C0;&#x67E5;&#x6027;&#x5F02;&#x5E38;</a></li>
</ul>
</li>
<li><a href="#%E6%AD%BB%E9%94%81">&#x6B7B;&#x9501;</a></li>
<li><a href="#%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E9%9D%9E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8">&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</a></li>
<li><a href="#%E5%A4%8D%E6%9D%82%E6%80%A7%E5%92%8C%E4%BB%A3%E4%BB%B7">&#x590D;&#x6742;&#x6027;&#x548C;&#x4EE3;&#x4EF7;</a></li>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93">&#x672C;&#x7AE0;&#x5C0F;&#x7ED3;</a>
<ul>
<li><a href="#%E7%BC%BA%E7%82%B9">&#x7F3A;&#x70B9;</a></li>
<li><a href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E9%99%B7%E9%98%B1">&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x9677;&#x9631;</a></li>
<li><a href="#this-albatross-is-big">This Albatross is Big</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%BA%93">&#x5176;&#x4ED6;&#x7C7B;&#x5E93;</a></li>
<li><a href="#%E8%80%83%E8%99%91%E4%B8%BA%E5%B9%B6%E5%8F%91%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%AF%AD%E8%A8%80">&#x8003;&#x8651;&#x4E3A;&#x5E76;&#x53D1;&#x8BBE;&#x8BA1;&#x7684;&#x8BED;&#x8A00;</a></li>
<li><a href="#%E6%8B%93%E5%B1%95%E9%98%85%E8%AF%BB">&#x62D3;&#x5C55;&#x9605;&#x8BFB;</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>